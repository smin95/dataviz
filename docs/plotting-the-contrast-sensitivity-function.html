<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Plotting the Contrast Sensitivity Function | Data Analysis and Visualization in R Using smplot2</title>
  <meta name="description" content="Chapter 13 Plotting the Contrast Sensitivity Function | Data Analysis and Visualization in R Using smplot2" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Plotting the Contrast Sensitivity Function | Data Analysis and Visualization in R Using smplot2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Plotting the Contrast Sensitivity Function | Data Analysis and Visualization in R Using smplot2" />
  
  
  

<meta name="author" content="Seung Hyun Min" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"/>
<link rel="next" href="area-under-curve-aulcsf-and-r2-of-the-csf.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#major-updates"><i class="fa fa-check"></i>Major updates</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="opening-remarks.html"><a href="opening-remarks.html"><i class="fa fa-check"></i><b>1</b> Opening Remarks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="opening-remarks.html"><a href="opening-remarks.html#how-to-read-this-book"><i class="fa fa-check"></i><b>1.1</b> How to read this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>2</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="2.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>2.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>2.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Visualization with smplot2</b></span></li>
<li class="chapter" data-level="3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>3</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>3.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i><b>3.1.1</b> Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i><b>3.2.1</b> Let’s make some graphs</a></li>
<li class="chapter" data-level="3.2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i><b>3.2.2</b> How ggplot works</a></li>
<li class="chapter" data-level="3.2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i><b>3.2.3</b> Different color of points for each unique group</a></li>
<li class="chapter" data-level="3.2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i><b>3.2.4</b> Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="3.2.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i><b>3.2.5</b> Same shape across all groups</a></li>
<li class="chapter" data-level="3.2.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i><b>3.2.6</b> How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="3.2.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i><b>3.2.7</b> geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="3.2.8" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i><b>3.2.8</b> Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot2"><i class="fa fa-check"></i><b>3.3</b> Improve data visualization using smplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i><b>3.3.1</b> Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i><b>3.3.2</b> Reporting statistics from a paired correlation</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#changing-the-text"><i class="fa fa-check"></i><b>3.3.3</b> Changing the text</a></li>
<li class="chapter" data-level="3.3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#plotting-the-average-with-standard-errors"><i class="fa fa-check"></i><b>3.3.4</b> Plotting the average with standard errors</a></li>
<li class="chapter" data-level="3.3.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><i class="fa fa-check"></i><b>3.3.5</b> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i><b>3.3.6</b> Different color for each group but with other colors</a></li>
<li class="chapter" data-level="3.3.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1."><i class="fa fa-check"></i><b>3.3.7</b> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>4</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>4.1</b> Upload sample data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i><b>4.1.1</b> Download requirements</a></li>
<li class="chapter" data-level="4.1.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i><b>4.1.2</b> Before we get started</a></li>
<li class="chapter" data-level="4.1.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i><b>4.1.3</b> data.csv</a></li>
<li class="chapter" data-level="4.1.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><i class="fa fa-check"></i><b>4.1.4</b> <code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i><b>4.1.5</b> Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>4.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i><b>4.2.1</b> What is a boxplot?</a></li>
<li class="chapter" data-level="4.2.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i><b>4.2.2</b> Boxplot vs bar graph</a></li>
<li class="chapter" data-level="4.2.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.3</b> Boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i><b>4.2.4</b> Problem: Alphabetical order</a></li>
<li class="chapter" data-level="4.2.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i><b>4.2.5</b> Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="4.2.6" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i><b>4.2.6</b> Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="4.2.7" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.7</b> Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.8" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i><b>4.2.8</b> A boxplot with individual data</a></li>
<li class="chapter" data-level="4.2.9" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><i class="fa fa-check"></i><b>4.2.9</b> <code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="4.2.10" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i><b>4.2.10</b> Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>4.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i><b>4.3.1</b> Structure of the violin plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>4.3.2</b> Violin plot with ggplot2</a></li>
<li class="chapter" data-level="4.3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i><b>4.3.3</b> Violin plot with individual points</a></li>
<li class="chapter" data-level="4.3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i><b>4.3.4</b> geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="4.3.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i><b>4.3.5</b> Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html"><i class="fa fa-check"></i><b>5</b> Bar Graph, Slope Chart and Point plot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph"><i class="fa fa-check"></i><b>5.1</b> Bar graph</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#scaling-the-y-axis"><i class="fa fa-check"></i><b>5.1.1</b> Scaling the y-axis</a></li>
<li class="chapter" data-level="5.1.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>5.1.2</b> Plotting individual points with unique colors</a></li>
<li class="chapter" data-level="5.1.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#other-parameters"><i class="fa fa-check"></i><b>5.1.3</b> Other parameters</a></li>
<li class="chapter" data-level="5.1.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph-with-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.1.4</b> Bar graph with data of multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart"><i class="fa fa-check"></i><b>5.2</b> Slope chart</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot"><i class="fa fa-check"></i><b>5.2.1</b> Slope chart with mean plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot-and-error-bar"><i class="fa fa-check"></i><b>5.2.2</b> Slope chart with mean plot and error bar</a></li>
<li class="chapter" data-level="5.2.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-x-levels"><i class="fa fa-check"></i><b>5.2.3</b> Slope chart with multiple x levels</a></li>
<li class="chapter" data-level="5.2.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-groups-and-x-levels"><i class="fa fa-check"></i><b>5.2.4</b> Slope chart with multiple groups and x levels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot"><i class="fa fa-check"></i><b>5.3</b> Point plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#data-with-more-than-two-groups"><i class="fa fa-check"></i><b>5.3.1</b> Data with more than two groups</a></li>
<li class="chapter" data-level="5.3.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-one-group"><i class="fa fa-check"></i><b>5.3.2</b> Point plot with a shadow using data of one group</a></li>
<li class="chapter" data-level="5.3.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.3.3</b> Point plot with a shadow using data of multiple groups</a></li>
<li class="chapter" data-level="5.3.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#adding-and-modifying-legends"><i class="fa fa-check"></i><b>5.3.4</b> Adding and modifying legends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html"><i class="fa fa-check"></i><b>6</b> Raincloud and Forest Plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot"><i class="fa fa-check"></i><b>6.1</b> Raincloud plot</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changing-the-x-axis-labels"><i class="fa fa-check"></i><b>6.1.1</b> Changing the x-axis labels</a></li>
<li class="chapter" data-level="6.1.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#separating-the-components-and-configuration"><i class="fa fa-check"></i><b>6.1.2</b> Separating the components and configuration</a></li>
<li class="chapter" data-level="6.1.3" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changng-the-theme-and-orientation"><i class="fa fa-check"></i><b>6.1.3</b> Changng the theme and orientation</a></li>
<li class="chapter" data-level="6.1.4" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot-with-data-from-multiple-groups"><i class="fa fa-check"></i><b>6.1.4</b> Raincloud plot with data from multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#forest-plot"><i class="fa fa-check"></i><b>6.2</b> Forest plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#plotting-the-forest-plot-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>6.2.1</b> Plotting the forest plot using data of multiple groups</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Analysis with smplot2</b></span></li>
<li class="chapter" data-level="7" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html"><i class="fa fa-check"></i><b>7</b> Combining Plots with Common Axes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>7.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-for-rows"><i class="fa fa-check"></i><b>7.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="7.1.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#select-for-columns"><i class="fa fa-check"></i><b>7.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="7.1.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>7.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-the-averaged-data-with-error-bars"><i class="fa fa-check"></i><b>7.2</b> Plotting the averaged data with error bars</a></li>
<li class="chapter" data-level="7.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-individual-data"><i class="fa fa-check"></i><b>7.3</b> Plotting individual data</a></li>
<li class="chapter" data-level="7.4" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#putting-multiple-plots-together"><i class="fa fa-check"></i><b>7.4</b> Putting multiple plots together</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html"><i class="fa fa-check"></i><b>8</b> Calculating Area under a Curve</a>
<ul>
<li class="chapter" data-level="8.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#pipe"><i class="fa fa-check"></i><b>8.1</b> Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="8.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#area-under-a-curve"><i class="fa fa-check"></i><b>8.2</b> Area under a curve</a></li>
<li class="chapter" data-level="8.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#reproducing-figures-in-the-paper-min-et-al.-2019"><i class="fa fa-check"></i><b>8.3</b> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3b-a-best-fit-line-with-points-and-error-bars"><i class="fa fa-check"></i><b>8.3.1</b> Figure 3B (a best-fit line with points and error bars)</a></li>
<li class="chapter" data-level="8.3.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3d-a-bar-graph"><i class="fa fa-check"></i><b>8.3.2</b> Figure 3D (a bar graph)</a></li>
<li class="chapter" data-level="8.3.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3e-modeling-in-matlab-and-plotting-in-r"><i class="fa fa-check"></i><b>8.3.3</b> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html"><i class="fa fa-check"></i><b>9</b> Calculating Linear Slopes</a>
<ul>
<li class="chapter" data-level="9.1" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#linear-relationship-using-lm"><i class="fa fa-check"></i><b>9.1</b> Linear relationship using <code>lm()</code></a></li>
<li class="chapter" data-level="9.2" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#calculating-slopes-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>9.2</b> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>10</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-statistics.html"><a href="basic-statistics.html#one-sample-t-test"><i class="fa fa-check"></i><b>10.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="10.2" data-path="basic-statistics.html"><a href="basic-statistics.html#two-sample-t-test"><i class="fa fa-check"></i><b>10.2</b> Two-sample t-test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#shapiro-wilk-test-to-test-for-normality-of-data"><i class="fa fa-check"></i><b>10.2.1</b> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basic-statistics.html"><a href="basic-statistics.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>10.3</b> Wilcoxon Signed-rank Test</a></li>
<li class="chapter" data-level="10.4" data-path="basic-statistics.html"><a href="basic-statistics.html#effect-size"><i class="fa fa-check"></i><b>10.4</b> Effect Size</a></li>
<li class="chapter" data-level="10.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.5</b> Post-hoc Power Analysis</a></li>
<li class="chapter" data-level="10.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>10.6</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#check-for-outliers"><i class="fa fa-check"></i><b>10.6.1</b> Check for Outliers</a></li>
<li class="chapter" data-level="10.6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data"><i class="fa fa-check"></i><b>10.6.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.6.3" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-the-assumption-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>10.6.3</b> Checking the Assumption for Homogeneity of Variance</a></li>
<li class="chapter" data-level="10.6.4" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-one-way-anova"><i class="fa fa-check"></i><b>10.6.4</b> Computing One-way ANOVA</a></li>
<li class="chapter" data-level="10.6.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-tests"><i class="fa fa-check"></i><b>10.6.5</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="10.6.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>10.6.6</b> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="basic-statistics.html"><a href="basic-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>10.7</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="basic-statistics.html"><a href="basic-statistics.html#identifying-outliers"><i class="fa fa-check"></i><b>10.7.1</b> Identifying Outliers</a></li>
<li class="chapter" data-level="10.7.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data-1"><i class="fa fa-check"></i><b>10.7.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.7.3" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-two-way-anova"><i class="fa fa-check"></i><b>10.7.3</b> Computing Two-way ANOVA</a></li>
<li class="chapter" data-level="10.7.4" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-test"><i class="fa fa-check"></i><b>10.7.4</b> Post-hoc Test</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="basic-statistics.html"><a href="basic-statistics.html#friedman-test"><i class="fa fa-check"></i><b>10.8</b> Friedman Test</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="basic-statistics.html"><a href="basic-statistics.html#performing-friedman-test"><i class="fa fa-check"></i><b>10.8.1</b> Performing Friedman Test</a></li>
<li class="chapter" data-level="10.8.2" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-analysis"><i class="fa fa-check"></i><b>10.8.2</b> Post-hoc Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-resources"><i class="fa fa-check"></i><b>10.9</b> Extra Resources</a></li>
</ul></li>
<li class="part"><span><b>III Manual for smplot2</b></span></li>
<li class="chapter" data-level="11" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><i class="fa fa-check"></i><b>11</b> Themes, Colors, Correlations, Boxplots, Violins and Bars (Part 1)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#installation-of-the-package"><i class="fa fa-check"></i><b>11.1</b> Installation of the Package</a></li>
<li class="chapter" data-level="11.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#how-...-and-xxx.params-arguments-work"><i class="fa fa-check"></i><b>11.2</b> How <code>...</code> and <code>xxx.params</code> arguments work</a></li>
<li class="chapter" data-level="11.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#color-palette"><i class="fa fa-check"></i><b>11.3</b> Color palette</a></li>
<li class="chapter" data-level="11.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#graph-themes"><i class="fa fa-check"></i><b>11.4</b> Graph themes</a></li>
<li class="chapter" data-level="11.5" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot"><i class="fa fa-check"></i><b>11.5</b> Correlation plot</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_statcorr"><i class="fa fa-check"></i><b>11.5.1</b> <code>sm_statCorr()</code></a></li>
<li class="chapter" data-level="11.5.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_corr_avgerr"><i class="fa fa-check"></i><b>11.5.2</b> <code>sm_corr_avgErr()</code></a></li>
<li class="chapter" data-level="11.5.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#structure-of-data-frame"><i class="fa fa-check"></i><b>11.5.3</b> Structure of data frame</a></li>
<li class="chapter" data-level="11.5.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>11.5.4</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>11.6</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>11.6.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>11.7</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>11.7.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>11.8</b> Bar plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-3"><i class="fa fa-check"></i><b>11.8.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><i class="fa fa-check"></i><b>12</b> Slope Charts, Point plots, Bland-Altman, Forests, Rainclouds, Histograms (Part 2)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#slope-chart---sm_slope"><i class="fa fa-check"></i><b>12.1</b> Slope chart - <code>sm_slope()</code></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#drawing-the-mean-plot"><i class="fa fa-check"></i><b>12.1.1</b> Drawing the mean plot</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#point-plot---sm_pointplot"><i class="fa fa-check"></i><b>12.2</b> Point plot - <code>sm_pointplot()</code></a></li>
<li class="chapter" data-level="12.3" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>12.3</b> A Bland Altman plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="12.4" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#forest-plot---sm_forest"><i class="fa fa-check"></i><b>12.4</b> Forest plot - <code>sm_forest()</code></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#annotation-using-sm_forest_annot"><i class="fa fa-check"></i><b>12.4.1</b> Annotation using <code>sm_forest_annot()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>12.5</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="12.6" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#histogram---sm_hist"><i class="fa fa-check"></i><b>12.6</b> Histogram - <code>sm_hist()</code></a></li>
</ul></li>
<li class="part"><span><b>IV Contrast Sensitivity Function</b></span></li>
<li class="chapter" data-level="13" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>13</b> Plotting the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="13.1" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#brief-introduction"><i class="fa fa-check"></i><b>13.1</b> Brief Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#data-visualization"><i class="fa fa-check"></i><b>13.2</b> Data Visualization</a></li>
<li class="chapter" data-level="13.3" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#facetting-the-contrast-sensitivity-functions"><i class="fa fa-check"></i><b>13.3</b> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html"><i class="fa fa-check"></i><b>14</b> Area under Curve, AULCSF and R2 of the CSF</a>
<ul>
<li class="chapter" data-level="14.1" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#area-under-a-curve-1"><i class="fa fa-check"></i><b>14.1</b> Area under a Curve</a></li>
<li class="chapter" data-level="14.2" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#sm_trapz-sm_aulcsf-and-sm_r2"><i class="fa fa-check"></i><b>14.2</b> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
<li class="chapter" data-level="14.3" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#calculating-area-and-r2-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>14.3</b> Calculating area and R2 of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="14.4" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#case-study"><i class="fa fa-check"></i><b>14.4</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>15</b> Understanding the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="15.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#contrast-sensitivity-function-model"><i class="fa fa-check"></i><b>15.1</b> Contrast Sensitivity Function Model</a></li>
<li class="chapter" data-level="15.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_csf"><i class="fa fa-check"></i><b>15.2</b> Understanding <code>sm_CSF()</code></a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_params"><i class="fa fa-check"></i><b>15.2.1</b> <code>sm_params()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_cutoff"><i class="fa fa-check"></i><b>15.2.2</b> <code>sm_cutOff()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_ribboncsf"><i class="fa fa-check"></i><b>15.3</b> Understanding <code>sm_ribbonCSF()</code></a></li>
<li class="chapter" data-level="15.4" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#calculating-the-five-parameters-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>15.4</b> Calculating the five parameters of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="15.5" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#visualization-of-the-parameters"><i class="fa fa-check"></i><b>15.5</b> Visualization of the parameters</a></li>
<li class="chapter" data-level="15.6" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#case-study-1"><i class="fa fa-check"></i><b>15.6</b> Case Study</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-the-contrast-sensitivity-function" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Plotting the Contrast Sensitivity Function<a href="plotting-the-contrast-sensitivity-function.html#plotting-the-contrast-sensitivity-function" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For the next three chapters, we will use <strong>smCSF</strong>. Make sure you have downloaded it.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="plotting-the-contrast-sensitivity-function.html#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb627-2"><a href="plotting-the-contrast-sensitivity-function.html#cb627-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smCSF&#39;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Also, we will use the data of achromatic contrast sensitivity from 51 normal observers from this paper (a subset of the entire dataset):</p>
<p><strong>Kim, Y. J., Reynaud, A., Hess, R. F., &amp; Mullen, K. T. (2017). A normative data set for the clinical assessment of achromatic and chromatic contrast sensitivity using a qCSF approach. Investigative ophthalmology &amp; visual science, 58(9), 3628-3636.</strong></p>
<p>Luckily, the data are publicly available. I have reorganized the data so that we could easily use them in the form of a data frame. Let’s load the data from online.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="plotting-the-contrast-sensitivity-function.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb628-2"><a href="plotting-the-contrast-sensitivity-function.html#cb628-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb628-3"><a href="plotting-the-contrast-sensitivity-function.html#cb628-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smCSF)</span></code></pre></div>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="plotting-the-contrast-sensitivity-function.html#cb629-1" aria-hidden="true" tabindex="-1"></a>ACh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="plotting-the-contrast-sensitivity-function.html#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Repetition SpatialFreq Sensitivity
##   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1 S1               1        0.25       23.8 
## 2 S2               1        0.25       18.0 
## 3 S3               1        0.25       14.2 
## 4 S4               1        0.25        5.14
## 5 S5               1        0.25       16.0 
## 6 S6               1        0.25       10.9</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 51 participants total in the .csv file.</p></li>
<li><p>Next, <code>Repetition</code> refers to each repetition of the measurement The participants performed two repetitions of the contrast sensitivity measurement.</p></li>
<li><p><code>SpatialFreq</code> refers to spatial frequency of the stimuli that were shown to test the observers’ contrast sensitivity. There are a total of 12 spatial frequencies.</p></li>
<li><p>The <code>Sensitivity</code> column refers to the linear values of the contrast sensitivity.</p></li>
</ul>
<div id="brief-introduction" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Brief Introduction<a href="plotting-the-contrast-sensitivity-function.html#brief-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The contrast sensitivity function (CSF) how the observer is sensitive to an image. This image could be large (low spatial frequency) or small (high spatal frequency). To obtain the CSF, the measurement test must measure the threshold. Threshold refers to the difference in stimulus magnitude between the states of presence and absence. If the observer can just barely discriminate between these two states of the visual stimulus, this can be described as the threshold for detection.</p>
</div>
<div id="data-visualization" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Data Visualization<a href="plotting-the-contrast-sensitivity-function.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s compute the average, standard errors and standard deviation using the dataset. It is recommended that the reader has read Chapters 5 and 6 already. Understanding of <code>summarise()</code>, <code>filter()</code>, <code>mutate()</code> and <code>%&gt;%</code> is assumed.</p>
<p>The code below reorganizes the <code>ACh</code> dataset so that instead of containing the data of each subject, it now contains the averaged data across <code>Repetition</code> and <code>SpatialFreq</code> as well as their standard errors and standard deviations. We use <code>mean()</code> to compute the mean, <code>sm_stdErr()</code> the standard error, and <code>sd()</code> the standard deviation.</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="plotting-the-contrast-sensitivity-function.html#cb632-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> </span>
<span id="cb632-2"><a href="plotting-the-contrast-sensitivity-function.html#cb632-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Repetition, SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb632-3"><a href="plotting-the-contrast-sensitivity-function.html#cb632-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb632-4"><a href="plotting-the-contrast-sensitivity-function.html#cb632-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb632-5"><a href="plotting-the-contrast-sensitivity-function.html#cb632-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb632-6"><a href="plotting-the-contrast-sensitivity-function.html#cb632-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb632-7"><a href="plotting-the-contrast-sensitivity-function.html#cb632-7" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1          1        0.25    12.6      0.743       5.31
##  2          1        0.35    14.7      0.777       5.55
##  3          1        0.49    18.6      0.993       7.09
##  4          1        0.68    23.7      1.22        8.71
##  5          1        0.94    28.7      1.36        9.68
##  6          1        1.31    32.0      1.40        9.99
##  7          1        1.83    32.4      1.43       10.2 
##  8          1        2.54    29.6      1.39        9.93
##  9          1        3.54    24.3      1.22        8.70
## 10          1        4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>Let’s create a variable that stores the data for each <code>Repetition</code>. Before we do that, however, it is important that we convert the data type of the <code>Repetition</code> column from <code>&lt;dbl&gt;</code> to <code>&lt;fct&gt;</code>, which refers from <strong>double</strong> to <strong>factor</strong>. <strong>Double</strong> refers to continuous data, whereas <strong>factor</strong> refers to categorical data.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="plotting-the-contrast-sensitivity-function.html#cb634-1" aria-hidden="true" tabindex="-1"></a>ACh_avg<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg<span class="sc">$</span>Repetition) <span class="co"># factor</span></span>
<span id="cb634-2"><a href="plotting-the-contrast-sensitivity-function.html#cb634-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-3"><a href="plotting-the-contrast-sensitivity-function.html#cb634-3" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># repetition 1</span></span>
<span id="cb634-4"><a href="plotting-the-contrast-sensitivity-function.html#cb634-4" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">2</span>) <span class="co"># repetition 2</span></span></code></pre></div>
<p>Let’s now plot the data for each repetition using <strong>ggplot2</strong>. Understanding of Chapters 1-4 is assumed.</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="plotting-the-contrast-sensitivity-function.html#cb635-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb635-2"><a href="plotting-the-contrast-sensitivity-function.html#cb635-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb635-3"><a href="plotting-the-contrast-sensitivity-function.html#cb635-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb635-4"><a href="plotting-the-contrast-sensitivity-function.html#cb635-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb635-5"><a href="plotting-the-contrast-sensitivity-function.html#cb635-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb635-6"><a href="plotting-the-contrast-sensitivity-function.html#cb635-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-518-1.png" width="336" /></p>
<p>So far, this graph does not show the contrast sensitivity function, which has a rotund shape. Instead, if we connect the points, we get this plot instead.</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="plotting-the-contrast-sensitivity-function.html#cb636-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb636-2"><a href="plotting-the-contrast-sensitivity-function.html#cb636-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb636-3"><a href="plotting-the-contrast-sensitivity-function.html#cb636-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb636-4"><a href="plotting-the-contrast-sensitivity-function.html#cb636-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb636-5"><a href="plotting-the-contrast-sensitivity-function.html#cb636-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb636-6"><a href="plotting-the-contrast-sensitivity-function.html#cb636-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb636-7"><a href="plotting-the-contrast-sensitivity-function.html#cb636-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-519-1.png" width="336" /></p>
<p>The function is still not a smooth, rotund shape. This is because it is standard to plot the contrast sensitivity function in log10 scales in both x and y axes. The code below shows the plot in the log scale.</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="plotting-the-contrast-sensitivity-function.html#cb637-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb637-2"><a href="plotting-the-contrast-sensitivity-function.html#cb637-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb637-3"><a href="plotting-the-contrast-sensitivity-function.html#cb637-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb637-4"><a href="plotting-the-contrast-sensitivity-function.html#cb637-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb637-5"><a href="plotting-the-contrast-sensitivity-function.html#cb637-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb637-6"><a href="plotting-the-contrast-sensitivity-function.html#cb637-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb637-7"><a href="plotting-the-contrast-sensitivity-function.html#cb637-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb637-8"><a href="plotting-the-contrast-sensitivity-function.html#cb637-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb637-9"><a href="plotting-the-contrast-sensitivity-function.html#cb637-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-520-1.png" width="336" /></p>
<p>This plot shows the averaged sensitivity for each spatial frequency during the first repetition. However, the contrast sensitivity function is still missing because this plot instead shows the plot that is connected between a pair of the points. To plot the contrast sensitivity function with the data, <code>sm_CSF()</code> is required.</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="plotting-the-contrast-sensitivity-function.html#cb638-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb638-2"><a href="plotting-the-contrast-sensitivity-function.html#cb638-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-521-1.png" width="336" /></p>
<p>Notice that even if the data frame contains data in <strong>linear units</strong>, the plotted data from <code>sm_CSF()</code> are in log10 scales. It shows a nice, rotund shape that is typical of the contrast sensitivity function. The function can also plot the linear curve by setting <code>sm_CSF(logXY = FALSE)</code>. The default is <code>sm_CSF(logXY = TRUE)</code>.</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="plotting-the-contrast-sensitivity-function.html#cb639-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb639-2"><a href="plotting-the-contrast-sensitivity-function.html#cb639-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-522-1.png" width="336" /></p>
<p>Now let’s plot a prettier contrast sensitivity function.</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="plotting-the-contrast-sensitivity-function.html#cb640-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb640-2"><a href="plotting-the-contrast-sensitivity-function.html#cb640-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>)) <span class="sc">+</span></span>
<span id="cb640-3"><a href="plotting-the-contrast-sensitivity-function.html#cb640-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb640-4"><a href="plotting-the-contrast-sensitivity-function.html#cb640-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb640-5"><a href="plotting-the-contrast-sensitivity-function.html#cb640-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb640-6"><a href="plotting-the-contrast-sensitivity-function.html#cb640-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb640-7"><a href="plotting-the-contrast-sensitivity-function.html#cb640-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-523-1.png" width="336" /></p>
<p>We can also plot the data using <code>ACh_avg2</code>, which contains data from the second repetition rather than first.</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="plotting-the-contrast-sensitivity-function.html#cb641-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb641-2"><a href="plotting-the-contrast-sensitivity-function.html#cb641-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb641-3"><a href="plotting-the-contrast-sensitivity-function.html#cb641-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb641-4"><a href="plotting-the-contrast-sensitivity-function.html#cb641-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb641-5"><a href="plotting-the-contrast-sensitivity-function.html#cb641-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb641-6"><a href="plotting-the-contrast-sensitivity-function.html#cb641-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb641-7"><a href="plotting-the-contrast-sensitivity-function.html#cb641-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-524-1.png" width="336" /></p>
<p>Notice that <code>sm_CSF()</code> is written first because the curve has to appear before the points (<code>geom_point()</code>); else, the points will be covered by the CSF curve. This example is shown below.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="plotting-the-contrast-sensitivity-function.html#cb642-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb642-2"><a href="plotting-the-contrast-sensitivity-function.html#cb642-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb642-3"><a href="plotting-the-contrast-sensitivity-function.html#cb642-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb642-4"><a href="plotting-the-contrast-sensitivity-function.html#cb642-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb642-5"><a href="plotting-the-contrast-sensitivity-function.html#cb642-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb642-6"><a href="plotting-the-contrast-sensitivity-function.html#cb642-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb642-7"><a href="plotting-the-contrast-sensitivity-function.html#cb642-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-525-1.png" width="336" /></p>
<p>The curve appears later in this plot, so it covers some overlapping points.</p>
<p><strong>smCSF</strong> also offers a function that fill the area of the CSF curve. This function is <code>sm_areaCSF()</code>. The default is set to plot the area in log10 scales, <code>sm_areaCSF(logXY = TRUE)</code>.</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="plotting-the-contrast-sensitivity-function.html#cb643-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb643-2"><a href="plotting-the-contrast-sensitivity-function.html#cb643-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>() <span class="sc">+</span></span>
<span id="cb643-3"><a href="plotting-the-contrast-sensitivity-function.html#cb643-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-526-1.png" width="336" /></p>
<p>To plot the linear CSF and its area, <code>logXY = FALSE</code> has to be set <code>FALSE</code> in both <code>sm_areaCSF()</code> and <code>sm_CSF()</code>. The functions of <code>smCSF</code> have defaults <code>logXY = TRUE</code>, therefore, it is recommended that the user uploads a data frame that contains the linear data of spatial frequencies and contrast sensitivities. The functions then will convert them into log scale by default.</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="plotting-the-contrast-sensitivity-function.html#cb644-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb644-2"><a href="plotting-the-contrast-sensitivity-function.html#cb644-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb644-3"><a href="plotting-the-contrast-sensitivity-function.html#cb644-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-527-1.png" width="336" /></p>
<p>We can make the area plot prettier.</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="plotting-the-contrast-sensitivity-function.html#cb645-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb645-2"><a href="plotting-the-contrast-sensitivity-function.html#cb645-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb645-3"><a href="plotting-the-contrast-sensitivity-function.html#cb645-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb645-4"><a href="plotting-the-contrast-sensitivity-function.html#cb645-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb645-5"><a href="plotting-the-contrast-sensitivity-function.html#cb645-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb645-6"><a href="plotting-the-contrast-sensitivity-function.html#cb645-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb645-7"><a href="plotting-the-contrast-sensitivity-function.html#cb645-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb645-8"><a href="plotting-the-contrast-sensitivity-function.html#cb645-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb645-9"><a href="plotting-the-contrast-sensitivity-function.html#cb645-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">0.9</span>, <span class="at">y =</span> <span class="fl">1.3</span>, <span class="at">label =</span> <span class="st">&#39;Area under Log CSF&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-528-1.png" width="336" /></p>
<p>You might get a warning that says <code>Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale</code>. You can ignore this warning and not be worried about it. This is because we used the function <code>scale_y_log10()</code> on top of <code>sm_CSF()</code>, which actually calls forth the function <code>scale_y_continuous()</code> to convert the plot into log scales. Hence, there are two functions that serve the same purpose here, so the warning message is printed.</p>
<p>The <strong>smCSF</strong> package also offers a function that draws a ribbon shade to denote standard error or standard deviation. This function works exactly the same as <code>geom_ribbon()</code>. It requires the uses to specify <code>ymin</code> and <code>ymax</code>. The example below plots standard deviation using <code>sm_ribbonCSF()</code>, where <code>ymin = avgSens - stdDevSens</code> and <code>ymax = avgSens + stdDevSens</code>. As before, its default is <code>logXY = TRUE</code>. Therefore, even if <code>ACh_avg2</code> contains data in linear units, the ribbon shade that is generated by <code>sm_ribbonCSF()</code> will be in log unit.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="plotting-the-contrast-sensitivity-function.html#cb646-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb646-2"><a href="plotting-the-contrast-sensitivity-function.html#cb646-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb646-3"><a href="plotting-the-contrast-sensitivity-function.html#cb646-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)) <span class="sc">+</span></span>
<span id="cb646-4"><a href="plotting-the-contrast-sensitivity-function.html#cb646-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb646-5"><a href="plotting-the-contrast-sensitivity-function.html#cb646-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-529-1.png" width="336" /></p>
<p>Let’s make the plot prettier using <strong>smplot</strong>.</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="plotting-the-contrast-sensitivity-function.html#cb647-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb647-2"><a href="plotting-the-contrast-sensitivity-function.html#cb647-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb647-3"><a href="plotting-the-contrast-sensitivity-function.html#cb647-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens),</span>
<span id="cb647-4"><a href="plotting-the-contrast-sensitivity-function.html#cb647-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb647-5"><a href="plotting-the-contrast-sensitivity-function.html#cb647-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)) <span class="sc">+</span></span>
<span id="cb647-6"><a href="plotting-the-contrast-sensitivity-function.html#cb647-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb647-7"><a href="plotting-the-contrast-sensitivity-function.html#cb647-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb647-8"><a href="plotting-the-contrast-sensitivity-function.html#cb647-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb647-9"><a href="plotting-the-contrast-sensitivity-function.html#cb647-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb647-10"><a href="plotting-the-contrast-sensitivity-function.html#cb647-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-530-1.png" width="336" /></p>
<p>You can also shade standard error instead, but the ribbon is barely visible.</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="plotting-the-contrast-sensitivity-function.html#cb648-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb648-2"><a href="plotting-the-contrast-sensitivity-function.html#cb648-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdErrSens,</span>
<span id="cb648-3"><a href="plotting-the-contrast-sensitivity-function.html#cb648-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdErrSens)) <span class="sc">+</span></span>
<span id="cb648-4"><a href="plotting-the-contrast-sensitivity-function.html#cb648-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb648-5"><a href="plotting-the-contrast-sensitivity-function.html#cb648-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-531-1.png" width="336" /></p>
<p>As practice, let’s plot the averaged data across all repetitions.</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="plotting-the-contrast-sensitivity-function.html#cb649-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_final <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb649-2"><a href="plotting-the-contrast-sensitivity-function.html#cb649-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb649-3"><a href="plotting-the-contrast-sensitivity-function.html#cb649-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb649-4"><a href="plotting-the-contrast-sensitivity-function.html#cb649-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb649-5"><a href="plotting-the-contrast-sensitivity-function.html#cb649-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-6"><a href="plotting-the-contrast-sensitivity-function.html#cb649-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh_avg_final)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1        0.25    13.2      0.536       5.41
## 2        0.35    15.2      0.568       5.74
## 3        0.49    19.1      0.698       7.05
## 4        0.68    24.3      0.836       8.44
## 5        0.94    29.4      0.938       9.48
## 6        1.31    33.0      0.977       9.87</code></pre>
<p>Here is the new data frame <code>ACh_avg_final</code>.</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="plotting-the-contrast-sensitivity-function.html#cb651-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_final <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb651-2"><a href="plotting-the-contrast-sensitivity-function.html#cb651-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb651-3"><a href="plotting-the-contrast-sensitivity-function.html#cb651-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens),</span>
<span id="cb651-4"><a href="plotting-the-contrast-sensitivity-function.html#cb651-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb651-5"><a href="plotting-the-contrast-sensitivity-function.html#cb651-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb651-6"><a href="plotting-the-contrast-sensitivity-function.html#cb651-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb651-7"><a href="plotting-the-contrast-sensitivity-function.html#cb651-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb651-8"><a href="plotting-the-contrast-sensitivity-function.html#cb651-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb651-9"><a href="plotting-the-contrast-sensitivity-function.html#cb651-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Contrast Sensitivity (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb651-10"><a href="plotting-the-contrast-sensitivity-function.html#cb651-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb651-11"><a href="plotting-the-contrast-sensitivity-function.html#cb651-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb651-12"><a href="plotting-the-contrast-sensitivity-function.html#cb651-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-533-1.png" width="336" /></p>
<p>The standard deviation seems to be still broad.</p>
</div>
<div id="facetting-the-contrast-sensitivity-functions" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Facetting the Contrast Sensitivity Functions<a href="plotting-the-contrast-sensitivity-function.html#facetting-the-contrast-sensitivity-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To facet means to split the plot into multiple plots based on a categorical variable (i.e., <strong>factor</strong>). We will facet the contrast sensitivity function plot above (the blue curve) into two panels based on two repetitions (red and green below).</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-534-1.png" width="624" /></p>
<p>To facet the plot, you need to have a data frame that has data with a column that specifies the categorical variable. For instance, let’s look at the data frame <code>ACh_avg</code>.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="plotting-the-contrast-sensitivity-function.html#cb652-1" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##    &lt;fct&gt;            &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 1                 0.25    12.6      0.743       5.31
##  2 1                 0.35    14.7      0.777       5.55
##  3 1                 0.49    18.6      0.993       7.09
##  4 1                 0.68    23.7      1.22        8.71
##  5 1                 0.94    28.7      1.36        9.68
##  6 1                 1.31    32.0      1.40        9.99
##  7 1                 1.83    32.4      1.43       10.2 
##  8 1                 2.54    29.6      1.39        9.93
##  9 1                 3.54    24.3      1.22        8.70
## 10 1                 4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>We see that the first column of <code>Ach_avg</code> has a column named <code>Repetition</code> which stores whether the given data are from the first or second repetition. To see all the unique levels of <code>Repetition</code>, we can use the function <code>unique()</code>.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="plotting-the-contrast-sensitivity-function.html#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ACh_avg<span class="sc">$</span>Repetition)</span></code></pre></div>
<pre><code>## [1] 1 2
## Levels: 1 2</code></pre>
<p>To facet a plot using ggplot2, the function <code>facet_wrap()</code> has to be used.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="plotting-the-contrast-sensitivity-function.html#cb656-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb656-2"><a href="plotting-the-contrast-sensitivity-function.html#cb656-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb656-3"><a href="plotting-the-contrast-sensitivity-function.html#cb656-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb656-4"><a href="plotting-the-contrast-sensitivity-function.html#cb656-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-537-1.png" width="624" /></p>
<p>The argument inside <code>facet_wrap</code> has to include the tilde (<code>~</code>). The right side the tilde (<code>~</code>) should be the name of the categorical variable by which you wish to facet the plot. If the variable however happens to be continuous, <code>facet_wrap()</code> would not work properly.</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="plotting-the-contrast-sensitivity-function.html#cb657-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb657-2"><a href="plotting-the-contrast-sensitivity-function.html#cb657-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb657-3"><a href="plotting-the-contrast-sensitivity-function.html#cb657-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb657-4"><a href="plotting-the-contrast-sensitivity-function.html#cb657-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> stdErrSens) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-538-1.png" width="624" /></p>
<p>However, I do not often use <code>facet_wrap()</code> because the plot often ends up not being pretty. Let’s try to make it prettier.</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="plotting-the-contrast-sensitivity-function.html#cb658-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb658-2"><a href="plotting-the-contrast-sensitivity-function.html#cb658-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb658-3"><a href="plotting-the-contrast-sensitivity-function.html#cb658-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb658-4"><a href="plotting-the-contrast-sensitivity-function.html#cb658-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb658-5"><a href="plotting-the-contrast-sensitivity-function.html#cb658-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb658-6"><a href="plotting-the-contrast-sensitivity-function.html#cb658-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb658-7"><a href="plotting-the-contrast-sensitivity-function.html#cb658-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb658-8"><a href="plotting-the-contrast-sensitivity-function.html#cb658-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb658-9"><a href="plotting-the-contrast-sensitivity-function.html#cb658-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb658-10"><a href="plotting-the-contrast-sensitivity-function.html#cb658-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb658-11"><a href="plotting-the-contrast-sensitivity-function.html#cb658-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb658-12"><a href="plotting-the-contrast-sensitivity-function.html#cb658-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb658-13"><a href="plotting-the-contrast-sensitivity-function.html#cb658-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb658-14"><a href="plotting-the-contrast-sensitivity-function.html#cb658-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) <span class="sc">+</span></span>
<span id="cb658-15"><a href="plotting-the-contrast-sensitivity-function.html#cb658-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-539-1.png" width="624" /></p>
<p>Personally, I do not like the grey-filled header of each panel. Since I personally will find myself repeatedly bypassing the default grey color into a color of my choice, I have created the function myself <code>sm_facet_header()</code> as part of the <strong>smCSF</strong> package.</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="plotting-the-contrast-sensitivity-function.html#cb659-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb659-2"><a href="plotting-the-contrast-sensitivity-function.html#cb659-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb659-3"><a href="plotting-the-contrast-sensitivity-function.html#cb659-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb659-4"><a href="plotting-the-contrast-sensitivity-function.html#cb659-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb659-5"><a href="plotting-the-contrast-sensitivity-function.html#cb659-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb659-6"><a href="plotting-the-contrast-sensitivity-function.html#cb659-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb659-7"><a href="plotting-the-contrast-sensitivity-function.html#cb659-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb659-8"><a href="plotting-the-contrast-sensitivity-function.html#cb659-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb659-9"><a href="plotting-the-contrast-sensitivity-function.html#cb659-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb659-10"><a href="plotting-the-contrast-sensitivity-function.html#cb659-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb659-11"><a href="plotting-the-contrast-sensitivity-function.html#cb659-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb659-12"><a href="plotting-the-contrast-sensitivity-function.html#cb659-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb659-13"><a href="plotting-the-contrast-sensitivity-function.html#cb659-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb659-14"><a href="plotting-the-contrast-sensitivity-function.html#cb659-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) <span class="sc">+</span></span>
<span id="cb659-15"><a href="plotting-the-contrast-sensitivity-function.html#cb659-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb659-16"><a href="plotting-the-contrast-sensitivity-function.html#cb659-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-540-1.png" width="624" /></p>
<p>Now the title of each plot has been bolded and the filled color is white. I personally think that this plot is a lot cleaner than the default one.</p>
<p>Next, I wish to change the titles of each panel because <code>1</code> and <code>2</code> are not descriptive. To do so, we need to use the argument <code>labeller</code> within <code>facet_wrap()</code> to specify the title of each panel.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="plotting-the-contrast-sensitivity-function.html#cb660-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb660-2"><a href="plotting-the-contrast-sensitivity-function.html#cb660-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb660-3"><a href="plotting-the-contrast-sensitivity-function.html#cb660-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb660-4"><a href="plotting-the-contrast-sensitivity-function.html#cb660-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb660-5"><a href="plotting-the-contrast-sensitivity-function.html#cb660-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb660-6"><a href="plotting-the-contrast-sensitivity-function.html#cb660-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb660-7"><a href="plotting-the-contrast-sensitivity-function.html#cb660-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb660-8"><a href="plotting-the-contrast-sensitivity-function.html#cb660-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb660-9"><a href="plotting-the-contrast-sensitivity-function.html#cb660-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb660-10"><a href="plotting-the-contrast-sensitivity-function.html#cb660-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb660-11"><a href="plotting-the-contrast-sensitivity-function.html#cb660-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb660-12"><a href="plotting-the-contrast-sensitivity-function.html#cb660-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb660-13"><a href="plotting-the-contrast-sensitivity-function.html#cb660-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb660-14"><a href="plotting-the-contrast-sensitivity-function.html#cb660-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition,</span>
<span id="cb660-15"><a href="plotting-the-contrast-sensitivity-function.html#cb660-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 1&#39;</span>,</span>
<span id="cb660-16"><a href="plotting-the-contrast-sensitivity-function.html#cb660-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 2&#39;</span>))) <span class="sc">+</span></span>
<span id="cb660-17"><a href="plotting-the-contrast-sensitivity-function.html#cb660-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb660-18"><a href="plotting-the-contrast-sensitivity-function.html#cb660-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>(<span class="at">font_size=</span><span class="dv">11</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-541-1.png" width="624" /></p>
<p>We use the function <code>as_labeller()</code> as part of the argument <code>labeller()</code> inside <code>facet_wrap()</code> to specify that factor level <code>1</code> should be shown as <code>Repetition 1</code> and <code>2</code> as <code>Repetition 2</code>.</p>
<p>We can also change the number of rows and columns using <code>facet_wrap()</code>. Lets make a data frame that has 4 repetitions instead of 2.</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="plotting-the-contrast-sensitivity-function.html#cb661-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb661-2"><a href="plotting-the-contrast-sensitivity-function.html#cb661-2" aria-hidden="true" tabindex="-1"></a>spatFreqNum <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(ACh_avg<span class="sc">$</span>SpatialFreq))</span>
<span id="cb661-3"><a href="plotting-the-contrast-sensitivity-function.html#cb661-3" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ACh_avg,ACh_avg)</span>
<span id="cb661-4"><a href="plotting-the-contrast-sensitivity-function.html#cb661-4" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">each=</span>spatFreqNum)</span>
<span id="cb661-5"><a href="plotting-the-contrast-sensitivity-function.html#cb661-5" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep[<span class="dv">25</span><span class="sc">:</span><span class="fu">nrow</span>(ACh_avg_4rep), <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> ACh_avg_4rep[<span class="dv">25</span><span class="sc">:</span><span class="fu">nrow</span>(ACh_avg_4rep), <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">+</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">24</span>),<span class="dv">1</span>) </span>
<span id="cb661-6"><a href="plotting-the-contrast-sensitivity-function.html#cb661-6" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg_4rep<span class="sc">$</span>Repetition)</span></code></pre></div>
<p>We can specify the number of columns (ex. <code>ncol = 2</code>) and rows (ex. <code>nrow = 2</code>) inside the function <code>facet_wrap()</code>, as shown in the example below.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="plotting-the-contrast-sensitivity-function.html#cb662-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep <span class="sc">%&gt;%</span></span>
<span id="cb662-2"><a href="plotting-the-contrast-sensitivity-function.html#cb662-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb662-3"><a href="plotting-the-contrast-sensitivity-function.html#cb662-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb662-4"><a href="plotting-the-contrast-sensitivity-function.html#cb662-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition,</span>
<span id="cb662-5"><a href="plotting-the-contrast-sensitivity-function.html#cb662-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb662-6"><a href="plotting-the-contrast-sensitivity-function.html#cb662-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb662-7"><a href="plotting-the-contrast-sensitivity-function.html#cb662-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)) <span class="sc">+</span></span>
<span id="cb662-8"><a href="plotting-the-contrast-sensitivity-function.html#cb662-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb662-9"><a href="plotting-the-contrast-sensitivity-function.html#cb662-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb662-10"><a href="plotting-the-contrast-sensitivity-function.html#cb662-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb662-11"><a href="plotting-the-contrast-sensitivity-function.html#cb662-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>,<span class="st">&#39;yelloworange&#39;</span>, <span class="st">&#39;crimson&#39;</span>)) <span class="sc">+</span></span>
<span id="cb662-12"><a href="plotting-the-contrast-sensitivity-function.html#cb662-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>, <span class="st">&#39;orange&#39;</span>,<span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb662-13"><a href="plotting-the-contrast-sensitivity-function.html#cb662-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb662-14"><a href="plotting-the-contrast-sensitivity-function.html#cb662-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb662-15"><a href="plotting-the-contrast-sensitivity-function.html#cb662-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb662-16"><a href="plotting-the-contrast-sensitivity-function.html#cb662-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb662-17"><a href="plotting-the-contrast-sensitivity-function.html#cb662-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 1&#39;</span>,</span>
<span id="cb662-18"><a href="plotting-the-contrast-sensitivity-function.html#cb662-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 2&#39;</span>,</span>
<span id="cb662-19"><a href="plotting-the-contrast-sensitivity-function.html#cb662-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;3&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 3&#39;</span>,</span>
<span id="cb662-20"><a href="plotting-the-contrast-sensitivity-function.html#cb662-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;4&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 4&#39;</span>))) <span class="sc">+</span></span>
<span id="cb662-21"><a href="plotting-the-contrast-sensitivity-function.html#cb662-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb662-22"><a href="plotting-the-contrast-sensitivity-function.html#cb662-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>(<span class="at">font_size=</span><span class="dv">11</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-543-1.png" width="624" /></p>
<p>Notice that when <code>facet_wrap()</code> is used, there is no need to create variable for each plot like we have done in Chapter 5 and use <code>sm_common_axis()</code>. The preference can vary depending on the user. Rather than using <code>facet_wrap()</code>, however, I still prefer to store each plot separately so that I can have freedom to decide where to place each panel wherever I want using <code>sm_common_axis()</code>.</p>
<p>Also, make sure that when you combine the plots using <code>facet_wrap()</code> you set the size of the figure properly within the <code>save_plot()</code> function or else the figure will appear to be too crowded. You can use <code>base_height</code> and <code>base_width</code> arguments within <code>facet_wrap()</code>.</p>
<p>Another issue with plotting each contrast sensitivity function per panel is that it is visually difficult to compare whether the functions between the panels are different. One way to overcome this problem is to plot all the plots together. In this case, legend is necessary, which can be generated using <code>sm_hgrid(legends = TRUE)</code>. Let’s use the data frame <code>ACh_avg</code> which has two levels in the <code>Repetition</code> column.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="plotting-the-contrast-sensitivity-function.html#cb663-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb663-2"><a href="plotting-the-contrast-sensitivity-function.html#cb663-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb663-3"><a href="plotting-the-contrast-sensitivity-function.html#cb663-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb663-4"><a href="plotting-the-contrast-sensitivity-function.html#cb663-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb663-5"><a href="plotting-the-contrast-sensitivity-function.html#cb663-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb663-6"><a href="plotting-the-contrast-sensitivity-function.html#cb663-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb663-7"><a href="plotting-the-contrast-sensitivity-function.html#cb663-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb663-8"><a href="plotting-the-contrast-sensitivity-function.html#cb663-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> T) <span class="sc">+</span></span>
<span id="cb663-9"><a href="plotting-the-contrast-sensitivity-function.html#cb663-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb663-10"><a href="plotting-the-contrast-sensitivity-function.html#cb663-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb663-11"><a href="plotting-the-contrast-sensitivity-function.html#cb663-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb663-12"><a href="plotting-the-contrast-sensitivity-function.html#cb663-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb663-13"><a href="plotting-the-contrast-sensitivity-function.html#cb663-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb663-14"><a href="plotting-the-contrast-sensitivity-function.html#cb663-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb663-15"><a href="plotting-the-contrast-sensitivity-function.html#cb663-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">&#39;Achromatic CSF (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-544-1.png" width="336" /></p>
<p>We see that these two curves are nearly identical, except that the green curve is uniformly higher than the red curve.</p>
<p>In the next chapter, we will discuss about some techniques on how to analyze contrast sensitivity data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="area-under-curve-aulcsf-and-r2-of-the-csf.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/Csf1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/Csf1.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
