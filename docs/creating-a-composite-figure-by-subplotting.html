<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Creating a Composite Figure by Subplotting | Visualizing Data for Publications Using smplot2</title>
  <meta name="description" content="Chapter 7 Creating a Composite Figure by Subplotting | Visualizing Data for Publications Using smplot2" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Creating a Composite Figure by Subplotting | Visualizing Data for Publications Using smplot2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Creating a Composite Figure by Subplotting | Visualizing Data for Publications Using smplot2" />
  
  
  

<meta name="author" content="Seung Hyun Min" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="raincloud-and-forest-plots.html"/>
<link rel="next" href="calculating-area-under-a-curve.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citing-the-guide-and-my-packages"><i class="fa fa-check"></i>Citing the guide and my packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation-of-smplot2"><i class="fa fa-check"></i>Installation of smplot2</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="opening-remarks-news.html"><a href="opening-remarks-news.html"><i class="fa fa-check"></i><b>1</b> Opening Remarks &amp; News</a>
<ul>
<li class="chapter" data-level="1.1" data-path="opening-remarks-news.html"><a href="opening-remarks-news.html#which-sections-to-read"><i class="fa fa-check"></i><b>1.1</b> Which sections to read</a></li>
<li class="chapter" data-level="1.2" data-path="opening-remarks-news.html"><a href="opening-remarks-news.html#how-to-use-this-guide"><i class="fa fa-check"></i><b>1.2</b> How to use this guide</a></li>
<li class="chapter" data-level="1.3" data-path="opening-remarks-news.html"><a href="opening-remarks-news.html#news"><i class="fa fa-check"></i><b>1.3</b> News</a>
<ul>
<li class="chapter" data-level="" data-path="opening-remarks-news.html"><a href="opening-remarks-news.html#version-0.2.4"><i class="fa fa-check"></i>2024-06-24: Version 0.2.4</a></li>
<li class="chapter" data-level="" data-path="opening-remarks-news.html"><a href="opening-remarks-news.html#version-0.2.3"><i class="fa fa-check"></i>2024-05-29: Version 0.2.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>2</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="2.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>2.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>2.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Visualization with smplot2</b></span></li>
<li class="chapter" data-level="3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>3</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#citing-the-guide-and-the-package"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#getting-started"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>3.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i><b>3.1.1</b> Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i><b>3.2.1</b> Let’s make some graphs</a></li>
<li class="chapter" data-level="3.2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i><b>3.2.2</b> How ggplot works</a></li>
<li class="chapter" data-level="3.2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i><b>3.2.3</b> Different color of points for each unique group</a></li>
<li class="chapter" data-level="3.2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i><b>3.2.4</b> Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="3.2.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i><b>3.2.5</b> Same shape across all groups</a></li>
<li class="chapter" data-level="3.2.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i><b>3.2.6</b> How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="3.2.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i><b>3.2.7</b> geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="3.2.8" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i><b>3.2.8</b> Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot2"><i class="fa fa-check"></i><b>3.3</b> Improve data visualization using smplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i><b>3.3.1</b> Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i><b>3.3.2</b> Reporting statistics from a paired correlation</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#changing-the-text"><i class="fa fa-check"></i><b>3.3.3</b> Changing the text</a></li>
<li class="chapter" data-level="3.3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#plotting-the-average-with-standard-errors"><i class="fa fa-check"></i><b>3.3.4</b> Plotting the average with standard errors</a></li>
<li class="chapter" data-level="3.3.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><i class="fa fa-check"></i><b>3.3.5</b> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i><b>3.3.6</b> Different color for each group but with other colors</a></li>
<li class="chapter" data-level="3.3.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1."><i class="fa fa-check"></i><b>3.3.7</b> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>4</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#citing-the-guide-and-the-package-1"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#getting-started-1"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="4.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>4.1</b> Upload sample data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i><b>4.1.1</b> Download requirements</a></li>
<li class="chapter" data-level="4.1.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i><b>4.1.2</b> Before we get started</a></li>
<li class="chapter" data-level="4.1.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i><b>4.1.3</b> data.csv</a></li>
<li class="chapter" data-level="4.1.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><i class="fa fa-check"></i><b>4.1.4</b> <code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i><b>4.1.5</b> Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>4.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i><b>4.2.1</b> What is a boxplot?</a></li>
<li class="chapter" data-level="4.2.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i><b>4.2.2</b> Boxplot vs bar graph</a></li>
<li class="chapter" data-level="4.2.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.3</b> Boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i><b>4.2.4</b> Problem: Alphabetical order</a></li>
<li class="chapter" data-level="4.2.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i><b>4.2.5</b> Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="4.2.6" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i><b>4.2.6</b> Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="4.2.7" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.7</b> Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.8" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i><b>4.2.8</b> A boxplot with individual data</a></li>
<li class="chapter" data-level="4.2.9" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><i class="fa fa-check"></i><b>4.2.9</b> <code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="4.2.10" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i><b>4.2.10</b> Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>4.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i><b>4.3.1</b> Structure of the violin plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>4.3.2</b> Violin plot with ggplot2</a></li>
<li class="chapter" data-level="4.3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i><b>4.3.3</b> Violin plot with individual points</a></li>
<li class="chapter" data-level="4.3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i><b>4.3.4</b> geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="4.3.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i><b>4.3.5</b> Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html"><i class="fa fa-check"></i><b>5</b> Bar Graph, Slope Chart and Point plot</a>
<ul>
<li class="chapter" data-level="" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#citing-the-guide-and-the-package-2"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#getting-started-2"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="5.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph"><i class="fa fa-check"></i><b>5.1</b> Bar graph</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#scaling-the-y-axis"><i class="fa fa-check"></i><b>5.1.1</b> Scaling the y-axis</a></li>
<li class="chapter" data-level="5.1.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>5.1.2</b> Plotting individual points with unique colors</a></li>
<li class="chapter" data-level="5.1.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#other-parameters"><i class="fa fa-check"></i><b>5.1.3</b> Other parameters</a></li>
<li class="chapter" data-level="5.1.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph-with-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.1.4</b> Bar graph with data of multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart"><i class="fa fa-check"></i><b>5.2</b> Slope chart</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot"><i class="fa fa-check"></i><b>5.2.1</b> Slope chart with mean plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot-and-error-bar"><i class="fa fa-check"></i><b>5.2.2</b> Slope chart with mean plot and error bar</a></li>
<li class="chapter" data-level="5.2.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-x-levels"><i class="fa fa-check"></i><b>5.2.3</b> Slope chart with multiple x levels</a></li>
<li class="chapter" data-level="5.2.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-groups-and-x-levels"><i class="fa fa-check"></i><b>5.2.4</b> Slope chart with multiple groups and x levels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot"><i class="fa fa-check"></i><b>5.3</b> Point plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#change-the-range-of-y-axis"><i class="fa fa-check"></i><b>5.3.1</b> Change the range of y-axis</a></li>
<li class="chapter" data-level="5.3.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#data-with-more-than-two-groups"><i class="fa fa-check"></i><b>5.3.2</b> Data with more than two groups</a></li>
<li class="chapter" data-level="5.3.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-one-group"><i class="fa fa-check"></i><b>5.3.3</b> Point plot with a shadow using data of one group</a></li>
<li class="chapter" data-level="5.3.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.3.4</b> Point plot with a shadow using data of multiple groups</a></li>
<li class="chapter" data-level="5.3.5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#adding-and-modifying-legends"><i class="fa fa-check"></i><b>5.3.5</b> Adding and modifying legends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html"><i class="fa fa-check"></i><b>6</b> Raincloud and Forest Plots</a>
<ul>
<li class="chapter" data-level="" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#citing-the-guide-and-the-package-3"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#getting-started-3"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="6.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot"><i class="fa fa-check"></i><b>6.1</b> Raincloud plot</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changing-the-x-axis-labels"><i class="fa fa-check"></i><b>6.1.1</b> Changing the x-axis labels</a></li>
<li class="chapter" data-level="6.1.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#separating-the-components-and-configuration"><i class="fa fa-check"></i><b>6.1.2</b> Separating the components and configuration</a></li>
<li class="chapter" data-level="6.1.3" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changng-the-theme-and-orientation"><i class="fa fa-check"></i><b>6.1.3</b> Changng the theme and orientation</a></li>
<li class="chapter" data-level="6.1.4" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot-with-data-from-multiple-groups"><i class="fa fa-check"></i><b>6.1.4</b> Raincloud plot with data from multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#forest-plot"><i class="fa fa-check"></i><b>6.2</b> Forest plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#plotting-the-forest-plot-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>6.2.1</b> Plotting the forest plot using data of multiple groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html"><i class="fa fa-check"></i><b>7</b> Creating a Composite Figure by Subplotting</a>
<ul>
<li class="chapter" data-level="" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#citing-the-guide-and-the-package-4"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#getting-started-4"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="7.1" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>7.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#filter-for-rows"><i class="fa fa-check"></i><b>7.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="7.1.2" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#select-for-columns"><i class="fa fa-check"></i><b>7.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="7.1.3" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>7.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#plotting-the-averaged-data-with-error-bars"><i class="fa fa-check"></i><b>7.2</b> Plotting the averaged data with error bars</a></li>
<li class="chapter" data-level="7.3" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#plotting-individual-data"><i class="fa fa-check"></i><b>7.3</b> Plotting individual data</a></li>
<li class="chapter" data-level="7.4" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#putting-multiple-plots-together-a-composite-figure---sm_put_together"><i class="fa fa-check"></i><b>7.4</b> Putting multiple plots together (a composite figure) - <code>sm_put_together()</code></a></li>
<li class="chapter" data-level="7.5" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#other-important-inputs-of-sm_put_together"><i class="fa fa-check"></i><b>7.5</b> Other important inputs of <code>sm_put_together()</code></a></li>
<li class="chapter" data-level="7.6" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#adding-annotations-to-the-composite-figure"><i class="fa fa-check"></i><b>7.6</b> Adding annotations to the composite figure</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#text-annotations"><i class="fa fa-check"></i><b>7.6.1</b> Text annotations</a></li>
<li class="chapter" data-level="7.6.2" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#point-annotations"><i class="fa fa-check"></i><b>7.6.2</b> Point annotations</a></li>
<li class="chapter" data-level="7.6.3" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#line-annotations"><i class="fa fa-check"></i><b>7.6.3</b> Line annotations</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#why-use-sm_put_together-advanced"><i class="fa fa-check"></i><b>7.7</b> Why use <code>sm_put_together()</code>? (Advanced)</a></li>
</ul></li>
<li class="part"><span><b>II Data Analysis with smplot2</b></span></li>
<li class="chapter" data-level="8" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html"><i class="fa fa-check"></i><b>8</b> Calculating Area under a Curve</a>
<ul>
<li class="chapter" data-level="" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#citing-the-guide-and-the-package-5"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#getting-started-5"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="8.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#pipe"><i class="fa fa-check"></i><b>8.1</b> Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="8.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#area-under-a-curve"><i class="fa fa-check"></i><b>8.2</b> Area under a curve</a></li>
<li class="chapter" data-level="8.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#reproducing-figures-in-the-paper-min-et-al.-2019"><i class="fa fa-check"></i><b>8.3</b> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3b-a-best-fit-line-with-points-and-error-bars"><i class="fa fa-check"></i><b>8.3.1</b> Figure 3B (a best-fit line with points and error bars)</a></li>
<li class="chapter" data-level="8.3.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3d-a-bar-graph"><i class="fa fa-check"></i><b>8.3.2</b> Figure 3D (a bar graph)</a></li>
<li class="chapter" data-level="8.3.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3e-modeling-in-matlab-and-plotting-in-r"><i class="fa fa-check"></i><b>8.3.3</b> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html"><i class="fa fa-check"></i><b>9</b> Calculating Linear Slopes</a>
<ul>
<li class="chapter" data-level="" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#citing-the-guide-and-the-package-6"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#getting-started-6"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="9.1" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#linear-relationship-using-lm"><i class="fa fa-check"></i><b>9.1</b> Linear relationship using <code>lm()</code></a></li>
<li class="chapter" data-level="9.2" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#calculating-slopes-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>9.2</b> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>10</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-statistics.html"><a href="basic-statistics.html#one-sample-t-test"><i class="fa fa-check"></i><b>10.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="10.2" data-path="basic-statistics.html"><a href="basic-statistics.html#two-sample-t-test"><i class="fa fa-check"></i><b>10.2</b> Two-sample t-test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#shapiro-wilk-test-to-test-for-normality-of-data"><i class="fa fa-check"></i><b>10.2.1</b> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basic-statistics.html"><a href="basic-statistics.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>10.3</b> Wilcoxon Signed-rank Test</a></li>
<li class="chapter" data-level="10.4" data-path="basic-statistics.html"><a href="basic-statistics.html#effect-size"><i class="fa fa-check"></i><b>10.4</b> Effect Size</a></li>
<li class="chapter" data-level="10.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.5</b> Post-hoc Power Analysis</a></li>
<li class="chapter" data-level="10.6" data-path="basic-statistics.html"><a href="basic-statistics.html#bayes-factor"><i class="fa fa-check"></i><b>10.6</b> Bayes Factor</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#issues-with-post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.6.1</b> Issues with post-hoc power analysis</a></li>
<li class="chapter" data-level="10.6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-the-bayes-factor-in-r"><i class="fa fa-check"></i><b>10.6.2</b> Computing the Bayes factor in R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>10.7</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="basic-statistics.html"><a href="basic-statistics.html#check-for-outliers"><i class="fa fa-check"></i><b>10.7.1</b> Check for Outliers</a></li>
<li class="chapter" data-level="10.7.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data"><i class="fa fa-check"></i><b>10.7.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.7.3" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-the-assumption-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>10.7.3</b> Checking the Assumption for Homogeneity of Variance</a></li>
<li class="chapter" data-level="10.7.4" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-one-way-anova"><i class="fa fa-check"></i><b>10.7.4</b> Computing One-way ANOVA</a></li>
<li class="chapter" data-level="10.7.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-tests"><i class="fa fa-check"></i><b>10.7.5</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="10.7.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>10.7.6</b> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="basic-statistics.html"><a href="basic-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>10.8</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="basic-statistics.html"><a href="basic-statistics.html#identifying-outliers"><i class="fa fa-check"></i><b>10.8.1</b> Identifying Outliers</a></li>
<li class="chapter" data-level="10.8.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data-1"><i class="fa fa-check"></i><b>10.8.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.8.3" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-two-way-anova"><i class="fa fa-check"></i><b>10.8.3</b> Computing Two-way ANOVA</a></li>
<li class="chapter" data-level="10.8.4" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-test"><i class="fa fa-check"></i><b>10.8.4</b> Post-hoc Test</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="basic-statistics.html"><a href="basic-statistics.html#friedman-test"><i class="fa fa-check"></i><b>10.9</b> Friedman Test</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="basic-statistics.html"><a href="basic-statistics.html#performing-friedman-test"><i class="fa fa-check"></i><b>10.9.1</b> Performing Friedman Test</a></li>
<li class="chapter" data-level="10.9.2" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-analysis"><i class="fa fa-check"></i><b>10.9.2</b> Post-hoc Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-resources"><i class="fa fa-check"></i><b>10.10</b> Extra Resources</a></li>
</ul></li>
<li class="part"><span><b>III Manual for smplot2</b></span></li>
<li class="chapter" data-level="11" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><i class="fa fa-check"></i><b>11</b> Themes, Colors, Correlations, Boxplots, Violins and Bars (Part 1)</a>
<ul>
<li class="chapter" data-level="" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#citing-the-guide-and-the-package-7"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#getting-started-7"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="11.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#installation-of-the-package"><i class="fa fa-check"></i><b>11.1</b> Installation of the Package</a></li>
<li class="chapter" data-level="11.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#how-...-and-xxx.params-arguments-work"><i class="fa fa-check"></i><b>11.2</b> How <code>...</code> and <code>xxx.params</code> arguments work</a></li>
<li class="chapter" data-level="11.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#modifying-the-default-aesthetics"><i class="fa fa-check"></i><b>11.3</b> Modifying the default aesthetics</a></li>
<li class="chapter" data-level="11.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#color-palette"><i class="fa fa-check"></i><b>11.4</b> Color palette</a></li>
<li class="chapter" data-level="11.5" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#graph-themes"><i class="fa fa-check"></i><b>11.5</b> Graph themes</a></li>
<li class="chapter" data-level="11.6" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot---sm_statcorr-and-sm_corr_avgerr"><i class="fa fa-check"></i><b>11.6</b> Correlation plot - <code>sm_statCorr()</code> and <code>sm_corr_avgErr()</code></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_statcorr"><i class="fa fa-check"></i><b>11.6.1</b> <code>sm_statCorr()</code></a></li>
<li class="chapter" data-level="11.6.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_corr_avgerr"><i class="fa fa-check"></i><b>11.6.2</b> <code>sm_corr_avgErr()</code></a></li>
<li class="chapter" data-level="11.6.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#structure-of-data-frame"><i class="fa fa-check"></i><b>11.6.3</b> Structure of data frame</a></li>
<li class="chapter" data-level="11.6.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>11.6.4</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>11.7</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>11.7.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>11.8</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>11.8.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>11.9</b> Bar plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-3"><i class="fa fa-check"></i><b>11.9.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><i class="fa fa-check"></i><b>12</b> Slope Charts, Point plots, Bland-Altman, Forests, Rainclouds, Histograms (Part 2)</a>
<ul>
<li class="chapter" data-level="" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#citing-the-guide-and-the-package-8"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#getting-started-8"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="12.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#slope-chart---sm_slope-and-sm_slope_mean"><i class="fa fa-check"></i><b>12.1</b> Slope chart - <code>sm_slope()</code> and <code>sm_slope_mean()</code></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#sm_slope"><i class="fa fa-check"></i><b>12.1.1</b> <code>sm_slope()</code></a></li>
<li class="chapter" data-level="12.1.2" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#drawing-the-mean-plot"><i class="fa fa-check"></i><b>12.1.2</b> Drawing the mean plot</a></li>
<li class="chapter" data-level="12.1.3" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#sm_slope_mean"><i class="fa fa-check"></i><b>12.1.3</b> <code>sm_slope_mean()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#point-plot---sm_pointplot"><i class="fa fa-check"></i><b>12.2</b> Point plot - <code>sm_pointplot()</code></a></li>
<li class="chapter" data-level="12.3" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>12.3</b> A Bland Altman plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="12.4" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#forest-plot---sm_forest"><i class="fa fa-check"></i><b>12.4</b> Forest plot - <code>sm_forest()</code></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#annotation-using-sm_forest_annot"><i class="fa fa-check"></i><b>12.4.1</b> Annotation using <code>sm_forest_annot()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>12.5</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="12.6" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#histogram---sm_hist"><i class="fa fa-check"></i><b>12.6</b> Histogram - <code>sm_hist()</code></a></li>
</ul></li>
<li class="part"><span><b>IV Contrast Sensitivity Function</b></span></li>
<li class="chapter" data-level="13" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>13</b> Plotting the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#citing-the-guide-and-the-package-9"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#getting-started-9"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="13.1" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#brief-introduction"><i class="fa fa-check"></i><b>13.1</b> Brief Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#data-visualization"><i class="fa fa-check"></i><b>13.2</b> Data Visualization</a></li>
<li class="chapter" data-level="13.3" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#facetting-the-contrast-sensitivity-functions"><i class="fa fa-check"></i><b>13.3</b> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html"><i class="fa fa-check"></i><b>14</b> Area under Curve, AULCSF and <span class="math inline">\(R^2\)</span> of the CSF</a>
<ul>
<li class="chapter" data-level="" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#citing-the-guide-and-the-package-10"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#getting-started-10"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="14.1" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#area-under-a-curve-1"><i class="fa fa-check"></i><b>14.1</b> Area under a Curve</a></li>
<li class="chapter" data-level="14.2" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#sm_trapz-sm_aulcsf-and-sm_r2"><i class="fa fa-check"></i><b>14.2</b> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
<li class="chapter" data-level="14.3" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#calculating-area-and-r2-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>14.3</b> Calculating area and <span class="math inline">\(R^2\)</span> of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="14.4" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#case-study"><i class="fa fa-check"></i><b>14.4</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>15</b> Understanding the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#citing-the-guide-and-the-package-11"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#getting-started-11"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="15.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#contrast-sensitivity-function-model"><i class="fa fa-check"></i><b>15.1</b> Contrast Sensitivity Function Model</a></li>
<li class="chapter" data-level="15.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_csf"><i class="fa fa-check"></i><b>15.2</b> Understanding <code>sm_CSF()</code></a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_params"><i class="fa fa-check"></i><b>15.2.1</b> <code>sm_params()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_cutoff"><i class="fa fa-check"></i><b>15.2.2</b> <code>sm_cutOff()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_ribboncsf"><i class="fa fa-check"></i><b>15.3</b> Understanding <code>sm_ribbonCSF()</code></a></li>
<li class="chapter" data-level="15.4" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#calculating-the-five-parameters-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>15.4</b> Calculating the five parameters of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="15.5" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#visualization-of-the-parameters"><i class="fa fa-check"></i><b>15.5</b> Visualization of the parameters</a></li>
<li class="chapter" data-level="15.6" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#case-study-1"><i class="fa fa-check"></i><b>15.6</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html"><i class="fa fa-check"></i><b>16</b> Factor Analysis and CSF</a>
<ul>
<li class="chapter" data-level="" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#citing-the-guide-and-the-package-12"><i class="fa fa-check"></i>Citing the Guide and the Package</a></li>
<li class="chapter" data-level="" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#getting-started-12"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="16.1" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#eigenvalues"><i class="fa fa-check"></i><b>16.1</b> Eigenvalues</a></li>
<li class="chapter" data-level="16.2" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#parallel-analysis"><i class="fa fa-check"></i><b>16.2</b> Parallel analysis</a></li>
<li class="chapter" data-level="16.3" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#non-parametric-bootstrapping"><i class="fa fa-check"></i><b>16.3</b> Non-parametric bootstrapping</a></li>
<li class="chapter" data-level="16.4" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#factor-analysis"><i class="fa fa-check"></i><b>16.4</b> Factor Analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualizing Data for Publications Using smplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-a-composite-figure-by-subplotting" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Creating a Composite Figure by Subplotting<a href="creating-a-composite-figure-by-subplotting.html#creating-a-composite-figure-by-subplotting" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="citing-the-guide-and-the-package-4" class="section level3 unnumbered hasAnchor">
<h3>Citing the Guide and the Package<a href="creating-a-composite-figure-by-subplotting.html#citing-the-guide-and-the-package-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you have used <strong>smplot2</strong> for your composite visualizations, please cite the paper below:</p>
<ol style="list-style-type: decimal">
<li><strong>Min, S. H.</strong> (2024). Visualization of composite plots in R using a programmatic approach and <em>smplot2</em>. <strong><em>Advances in Methods and Practices in Psychological Science</em></strong>, 7(3). <a href="https://www.smin95.com/pubs/ampps2024.pdf"><strong>[pdf]</strong></a> <a href="https://www.smin95.com/smplot2doc"><strong>[codes]</strong></a></li>
</ol>
</div>
<div id="getting-started-4" class="section level3 unnumbered hasAnchor">
<h3>Getting Started<a href="creating-a-composite-figure-by-subplotting.html#getting-started-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we will plot a composite figure. This refers to a type of plot that has many panels with common information, such as the same x- and y-axes. Subplotting is referred to when we allocate subsets of data to particular panels but not others in the composite figure. We will make each panel (i.e., subplot) one-by-one, combine them into a composite figure, add a common legend, and then annotate it with texts and shapes using the functions from <em>smplot2</em> package.</p>
<p>First, you need to load data (.csv file). When you are loading your own .csv file for your data analysis, make sure you place the .csv file of your interest in the folder that has been set to the <strong>working directory</strong>.</p>
<p>In this example, we will be using data from this paper:</p>
<p><strong>Min, S. H.</strong>, Baldwin, A. S., &amp; Hess, R. F. (2019). Ocular dominance plasticity: a binocular combination task finds no cumulative effect with repeated patching. <strong><em>Vision Research</em></strong>, 161, 36-42.</p>
<p>We will be creating similar figures to those in the paper (ex. <strong>Figure 3A</strong> and <strong>Figure A2</strong>) using <strong>smplot2</strong>, as shown in the <a href="https://www.smin95.com/pubs/min2019.pdf"><strong>PDF</strong></a>.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="creating-a-composite-figure-by-subplotting.html#cb267-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb267-2"><a href="creating-a-composite-figure-by-subplotting.html#cb267-2" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="creating-a-composite-figure-by-subplotting.html#cb268-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://www.smin95.com/min2019.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="creating-a-composite-figure-by-subplotting.html#cb269-1" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb269-2"><a href="creating-a-composite-figure-by-subplotting.html#cb269-2" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S2      1         0   2.82 
## 3 S3      1         0   1.69 
## 4 S4      1         0   2.55 
## 5 S5      1         0  -0.217
## 6 S6      1         0   0.626</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 10 participants total.</p></li>
<li><p>Next, <code>Day</code> refers to the day of testing. The participants were tested on Day 1, 2, 3, 4 and 5. We will only use Day from 1 and 5.</p></li>
<li><p><code>Time</code> refers to the number of minutes after an experimental manipulation (ex. monocular deprivation). These are 0, 3, 6, 12, 24 and 48 minutes, but in the data frame, it says 0, 1, 2, 3, 4 and 5; we will change the labels manually.</p></li>
<li><p>The <code>Cbratio</code> column refers to the actual data that will be plotted here.</p></li>
</ul>
<p>In the example below, the plots will have different colors based on Day (1 or 5). Therefore, the values in <code>Day</code> column have to be discrete, not continuous. To make them discrete, one needs to convert the <code>Day</code> column from <strong>double</strong> (continuous variable) to <strong>factor</strong> (discrete variable).</p>
</div>
<div id="filter-select-and-summarise" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> <code>filter()</code>, <code>select()</code> and <code>summarise()</code><a href="creating-a-composite-figure-by-subplotting.html#filter-select-and-summarise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="filter-for-rows" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> <code>filter()</code> for rows<a href="creating-a-composite-figure-by-subplotting.html#filter-for-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To plot data of each subject separately, we need the data frame to show data only from one subject. This can be achieved as using <code>filter()</code>:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="creating-a-composite-figure-by-subplotting.html#cb271-1" tabindex="-1"></a><span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S1&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S1      1         1   0.802
##  3 S1      1         2   1.01 
##  4 S1      1         3   0.634
##  5 S1      1         4  -0.245
##  6 S1      1         5  -0.834
##  7 S1      5         0   2.42 
##  8 S1      5         1   1.76 
##  9 S1      5         2   1.91 
## 10 S1      5         3   0.609
## 11 S1      5         4   0.811
## 12 S1      5         5   0.363</code></pre>
<ul>
<li>The first argument of <code>filter()</code>, <code>select()</code>, <code>summarise()</code> and <code>mutate()</code> is a data frame.</li>
<li>The subsequent argument specifies how the data frame should be treated.</li>
<li>The new printed result is a new data frame.</li>
</ul>
<p><code>filter()</code> is used to filter for rows that meet the requirement of your interest.</p>
<p>Here is another example.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="creating-a-composite-figure-by-subplotting.html#cb273-1" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 × 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ℹ 50 more rows</code></pre>
<p>The above code can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column.</p>
<p>Notice that S1 is a <strong>character</strong> because it has an alphabet. Therefore, it needs to be written as <code>'S1'</code>. However, <code>1</code> of <code>Day</code> is <strong>double</strong>, which is essentially just a number digit. Therefore, it can be written as <code>1</code> with no quotation mark.</p>
<p>Let’s try another example.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="creating-a-composite-figure-by-subplotting.html#cb275-1" tabindex="-1"></a>day1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># save the new data frame into a new variable</span></span>
<span id="cb275-2"><a href="creating-a-composite-figure-by-subplotting.html#cb275-2" tabindex="-1"></a><span class="fu">filter</span>(day1, Subject <span class="sc">==</span> <span class="st">&quot;S1&quot;</span>) <span class="co"># this new data frame contains Day 1 and Subject 1 data only.</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S1      1         1   0.802
## 3 S1      1         2   1.01 
## 4 S1      1         3   0.634
## 5 S1      1         4  -0.245
## 6 S1      1         5  -0.834</code></pre>
<p>The above code can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column. Save this new data frame as <code>day1</code>. Then, <strong>filter</strong> for all rows of the data frame <code>day1</code> that have <code>S1</code> in the <code>Subject</code> column.</p>
<p>The above can also be written like the one below:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="creating-a-composite-figure-by-subplotting.html#cb277-1" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&quot;S1&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S1      1         1   0.802
## 3 S1      1         2   1.01 
## 4 S1      1         3   0.634
## 5 S1      1         4  -0.245
## 6 S1      1         5  -0.834</code></pre>
<p>The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>AND</strong> have <code>S1</code> in the <code>Subject</code> column.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="creating-a-composite-figure-by-subplotting.html#cb279-1" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Subject <span class="sc">==</span> <span class="st">&quot;S1&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 66 × 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ℹ 56 more rows</code></pre>
<p>The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>OR</strong> have <code>S1</code> in the <code>Subject</code> column. <code>|</code> represents <strong>OR</strong>, <code>&amp;</code> represents <strong>AND</strong>.</p>
</div>
<div id="select-for-columns" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> <code>select()</code> for columns<a href="creating-a-composite-figure-by-subplotting.html#select-for-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you wish to see the <code>Cbratio</code> column only (i.e., data only) for rows of <strong>df</strong> that have <code>Day ==  1</code> and <code>Time == 0</code>, you can write it like this:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="creating-a-composite-figure-by-subplotting.html#cb281-1" tabindex="-1"></a>day1_time0 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Time <span class="sc">==</span> <span class="dv">0</span>) <span class="co"># save the new data frame in the day1_time0 variable</span></span>
<span id="cb281-2"><a href="creating-a-composite-figure-by-subplotting.html#cb281-2" tabindex="-1"></a><span class="fu">select</span>(day1_time0, Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 1
##    Cbratio
##      &lt;dbl&gt;
##  1  -0.421
##  2   2.82 
##  3   1.69 
##  4   2.55 
##  5  -0.217
##  6   0.626
##  7   2.62 
##  8   1.42 
##  9   1.54 
## 10   3.05</code></pre>
<p>There are 10 rows (i.e., 10 subjects) in this filtered data frame and 1 column, which is <code>Cbratio</code>. The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>AND</strong> have <code>0</code> in the <code>Time</code> column. Then, store the new data frame in <code>day1_time0</code>. Then, select for <code>Cbratio</code> column from <code>day1_time0</code>.</p>
<p><code>select()</code> is used to filter for columns that meet the requirement of your interest.</p>
</div>
<div id="summarise-for-grouped-summaries" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> <code>summarise()</code> for grouped summaries<a href="creating-a-composite-figure-by-subplotting.html#summarise-for-grouped-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>df</strong> contains individual data for all subjects on Days 1 and 5 across all time points. However, it does not contain average data either for each <strong>Day</strong> or <strong>Time</strong>.</p>
<p><code>summarise()</code> can collapse multiple rows of observations into values such as the mean.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="creating-a-composite-figure-by-subplotting.html#cb283-1" tabindex="-1"></a><span class="fu">summarise</span>(df, <span class="at">average =</span> <span class="fu">mean</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   average
##     &lt;dbl&gt;
## 1    1.35</code></pre>
<p>However, in this case, we get an example of <code>Cbratio</code> across <code>Subject</code>, <code>Day</code> and <code>Time</code>. This average value itself is not so meaningful. If we wish to obtain the average for each <code>Day</code> and <code>Time</code>, we can use the function <code>group_by()</code> to group data for each day and time.</p>
<ul>
<li><p>As it was the case before, the first argument of <code>group_by()</code> is a data frame.</p></li>
<li><p>The second argument of <code>group_by()</code> is the name of the column through which you would like to group the data.</p></li>
</ul>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="creating-a-composite-figure-by-subplotting.html#cb285-1" tabindex="-1"></a>by_day_time <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df, Day, Time)</span>
<span id="cb285-2"><a href="creating-a-composite-figure-by-subplotting.html#cb285-2" tabindex="-1"></a><span class="fu">print</span>(by_day_time)</span></code></pre></div>
<pre><code>## # A tibble: 120 × 4
## # Groups:   Day, Time [12]
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ℹ 110 more rows</code></pre>
<p>The output of <code>group_by()</code> is a new data frame (it might appear exactly the same as before, ex. <strong>df</strong>). However, it will respond differently to <code>summarise()</code> because the rows of the data frame are now grouped based on day and time, as we have specified.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="creating-a-composite-figure-by-subplotting.html#cb287-1" tabindex="-1"></a><span class="fu">summarise</span>(by_day_time, <span class="at">Average_Cbratio =</span> <span class="fu">mean</span>(Cbratio))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Day&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 12 × 3
## # Groups:   Day [2]
##    Day    Time Average_Cbratio
##    &lt;fct&gt; &lt;dbl&gt;           &lt;dbl&gt;
##  1 1         0           1.57 
##  2 1         1           2.21 
##  3 1         2           2.32 
##  4 1         3           0.979
##  5 1         4           1.25 
##  6 1         5           1.14 
##  7 5         0           1.85 
##  8 5         1           1.49 
##  9 5         2           1.02 
## 10 5         3           1.15 
## 11 5         4           0.759
## 12 5         5           0.452</code></pre>
<p>This new data frame yields average for each Day and Time. We have now created a new column <code>Average_Cbratio</code> which stores all the average data of <code>Cbratio</code>.</p>
<p>Therefore, <code>group_by()</code> and <code>summarise()</code> are very useful together. They provide grouped summaries, such as the average. However, <code>summarise()</code> alone may not be so useful. <code>group_by()</code> alone is also rarely used.</p>
<p>Besides the <strong>average</strong>, one might also be interested in obtaining either <strong>standard deviation</strong> or <strong>standard error</strong>.</p>
<p>However, our <strong>df</strong> does not contain any data about the <strong>standard deviation</strong> or <strong>standard error</strong> per Day or Time, etc. Standard deviation can be calculated via <code>sd()</code> and standard error can be computed with <code>sm_stdErr()</code>.</p>
<p>Below, we obtain standard error with the help of the <code>summarise()</code> function for each <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="creating-a-composite-figure-by-subplotting.html#cb290-1" tabindex="-1"></a><span class="fu">summarise</span>(df, <span class="at">standard_error =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   standard_error
##            &lt;dbl&gt;
## 1          0.115</code></pre>
<p>As we have seen before, we see that <code>standard_error</code> has been calculated across all subjects, day and time. This is not so useful. We should use <code>summarise()</code> with <code>group_by()</code> so that each standard error could be for each <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="creating-a-composite-figure-by-subplotting.html#cb292-1" tabindex="-1"></a>by_day_time <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df, Day, Time)</span>
<span id="cb292-2"><a href="creating-a-composite-figure-by-subplotting.html#cb292-2" tabindex="-1"></a><span class="fu">summarise</span>(by_day_time, <span class="at">standard_error =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Day&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 12 × 3
## # Groups:   Day [2]
##    Day    Time standard_error
##    &lt;fct&gt; &lt;dbl&gt;          &lt;dbl&gt;
##  1 1         0          0.393
##  2 1         1          0.363
##  3 1         2          0.400
##  4 1         3          0.352
##  5 1         4          0.266
##  6 1         5          0.438
##  7 5         0          0.563
##  8 5         1          0.422
##  9 5         2          0.462
## 10 5         3          0.224
## 11 5         4          0.292
## 12 5         5          0.193</code></pre>
<p>This standard error is for each <code>Day</code> and <code>Time</code> across all subjects.</p>
<p>Now let’s obtain the <strong>mean</strong> and <strong>standard error</strong> of <code>Cbratio</code> for each <code>Day</code> and <code>Time</code> across all subjects using the data frame that has been grouped by <code>Day</code> and <code>Time</code> via <code>group_by()</code>.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="creating-a-composite-figure-by-subplotting.html#cb295-1" tabindex="-1"></a>by_day_time1 <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_day_time,</span>
<span id="cb295-2"><a href="creating-a-composite-figure-by-subplotting.html#cb295-2" tabindex="-1"></a>  <span class="at">Average =</span> <span class="fu">mean</span>(Cbratio),</span>
<span id="cb295-3"><a href="creating-a-composite-figure-by-subplotting.html#cb295-3" tabindex="-1"></a>  <span class="at">StdError =</span> <span class="fu">sm_stdErr</span>(Cbratio)</span>
<span id="cb295-4"><a href="creating-a-composite-figure-by-subplotting.html#cb295-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Day&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="creating-a-composite-figure-by-subplotting.html#cb297-1" tabindex="-1"></a><span class="fu">print</span>(by_day_time1)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
## # Groups:   Day [2]
##    Day    Time Average StdError
##    &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 1         0   1.57     0.393
##  2 1         1   2.21     0.363
##  3 1         2   2.32     0.400
##  4 1         3   0.979    0.352
##  5 1         4   1.25     0.266
##  6 1         5   1.14     0.438
##  7 5         0   1.85     0.563
##  8 5         1   1.49     0.422
##  9 5         2   1.02     0.462
## 10 5         3   1.15     0.224
## 11 5         4   0.759    0.292
## 12 5         5   0.452    0.193</code></pre>
<p>The original <strong>df</strong>, which contains data for each subject, has now been transformed to a new data frame that contains grouped summaries, such as group averages and standard errors.</p>
<p>If you are interested in learning more about this topic (data transformation), please check out Chapter 5 of R for Data Science by Hadley Wickham (<a href="https://r4ds.had.co.nz/transform.html" class="uri">https://r4ds.had.co.nz/transform.html</a>).</p>
</div>
</div>
<div id="plotting-the-averaged-data-with-error-bars" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Plotting the averaged data with error bars<a href="creating-a-composite-figure-by-subplotting.html#plotting-the-averaged-data-with-error-bars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plotting the averaged data can be done with a data frame that contains individual observation (ex. each subject, condition, etc). This data frame can be modified to only contain summary values, such as mean and standard error, using <code>group_by()</code> and <code>summarise()</code> together as shown above.</p>
<p>We will plot a similar graph to <strong>Figure 3A</strong> in the Vision Research paper (Min et al., 2019) in this section.</p>
<ul>
<li>A data frame that has grouped summary information (<code>group_by()</code> and <code>summarise()</code>), such as average and standard error across subject, is needed to plot a graph that shows the average data with error bars.</li>
<li><code>geom_errorbar()</code> is required to plot the error bar of the sample.</li>
<li>Legend title has been removed with the <code>theme()</code> function.</li>
<li>Greek letter <strong>Delta</strong> is printed with <code>\u0394</code>.</li>
<li>X-tick labels are originally 0, 1, 2, 3, 4, 5 (as specified in the <strong>df</strong> data frame). However, they can be manually changed using <code>labels =</code> argument in the <code>scale_x_continuous()</code> function.</li>
<li>Legend label can also be changed in <code>labels =</code> from the <code>scale_color_manual()</code> function because each <code>Day</code> has been defined by each <code>color</code>; this is the case because <code>color = Day</code> in <code>aes(..., ..., color = Day)</code>.</li>
</ul>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="creating-a-composite-figure-by-subplotting.html#cb299-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> by_day_time1, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Average, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb299-2"><a href="creating-a-composite-figure-by-subplotting.html#cb299-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb299-3"><a href="creating-a-composite-figure-by-subplotting.html#cb299-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Average <span class="sc">-</span> StdError, <span class="at">ymax =</span> Average <span class="sc">+</span> StdError), <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">width =</span> .<span class="dv">05</span>) <span class="sc">+</span></span>
<span id="cb299-4"><a href="creating-a-composite-figure-by-subplotting.html#cb299-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb299-5"><a href="creating-a-composite-figure-by-subplotting.html#cb299-5" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb299-6"><a href="creating-a-composite-figure-by-subplotting.html#cb299-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb299-7"><a href="creating-a-composite-figure-by-subplotting.html#cb299-7" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb299-8"><a href="creating-a-composite-figure-by-subplotting.html#cb299-8" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb299-9"><a href="creating-a-composite-figure-by-subplotting.html#cb299-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb299-10"><a href="creating-a-composite-figure-by-subplotting.html#cb299-10" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb299-11"><a href="creating-a-composite-figure-by-subplotting.html#cb299-11" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb299-12"><a href="creating-a-composite-figure-by-subplotting.html#cb299-12" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb299-13"><a href="creating-a-composite-figure-by-subplotting.html#cb299-13" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Day 1&quot;</span>, <span class="st">&quot;Day 5&quot;</span>)</span>
<span id="cb299-14"><a href="creating-a-composite-figure-by-subplotting.html#cb299-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb299-15"><a href="creating-a-composite-figure-by-subplotting.html#cb299-15" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Recovery of the patching effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb299-16"><a href="creating-a-composite-figure-by-subplotting.html#cb299-16" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time after monocular deprivation (min)&quot;</span>) <span class="sc">+</span></span>
<span id="cb299-17"><a href="creating-a-composite-figure-by-subplotting.html#cb299-17" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb299-18"><a href="creating-a-composite-figure-by-subplotting.html#cb299-18" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb299-19"><a href="creating-a-composite-figure-by-subplotting.html#cb299-19" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb299-20"><a href="creating-a-composite-figure-by-subplotting.html#cb299-20" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.67</span>),</span>
<span id="cb299-21"><a href="creating-a-composite-figure-by-subplotting.html#cb299-21" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb299-22"><a href="creating-a-composite-figure-by-subplotting.html#cb299-22" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-250-1.png" width="336" /></p>
</div>
<div id="plotting-individual-data" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Plotting individual data<a href="creating-a-composite-figure-by-subplotting.html#plotting-individual-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we will plot a similar graph to <strong>Figure A2</strong> in the Vision Research paper (Min et al., 2019).</p>
<p>First, let’s plot data for each subject (S1-S9) except S10. Each panel shows the data of each subject for both Days 1 and 5.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="creating-a-composite-figure-by-subplotting.html#cb301-1" tabindex="-1"></a>df_s1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S1&quot;</span>)</span>
<span id="cb301-2"><a href="creating-a-composite-figure-by-subplotting.html#cb301-2" tabindex="-1"></a><span class="co"># rows of df that only contain S1 in the Subject column</span></span>
<span id="cb301-3"><a href="creating-a-composite-figure-by-subplotting.html#cb301-3" tabindex="-1"></a></span>
<span id="cb301-4"><a href="creating-a-composite-figure-by-subplotting.html#cb301-4" tabindex="-1"></a><span class="co"># use df_s1 to plot the data of S1</span></span>
<span id="cb301-5"><a href="creating-a-composite-figure-by-subplotting.html#cb301-5" tabindex="-1"></a></span>
<span id="cb301-6"><a href="creating-a-composite-figure-by-subplotting.html#cb301-6" tabindex="-1"></a>plot_s1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s1, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb301-7"><a href="creating-a-composite-figure-by-subplotting.html#cb301-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb301-8"><a href="creating-a-composite-figure-by-subplotting.html#cb301-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb301-9"><a href="creating-a-composite-figure-by-subplotting.html#cb301-9" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb301-10"><a href="creating-a-composite-figure-by-subplotting.html#cb301-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb301-11"><a href="creating-a-composite-figure-by-subplotting.html#cb301-11" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb301-12"><a href="creating-a-composite-figure-by-subplotting.html#cb301-12" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb301-13"><a href="creating-a-composite-figure-by-subplotting.html#cb301-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb301-14"><a href="creating-a-composite-figure-by-subplotting.html#cb301-14" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb301-15"><a href="creating-a-composite-figure-by-subplotting.html#cb301-15" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb301-16"><a href="creating-a-composite-figure-by-subplotting.html#cb301-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb301-17"><a href="creating-a-composite-figure-by-subplotting.html#cb301-17" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb301-18"><a href="creating-a-composite-figure-by-subplotting.html#cb301-18" tabindex="-1"></a></span>
<span id="cb301-19"><a href="creating-a-composite-figure-by-subplotting.html#cb301-19" tabindex="-1"></a><span class="fu">print</span>(plot_s1)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-251-1.png" width="336" /></p>
<p>Then make each one for the other subjects (S2-S9).</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="creating-a-composite-figure-by-subplotting.html#cb303-1" tabindex="-1"></a>df_s2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S2&quot;</span>)</span>
<span id="cb303-2"><a href="creating-a-composite-figure-by-subplotting.html#cb303-2" tabindex="-1"></a></span>
<span id="cb303-3"><a href="creating-a-composite-figure-by-subplotting.html#cb303-3" tabindex="-1"></a>plot_s2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s2, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb303-4"><a href="creating-a-composite-figure-by-subplotting.html#cb303-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb303-5"><a href="creating-a-composite-figure-by-subplotting.html#cb303-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb303-6"><a href="creating-a-composite-figure-by-subplotting.html#cb303-6" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb303-7"><a href="creating-a-composite-figure-by-subplotting.html#cb303-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb303-8"><a href="creating-a-composite-figure-by-subplotting.html#cb303-8" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb303-9"><a href="creating-a-composite-figure-by-subplotting.html#cb303-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb303-10"><a href="creating-a-composite-figure-by-subplotting.html#cb303-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb303-11"><a href="creating-a-composite-figure-by-subplotting.html#cb303-11" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb303-12"><a href="creating-a-composite-figure-by-subplotting.html#cb303-12" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb303-13"><a href="creating-a-composite-figure-by-subplotting.html#cb303-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb303-14"><a href="creating-a-composite-figure-by-subplotting.html#cb303-14" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb303-15"><a href="creating-a-composite-figure-by-subplotting.html#cb303-15" tabindex="-1"></a></span>
<span id="cb303-16"><a href="creating-a-composite-figure-by-subplotting.html#cb303-16" tabindex="-1"></a><span class="fu">print</span>(plot_s2)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-252-1.png" width="336" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="creating-a-composite-figure-by-subplotting.html#cb305-1" tabindex="-1"></a>df_s3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S3&quot;</span>)</span>
<span id="cb305-2"><a href="creating-a-composite-figure-by-subplotting.html#cb305-2" tabindex="-1"></a></span>
<span id="cb305-3"><a href="creating-a-composite-figure-by-subplotting.html#cb305-3" tabindex="-1"></a>plot_s3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s3, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb305-4"><a href="creating-a-composite-figure-by-subplotting.html#cb305-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb305-5"><a href="creating-a-composite-figure-by-subplotting.html#cb305-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb305-6"><a href="creating-a-composite-figure-by-subplotting.html#cb305-6" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb305-7"><a href="creating-a-composite-figure-by-subplotting.html#cb305-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb305-8"><a href="creating-a-composite-figure-by-subplotting.html#cb305-8" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb305-9"><a href="creating-a-composite-figure-by-subplotting.html#cb305-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb305-10"><a href="creating-a-composite-figure-by-subplotting.html#cb305-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb305-11"><a href="creating-a-composite-figure-by-subplotting.html#cb305-11" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb305-12"><a href="creating-a-composite-figure-by-subplotting.html#cb305-12" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb305-13"><a href="creating-a-composite-figure-by-subplotting.html#cb305-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb305-14"><a href="creating-a-composite-figure-by-subplotting.html#cb305-14" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb305-15"><a href="creating-a-composite-figure-by-subplotting.html#cb305-15" tabindex="-1"></a></span>
<span id="cb305-16"><a href="creating-a-composite-figure-by-subplotting.html#cb305-16" tabindex="-1"></a><span class="fu">print</span>(plot_s3)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-253-1.png" width="336" /></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="creating-a-composite-figure-by-subplotting.html#cb307-1" tabindex="-1"></a>df_s4 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S4&quot;</span>)</span>
<span id="cb307-2"><a href="creating-a-composite-figure-by-subplotting.html#cb307-2" tabindex="-1"></a></span>
<span id="cb307-3"><a href="creating-a-composite-figure-by-subplotting.html#cb307-3" tabindex="-1"></a>plot_s4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s4, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb307-4"><a href="creating-a-composite-figure-by-subplotting.html#cb307-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb307-5"><a href="creating-a-composite-figure-by-subplotting.html#cb307-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb307-6"><a href="creating-a-composite-figure-by-subplotting.html#cb307-6" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb307-7"><a href="creating-a-composite-figure-by-subplotting.html#cb307-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb307-8"><a href="creating-a-composite-figure-by-subplotting.html#cb307-8" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb307-9"><a href="creating-a-composite-figure-by-subplotting.html#cb307-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb307-10"><a href="creating-a-composite-figure-by-subplotting.html#cb307-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb307-11"><a href="creating-a-composite-figure-by-subplotting.html#cb307-11" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb307-12"><a href="creating-a-composite-figure-by-subplotting.html#cb307-12" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb307-13"><a href="creating-a-composite-figure-by-subplotting.html#cb307-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb307-14"><a href="creating-a-composite-figure-by-subplotting.html#cb307-14" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb307-15"><a href="creating-a-composite-figure-by-subplotting.html#cb307-15" tabindex="-1"></a></span>
<span id="cb307-16"><a href="creating-a-composite-figure-by-subplotting.html#cb307-16" tabindex="-1"></a><span class="fu">print</span>(plot_s4)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-254-1.png" width="336" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="creating-a-composite-figure-by-subplotting.html#cb309-1" tabindex="-1"></a><span class="co"># Subject 5</span></span>
<span id="cb309-2"><a href="creating-a-composite-figure-by-subplotting.html#cb309-2" tabindex="-1"></a>df_s5 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S5&quot;</span>)</span>
<span id="cb309-3"><a href="creating-a-composite-figure-by-subplotting.html#cb309-3" tabindex="-1"></a><span class="co"># rows of df that only contain S5 in the Subject column</span></span>
<span id="cb309-4"><a href="creating-a-composite-figure-by-subplotting.html#cb309-4" tabindex="-1"></a></span>
<span id="cb309-5"><a href="creating-a-composite-figure-by-subplotting.html#cb309-5" tabindex="-1"></a>plot_s5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s5, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb309-6"><a href="creating-a-composite-figure-by-subplotting.html#cb309-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb309-7"><a href="creating-a-composite-figure-by-subplotting.html#cb309-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb309-8"><a href="creating-a-composite-figure-by-subplotting.html#cb309-8" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb309-9"><a href="creating-a-composite-figure-by-subplotting.html#cb309-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb309-10"><a href="creating-a-composite-figure-by-subplotting.html#cb309-10" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb309-11"><a href="creating-a-composite-figure-by-subplotting.html#cb309-11" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb309-12"><a href="creating-a-composite-figure-by-subplotting.html#cb309-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb309-13"><a href="creating-a-composite-figure-by-subplotting.html#cb309-13" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb309-14"><a href="creating-a-composite-figure-by-subplotting.html#cb309-14" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb309-15"><a href="creating-a-composite-figure-by-subplotting.html#cb309-15" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb309-16"><a href="creating-a-composite-figure-by-subplotting.html#cb309-16" tabindex="-1"></a></span>
<span id="cb309-17"><a href="creating-a-composite-figure-by-subplotting.html#cb309-17" tabindex="-1"></a><span class="fu">print</span>(plot_s5)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-255-1.png" width="336" /></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="creating-a-composite-figure-by-subplotting.html#cb311-1" tabindex="-1"></a><span class="co"># Subject 6</span></span>
<span id="cb311-2"><a href="creating-a-composite-figure-by-subplotting.html#cb311-2" tabindex="-1"></a>df_s6 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S6&quot;</span>)</span>
<span id="cb311-3"><a href="creating-a-composite-figure-by-subplotting.html#cb311-3" tabindex="-1"></a><span class="co"># rows of df that only contain S6 in the Subject column</span></span>
<span id="cb311-4"><a href="creating-a-composite-figure-by-subplotting.html#cb311-4" tabindex="-1"></a></span>
<span id="cb311-5"><a href="creating-a-composite-figure-by-subplotting.html#cb311-5" tabindex="-1"></a>plot_s6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s5, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb311-6"><a href="creating-a-composite-figure-by-subplotting.html#cb311-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb311-7"><a href="creating-a-composite-figure-by-subplotting.html#cb311-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb311-8"><a href="creating-a-composite-figure-by-subplotting.html#cb311-8" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb311-9"><a href="creating-a-composite-figure-by-subplotting.html#cb311-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb311-10"><a href="creating-a-composite-figure-by-subplotting.html#cb311-10" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb311-11"><a href="creating-a-composite-figure-by-subplotting.html#cb311-11" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb311-12"><a href="creating-a-composite-figure-by-subplotting.html#cb311-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb311-13"><a href="creating-a-composite-figure-by-subplotting.html#cb311-13" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb311-14"><a href="creating-a-composite-figure-by-subplotting.html#cb311-14" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb311-15"><a href="creating-a-composite-figure-by-subplotting.html#cb311-15" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb311-16"><a href="creating-a-composite-figure-by-subplotting.html#cb311-16" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb311-17"><a href="creating-a-composite-figure-by-subplotting.html#cb311-17" tabindex="-1"></a></span>
<span id="cb311-18"><a href="creating-a-composite-figure-by-subplotting.html#cb311-18" tabindex="-1"></a><span class="fu">print</span>(plot_s6)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-256-1.png" width="336" /></p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="creating-a-composite-figure-by-subplotting.html#cb313-1" tabindex="-1"></a>df_s7 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S7&quot;</span>)</span>
<span id="cb313-2"><a href="creating-a-composite-figure-by-subplotting.html#cb313-2" tabindex="-1"></a></span>
<span id="cb313-3"><a href="creating-a-composite-figure-by-subplotting.html#cb313-3" tabindex="-1"></a>plot_s7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s7, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb313-4"><a href="creating-a-composite-figure-by-subplotting.html#cb313-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb313-5"><a href="creating-a-composite-figure-by-subplotting.html#cb313-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb313-6"><a href="creating-a-composite-figure-by-subplotting.html#cb313-6" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb313-7"><a href="creating-a-composite-figure-by-subplotting.html#cb313-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb313-8"><a href="creating-a-composite-figure-by-subplotting.html#cb313-8" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb313-9"><a href="creating-a-composite-figure-by-subplotting.html#cb313-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb313-10"><a href="creating-a-composite-figure-by-subplotting.html#cb313-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb313-11"><a href="creating-a-composite-figure-by-subplotting.html#cb313-11" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb313-12"><a href="creating-a-composite-figure-by-subplotting.html#cb313-12" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb313-13"><a href="creating-a-composite-figure-by-subplotting.html#cb313-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb313-14"><a href="creating-a-composite-figure-by-subplotting.html#cb313-14" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb313-15"><a href="creating-a-composite-figure-by-subplotting.html#cb313-15" tabindex="-1"></a></span>
<span id="cb313-16"><a href="creating-a-composite-figure-by-subplotting.html#cb313-16" tabindex="-1"></a><span class="fu">print</span>(plot_s7)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-257-1.png" width="336" /></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="creating-a-composite-figure-by-subplotting.html#cb315-1" tabindex="-1"></a>df_s8 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S8&quot;</span>)</span>
<span id="cb315-2"><a href="creating-a-composite-figure-by-subplotting.html#cb315-2" tabindex="-1"></a></span>
<span id="cb315-3"><a href="creating-a-composite-figure-by-subplotting.html#cb315-3" tabindex="-1"></a>plot_s8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s8, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb315-4"><a href="creating-a-composite-figure-by-subplotting.html#cb315-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb315-5"><a href="creating-a-composite-figure-by-subplotting.html#cb315-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb315-6"><a href="creating-a-composite-figure-by-subplotting.html#cb315-6" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb315-7"><a href="creating-a-composite-figure-by-subplotting.html#cb315-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb315-8"><a href="creating-a-composite-figure-by-subplotting.html#cb315-8" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb315-9"><a href="creating-a-composite-figure-by-subplotting.html#cb315-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb315-10"><a href="creating-a-composite-figure-by-subplotting.html#cb315-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb315-11"><a href="creating-a-composite-figure-by-subplotting.html#cb315-11" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb315-12"><a href="creating-a-composite-figure-by-subplotting.html#cb315-12" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb315-13"><a href="creating-a-composite-figure-by-subplotting.html#cb315-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb315-14"><a href="creating-a-composite-figure-by-subplotting.html#cb315-14" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb315-15"><a href="creating-a-composite-figure-by-subplotting.html#cb315-15" tabindex="-1"></a></span>
<span id="cb315-16"><a href="creating-a-composite-figure-by-subplotting.html#cb315-16" tabindex="-1"></a><span class="fu">print</span>(plot_s8)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-258-1.png" width="336" /></p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="creating-a-composite-figure-by-subplotting.html#cb317-1" tabindex="-1"></a><span class="co"># Subject 9</span></span>
<span id="cb317-2"><a href="creating-a-composite-figure-by-subplotting.html#cb317-2" tabindex="-1"></a></span>
<span id="cb317-3"><a href="creating-a-composite-figure-by-subplotting.html#cb317-3" tabindex="-1"></a>df_s9 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&quot;S9&quot;</span>)</span>
<span id="cb317-4"><a href="creating-a-composite-figure-by-subplotting.html#cb317-4" tabindex="-1"></a></span>
<span id="cb317-5"><a href="creating-a-composite-figure-by-subplotting.html#cb317-5" tabindex="-1"></a>plot_s9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s9, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb317-6"><a href="creating-a-composite-figure-by-subplotting.html#cb317-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb317-7"><a href="creating-a-composite-figure-by-subplotting.html#cb317-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb317-8"><a href="creating-a-composite-figure-by-subplotting.html#cb317-8" tabindex="-1"></a>  <span class="co"># lm = linear regression method</span></span>
<span id="cb317-9"><a href="creating-a-composite-figure-by-subplotting.html#cb317-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb317-10"><a href="creating-a-composite-figure-by-subplotting.html#cb317-10" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb317-11"><a href="creating-a-composite-figure-by-subplotting.html#cb317-11" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb317-12"><a href="creating-a-composite-figure-by-subplotting.html#cb317-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb317-13"><a href="creating-a-composite-figure-by-subplotting.html#cb317-13" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb317-14"><a href="creating-a-composite-figure-by-subplotting.html#cb317-14" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb317-15"><a href="creating-a-composite-figure-by-subplotting.html#cb317-15" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb317-16"><a href="creating-a-composite-figure-by-subplotting.html#cb317-16" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size.</span></span>
<span id="cb317-17"><a href="creating-a-composite-figure-by-subplotting.html#cb317-17" tabindex="-1"></a></span>
<span id="cb317-18"><a href="creating-a-composite-figure-by-subplotting.html#cb317-18" tabindex="-1"></a><span class="fu">print</span>(plot_s9)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-259-1.png" width="336" /></p>
<p>This is quite a repetitive process! Fortunately, you can also generate the nine plots using a programmatic approach, which involves loop around the nine subjects using one code chunk. This method is described in section 7.7.</p>
</div>
<div id="putting-multiple-plots-together-a-composite-figure---sm_put_together" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Putting multiple plots together (a composite figure) - <code>sm_put_together()</code><a href="creating-a-composite-figure-by-subplotting.html#putting-multiple-plots-together-a-composite-figure---sm_put_together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Each panel output has to be stored in a <code>list</code> using the function <code>list()</code>. X-axis label can be specified using <code>sm_common_xlabel()</code>, which has <code>x</code> and <code>y</code> arguments for setting the location of the label. Y-axis label is specified using <code>sm_common_ylabel()</code> with the same <code>x</code> and <code>y</code> arguments. The title can be set using <code>sm_common_title()</code>.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="creating-a-composite-figure-by-subplotting.html#cb319-1" tabindex="-1"></a>all_plots <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb319-2"><a href="creating-a-composite-figure-by-subplotting.html#cb319-2" tabindex="-1"></a>  plot_s1, plot_s2, plot_s3,</span>
<span id="cb319-3"><a href="creating-a-composite-figure-by-subplotting.html#cb319-3" tabindex="-1"></a>  plot_s4, plot_s5, plot_s6,</span>
<span id="cb319-4"><a href="creating-a-composite-figure-by-subplotting.html#cb319-4" tabindex="-1"></a>  plot_s7, plot_s8, plot_s9</span>
<span id="cb319-5"><a href="creating-a-composite-figure-by-subplotting.html#cb319-5" tabindex="-1"></a>)</span>
<span id="cb319-6"><a href="creating-a-composite-figure-by-subplotting.html#cb319-6" tabindex="-1"></a></span>
<span id="cb319-7"><a href="creating-a-composite-figure-by-subplotting.html#cb319-7" tabindex="-1"></a>xlabel <span class="ot">&lt;-</span> <span class="fu">sm_common_xlabel</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>, <span class="at">x =</span> <span class="fl">0.52</span>, <span class="at">y =</span> <span class="fl">0.6</span>)</span>
<span id="cb319-8"><a href="creating-a-composite-figure-by-subplotting.html#cb319-8" tabindex="-1"></a>ylabel <span class="ot">&lt;-</span> <span class="fu">sm_common_ylabel</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>)</span>
<span id="cb319-9"><a href="creating-a-composite-figure-by-subplotting.html#cb319-9" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">sm_common_title</span>(<span class="st">&quot;Individual data&quot;</span>, <span class="at">y =</span> <span class="fl">0.2</span>)</span>
<span id="cb319-10"><a href="creating-a-composite-figure-by-subplotting.html#cb319-10" tabindex="-1"></a></span>
<span id="cb319-11"><a href="creating-a-composite-figure-by-subplotting.html#cb319-11" tabindex="-1"></a>plots_tgd <span class="ot">&lt;-</span> <span class="fu">sm_put_together</span>(all_plots,</span>
<span id="cb319-12"><a href="creating-a-composite-figure-by-subplotting.html#cb319-12" tabindex="-1"></a>  <span class="at">title =</span> title, <span class="at">xlabel =</span> xlabel,</span>
<span id="cb319-13"><a href="creating-a-composite-figure-by-subplotting.html#cb319-13" tabindex="-1"></a>  <span class="at">ylabel =</span> ylabel, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb319-14"><a href="creating-a-composite-figure-by-subplotting.html#cb319-14" tabindex="-1"></a>  <span class="at">hmargin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">wmargin =</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb319-15"><a href="creating-a-composite-figure-by-subplotting.html#cb319-15" tabindex="-1"></a>)</span></code></pre></div>
<p>Now let’s put them together in a 3x3 figure (3 rows, 3 columns) using the function <code>sm_put_together()</code>. So, <code>ncol</code> and <code>nrow</code> are set to 3 in <code>sm_put_together()</code>. The function automatically removes tick labels in both x- and y-axes in inner panels, and keeps them on the outer panels, so that combined plot looks clean. Also, the <code>hmargin</code> argument can be set to adjust the blank space of height between panels; the <code>wmargin</code> argument can be set to adjust the blank space of width between panels. Their values can be both negative (less blank space) and positive (more blank space). I suggest you use values from <em>-5 to 5</em> for <code>hmargin</code> and <code>wmargin</code>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-261"></span>
<img src="img/rc33.png" alt="3x3 figure. It has 3 columns and 3 rows" width="75%" />
<p class="caption">
Figure 7.1: 3x3 figure. It has 3 columns and 3 rows
</p>
</div>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="creating-a-composite-figure-by-subplotting.html#cb320-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;together1.png&quot;</span>, plots_tgd,</span>
<span id="cb320-2"><a href="creating-a-composite-figure-by-subplotting.html#cb320-2" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb320-3"><a href="creating-a-composite-figure-by-subplotting.html#cb320-3" tabindex="-1"></a>  <span class="at">height =</span> <span class="fl">10.2</span></span>
<span id="cb320-4"><a href="creating-a-composite-figure-by-subplotting.html#cb320-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="together1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><code>ggsave()</code>, a function from the <strong>ggplot2</strong> package, can be used to save the graph as an image/vector file with a specified dimension of the figure, using <code>width</code> and <code>height</code> arguments (inches).</p>
<p>Open <code>together1.png</code> in your directory folder. The figure is clean but it lacks a few things: 1) label for each panel, 2) legend. With examples below, we will add them.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="creating-a-composite-figure-by-subplotting.html#cb321-1" tabindex="-1"></a>all_plots2 <span class="ot">&lt;-</span> <span class="fu">sm_panel_label</span>(all_plots,</span>
<span id="cb321-2"><a href="creating-a-composite-figure-by-subplotting.html#cb321-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="fl">0.9</span>, <span class="at">panel_tag =</span> <span class="st">&quot;1&quot;</span>, <span class="at">panel_pretag =</span> <span class="st">&quot;S&quot;</span>, <span class="at">text_size =</span> <span class="dv">5</span>,</span>
<span id="cb321-3"><a href="creating-a-composite-figure-by-subplotting.html#cb321-3" tabindex="-1"></a>  <span class="at">text_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb321-4"><a href="creating-a-composite-figure-by-subplotting.html#cb321-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Here, we include a label for each panel, which represents the data of each subject, using <code>sm_panel_label()</code>.</p>
<p>The function <code>sm_panel_label()</code> has a few arguments. <code>x</code> and <code>y</code> determine the location of the panel label; 0.5 represents its origin in the middle of the panel. <code>panel_tag</code> determines the character string that will be used for enumeration. In this example, <code>panel_tag = "1"</code> is chosen so there will be a sequence of numbers. Other options include: 1) <code>panel_tag = "A"</code> for uppercase letters, 2) <code>panel_tag = "a"</code> for small case letters, 3) <code>panel_tag = "I"</code> for upper roman numerals, and 4) <code>panel_tag = "i"</code> for lower roman numerals. There are also tag labels that can set to be <em>consistent</em> across panels: these are <code>panel_pretag</code> and <code>panel_posttag</code>. <code>panel_pretag</code> comes before <code>panel_tag</code> (as shown in this example, in the form of <code>S</code>, ex. <code>S1</code>), and <code>panel_posttag</code> comes after <code>panel_tag</code>.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="creating-a-composite-figure-by-subplotting.html#cb322-1" tabindex="-1"></a>plots_tgd2 <span class="ot">&lt;-</span> <span class="fu">sm_put_together</span>(all_plots2,</span>
<span id="cb322-2"><a href="creating-a-composite-figure-by-subplotting.html#cb322-2" tabindex="-1"></a>  <span class="at">title =</span> title, <span class="at">xlabel =</span> xlabel,</span>
<span id="cb322-3"><a href="creating-a-composite-figure-by-subplotting.html#cb322-3" tabindex="-1"></a>  <span class="at">ylabel =</span> ylabel, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb322-4"><a href="creating-a-composite-figure-by-subplotting.html#cb322-4" tabindex="-1"></a>  <span class="at">hmargin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">wmargin =</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb322-5"><a href="creating-a-composite-figure-by-subplotting.html#cb322-5" tabindex="-1"></a>)</span>
<span id="cb322-6"><a href="creating-a-composite-figure-by-subplotting.html#cb322-6" tabindex="-1"></a></span>
<span id="cb322-7"><a href="creating-a-composite-figure-by-subplotting.html#cb322-7" tabindex="-1"></a>plots_tgd3 <span class="ot">&lt;-</span> <span class="fu">sm_add_legend</span>(plots_tgd2,</span>
<span id="cb322-8"><a href="creating-a-composite-figure-by-subplotting.html#cb322-8" tabindex="-1"></a>  <span class="at">x =</span> .<span class="dv">88</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">sampleplot =</span> all_plots2[[<span class="dv">1</span>]],</span>
<span id="cb322-9"><a href="creating-a-composite-figure-by-subplotting.html#cb322-9" tabindex="-1"></a>  <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="at">border =</span> <span class="cn">FALSE</span></span>
<span id="cb322-10"><a href="creating-a-composite-figure-by-subplotting.html#cb322-10" tabindex="-1"></a>)</span></code></pre></div>
<p>As before, we then combine the list of plots with panel label (<code>all_plots2</code>) and the labels for the common x- and y-axes, as well as the title of the combined figure using <code>sm_put_together()</code>. The arguments of <code>sm_put_together()</code> have to be written in this order unless they are specified (ex. <code>sm_put_together(all_plots=all_plots, xlabel=xlabel, title=title)</code>). We reduce the margin of width and height blank space between panels by setting <code>hmargin=-5</code> and <code>vmargin=-5</code>.</p>
<p>Next, we add legend using <code>sm_add_legend()</code>. It has a number of arguments. First, the combined figure (output from <code>sm_put_together()</code>) must be provided. Next, <code>x</code> and <code>y</code> are the location of the legend in the coordinates of the combined figure (0 to 1), where <code>x=0.5</code> and <code>y=0.5</code> represents the center of the combined figure. <code>sampleplot</code> has to be provided, which in this case one of the plots in the <code>plots_tgd2</code> list, so that the function <code>sm_add_legend()</code> can derive a legend for the whole combined plot. The <code>direction</code> (or orientation) of the legend can also be set as <code>horizontal</code> or <code>vertical</code>; in this case, we set it to <code>direction = horizontal</code>.</p>
<p><img src="together2a.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The border of the legend can also be included by setting <code>border = TRUE</code>. We can also increase the amount of spacing within the legend using <code>legend_spacing</code> argument from <code>sm_add_legend</code>. This change is subtle but you will definitely notice it.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="creating-a-composite-figure-by-subplotting.html#cb323-1" tabindex="-1"></a>plots_tgd3b <span class="ot">&lt;-</span> <span class="fu">sm_add_legend</span>(plots_tgd2,</span>
<span id="cb323-2"><a href="creating-a-composite-figure-by-subplotting.html#cb323-2" tabindex="-1"></a>  <span class="at">x =</span> .<span class="dv">88</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">sampleplot =</span> all_plots2[[<span class="dv">1</span>]],</span>
<span id="cb323-3"><a href="creating-a-composite-figure-by-subplotting.html#cb323-3" tabindex="-1"></a>  <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="at">border =</span> <span class="cn">TRUE</span>, <span class="at">legend_spacing =</span> <span class="dv">1</span></span>
<span id="cb323-4"><a href="creating-a-composite-figure-by-subplotting.html#cb323-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="together2b.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can even make a separate legend on your own with full customization using <code>sm_common_legend()</code>, then add the legend to the combined plot using <code>sm_add_legend()</code>. We will do this by first making a combined figure with two rows and five columns (<code>nrow=2</code> and <code>ncol=5</code>). The legend can be on the 10th panel because its empty.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="creating-a-composite-figure-by-subplotting.html#cb325-1" tabindex="-1"></a>legend <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s9, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb325-2"><a href="creating-a-composite-figure-by-subplotting.html#cb325-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb325-3"><a href="creating-a-composite-figure-by-subplotting.html#cb325-3" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb325-4"><a href="creating-a-composite-figure-by-subplotting.html#cb325-4" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb325-5"><a href="creating-a-composite-figure-by-subplotting.html#cb325-5" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Data from Day 1 &quot;</span>, <span class="st">&quot;Data from Day 5 &quot;</span>)</span>
<span id="cb325-6"><a href="creating-a-composite-figure-by-subplotting.html#cb325-6" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb325-7"><a href="creating-a-composite-figure-by-subplotting.html#cb325-7" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb325-8"><a href="creating-a-composite-figure-by-subplotting.html#cb325-8" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),</span>
<span id="cb325-9"><a href="creating-a-composite-figure-by-subplotting.html#cb325-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Data from Day 1 &quot;</span>, <span class="st">&quot;Data from Day 5 &quot;</span>)</span>
<span id="cb325-10"><a href="creating-a-composite-figure-by-subplotting.html#cb325-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb325-11"><a href="creating-a-composite-figure-by-subplotting.html#cb325-11" tabindex="-1"></a>  <span class="fu">sm_common_legend</span>(<span class="at">title =</span> <span class="cn">FALSE</span>, <span class="at">legend_spacing =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-272-1.png" width="288" /></p>
<p>Basically, <code>legend</code> that is created with <code>sm_common_legend()</code> is a new plot with no points; however, you still need to draw the same points and include other features from other sub-panels to make sure that they are included in the legend. Notice that legend labels have been customized as well by adjusting the <code>labels</code> within <code>scale_color_manual()</code> and <code>scale_shape_manual()</code>. The title has been removed by setting <code>title = FALSE</code>.</p>
<p>The <code>legend</code> can then be added to the combined plot using <code>sm_add_legend()</code>. If you provide a separate legend, then other arguments of the function will be ignored, such as <code>direction</code> and <code>border</code> from <code>sm_add_legend()</code> because these arguments are used to derive a legend based on <code>sampleplot</code>. <code>x</code> and <code>y</code> describe the coordinates of the legend in the composite plot (output from <code>sm_put_together()</code>: <code>plots_tgd2</code>), and these are supplied in the <code>sm_add_legend()</code>.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="creating-a-composite-figure-by-subplotting.html#cb326-1" tabindex="-1"></a>plots_tgd3c <span class="ot">&lt;-</span> <span class="fu">sm_add_legend</span>(plots_tgd2, <span class="at">x =</span> .<span class="dv">91</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">legend =</span> legend)</span></code></pre></div>
<p><img src="together2c.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Also, besides <code>sm_add_legend()</code>, <code>sm_put_together()</code> can also legend onto the combined plot if the user supplies a separate legend input: ex. <code>sm_put_together(legend = legend)</code>, where <code>legend</code> is a separate legend created as shown above. If the <code>legend</code> is provided in <code>sm_put_together()</code>, the function will automatically add legend onto the last panel of the combined plot, so make sure that the last empty panel is empty. The <code>x</code> and <code>y</code> coordinates howeevr are determined using <code>sm_common_legend()</code>, which we have opted for their defaults <code>x=0.5</code> and <code>y=0.5</code>, ex. <code>sm_common_legend(title=FALSE, legend_spacing=1, x=0.5, y=0.5)</code> in the above.</p>
<p>To demonstrate this function, we will make a combined figure with 2 rows and 5 columns.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="creating-a-composite-figure-by-subplotting.html#cb327-1" tabindex="-1"></a>xlabel <span class="ot">&lt;-</span> <span class="fu">sm_common_xlabel</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>, <span class="at">x =</span> <span class="fl">0.51</span>, <span class="at">y =</span> <span class="fl">0.6</span>)</span>
<span id="cb327-2"><a href="creating-a-composite-figure-by-subplotting.html#cb327-2" tabindex="-1"></a>ylabel <span class="ot">&lt;-</span> <span class="fu">sm_common_ylabel</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>, <span class="at">x =</span> <span class="fl">0.7</span>)</span>
<span id="cb327-3"><a href="creating-a-composite-figure-by-subplotting.html#cb327-3" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">sm_common_title</span>(<span class="st">&quot;Individual data&quot;</span>, <span class="at">y =</span> <span class="fl">0.3</span>, <span class="at">x =</span> <span class="fl">0.51</span>, <span class="at">size =</span> <span class="dv">18</span>)</span>
<span id="cb327-4"><a href="creating-a-composite-figure-by-subplotting.html#cb327-4" tabindex="-1"></a></span>
<span id="cb327-5"><a href="creating-a-composite-figure-by-subplotting.html#cb327-5" tabindex="-1"></a>plots_tgd4 <span class="ot">&lt;-</span> <span class="fu">sm_put_together</span>(all_plots,</span>
<span id="cb327-6"><a href="creating-a-composite-figure-by-subplotting.html#cb327-6" tabindex="-1"></a>  <span class="at">title =</span> title, <span class="at">xlabel =</span> xlabel,</span>
<span id="cb327-7"><a href="creating-a-composite-figure-by-subplotting.html#cb327-7" tabindex="-1"></a>  <span class="at">ylabel =</span> ylabel, <span class="at">legend =</span> legend,</span>
<span id="cb327-8"><a href="creating-a-composite-figure-by-subplotting.html#cb327-8" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">hmargin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">wmargin =</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb327-9"><a href="creating-a-composite-figure-by-subplotting.html#cb327-9" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="creating-a-composite-figure-by-subplotting.html#cb328-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;together4.png&quot;</span>, plots_tgd4,</span>
<span id="cb328-2"><a href="creating-a-composite-figure-by-subplotting.html#cb328-2" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">15</span>,</span>
<span id="cb328-3"><a href="creating-a-composite-figure-by-subplotting.html#cb328-3" tabindex="-1"></a>  <span class="at">height =</span> <span class="fl">6.8</span></span>
<span id="cb328-4"><a href="creating-a-composite-figure-by-subplotting.html#cb328-4" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments of <code>sm_put_together()</code> have to be written in this order unless they are specified (ex. <code>sm_put_together(all_plots=all_plots, xlabel=xlabel, title=title)</code>).</p>
<p>The <code>title</code>, <code>xlabel</code>, <code>xlabel2</code>, <code>ylabel</code> and <code>ylabel2</code> can be provided as string characters, as shown below. If characters are provided rather than the outputs of <code>sm_common_title()</code>, <code>sm_common_xlabel()</code> and <code>sm_common_ylabel()</code>, then their locations cannot be modified. Their sizes can be adjusted using <code>labelRatio</code> argument. A value of 1 refers to the optimized text size, and 1.1 will be 0.1x larger than the optimized size. The text size optimization and the text locations are set by a simple algorithm that relies on the plot’s layout and other information to give optimal values. <code>labelRatio</code> only adjusts the text sizes when the label inputs are supplied as character strings, and they wont change text sizes when these have been created with <code>sm_common_title()</code>, <code>sm_common_xlabel()</code> and <code>sm_common_ylabel()</code>.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="creating-a-composite-figure-by-subplotting.html#cb329-1" tabindex="-1"></a>plots_tgd_quick <span class="ot">&lt;-</span> <span class="fu">sm_put_together</span>(all_plots,</span>
<span id="cb329-2"><a href="creating-a-composite-figure-by-subplotting.html#cb329-2" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Individual data&quot;</span>, <span class="at">xlabel =</span> <span class="st">&quot;Minutes after monocular deprivation&quot;</span>,</span>
<span id="cb329-3"><a href="creating-a-composite-figure-by-subplotting.html#cb329-3" tabindex="-1"></a>  <span class="at">ylabel =</span> <span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>, <span class="at">legend =</span> legend,</span>
<span id="cb329-4"><a href="creating-a-composite-figure-by-subplotting.html#cb329-4" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">hmargin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">wmargin =</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb329-5"><a href="creating-a-composite-figure-by-subplotting.html#cb329-5" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="creating-a-composite-figure-by-subplotting.html#cb330-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;together4_quick.png&quot;</span>, plots_tgd_quick,</span>
<span id="cb330-2"><a href="creating-a-composite-figure-by-subplotting.html#cb330-2" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">15</span>,</span>
<span id="cb330-3"><a href="creating-a-composite-figure-by-subplotting.html#cb330-3" tabindex="-1"></a>  <span class="at">height =</span> <span class="fl">6.8</span></span>
<span id="cb330-4"><a href="creating-a-composite-figure-by-subplotting.html#cb330-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="other-important-inputs-of-sm_put_together" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Other important inputs of <code>sm_put_together()</code><a href="creating-a-composite-figure-by-subplotting.html#other-important-inputs-of-sm_put_together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These inputs are automatically optimized (or adjusted) as default if the user does not supply input.</p>
<ol style="list-style-type: decimal">
<li><p><code>wRatio</code>: controls the relative width of the panels in the left-most column of the composite plot with ticks for the <strong>primary y-axis</strong>.</p></li>
<li><p><code>wRatio2</code>: controls the relative width of the panels in the right-most column of the composite plot with ticks for the <strong>secondary y-axis</strong>. This gets activated if one of the plots in the input list has secondary y-axis.</p></li>
<li><p><code>hRatio</code>: controls the relative height of the panels in the bottom row of the composite plot with ticks for the <strong>primary x-axis</strong>.</p></li>
<li><p><code>hRatio2</code>: controls the relative height of the panels in the top row of the composite plot with ticks for the <strong>secondary x-axis</strong>. This gets activated if one of the plots in the input list has secondary x-axis.</p></li>
<li><p><code>tickRatio</code>: controls the relative text size of the tick labels on both axes of the outer panels in the composite plot.</p></li>
</ol>
<p>However, it is possible that the optimization might not yield the best composite output, especially if users change the font sizes and because I cannot simply anticipate all possible plotting situations. <strong>So, users are encouraged to modify these arguments using values from 1.1 to 1.4</strong>.</p>
<ol start="6" style="list-style-type: decimal">
<li><code>labelRatio</code>: controls the size of the titles (labels) of both axes. This gets activated only when users supply character inputs for the labels (<code>title</code>,<code>xlabel</code>, <code>ylabel</code>, <code>xlabel2</code> or <code>ylabel2</code>). Otherwise, it gets ignored when users supply outputs from <code>sm_common_title()</code>, <code>sm_common_xaxis()</code> and <code>sm_common_yaxis()</code>.</li>
</ol>
<p><img src="together4.png" width="2250" style="display: block; margin: auto;" /></p>
</div>
<div id="adding-annotations-to-the-composite-figure" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Adding annotations to the composite figure<a href="creating-a-composite-figure-by-subplotting.html#adding-annotations-to-the-composite-figure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>smplot2</em> enables users to add annotations on the final, combined figure with a full flexibility. Here are some examples using both functions of <em>smplot2</em> and <code>annotate()</code> from <code>ggplot2</code>. Theoretically, users can also use functions from other packages. Except for <code>sm_add_legend()</code>, <code>sm_add_point()</code> and <code>sm_add_text()</code> functions are added modularly to the composite plot (output from <code>sm_put_together()</code>) as shown below.</p>
<div id="text-annotations" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Text annotations<a href="creating-a-composite-figure-by-subplotting.html#text-annotations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Text annotations can be added to the composite figure using <code>sm_add_text()</code>. The <code>label</code> argument can be used to specify the text label. <code>x</code> and <code>y</code> are the coordinate values of the text in the composite figure, and they have to be between 0 and 1; 0.5 represents the origin (center) of the composite figure. <code>size</code> determines the text size and the <code>fontface</code> can be either <code>bold</code>, <code>plain</code>, <code>italic</code> or <code>italic.bold</code>.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="creating-a-composite-figure-by-subplotting.html#cb331-1" tabindex="-1"></a>plots_tgd4b <span class="ot">&lt;-</span> plots_tgd4 <span class="sc">+</span> <span class="fu">sm_add_text</span>(</span>
<span id="cb331-2"><a href="creating-a-composite-figure-by-subplotting.html#cb331-2" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;My composite figure&quot;</span>,</span>
<span id="cb331-3"><a href="creating-a-composite-figure-by-subplotting.html#cb331-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.185</span>, <span class="at">y =</span> <span class="fl">0.19</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb331-4"><a href="creating-a-composite-figure-by-subplotting.html#cb331-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="together4b.png" width="2250" style="display: block; margin: auto;" /></p>
</div>
<div id="point-annotations" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Point annotations<a href="creating-a-composite-figure-by-subplotting.html#point-annotations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Point annotations can be added to the composite figure using <code>sm_add_point()</code>. <code>x</code> and <code>y</code> are the coordinate values of the point in the composite figure, and they have to be between 0 and 1; 0.5 represents the origin (center) of the composite figure. <code>size</code> determines the point size and the <code>shape</code> number input should be the same as the ones in <em>ggplot2</em> (ex. 21 is circle with border). <code>fill</code> should be provided for shapes with border. If the shape has no border, then <code>color</code> is sufficient to set the color that fills the point.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="creating-a-composite-figure-by-subplotting.html#cb332-1" tabindex="-1"></a>plots_tgd4c <span class="ot">&lt;-</span> plots_tgd4b <span class="sc">+</span> <span class="fu">sm_add_point</span>(</span>
<span id="cb332-2"><a href="creating-a-composite-figure-by-subplotting.html#cb332-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.50</span>, <span class="at">y =</span> <span class="fl">0.50</span>, <span class="at">size =</span> <span class="dv">35</span>,</span>
<span id="cb332-3"><a href="creating-a-composite-figure-by-subplotting.html#cb332-3" tabindex="-1"></a>  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;gray80&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb332-4"><a href="creating-a-composite-figure-by-subplotting.html#cb332-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="together4c.png" width="2250" style="display: block; margin: auto;" /></p>
</div>
<div id="line-annotations" class="section level3 hasAnchor" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Line annotations<a href="creating-a-composite-figure-by-subplotting.html#line-annotations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Line annotations can be added to the composite figure using <code>annotate()</code>. <code>x</code> and <code>y</code> are the starting coordinate values of the line in the composite figure. <code>xend</code> and <code>yend</code> are the ending coordinate values of the line. These coordinate values have to be between 0 and 1; 0.5 represents the origin (center) of the composite figure. <code>linewidth</code> determines the width of the line and the <code>color</code> should adjust the color of the line. There is no <code>fill</code> argument.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="creating-a-composite-figure-by-subplotting.html#cb333-1" tabindex="-1"></a>plots_tgd4e <span class="ot">&lt;-</span> plots_tgd4c <span class="sc">+</span></span>
<span id="cb333-2"><a href="creating-a-composite-figure-by-subplotting.html#cb333-2" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>,</span>
<span id="cb333-3"><a href="creating-a-composite-figure-by-subplotting.html#cb333-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.475</span>, <span class="at">xend =</span> <span class="fl">0.5</span>,</span>
<span id="cb333-4"><a href="creating-a-composite-figure-by-subplotting.html#cb333-4" tabindex="-1"></a>    <span class="at">yend =</span> <span class="fl">0.525</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb333-5"><a href="creating-a-composite-figure-by-subplotting.html#cb333-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb333-6"><a href="creating-a-composite-figure-by-subplotting.html#cb333-6" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>,</span>
<span id="cb333-7"><a href="creating-a-composite-figure-by-subplotting.html#cb333-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.49</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.51</span>,</span>
<span id="cb333-8"><a href="creating-a-composite-figure-by-subplotting.html#cb333-8" tabindex="-1"></a>    <span class="at">yend =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb333-9"><a href="creating-a-composite-figure-by-subplotting.html#cb333-9" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="together4e.png" width="2250" style="display: block; margin: auto;" /></p>
<p>You can also use third-party annotation functions to annotate the composite figure generated from <code>sm_put_together()</code>.</p>
</div>
</div>
<div id="why-use-sm_put_together-advanced" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Why use <code>sm_put_together()</code>? (Advanced)<a href="creating-a-composite-figure-by-subplotting.html#why-use-sm_put_together-advanced" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The primary reason for its existence is that the function has been designed to change the workflow of <em>ggplot2</em> for subplotting and creating a composite figure by integrating the programmatic approach, which is not commonly used among users of <em>ggplot2</em> because they otherwise risk losing flexibility for aesthetics and control.</p>
<p>A programming approach refers to a means that involves creating programming constructs, such as a for loop, if conditionals or vertorization, to minimize the length of code and improve the speed for computing to perform a complex task. Creating a composite plot with many panels, such as the example here, is a type of complex data visualization whose procedure can appear to be repetitive and cumbersome.</p>
<p>In this short example, I recreate the composite plot generated above using the function <code>lapply()</code>, which creates an iterative loop, producing one ggplot2 object per loop. There will be nine loops total, and these will be stored in the output object <code>all_figs</code>. More basic details about the function <code>lapply()</code> can be found in this <a href="https://www.smin95.com/smplot2doc"><strong>tutorial</strong></a>.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="creating-a-composite-figure-by-subplotting.html#cb334-1" tabindex="-1"></a>subj_list <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;S&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb334-2"><a href="creating-a-composite-figure-by-subplotting.html#cb334-2" tabindex="-1"></a></span>
<span id="cb334-3"><a href="creating-a-composite-figure-by-subplotting.html#cb334-3" tabindex="-1"></a>all_figs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(subj_list), <span class="cf">function</span>(i) {</span>
<span id="cb334-4"><a href="creating-a-composite-figure-by-subplotting.html#cb334-4" tabindex="-1"></a>  df_subj <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">==</span> subj_list[[i]])</span>
<span id="cb334-5"><a href="creating-a-composite-figure-by-subplotting.html#cb334-5" tabindex="-1"></a></span>
<span id="cb334-6"><a href="creating-a-composite-figure-by-subplotting.html#cb334-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df_subj, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb334-7"><a href="creating-a-composite-figure-by-subplotting.html#cb334-7" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb334-8"><a href="creating-a-composite-figure-by-subplotting.html#cb334-8" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb334-9"><a href="creating-a-composite-figure-by-subplotting.html#cb334-9" tabindex="-1"></a>    <span class="co"># lm = linear regression method</span></span>
<span id="cb334-10"><a href="creating-a-composite-figure-by-subplotting.html#cb334-10" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb334-11"><a href="creating-a-composite-figure-by-subplotting.html#cb334-11" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb334-12"><a href="creating-a-composite-figure-by-subplotting.html#cb334-12" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb334-13"><a href="creating-a-composite-figure-by-subplotting.html#cb334-13" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb334-14"><a href="creating-a-composite-figure-by-subplotting.html#cb334-14" tabindex="-1"></a>    <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb334-15"><a href="creating-a-composite-figure-by-subplotting.html#cb334-15" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb334-16"><a href="creating-a-composite-figure-by-subplotting.html#cb334-16" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb334-17"><a href="creating-a-composite-figure-by-subplotting.html#cb334-17" tabindex="-1"></a>})</span></code></pre></div>
<p>We see that <code>all_figs</code> has nine plots and that it is a list structure, which can be handled by <code>sm_put_together()</code> to generate a composite plot.</p>
<p><img src="together5.png" width="2250" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="creating-a-composite-figure-by-subplotting.html#cb335-1" tabindex="-1"></a>plots_tgd5 <span class="ot">&lt;-</span> <span class="fu">sm_put_together</span>(all_figs,</span>
<span id="cb335-2"><a href="creating-a-composite-figure-by-subplotting.html#cb335-2" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Individual data&quot;</span>,</span>
<span id="cb335-3"><a href="creating-a-composite-figure-by-subplotting.html#cb335-3" tabindex="-1"></a>  <span class="at">xlabel =</span> <span class="st">&quot;Minutes after monocular deprivation&quot;</span>,</span>
<span id="cb335-4"><a href="creating-a-composite-figure-by-subplotting.html#cb335-4" tabindex="-1"></a>  <span class="at">ylabel =</span> <span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>, <span class="at">legend =</span> legend,</span>
<span id="cb335-5"><a href="creating-a-composite-figure-by-subplotting.html#cb335-5" tabindex="-1"></a>  <span class="at">labelRatio =</span> <span class="fl">0.95</span>, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">hmargin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">wmargin =</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb335-6"><a href="creating-a-composite-figure-by-subplotting.html#cb335-6" tabindex="-1"></a>)</span></code></pre></div>
<p><code>sm_put_together()</code> can also handle nested list objects (i.e., list of list), so users can fully integrate complex programming constructs into their visualization routines to perform sophisticated data visualizations without relying on external packages.</p>
<p>To create a mosaic, where there is an empty panel in the every other panel, simply create an empty plot <code>ggplot(NULL) + sm_common_legend()</code> inside the <code>lapply()</code> construct.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="creating-a-composite-figure-by-subplotting.html#cb336-1" tabindex="-1"></a>ncol <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb336-2"><a href="creating-a-composite-figure-by-subplotting.html#cb336-2" tabindex="-1"></a>nrow <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb336-3"><a href="creating-a-composite-figure-by-subplotting.html#cb336-3" tabindex="-1"></a>numPanels <span class="ot">&lt;-</span> ncol <span class="sc">*</span> nrow</span>
<span id="cb336-4"><a href="creating-a-composite-figure-by-subplotting.html#cb336-4" tabindex="-1"></a>subj_list <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;S&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb336-5"><a href="creating-a-composite-figure-by-subplotting.html#cb336-5" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb336-6"><a href="creating-a-composite-figure-by-subplotting.html#cb336-6" tabindex="-1"></a>figs_mosaic <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>numPanels, <span class="cf">function</span>(iPlot) {</span>
<span id="cb336-7"><a href="creating-a-composite-figure-by-subplotting.html#cb336-7" tabindex="-1"></a>  <span class="cf">if</span> (iPlot <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb336-8"><a href="creating-a-composite-figure-by-subplotting.html#cb336-8" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb336-9"><a href="creating-a-composite-figure-by-subplotting.html#cb336-9" tabindex="-1"></a>      <span class="fu">sm_common_legend</span>() <span class="co"># empty panel</span></span>
<span id="cb336-10"><a href="creating-a-composite-figure-by-subplotting.html#cb336-10" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (iPlot <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb336-11"><a href="creating-a-composite-figure-by-subplotting.html#cb336-11" tabindex="-1"></a>    i <span class="ot">&lt;&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb336-12"><a href="creating-a-composite-figure-by-subplotting.html#cb336-12" tabindex="-1"></a>    df_subj <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">==</span> subj_list[[i]])</span>
<span id="cb336-13"><a href="creating-a-composite-figure-by-subplotting.html#cb336-13" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> df_subj, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb336-14"><a href="creating-a-composite-figure-by-subplotting.html#cb336-14" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb336-15"><a href="creating-a-composite-figure-by-subplotting.html#cb336-15" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb336-16"><a href="creating-a-composite-figure-by-subplotting.html#cb336-16" tabindex="-1"></a>      <span class="co"># lm = linear regression method</span></span>
<span id="cb336-17"><a href="creating-a-composite-figure-by-subplotting.html#cb336-17" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(</span>
<span id="cb336-18"><a href="creating-a-composite-figure-by-subplotting.html#cb336-18" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb336-19"><a href="creating-a-composite-figure-by-subplotting.html#cb336-19" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb336-20"><a href="creating-a-composite-figure-by-subplotting.html#cb336-20" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb336-21"><a href="creating-a-composite-figure-by-subplotting.html#cb336-21" tabindex="-1"></a>      <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb336-22"><a href="creating-a-composite-figure-by-subplotting.html#cb336-22" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb336-23"><a href="creating-a-composite-figure-by-subplotting.html#cb336-23" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb336-24"><a href="creating-a-composite-figure-by-subplotting.html#cb336-24" tabindex="-1"></a>  }</span>
<span id="cb336-25"><a href="creating-a-composite-figure-by-subplotting.html#cb336-25" tabindex="-1"></a>})</span></code></pre></div>
<p><code>sm_put_together()</code> provides a limitless possibility of creating a composite plot with expressive layouts of subplots, as shown below.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="creating-a-composite-figure-by-subplotting.html#cb337-1" tabindex="-1"></a>mosaic_tgd <span class="ot">&lt;-</span> <span class="fu">sm_put_together</span>(figs_mosaic,</span>
<span id="cb337-2"><a href="creating-a-composite-figure-by-subplotting.html#cb337-2" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Mosaic of individual data&quot;</span>,</span>
<span id="cb337-3"><a href="creating-a-composite-figure-by-subplotting.html#cb337-3" tabindex="-1"></a>  <span class="at">xlabel =</span> <span class="st">&quot;Minutes after monocular deprivation&quot;</span>,</span>
<span id="cb337-4"><a href="creating-a-composite-figure-by-subplotting.html#cb337-4" tabindex="-1"></a>  <span class="at">ylabel =</span> <span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>,</span>
<span id="cb337-5"><a href="creating-a-composite-figure-by-subplotting.html#cb337-5" tabindex="-1"></a>  <span class="at">labelRatio =</span> <span class="fl">0.95</span>, <span class="at">ncol =</span> ncol, <span class="at">nrow =</span> nrow, <span class="at">hmargin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">wmargin =</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb337-6"><a href="creating-a-composite-figure-by-subplotting.html#cb337-6" tabindex="-1"></a>)</span>
<span id="cb337-7"><a href="creating-a-composite-figure-by-subplotting.html#cb337-7" tabindex="-1"></a></span>
<span id="cb337-8"><a href="creating-a-composite-figure-by-subplotting.html#cb337-8" tabindex="-1"></a>mosaic_tgd1 <span class="ot">&lt;-</span> <span class="fu">sm_add_legend</span>(mosaic_tgd, <span class="at">x =</span> <span class="fl">0.555</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">legend =</span> legend)</span></code></pre></div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="creating-a-composite-figure-by-subplotting.html#cb338-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;mosaic.png&quot;</span>, mosaic_tgd1,</span>
<span id="cb338-2"><a href="creating-a-composite-figure-by-subplotting.html#cb338-2" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">15</span>,</span>
<span id="cb338-3"><a href="creating-a-composite-figure-by-subplotting.html#cb338-3" tabindex="-1"></a>  <span class="at">height =</span> <span class="fl">13.6</span></span>
<span id="cb338-4"><a href="creating-a-composite-figure-by-subplotting.html#cb338-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="mosaic.png" width="2250" style="display: block; margin: auto;" /></p>
<p>In this last example, we will organize the subplots using the configuration of a lower triangular matrix.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="creating-a-composite-figure-by-subplotting.html#cb339-1" tabindex="-1"></a>ncol <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb339-2"><a href="creating-a-composite-figure-by-subplotting.html#cb339-2" tabindex="-1"></a>nrow <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb339-3"><a href="creating-a-composite-figure-by-subplotting.html#cb339-3" tabindex="-1"></a>numPanels <span class="ot">&lt;-</span> ncol <span class="sc">*</span> nrow</span>
<span id="cb339-4"><a href="creating-a-composite-figure-by-subplotting.html#cb339-4" tabindex="-1"></a>subj_list <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;S&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb339-5"><a href="creating-a-composite-figure-by-subplotting.html#cb339-5" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb339-6"><a href="creating-a-composite-figure-by-subplotting.html#cb339-6" tabindex="-1"></a>low_triangle <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>numPanels, <span class="cf">function</span>(iPlot) {</span>
<span id="cb339-7"><a href="creating-a-composite-figure-by-subplotting.html#cb339-7" tabindex="-1"></a>  <span class="cf">if</span> (iPlot <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">12</span>)) {</span>
<span id="cb339-8"><a href="creating-a-composite-figure-by-subplotting.html#cb339-8" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb339-9"><a href="creating-a-composite-figure-by-subplotting.html#cb339-9" tabindex="-1"></a>      <span class="fu">sm_common_legend</span>() <span class="co"># empty panel</span></span>
<span id="cb339-10"><a href="creating-a-composite-figure-by-subplotting.html#cb339-10" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb339-11"><a href="creating-a-composite-figure-by-subplotting.html#cb339-11" tabindex="-1"></a>    i <span class="ot">&lt;&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb339-12"><a href="creating-a-composite-figure-by-subplotting.html#cb339-12" tabindex="-1"></a>    df_subj <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">==</span> subj_list[[i]])</span>
<span id="cb339-13"><a href="creating-a-composite-figure-by-subplotting.html#cb339-13" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> df_subj, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb339-14"><a href="creating-a-composite-figure-by-subplotting.html#cb339-14" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb339-15"><a href="creating-a-composite-figure-by-subplotting.html#cb339-15" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb339-16"><a href="creating-a-composite-figure-by-subplotting.html#cb339-16" tabindex="-1"></a>      <span class="co"># lm = linear regression method</span></span>
<span id="cb339-17"><a href="creating-a-composite-figure-by-subplotting.html#cb339-17" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(</span>
<span id="cb339-18"><a href="creating-a-composite-figure-by-subplotting.html#cb339-18" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time),</span>
<span id="cb339-19"><a href="creating-a-composite-figure-by-subplotting.html#cb339-19" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)</span>
<span id="cb339-20"><a href="creating-a-composite-figure-by-subplotting.html#cb339-20" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb339-21"><a href="creating-a-composite-figure-by-subplotting.html#cb339-21" tabindex="-1"></a>      <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb339-22"><a href="creating-a-composite-figure-by-subplotting.html#cb339-22" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb339-23"><a href="creating-a-composite-figure-by-subplotting.html#cb339-23" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))</span>
<span id="cb339-24"><a href="creating-a-composite-figure-by-subplotting.html#cb339-24" tabindex="-1"></a>  }</span>
<span id="cb339-25"><a href="creating-a-composite-figure-by-subplotting.html#cb339-25" tabindex="-1"></a>})</span>
<span id="cb339-26"><a href="creating-a-composite-figure-by-subplotting.html#cb339-26" tabindex="-1"></a></span>
<span id="cb339-27"><a href="creating-a-composite-figure-by-subplotting.html#cb339-27" tabindex="-1"></a><span class="co"># Combine the subplots</span></span>
<span id="cb339-28"><a href="creating-a-composite-figure-by-subplotting.html#cb339-28" tabindex="-1"></a>low_tr_tgd <span class="ot">&lt;-</span> <span class="fu">sm_put_together</span>(low_triangle,</span>
<span id="cb339-29"><a href="creating-a-composite-figure-by-subplotting.html#cb339-29" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Low triangle of individual data&quot;</span>,</span>
<span id="cb339-30"><a href="creating-a-composite-figure-by-subplotting.html#cb339-30" tabindex="-1"></a>  <span class="at">xlabel =</span> <span class="st">&quot;Minutes after monocular deprivation&quot;</span>,</span>
<span id="cb339-31"><a href="creating-a-composite-figure-by-subplotting.html#cb339-31" tabindex="-1"></a>  <span class="at">ylabel =</span> <span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>,</span>
<span id="cb339-32"><a href="creating-a-composite-figure-by-subplotting.html#cb339-32" tabindex="-1"></a>  <span class="at">labelRatio =</span> <span class="fl">0.95</span>, <span class="at">ncol =</span> ncol, <span class="at">nrow =</span> nrow, <span class="at">hmargin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">wmargin =</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb339-33"><a href="creating-a-composite-figure-by-subplotting.html#cb339-33" tabindex="-1"></a>)</span>
<span id="cb339-34"><a href="creating-a-composite-figure-by-subplotting.html#cb339-34" tabindex="-1"></a></span>
<span id="cb339-35"><a href="creating-a-composite-figure-by-subplotting.html#cb339-35" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb339-36"><a href="creating-a-composite-figure-by-subplotting.html#cb339-36" tabindex="-1"></a>low_tr_tgd1 <span class="ot">&lt;-</span> <span class="fu">sm_add_legend</span>(low_tr_tgd, <span class="at">x =</span> <span class="fl">0.89</span>, <span class="at">y =</span> <span class="fl">0.35</span>, <span class="at">legend =</span> legend)</span>
<span id="cb339-37"><a href="creating-a-composite-figure-by-subplotting.html#cb339-37" tabindex="-1"></a></span>
<span id="cb339-38"><a href="creating-a-composite-figure-by-subplotting.html#cb339-38" tabindex="-1"></a><span class="co"># Add annotation</span></span>
<span id="cb339-39"><a href="creating-a-composite-figure-by-subplotting.html#cb339-39" tabindex="-1"></a>low_tr_tgd2 <span class="ot">&lt;-</span> low_tr_tgd1 <span class="sc">+</span> <span class="fu">sm_add_text</span>(<span class="st">&quot;Programmatic approach&quot;</span>,</span>
<span id="cb339-40"><a href="creating-a-composite-figure-by-subplotting.html#cb339-40" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.65</span>,</span>
<span id="cb339-41"><a href="creating-a-composite-figure-by-subplotting.html#cb339-41" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">48</span>, <span class="at">angle =</span> <span class="dv">315</span>,</span>
<span id="cb339-42"><a href="creating-a-composite-figure-by-subplotting.html#cb339-42" tabindex="-1"></a>  <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb339-43"><a href="creating-a-composite-figure-by-subplotting.html#cb339-43" tabindex="-1"></a>)</span>
<span id="cb339-44"><a href="creating-a-composite-figure-by-subplotting.html#cb339-44" tabindex="-1"></a></span>
<span id="cb339-45"><a href="creating-a-composite-figure-by-subplotting.html#cb339-45" tabindex="-1"></a><span class="co"># Save figure</span></span>
<span id="cb339-46"><a href="creating-a-composite-figure-by-subplotting.html#cb339-46" tabindex="-1"></a></span>
<span id="cb339-47"><a href="creating-a-composite-figure-by-subplotting.html#cb339-47" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;low_tr.png&quot;</span>, low_tr_tgd2,</span>
<span id="cb339-48"><a href="creating-a-composite-figure-by-subplotting.html#cb339-48" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">12</span>,</span>
<span id="cb339-49"><a href="creating-a-composite-figure-by-subplotting.html#cb339-49" tabindex="-1"></a>  <span class="at">height =</span> <span class="fl">13.6</span></span>
<span id="cb339-50"><a href="creating-a-composite-figure-by-subplotting.html#cb339-50" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="low_tr.png" width="85%" style="display: block; margin: auto;" /></p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="raincloud-and-forest-plots.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="calculating-area-under-a-curve.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/CommonAxis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/CommonAxis.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
