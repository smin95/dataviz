<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Factor Analysis and CSF | Data Analysis and Visualization in R Using smplot2</title>
  <meta name="description" content="Chapter 16 Factor Analysis and CSF | Data Analysis and Visualization in R Using smplot2" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Factor Analysis and CSF | Data Analysis and Visualization in R Using smplot2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Factor Analysis and CSF | Data Analysis and Visualization in R Using smplot2" />
  
  
  

<meta name="author" content="Seung Hyun Min" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="understanding-the-contrast-sensitivity-function.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation-of-smplot2"><i class="fa fa-check"></i>Installation of smplot2</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="opening-remarks.html"><a href="opening-remarks.html"><i class="fa fa-check"></i><b>1</b> Opening Remarks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="opening-remarks.html"><a href="opening-remarks.html#how-to-read-this-book"><i class="fa fa-check"></i><b>1.1</b> How to read this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>2</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="2.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>2.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>2.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Visualization with smplot2</b></span></li>
<li class="chapter" data-level="3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>3</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>3.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i><b>3.1.1</b> Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i><b>3.2.1</b> Let’s make some graphs</a></li>
<li class="chapter" data-level="3.2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i><b>3.2.2</b> How ggplot works</a></li>
<li class="chapter" data-level="3.2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i><b>3.2.3</b> Different color of points for each unique group</a></li>
<li class="chapter" data-level="3.2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i><b>3.2.4</b> Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="3.2.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i><b>3.2.5</b> Same shape across all groups</a></li>
<li class="chapter" data-level="3.2.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i><b>3.2.6</b> How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="3.2.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i><b>3.2.7</b> geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="3.2.8" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i><b>3.2.8</b> Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot2"><i class="fa fa-check"></i><b>3.3</b> Improve data visualization using smplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i><b>3.3.1</b> Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i><b>3.3.2</b> Reporting statistics from a paired correlation</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#changing-the-text"><i class="fa fa-check"></i><b>3.3.3</b> Changing the text</a></li>
<li class="chapter" data-level="3.3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#plotting-the-average-with-standard-errors"><i class="fa fa-check"></i><b>3.3.4</b> Plotting the average with standard errors</a></li>
<li class="chapter" data-level="3.3.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><i class="fa fa-check"></i><b>3.3.5</b> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i><b>3.3.6</b> Different color for each group but with other colors</a></li>
<li class="chapter" data-level="3.3.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1."><i class="fa fa-check"></i><b>3.3.7</b> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>4</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>4.1</b> Upload sample data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i><b>4.1.1</b> Download requirements</a></li>
<li class="chapter" data-level="4.1.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i><b>4.1.2</b> Before we get started</a></li>
<li class="chapter" data-level="4.1.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i><b>4.1.3</b> data.csv</a></li>
<li class="chapter" data-level="4.1.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><i class="fa fa-check"></i><b>4.1.4</b> <code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i><b>4.1.5</b> Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>4.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i><b>4.2.1</b> What is a boxplot?</a></li>
<li class="chapter" data-level="4.2.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i><b>4.2.2</b> Boxplot vs bar graph</a></li>
<li class="chapter" data-level="4.2.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.3</b> Boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i><b>4.2.4</b> Problem: Alphabetical order</a></li>
<li class="chapter" data-level="4.2.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i><b>4.2.5</b> Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="4.2.6" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i><b>4.2.6</b> Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="4.2.7" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.7</b> Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.8" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i><b>4.2.8</b> A boxplot with individual data</a></li>
<li class="chapter" data-level="4.2.9" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><i class="fa fa-check"></i><b>4.2.9</b> <code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="4.2.10" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i><b>4.2.10</b> Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>4.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i><b>4.3.1</b> Structure of the violin plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>4.3.2</b> Violin plot with ggplot2</a></li>
<li class="chapter" data-level="4.3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i><b>4.3.3</b> Violin plot with individual points</a></li>
<li class="chapter" data-level="4.3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i><b>4.3.4</b> geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="4.3.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i><b>4.3.5</b> Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html"><i class="fa fa-check"></i><b>5</b> Bar Graph, Slope Chart and Point plot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph"><i class="fa fa-check"></i><b>5.1</b> Bar graph</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#scaling-the-y-axis"><i class="fa fa-check"></i><b>5.1.1</b> Scaling the y-axis</a></li>
<li class="chapter" data-level="5.1.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>5.1.2</b> Plotting individual points with unique colors</a></li>
<li class="chapter" data-level="5.1.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#other-parameters"><i class="fa fa-check"></i><b>5.1.3</b> Other parameters</a></li>
<li class="chapter" data-level="5.1.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph-with-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.1.4</b> Bar graph with data of multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart"><i class="fa fa-check"></i><b>5.2</b> Slope chart</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot"><i class="fa fa-check"></i><b>5.2.1</b> Slope chart with mean plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot-and-error-bar"><i class="fa fa-check"></i><b>5.2.2</b> Slope chart with mean plot and error bar</a></li>
<li class="chapter" data-level="5.2.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-x-levels"><i class="fa fa-check"></i><b>5.2.3</b> Slope chart with multiple x levels</a></li>
<li class="chapter" data-level="5.2.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-groups-and-x-levels"><i class="fa fa-check"></i><b>5.2.4</b> Slope chart with multiple groups and x levels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot"><i class="fa fa-check"></i><b>5.3</b> Point plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#change-the-range-of-y-axis"><i class="fa fa-check"></i><b>5.3.1</b> Change the range of y-axis</a></li>
<li class="chapter" data-level="5.3.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#data-with-more-than-two-groups"><i class="fa fa-check"></i><b>5.3.2</b> Data with more than two groups</a></li>
<li class="chapter" data-level="5.3.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-one-group"><i class="fa fa-check"></i><b>5.3.3</b> Point plot with a shadow using data of one group</a></li>
<li class="chapter" data-level="5.3.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.3.4</b> Point plot with a shadow using data of multiple groups</a></li>
<li class="chapter" data-level="5.3.5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#adding-and-modifying-legends"><i class="fa fa-check"></i><b>5.3.5</b> Adding and modifying legends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html"><i class="fa fa-check"></i><b>6</b> Raincloud and Forest Plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot"><i class="fa fa-check"></i><b>6.1</b> Raincloud plot</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changing-the-x-axis-labels"><i class="fa fa-check"></i><b>6.1.1</b> Changing the x-axis labels</a></li>
<li class="chapter" data-level="6.1.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#separating-the-components-and-configuration"><i class="fa fa-check"></i><b>6.1.2</b> Separating the components and configuration</a></li>
<li class="chapter" data-level="6.1.3" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changng-the-theme-and-orientation"><i class="fa fa-check"></i><b>6.1.3</b> Changng the theme and orientation</a></li>
<li class="chapter" data-level="6.1.4" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot-with-data-from-multiple-groups"><i class="fa fa-check"></i><b>6.1.4</b> Raincloud plot with data from multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#forest-plot"><i class="fa fa-check"></i><b>6.2</b> Forest plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#plotting-the-forest-plot-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>6.2.1</b> Plotting the forest plot using data of multiple groups</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Analysis with smplot2</b></span></li>
<li class="chapter" data-level="7" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html"><i class="fa fa-check"></i><b>7</b> Combining Plots with Common Axes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>7.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-for-rows"><i class="fa fa-check"></i><b>7.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="7.1.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#select-for-columns"><i class="fa fa-check"></i><b>7.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="7.1.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>7.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-the-averaged-data-with-error-bars"><i class="fa fa-check"></i><b>7.2</b> Plotting the averaged data with error bars</a></li>
<li class="chapter" data-level="7.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-individual-data"><i class="fa fa-check"></i><b>7.3</b> Plotting individual data</a></li>
<li class="chapter" data-level="7.4" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#putting-multiple-plots-together"><i class="fa fa-check"></i><b>7.4</b> Putting multiple plots together</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html"><i class="fa fa-check"></i><b>8</b> Calculating Area under a Curve</a>
<ul>
<li class="chapter" data-level="8.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#pipe"><i class="fa fa-check"></i><b>8.1</b> Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="8.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#area-under-a-curve"><i class="fa fa-check"></i><b>8.2</b> Area under a curve</a></li>
<li class="chapter" data-level="8.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#reproducing-figures-in-the-paper-min-et-al.-2019"><i class="fa fa-check"></i><b>8.3</b> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3b-a-best-fit-line-with-points-and-error-bars"><i class="fa fa-check"></i><b>8.3.1</b> Figure 3B (a best-fit line with points and error bars)</a></li>
<li class="chapter" data-level="8.3.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3d-a-bar-graph"><i class="fa fa-check"></i><b>8.3.2</b> Figure 3D (a bar graph)</a></li>
<li class="chapter" data-level="8.3.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3e-modeling-in-matlab-and-plotting-in-r"><i class="fa fa-check"></i><b>8.3.3</b> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html"><i class="fa fa-check"></i><b>9</b> Calculating Linear Slopes</a>
<ul>
<li class="chapter" data-level="9.1" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#linear-relationship-using-lm"><i class="fa fa-check"></i><b>9.1</b> Linear relationship using <code>lm()</code></a></li>
<li class="chapter" data-level="9.2" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#calculating-slopes-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>9.2</b> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>10</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-statistics.html"><a href="basic-statistics.html#one-sample-t-test"><i class="fa fa-check"></i><b>10.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="10.2" data-path="basic-statistics.html"><a href="basic-statistics.html#two-sample-t-test"><i class="fa fa-check"></i><b>10.2</b> Two-sample t-test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#shapiro-wilk-test-to-test-for-normality-of-data"><i class="fa fa-check"></i><b>10.2.1</b> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basic-statistics.html"><a href="basic-statistics.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>10.3</b> Wilcoxon Signed-rank Test</a></li>
<li class="chapter" data-level="10.4" data-path="basic-statistics.html"><a href="basic-statistics.html#effect-size"><i class="fa fa-check"></i><b>10.4</b> Effect Size</a></li>
<li class="chapter" data-level="10.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.5</b> Post-hoc Power Analysis</a></li>
<li class="chapter" data-level="10.6" data-path="basic-statistics.html"><a href="basic-statistics.html#bayes-factor"><i class="fa fa-check"></i><b>10.6</b> Bayes Factor</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#issues-with-post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.6.1</b> Issues with post-hoc power analysis</a></li>
<li class="chapter" data-level="10.6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-the-bayes-factor-in-r"><i class="fa fa-check"></i><b>10.6.2</b> Computing the Bayes factor in R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>10.7</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="basic-statistics.html"><a href="basic-statistics.html#check-for-outliers"><i class="fa fa-check"></i><b>10.7.1</b> Check for Outliers</a></li>
<li class="chapter" data-level="10.7.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data"><i class="fa fa-check"></i><b>10.7.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.7.3" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-the-assumption-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>10.7.3</b> Checking the Assumption for Homogeneity of Variance</a></li>
<li class="chapter" data-level="10.7.4" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-one-way-anova"><i class="fa fa-check"></i><b>10.7.4</b> Computing One-way ANOVA</a></li>
<li class="chapter" data-level="10.7.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-tests"><i class="fa fa-check"></i><b>10.7.5</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="10.7.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>10.7.6</b> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="basic-statistics.html"><a href="basic-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>10.8</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="basic-statistics.html"><a href="basic-statistics.html#identifying-outliers"><i class="fa fa-check"></i><b>10.8.1</b> Identifying Outliers</a></li>
<li class="chapter" data-level="10.8.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data-1"><i class="fa fa-check"></i><b>10.8.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.8.3" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-two-way-anova"><i class="fa fa-check"></i><b>10.8.3</b> Computing Two-way ANOVA</a></li>
<li class="chapter" data-level="10.8.4" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-test"><i class="fa fa-check"></i><b>10.8.4</b> Post-hoc Test</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="basic-statistics.html"><a href="basic-statistics.html#friedman-test"><i class="fa fa-check"></i><b>10.9</b> Friedman Test</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="basic-statistics.html"><a href="basic-statistics.html#performing-friedman-test"><i class="fa fa-check"></i><b>10.9.1</b> Performing Friedman Test</a></li>
<li class="chapter" data-level="10.9.2" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-analysis"><i class="fa fa-check"></i><b>10.9.2</b> Post-hoc Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-resources"><i class="fa fa-check"></i><b>10.10</b> Extra Resources</a></li>
</ul></li>
<li class="part"><span><b>III Manual for smplot2</b></span></li>
<li class="chapter" data-level="11" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><i class="fa fa-check"></i><b>11</b> Themes, Colors, Correlations, Boxplots, Violins and Bars (Part 1)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#installation-of-the-package"><i class="fa fa-check"></i><b>11.1</b> Installation of the Package</a></li>
<li class="chapter" data-level="11.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#how-...-and-xxx.params-arguments-work"><i class="fa fa-check"></i><b>11.2</b> How <code>...</code> and <code>xxx.params</code> arguments work</a></li>
<li class="chapter" data-level="11.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#color-palette"><i class="fa fa-check"></i><b>11.3</b> Color palette</a></li>
<li class="chapter" data-level="11.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#graph-themes"><i class="fa fa-check"></i><b>11.4</b> Graph themes</a></li>
<li class="chapter" data-level="11.5" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot"><i class="fa fa-check"></i><b>11.5</b> Correlation plot</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_statcorr"><i class="fa fa-check"></i><b>11.5.1</b> <code>sm_statCorr()</code></a></li>
<li class="chapter" data-level="11.5.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_corr_avgerr"><i class="fa fa-check"></i><b>11.5.2</b> <code>sm_corr_avgErr()</code></a></li>
<li class="chapter" data-level="11.5.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#structure-of-data-frame"><i class="fa fa-check"></i><b>11.5.3</b> Structure of data frame</a></li>
<li class="chapter" data-level="11.5.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>11.5.4</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>11.6</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>11.6.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>11.7</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>11.7.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>11.8</b> Bar plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-3"><i class="fa fa-check"></i><b>11.8.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><i class="fa fa-check"></i><b>12</b> Slope Charts, Point plots, Bland-Altman, Forests, Rainclouds, Histograms (Part 2)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#slope-chart---sm_slope"><i class="fa fa-check"></i><b>12.1</b> Slope chart - <code>sm_slope()</code></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#drawing-the-mean-plot"><i class="fa fa-check"></i><b>12.1.1</b> Drawing the mean plot</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#point-plot---sm_pointplot"><i class="fa fa-check"></i><b>12.2</b> Point plot - <code>sm_pointplot()</code></a></li>
<li class="chapter" data-level="12.3" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>12.3</b> A Bland Altman plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="12.4" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#forest-plot---sm_forest"><i class="fa fa-check"></i><b>12.4</b> Forest plot - <code>sm_forest()</code></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#annotation-using-sm_forest_annot"><i class="fa fa-check"></i><b>12.4.1</b> Annotation using <code>sm_forest_annot()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>12.5</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="12.6" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#histogram---sm_hist"><i class="fa fa-check"></i><b>12.6</b> Histogram - <code>sm_hist()</code></a></li>
</ul></li>
<li class="part"><span><b>IV Contrast Sensitivity Function</b></span></li>
<li class="chapter" data-level="13" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>13</b> Plotting the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="13.1" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#brief-introduction"><i class="fa fa-check"></i><b>13.1</b> Brief Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#data-visualization"><i class="fa fa-check"></i><b>13.2</b> Data Visualization</a></li>
<li class="chapter" data-level="13.3" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#facetting-the-contrast-sensitivity-functions"><i class="fa fa-check"></i><b>13.3</b> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html"><i class="fa fa-check"></i><b>14</b> Area under Curve, AULCSF and R2 of the CSF</a>
<ul>
<li class="chapter" data-level="14.1" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#area-under-a-curve-1"><i class="fa fa-check"></i><b>14.1</b> Area under a Curve</a></li>
<li class="chapter" data-level="14.2" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#sm_trapz-sm_aulcsf-and-sm_r2"><i class="fa fa-check"></i><b>14.2</b> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
<li class="chapter" data-level="14.3" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#calculating-area-and-r2-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>14.3</b> Calculating area and R2 of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="14.4" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#case-study"><i class="fa fa-check"></i><b>14.4</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>15</b> Understanding the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="15.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#contrast-sensitivity-function-model"><i class="fa fa-check"></i><b>15.1</b> Contrast Sensitivity Function Model</a></li>
<li class="chapter" data-level="15.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_csf"><i class="fa fa-check"></i><b>15.2</b> Understanding <code>sm_CSF()</code></a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_params"><i class="fa fa-check"></i><b>15.2.1</b> <code>sm_params()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_cutoff"><i class="fa fa-check"></i><b>15.2.2</b> <code>sm_cutOff()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_ribboncsf"><i class="fa fa-check"></i><b>15.3</b> Understanding <code>sm_ribbonCSF()</code></a></li>
<li class="chapter" data-level="15.4" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#calculating-the-five-parameters-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>15.4</b> Calculating the five parameters of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="15.5" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#visualization-of-the-parameters"><i class="fa fa-check"></i><b>15.5</b> Visualization of the parameters</a></li>
<li class="chapter" data-level="15.6" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#case-study-1"><i class="fa fa-check"></i><b>15.6</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html"><i class="fa fa-check"></i><b>16</b> Factor Analysis and CSF</a>
<ul>
<li class="chapter" data-level="16.1" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#eigenvalues"><i class="fa fa-check"></i><b>16.1</b> Eigenvalues</a></li>
<li class="chapter" data-level="16.2" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#parallel-analysis"><i class="fa fa-check"></i><b>16.2</b> Parallel analysis</a></li>
<li class="chapter" data-level="16.3" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#non-parametric-bootstrapping"><i class="fa fa-check"></i><b>16.3</b> Non-parametric bootstrapping</a></li>
<li class="chapter" data-level="16.4" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#factor-analysis"><i class="fa fa-check"></i><b>16.4</b> Factor Analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factor-analysis-and-csf" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> Factor Analysis and CSF<a href="factor-analysis-and-csf.html#factor-analysis-and-csf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="factor-analysis-and-csf.html#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb811-2"><a href="factor-analysis-and-csf.html#cb811-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb811-3"><a href="factor-analysis-and-csf.html#cb811-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb811-4"><a href="factor-analysis-and-csf.html#cb811-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smCSF)</span>
<span id="cb811-5"><a href="factor-analysis-and-csf.html#cb811-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code></pre></div>
<p>In this chapter, we will use a public dataset of achromatic contrast sensitivity from 51 normally sighted observers.</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="factor-analysis-and-csf.html#cb812-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh.csv&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb812-2"><a href="factor-analysis-and-csf.html#cb812-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Subject, SpatialFreq) <span class="sc">%&gt;%</span> </span>
<span id="cb812-3"><a href="factor-analysis-and-csf.html#cb812-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sensitivity =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb812-4"><a href="factor-analysis-and-csf.html#cb812-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Repetition =</span> <span class="st">&#39;avg&#39;</span>)</span></code></pre></div>
<p>Factor analysis is a technique to identify latent factors that produce local patterns/correlations in a high-dimensional dataset. In other words, it aims to reduce the number of dimensions in the data.</p>
<p>In this dataset, there are 12 unique spatial frequencies. The sensitivity data were collected at these spatial frequencies to produce the contrast sensitivity function, which has a peak and has an asymmetrical shape. There are 12 dimensions total.</p>
<p>Can the curve be summarised using less than 12 dimensions? This is the purpose of factor analysis.</p>
<p>One way to extract an adequate number of factors/dimensions is to draw a scree plot.</p>
<div id="eigenvalues" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Eigenvalues<a href="factor-analysis-and-csf.html#eigenvalues" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The scree plot has a y-axis of the <strong>eigenvalue</strong>, which refers the amount of variance of the data from the factor of interest. Essentially, the higher the eigenvalue, the more important the factor is in the dataset.</p>
<p>Some methods for factor analysis determine the number of factors in a potential factor model based on eigenvalues. The Guttman Rule (i.e. K1) extracts all factors with eigenvalues larger than 1.</p>
<p>Another method that relies on eigenvalues to determine the number of factors is parallel analysis.</p>
</div>
<div id="parallel-analysis" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Parallel analysis<a href="factor-analysis-and-csf.html#parallel-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Parallel analysis by Horn is a statistical method to determine the number of factors in an exploratory factor model. It uses Monte Carlo simulation to generate a dataset of random numbers. This random dataset has the same size of the real dataset. Eigenvalues are obtained from the random dataset.</p>
<p>We will use <code>psych</code> package’s function <code>fa.parallel</code> to perform parallel analysis.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="factor-analysis-and-csf.html#cb813-1" aria-hidden="true" tabindex="-1"></a>df_mat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh_mat.csv&#39;</span>) <span class="co"># ACh data in matrix form</span></span>
<span id="cb813-2"><a href="factor-analysis-and-csf.html#cb813-2" aria-hidden="true" tabindex="-1"></a>df_mat1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df_mat[,<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<p>After we have extracted the data that are in matrix form (not data frame), which is required to properly use functions of the <code>psych</code> package, we can then perform parallel analysis.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="factor-analysis-and-csf.html#cb814-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(df_mat1, <span class="at">fa =</span><span class="st">&#39;fa&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-604-1.png" width="403.2" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  2  and the number of components =  NA</code></pre>
<p>Based on the parallel analysis, we see that there are two factors with eigenvalues larger than those from the random data. Therefore, it supports a two-factor model.</p>
</div>
<div id="non-parametric-bootstrapping" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Non-parametric bootstrapping<a href="factor-analysis-and-csf.html#non-parametric-bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Guttman rule can suggest different numbers of factors depending on the sample. For example, in one dataset, factor A can have an eigenvalue larger than 1 but in another dataset from another population factor B can have an eigenvalue lower than 1. Therefore the number of factors that is extracted can vary depending on the local sample. This creates variability in results. This issue can also be observed in parallel analysis.</p>
<p>Therefore, it might be better to include a range of uncertainty of eigenvalues so that one can better be informed about the possible range of eigenvalues in a population. This can be done by plotting 95% confidence interval of eigenvalues.</p>
<p>In this section, we will perform non-parametric bootstrapping to compute the confidence intervals of the eigenvalues. However, it turns out, if we resample the contrast sensitivity data directly, it removes the local correlation and therefore the influence of latent factors on the dataset, thereby erasing covariance from its existence.</p>
<p>Here is the original data set’s covariance of achromatic sensitivity.</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="factor-analysis-and-csf.html#cb816-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(df_mat1)</span></code></pre></div>
<pre><code>##           0.25ACh   0.35ACh   0.48ACh   0.68ACh   0.94ACh   1.31ACh  1.83ACh
## 0.25ACh 22.553853 23.429188 24.498759 26.144819 27.119722 25.625359 21.60603
## 0.35ACh 23.429188 28.352093 33.069624 35.968829 36.247616 32.082207 24.74990
## 0.48ACh 24.498759 33.069624 43.379601 49.569655 50.700145 44.517286 33.59999
## 0.68ACh 26.144819 35.968829 49.569655 60.799455 65.982921 61.091867 49.19744
## 0.94ACh 27.119722 36.247616 50.700145 65.982921 76.568315 75.668977 65.44809
## 1.31ACh 25.625359 32.082207 44.517286 61.091867 75.668977 80.867183 76.21127
## 1.83ACh 21.606032 24.749903 33.599993 49.197444 65.448091 76.211272 78.52685
## 2.54ACh 16.122200 16.586739 21.887087 34.913235 50.230931 63.817194 71.38985
## 3.54ACh 10.666987  9.723740 12.519950 22.282367 34.652600 47.611582 57.03988
## 4.93ACh  6.315921  5.102076  6.577193 13.174275 21.766266 31.660552 39.90512
## 6.87ACh  3.399220  2.468148  3.327873  7.293607 12.380894 18.588982 24.32394
## 9.57ACh  1.687677  1.094862  1.576529  3.604515  6.087617  9.344805 12.76669
##          2.54ACh  3.54ACh   4.93ACh   6.87ACh   9.57ACh
## 0.25ACh 16.12220 10.66699  6.315921  3.399220  1.687677
## 0.35ACh 16.58674  9.72374  5.102076  2.468148  1.094862
## 0.48ACh 21.88709 12.51995  6.577193  3.327873  1.576529
## 0.68ACh 34.91323 22.28237 13.174275  7.293607  3.604515
## 0.94ACh 50.23093 34.65260 21.766266 12.380894  6.087617
## 1.31ACh 63.81719 47.61158 31.660552 18.588982  9.344805
## 1.83ACh 71.38985 57.03988 39.905123 24.323943 12.766688
## 2.54ACh 69.65836 59.06055 43.467590 27.852288 15.605554
## 3.54ACh 59.06055 52.88406 41.115079 28.023283 16.971267
## 4.93ACh 43.46759 41.11508 34.012289 24.895661 16.353468
## 6.87ACh 27.85229 28.02328 24.895661 19.676502 13.963902
## 9.57ACh 15.60555 16.97127 16.353468 13.963902 10.614072</code></pre>
<p>Covariance is high. If the dataset’s covariance is high, then it is suitable for factor analysis, as demonstrated by Kaiser, Meyer and Olkin test.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="factor-analysis-and-csf.html#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(df_mat1)</span></code></pre></div>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = df_mat1)
## Overall MSA =  0.58
## MSA for each item = 
## 0.25ACh 0.35ACh 0.48ACh 0.68ACh 0.94ACh 1.31ACh 1.83ACh 2.54ACh 3.54ACh 4.93ACh 
##    0.64    0.62    0.66    0.68    0.65    0.77    0.61    0.54    0.50    0.49 
## 6.87ACh 9.57ACh 
##    0.47    0.43</code></pre>
<p>The test reveals that covariance is adequately high (test score &gt; 0.5) at most spatial frequencies, suggesting that factor analysis is suitable.</p>
<p>Now I demonstrate what happens to covariance after resampling with replacement.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="factor-analysis-and-csf.html#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb820-2"><a href="factor-analysis-and-csf.html#cb820-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-3"><a href="factor-analysis-and-csf.html#cb820-3" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">&lt;-</span> <span class="dv">51</span></span>
<span id="cb820-4"><a href="factor-analysis-and-csf.html#cb820-4" aria-hidden="true" tabindex="-1"></a>nSF <span class="ot">&lt;-</span> <span class="fu">ncol</span>(df_mat1) <span class="co"># 12 SFs total</span></span>
<span id="cb820-5"><a href="factor-analysis-and-csf.html#cb820-5" aria-hidden="true" tabindex="-1"></a>resampled_ACh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>,<span class="at">nrow=</span>nObs,<span class="at">ncol=</span>nSF)</span>
<span id="cb820-6"><a href="factor-analysis-and-csf.html#cb820-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-7"><a href="factor-analysis-and-csf.html#cb820-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iSF <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSF) {</span>
<span id="cb820-8"><a href="factor-analysis-and-csf.html#cb820-8" aria-hidden="true" tabindex="-1"></a>  resampled_ACh[,iSF] <span class="ot">&lt;-</span> <span class="fu">sample</span>(df_mat1[,iSF],nObs, <span class="at">replace =</span> T)</span>
<span id="cb820-9"><a href="factor-analysis-and-csf.html#cb820-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is the re-sampled data set. We can also plot the re-sampled data against the experimental data using base <code>R</code> (not <code>ggplot2</code>) since we are using matrices to store data. Plotting in base <code>R</code> can be more tedious but it can be quite fun as you can control every aspect of the plot.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="factor-analysis-and-csf.html#cb821-1" aria-hidden="true" tabindex="-1"></a>avgs_expt <span class="ot">&lt;-</span> avgs_resampled <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&#39;double&#39;</span>,nSF)</span>
<span id="cb821-2"><a href="factor-analysis-and-csf.html#cb821-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-3"><a href="factor-analysis-and-csf.html#cb821-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iSF <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSF) {</span>
<span id="cb821-4"><a href="factor-analysis-and-csf.html#cb821-4" aria-hidden="true" tabindex="-1"></a>  avgs_resampled[[iSF]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(resampled_ACh[,iSF])</span>
<span id="cb821-5"><a href="factor-analysis-and-csf.html#cb821-5" aria-hidden="true" tabindex="-1"></a>  avgs_expt[[iSF]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_mat1[,iSF])</span>
<span id="cb821-6"><a href="factor-analysis-and-csf.html#cb821-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb821-7"><a href="factor-analysis-and-csf.html#cb821-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-8"><a href="factor-analysis-and-csf.html#cb821-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="fl">4.1</span>,<span class="fl">1.2</span>,<span class="fl">1.2</span>))</span>
<span id="cb821-9"><a href="factor-analysis-and-csf.html#cb821-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-10"><a href="factor-analysis-and-csf.html#cb821-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">unique</span>(df<span class="sc">$</span>SpatialFreq),<span class="fu">log</span>(avgs_resampled), <span class="at">log=</span><span class="st">&#39;x&#39;</span>,</span>
<span id="cb821-11"><a href="factor-analysis-and-csf.html#cb821-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fu">max</span>(<span class="fu">log</span>(<span class="fu">c</span>(avgs_resampled,avgs_expt)))<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb821-12"><a href="factor-analysis-and-csf.html#cb821-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&#39;Spatial frequency&#39;</span>,</span>
<span id="cb821-13"><a href="factor-analysis-and-csf.html#cb821-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&#39;Contrast sensitivity&#39;</span>, <span class="at">col=</span><span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb821-14"><a href="factor-analysis-and-csf.html#cb821-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">15</span>, <span class="at">cex=</span><span class="fl">1.4</span>)</span>
<span id="cb821-15"><a href="factor-analysis-and-csf.html#cb821-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-16"><a href="factor-analysis-and-csf.html#cb821-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">unique</span>(df<span class="sc">$</span>SpatialFreq),<span class="fu">log</span>(avgs_resampled), </span>
<span id="cb821-17"><a href="factor-analysis-and-csf.html#cb821-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb821-18"><a href="factor-analysis-and-csf.html#cb821-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-19"><a href="factor-analysis-and-csf.html#cb821-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">unique</span>(df<span class="sc">$</span>SpatialFreq)<span class="sc">+</span><span class="fu">unique</span>(df<span class="sc">$</span>SpatialFreq)<span class="sc">*</span><span class="fl">0.1</span>, </span>
<span id="cb821-20"><a href="factor-analysis-and-csf.html#cb821-20" aria-hidden="true" tabindex="-1"></a>       <span class="fu">log</span>(avgs_expt), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>), <span class="at">cex=</span><span class="fl">1.4</span>)</span>
<span id="cb821-21"><a href="factor-analysis-and-csf.html#cb821-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-22"><a href="factor-analysis-and-csf.html#cb821-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">unique</span>(df<span class="sc">$</span>SpatialFreq)<span class="sc">+</span><span class="fu">unique</span>(df<span class="sc">$</span>SpatialFreq)<span class="sc">*</span><span class="fl">0.1</span>,</span>
<span id="cb821-23"><a href="factor-analysis-and-csf.html#cb821-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log</span>(avgs_expt), <span class="at">col=</span><span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>), <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb821-24"><a href="factor-analysis-and-csf.html#cb821-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-25"><a href="factor-analysis-and-csf.html#cb821-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.3</span>,<span class="fl">1.5</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;Resampled data&#39;</span>,<span class="st">&#39;Real data&#39;</span>),</span>
<span id="cb821-26"><a href="factor-analysis-and-csf.html#cb821-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>), <span class="at">pch=</span><span class="dv">15</span><span class="sc">:</span><span class="dv">16</span>,<span class="at">pt.cex=</span><span class="fl">1.8</span>,</span>
<span id="cb821-27"><a href="factor-analysis-and-csf.html#cb821-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-608-1.png" width="345.6" /></p>
<p>The two data sets look very similar but only one of them (expt data) can be used for factor analysis. Therefore, we can notice that factor analysis captures the <em>invisible</em> pattern of the data.</p>
<p>The covariance of the resampled data is shown below.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="factor-analysis-and-csf.html#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(resampled_ACh)</span></code></pre></div>
<pre><code>##             [,1]      [,2]         [,3]      [,4]       [,5]       [,6]
##  [1,] 21.4627680  5.494515 10.221965102  2.729971 -8.5757210  7.4823660
##  [2,]  5.4945145 22.568920  4.826946260 -5.207635 -3.0187011  2.6928204
##  [3,] 10.2219651  4.826946 25.536795106  4.487807  4.5788106  0.9115256
##  [4,]  2.7299707 -5.207635  4.487807344 64.213237 -6.6327835 -4.6702260
##  [5,] -8.5757210 -3.018701  4.578810639 -6.632783 70.0085470 -0.9150367
##  [6,]  7.4823660  2.692820  0.911525567 -4.670226 -0.9150367 76.9832954
##  [7,] -2.6890863 -1.019733  1.061256799  6.332680 -7.8498872  1.1816949
##  [8,] -4.4720287  2.642418 -0.625930137 -1.147609 -0.6128172 15.0063584
##  [9,] -2.1897953 -3.724741  2.939968833 -6.660292 -0.1807790 -8.3721325
## [10,]  1.8767583 -0.745601 -0.429574950 -5.335867  3.9479842  1.3837711
## [11,] -2.6829180 -2.175812 -0.008150298  2.882779  2.7068057 -0.1694499
## [12,]  0.7907782  3.129077  2.218694747  5.489131  3.3182865 -4.0557000
##             [,7]       [,8]       [,9]      [,10]        [,11]      [,12]
##  [1,] -2.6890863 -4.4720287 -2.1897953  1.8767583 -2.682918028  0.7907782
##  [2,] -1.0197334  2.6424185 -3.7247411 -0.7456010 -2.175812094  3.1290769
##  [3,]  1.0612568 -0.6259301  2.9399688 -0.4295749 -0.008150298  2.2186947
##  [4,]  6.3326798 -1.1476088 -6.6602917 -5.3358669  2.882779438  5.4891305
##  [5,] -7.8498872 -0.6128172 -0.1807790  3.9479842  2.706805733  3.3182865
##  [6,]  1.1816949 15.0063584 -8.3721325  1.3837711 -0.169449871 -4.0557000
##  [7,] 54.0277401 -4.2848924  3.0920237 -0.4751554 -0.748155767 -2.4362892
##  [8,] -4.2848924 58.1828473  5.0594523  0.9514982  1.830535708  2.3200300
##  [9,]  3.0920237  5.0594523 45.7463808  7.9552430 -2.847712952 -0.8958255
## [10,] -0.4751554  0.9514982  7.9552430 31.6710052 -0.171881025 -4.3512357
## [11,] -0.7481558  1.8305357 -2.8477130 -0.1718810  9.950180547 -0.8796060
## [12,] -2.4362892  2.3200300 -0.8958255 -4.3512357 -0.879605958  9.2390137</code></pre>
<p>We now see that the resampled dataset has a much lower covariance in general. Since covariance is too low, it is not suitable to perform factor analysis.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="factor-analysis-and-csf.html#cb824-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(resampled_ACh)</span></code></pre></div>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = resampled_ACh)
## Overall MSA =  0.41
## MSA for each item = 
##  [1] 0.43 0.51 0.42 0.41 0.28 0.37 0.34 0.32 0.39 0.43 0.48 0.44</code></pre>
<p>The values from the KMO test are lower than 0.5 at most spatial frequencies, suggesting the data set is not suitable for factor analysis.</p>
<p>We can still try parallel analysis and see what happens.</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="factor-analysis-and-csf.html#cb826-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(resampled_ACh, <span class="at">fa =</span><span class="st">&#39;fa&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-611-1.png" width="403.2" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  0  and the number of components =  NA</code></pre>
<p>There is no identified factor because there is no covariance.</p>
<p>However, re-sampling is required to perform 95% confidence interval.</p>
<p>Therefore, a solution is to use a model that captures the contrast sensitivity function, compute parameters that retain the overall characteristic of the curve for each subject, and then re-sample the parameters with replacement. In this example, we will re-sample for 100 times (<code>nSim &lt;- 100</code>).</p>
<p>Calculation of the parameters from a data frame that contains contrast sensitivity data can be perfomed with <code>sm_params_list()</code>.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="factor-analysis-and-csf.html#cb828-1" aria-hidden="true" tabindex="-1"></a>param_res <span class="ot">&lt;-</span> <span class="fu">sm_params_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb828-2"><a href="factor-analysis-and-csf.html#cb828-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb828-3"><a href="factor-analysis-and-csf.html#cb828-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb828-4"><a href="factor-analysis-and-csf.html#cb828-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb828-5"><a href="factor-analysis-and-csf.html#cb828-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;CSF parameters = Sensitivity ~ SpatialFreq&quot;</code></pre>
<p>After we compute the four parameters of the parabola model of CSF for each subject, we resample them with replacement. Note that the sample size with resampled data should be identical to the original sample size (<code>nObs &lt;- 51</code>).</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="factor-analysis-and-csf.html#cb830-1" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">&lt;-</span> <span class="dv">51</span></span>
<span id="cb830-2"><a href="factor-analysis-and-csf.html#cb830-2" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># 100 simulations</span></span></code></pre></div>
<p>Then, we can perform non-parametric bootstrapping and obtain 95% confidence interval of the eigenvalues using <code>sm_np_boot()</code>. It produces a data frame with the confidence intervals from re-sampling and mean eigenvalue from the multiple rounds of re-sampling. This is stored on <code>boot_res</code>.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="factor-analysis-and-csf.html#cb831-1" aria-hidden="true" tabindex="-1"></a>boot_res <span class="ot">&lt;-</span> <span class="fu">sm_np_boot</span>(param_res, <span class="at">n=</span>nObs, <span class="at">nSim =</span> nSim)</span>
<span id="cb831-2"><a href="factor-analysis-and-csf.html#cb831-2" aria-hidden="true" tabindex="-1"></a>boot_res</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
##       mean downCI    upCI group  nFac
##      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
##  1  8.51    7.36   9.75   data      1
##  2  2.09    1.25   3.07   data      2
##  3  0.417   0.140  0.765  data      3
##  4 -0.0858 -0.152 -0.0413 data      4
##  5 -0.116  -0.174 -0.0798 data      5
##  6 -0.150  -0.214 -0.101  data      6
##  7 -0.207  -0.296 -0.132  data      7
##  8 -0.253  -0.378 -0.156  data      8
##  9 -0.319  -0.438 -0.200  data      9
## 10 -0.380  -0.539 -0.231  data     10
## # ... with 14 more rows</code></pre>
<p>By using <code>sm_plot_boot()</code>, we can then draw the scree plot with the eigenvalues and their 95% confidence intervals. It draws it by using <code>ggplot2</code>, so you can customise the aesthetics by adding (<code>+</code>) ggplot2 functions as I have done here with <code>ylab()</code>.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="factor-analysis-and-csf.html#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_plot_boot</span>(boot_res, <span class="at">shapes =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb833-2"><a href="factor-analysis-and-csf.html#cb833-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Eigenvalue&#39;</span>) <span class="ot">-&gt;</span> eigen1</span>
<span id="cb833-3"><a href="factor-analysis-and-csf.html#cb833-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-4"><a href="factor-analysis-and-csf.html#cb833-4" aria-hidden="true" tabindex="-1"></a>eigen1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-616-1.png" width="364.8" /></p>
<p>We can then extract the number of factors where the 95% confidence intervals of the eigenvalues from the observed data do not overlap with those from randomly generated data from parallel analysis. In this example, we can develop an exploratory model with two factors.</p>
</div>
<div id="factor-analysis" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Factor Analysis<a href="factor-analysis-and-csf.html#factor-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, we perform factor analysis with two factors. In this example, we perform varimax rotation to increase the interpretability of the results from factor analysis.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="factor-analysis-and-csf.html#cb834-1" aria-hidden="true" tabindex="-1"></a>nFac <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb834-2"><a href="factor-analysis-and-csf.html#cb834-2" aria-hidden="true" tabindex="-1"></a>fa_res <span class="ot">&lt;-</span> <span class="fu">fa</span>(df_mat1, nFac, <span class="at">fm=</span><span class="st">&#39;minres&#39;</span>, <span class="at">rotate=</span><span class="st">&#39;varimax&#39;</span>)</span>
<span id="cb834-3"><a href="factor-analysis-and-csf.html#cb834-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_res<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## 
## Loadings:
##         MR1    MR2   
## 0.25ACh  0.778       
## 0.35ACh  0.926       
## 0.48ACh  0.967       
## 0.68ACh  0.957       
## 0.94ACh  0.903       
## 1.31ACh  0.797  0.524
## 1.83ACh  0.628  0.707
## 2.54ACh         0.844
## 3.54ACh         0.947
## 4.93ACh         0.997
## 6.87ACh         0.950
## 9.57ACh         0.810
## 
##                  MR1   MR2
## SS loadings    5.442 5.085
## Proportion Var 0.453 0.424
## Cumulative Var 0.453 0.877</code></pre>
<p>It seems that two factors can describe enough of the achromatic data. The proportion of variance from these two factors are 87.7%. However, the loading scores per factor vary quite significantly, especially for the second factor (<code>MR2</code>). Therefore, there needs some more work to do to confirm whether a two-factor model adequately captures the covariance of the achromatic data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="understanding-the-contrast-sensitivity-function.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/Csf4_FA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/Csf4_FA.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
