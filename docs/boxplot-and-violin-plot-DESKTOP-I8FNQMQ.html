<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Boxplot and Violin Plot | Data Visualization in R Using smplot</title>
  <meta name="description" content="Chapter 3 Boxplot and Violin Plot | Data Visualization in R Using smplot" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Boxplot and Violin Plot | Data Visualization in R Using smplot" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Boxplot and Violin Plot | Data Visualization in R Using smplot" />
  
  
  

<meta name="author" content="Seung Hyun Min" />


<meta name="date" content="2022-02-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basics-of-ggplot2-and-correlation-plot.html"/>
<link rel="next" href="manual-and-examples-of-smplot.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#major-updates-on-smplot"><i class="fa fa-check"></i>Major updates on smplot</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#please-cite-this-paper-when-smplot-is-used"><i class="fa fa-check"></i>Please cite this paper when smplot is used</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#for-r-and-ggplot2-experts"><i class="fa fa-check"></i>For R and ggplot2 experts</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>1</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>1.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="1.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>1.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>1.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>2</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>2.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i>Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>2.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i>Let’s make some graphs</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i>How ggplot works</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i>Different color of points for each unique group</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i>Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i>Same shape across all groups</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#exercise-try-changing-the-shape-of-the-points-to-the-circle-with-the-border."><i class="fa fa-check"></i>Exercise: try changing the shape of the points to the circle with the border.</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i>How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i>geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i>Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot"><i class="fa fa-check"></i><b>2.3</b> Improve Data Visualization using smplot</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i>Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i>Reporting statistics from a paired correlation</a></li>
<li><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i>Different color for each group but with other colors</a></li>
<li><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1.">Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>3</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>3.1</b> Upload Sample Data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i>Download requirements</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i>Before we get started</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i>data.csv</a></li>
<li><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i>Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>3.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i>What is a boxplot?</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i>Boxplot vs bar graph</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i>Boxplot using ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i>Problem: Alphabetical order</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i>Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i>Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i>Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i>A boxplot with individual data</a></li>
<li><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i>Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>3.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i>Structure of the violin plot</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i>Violin plot with ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i>Violin plot with individual points</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i>geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i>Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html"><i class="fa fa-check"></i><b>4</b> Manual and Examples of smplot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#installation-of-the-package"><i class="fa fa-check"></i><b>4.1</b> Installation of the Package</a>
<ul>
<li><a href="manual-and-examples-of-smplot.html#what-is-smplot">What is <code>smplot</code>?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-color-palette-and-graph-themes"><i class="fa fa-check"></i><b>4.2</b> smplot’s Color Palette and Graph Themes</a>
<ul>
<li class="chapter" data-level="" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-color-palette"><i class="fa fa-check"></i>smplot’s color palette</a></li>
<li class="chapter" data-level="" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-graph-themes"><i class="fa fa-check"></i>smplot’s graph themes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#correlation-plot"><i class="fa fa-check"></i><b>4.3</b> Correlation Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#data-frame-for-a-correlation-plot"><i class="fa fa-check"></i><b>4.3.1</b> Data frame for a correlation plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>4.3.2</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>4.4</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>4.4.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>4.5</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>4.5.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>4.6</b> Bar Plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>4.6.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#slope-chart---sm_slope"><i class="fa fa-check"></i><b>4.7</b> Slope Chart - <code>sm_slope()</code></a></li>
<li class="chapter" data-level="4.8" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>4.8</b> A Bland Altman Plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="4.9" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>4.9</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="4.10" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#overriding-defaults-of-smplots-themes"><i class="fa fa-check"></i><b>4.10</b> Overriding Defaults of smplot’s Themes</a></li>
<li class="chapter" data-level="4.11" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#overriding-defaults-of-smplot-colors"><i class="fa fa-check"></i><b>4.11</b> Overriding Defaults of smplot Colors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>5</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-analysis.html"><a href="data-analysis.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>5.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-analysis.html"><a href="data-analysis.html#filter-for-rows"><i class="fa fa-check"></i><b>5.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-analysis.html"><a href="data-analysis.html#select-for-columns"><i class="fa fa-check"></i><b>5.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-analysis.html"><a href="data-analysis.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>5.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-analysis.html"><a href="data-analysis.html#plotting-average-data-with-error-bars"><i class="fa fa-check"></i><b>5.2</b> Plotting average data with error bars</a></li>
<li class="chapter" data-level="5.3" data-path="data-analysis.html"><a href="data-analysis.html#plotting-individual-data"><i class="fa fa-check"></i><b>5.3</b> Plotting Individual Data</a></li>
<li class="chapter" data-level="5.4" data-path="data-analysis.html"><a href="data-analysis.html#basic-statistics"><i class="fa fa-check"></i><b>5.4</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-analysis.html"><a href="data-analysis.html#t-test"><i class="fa fa-check"></i><b>5.4.1</b> T-test</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-analysis.html"><a href="data-analysis.html#effect-size"><i class="fa fa-check"></i><b>5.4.2</b> Effect Size</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-analysis.html"><a href="data-analysis.html#power-analysis"><i class="fa fa-check"></i><b>5.4.3</b> Power Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html"><i class="fa fa-check"></i><b>6</b> Recreating Figures from Front. Genetics (2021)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html#figure-1---correlation-plot"><i class="fa fa-check"></i><b>6.1</b> Figure 1 - Correlation Plot</a></li>
<li class="chapter" data-level="6.2" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html#figure-2---bar-plot"><i class="fa fa-check"></i><b>6.2</b> Figure 2 - Bar Plot</a></li>
<li class="chapter" data-level="6.3" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html#figure-3---boxplot"><i class="fa fa-check"></i><b>6.3</b> Figure 3 - Boxplot</a></li>
<li class="chapter" data-level="6.4" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html#figure-4---violin-plot"><i class="fa fa-check"></i><b>6.4</b> Figure 4 - Violin Plot</a></li>
<li class="chapter" data-level="6.5" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html#figure-5---slope-chart"><i class="fa fa-check"></i><b>6.5</b> Figure 5 - Slope Chart</a></li>
<li class="chapter" data-level="6.6" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html#figure-6---raincloud-plot"><i class="fa fa-check"></i><b>6.6</b> Figure 6 - Raincloud Plot</a></li>
<li class="chapter" data-level="6.7" data-path="recreating-figures-from-front-genetics-2021.html"><a href="recreating-figures-from-front-genetics-2021.html#figure-7---case-study"><i class="fa fa-check"></i><b>6.7</b> Figure 7 - Case Study</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Visualization in R Using smplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="boxplot-and-violin-plot" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Boxplot and Violin Plot</h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="boxplot-and-violin-plot.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb74-2"><a href="boxplot-and-violin-plot.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb74-3"><a href="boxplot-and-violin-plot.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="upload-sample-data-csv-file-in-rstudio" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Upload Sample Data (csv file) in RStudio</h2>
<div id="download-requirements" class="section level3 unnumbered">
<h3>Download requirements</h3>
<ul>
<li>Download <strong>data.csv</strong> from <a href="https://raw.githubusercontent.com/smin95/dataviz/master/data.csv" class="uri">https://raw.githubusercontent.com/smin95/dataviz/master/data.csv</a></li>
<li>Put the file <strong>data.csv</strong> in your <strong>LearnR</strong> folder</li>
</ul>
</div>
<div id="before-we-get-started" class="section level3 unnumbered">
<h3>Before we get started</h3>
<ul>
<li>Set <strong>LearnR</strong> folder as your working directory by by clicking: <strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>. Then find your <strong>LearnR</strong> folder.</li>
<li>Load these three packages with the <code>library()</code> function: <strong>ggplot2</strong>, <strong>cowplot</strong> and <strong>smplot</strong>.
<ul>
<li>Since the <strong>tidyverse</strong> package includes the <strong>ggplot2</strong> package, you can load <strong>tidyverse</strong> instead. <strong>tidyverse</strong> has other packages beside <strong>ggplot2</strong>, so it is more useful.</li>
</ul></li>
<li>Remember from the last tutorial that:
<ul>
<li>Functions from the <strong>ggplot2</strong> package include <code>ggplot()</code> and other <strong>geom</strong> functions such as <code>geom_point()</code>, <code>geom_smooth()</code>, etc.</li>
<li>Functions from the <strong>smplot</strong> package improve the <strong>ggplot2</strong> graphs visually. However, they are not required to make a graph using <strong>ggplot2</strong>.</li>
<li>The <strong>cowplot</strong> package has a function called <code>save_plot</code>, which is very useful for saving a graph as an image.</li>
</ul></li>
</ul>
</div>
<div id="data.csv" class="section level3 unnumbered">
<h3>data.csv</h3>
<ul>
<li>Let’s load <strong>data.csv</strong> in R from your <strong>LearnR</strong> folder.</li>
<li>Then store the loaded data into a variable called <code>df</code>.</li>
<li>We will use a function from the <strong>tidyverse</strong> package called <strong>read_csv()</strong>.
<ul>
<li>For more information, type <code>?read_csv()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="boxplot-and-violin-plot.html#cb75-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data.csv&#39;</span>)</span></code></pre></div>
<pre><code>## 
## -- Column specification -----------------------------------------------------------
## cols(
##   Subject = col_character(),
##   Value = col_double(),
##   Day = col_character()
## )</code></pre>
<ul>
<li><p>If you get an <strong>error</strong> such as <code>object 'data.csv' not found</code>, make sure you set your working directory in the <strong>LearnR</strong> folder. Also make sure you have downloaded your data and saved it in the <strong>LearnR</strong> folder.</p></li>
<li><p>You can view the entire data frame by typing <code>View(df)</code>.</p></li>
</ul>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="boxplot-and-violin-plot.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df)</span></code></pre></div>
<ul>
<li>There are <strong>three columns</strong> in <strong>df</strong>.
<ul>
<li>The first column (<strong>Subject</strong>) is the subject number. S1 means the first subject, and S2 second.</li>
<li>The second column (<strong>Value</strong>) is the data. It contains numbers.</li>
<li>The third column (<strong>Day</strong>) is the day of testing. There are three days of measurement: <strong>One</strong>, <strong>Two</strong> and <strong>Three</strong>.</li>
</ul></li>
<li><strong>What is the data about?</strong>
<ul>
<li>30 patients were tested across three days to see if there was an improvement in their visual function (<strong>Value</strong>). The higher value, the better the vision.</li>
<li>Day <strong>One</strong>: first day of the study. This is the baseline value. After this measurement, patients received treatment (ex. drug, surgery, etc).</li>
<li>Day <strong>Two</strong>: second day of the study. This is the one day after receiving the treatment.</li>
<li>Day <strong>Three</strong>: third day of the study. This is two days after receiving the treatment.</li>
</ul></li>
<li>The data are all fake.</li>
</ul>
</div>
<div id="read_csvdata.csv" class="section level3 unnumbered">
<h3><code>read_csv('data.csv')</code></h3>
<ul>
<li><p>Let’s use the variable <strong>df</strong> to store the output from <strong>data.csv</strong>.</p></li>
<li><p><strong>df</strong> is shortened from <strong>data frame</strong>, which refers to a structure of the data that is commonly used for data analysis.</p></li>
<li><p>In fact, ‘data.csv’ has the structure of a typical <strong>data frame</strong>.</p>
<ul>
<li>Each <strong>column</strong> is a <strong>variable</strong>.</li>
<li>Each <strong>row</strong> represents an <strong>observation</strong></li>
</ul></li>
<li><p>In future, I suggest you save data that has a similar structure to that of <strong>df</strong>.</p>
<ul>
<li>Put your own data in Microsoft Excel and save it as a <strong>csv file</strong> to load it on R.</li>
</ul></li>
<li><p><strong>Exercise</strong>: Open <strong>data.csv</strong> using Microsoft Excel. Change the name of third column into <strong>Group</strong>. Then, save it as <strong>data2.csv</strong>. What does this data frame indicate now?</p>
<ul>
<li>It indicates there are 30 individuals for each group. Also, there are 3 groups, so there are 90 individuals total. So, it might be better to change the subject number so each person has a unique label, such as <strong>S1</strong> to <strong>S90</strong>.</li>
</ul></li>
</ul>
</div>
<div id="best-way-to-plot-data" class="section level3 unnumbered">
<h3>Best way to plot data</h3>
<ul>
<li>A popular way to visualize data is plotting a bar graph.</li>
<li>However, a bar graph does not show the distribution of the data well.</li>
<li>For this reason, boxplot and violin plots have become more popular in scientific writing.</li>
</ul>
</div>
</div>
<div id="boxplot" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Boxplot</h2>
<div id="what-is-a-boxplot" class="section level3 unnumbered">
<h3>What is a boxplot?</h3>
<ul>
<li>This is the basic structure of the boxplot.</li>
</ul>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-61-1.png" width="685.714285714286" /></p>
<ul>
<li>The line in the middle is the <strong>median</strong> of the data.</li>
<li>The <strong>first quartile</strong> is the lower 25% of the data.</li>
<li>The <strong>third quartile</strong> is the 75% percentile of the data.</li>
<li>The <strong>interquartile range</strong> is the distance between the first and third quartiles.</li>
<li>The <strong>lower whisker</strong> is the lowest data point without outliers.</li>
<li>The <strong>upper whisker</strong> is the highest data point without outliers.</li>
<li>The point that lies outside the whisker is the <strong>outlier</strong>.</li>
</ul>
</div>
<div id="boxplot-vs-bar-graph" class="section level3 unnumbered">
<h3>Boxplot vs bar graph</h3>
<ul>
<li>Here is the basic structure of the bar graph.</li>
</ul>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-62-1.png" width="685.714285714286" /></p>
<ul>
<li>The boxplot is more informative than bar graph.</li>
<li>The bar graph only shows the mean (average) of the data and the standard error.</li>
<li>The bar graph does not represent the distribution very well. The narrow errorbar is quite misleading here.</li>
<li>For this reason, let’s focus on drawing a boxplot.</li>
</ul>
</div>
<div id="boxplot-using-ggplot2" class="section level3 unnumbered">
<h3>Boxplot using ggplot2</h3>
<ul>
<li>We want to plot <strong>Value</strong> (y-axis) from each <strong>Day</strong> (x-axis).</li>
<li>As always in <strong>ggplot</strong>, let’s start by writing <code>ggplot()</code>.
<ul>
<li>Make sure you specify the data to plot by writing <code>data = df</code> in <code>ggplot()</code>.</li>
</ul></li>
<li>Also, you will need to specify the x- and y-axes in the <code>mapping</code> argument within <code>ggplot()</code>.
<ul>
<li><code>x = Day</code> and <code>y = Value</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="boxplot-and-violin-plot.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-63-1.png" width="355.2" /></p>
<ul>
<li>However, as we learned in the last lesson, <strong>ggplot</strong> requires <strong>geom</strong> objects to plot something. Last time we used <strong>geom_point()</strong>, which plots points.</li>
<li>Now, let’s use <strong>geom_boxplot()</strong> to plot a boxplot.</li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="boxplot-and-violin-plot.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-64-1.png" width="355.2" /></p>
<ul>
<li>Here’s the boxplot! But I think there is a problem here.</li>
<li>Day <strong>Three</strong> precedes Day <strong>Two</strong> in the x-axis.</li>
<li><strong>Exercise</strong>: Why do you think <strong>Three</strong> appeared first?</li>
</ul>
</div>
<div id="problem-alphabetical-order" class="section level3 unnumbered">
<h3>Problem: Alphabetical order</h3>
<ul>
<li>The issue with the boxplot is that the x-axis followed an alphabetical order.</li>
<li><strong>Th</strong> precedes <strong>Tw</strong>. In short, R does not seem to know that we want the order to be <strong>One -&gt; Two -&gt; Three</strong>.</li>
<li>R decided to follow the alphabetical order is because the column <strong>Day</strong> is shown as <code>&lt;chr&gt;</code>, which means <strong>character</strong>.</li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="boxplot-and-violin-plot.html#cb80-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<ul>
<li>Note that the <strong>Subject</strong> column is also considered as <code>&lt;chr&gt;</code> (<strong>characters</strong>) because it contains texts/alphabets.</li>
<li>The <strong>Value</strong> column is categorized as <code>&lt;dbl&gt;</code>, which means <strong>double</strong>.
<ul>
<li><strong>Double</strong> basically means numbers.</li>
</ul></li>
<li>In R, <strong>character</strong> is also referred to as <strong>string</strong>. They mean the same thing.</li>
<li>Here are more examples of <strong>characters/strings</strong>.</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="boxplot-and-violin-plot.html#cb82-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">&#39;R is very useful!&#39;</span></span>
<span id="cb82-2"><a href="boxplot-and-violin-plot.html#cb82-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="st">&#39;Dogs are so cute.&#39;</span></span>
<span id="cb82-3"><a href="boxplot-and-violin-plot.html#cb82-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="st">&#39;Clarinet is the best.&#39;</span></span></code></pre></div>
<ul>
<li>In these examples, you have stored the <strong>characters/strings</strong> in the variables <strong>a</strong>, <strong>b</strong> and <strong>c</strong>.</li>
</ul>
</div>
<div id="displaying-characters-in-a-non-alphabetical-order" class="section level3 unnumbered">
<h3>Displaying characters in a non-alphabetical order</h3>
<ul>
<li><p><strong>Factors</strong> are important when you want to display characters in non-alphabetical order.</p></li>
<li><p><strong>Factors</strong> are variables that have a limited number of different values.</p></li>
<li><p>For example, if a dataset has two groups (<strong>controls</strong> and <strong>patients</strong>), these can be referred to as <strong>factors</strong>.</p></li>
<li><p>However, when you are using <code>read_csv()</code> to load data into RStudio, <code>read_csv()</code> will interpret texts/alphabets as <strong>characters</strong>, not <strong>factors</strong>.</p>
<ul>
<li>This is a problem when you need a non-alphabetical order, such as <strong>one -&gt; two -&gt; three</strong> and <strong>Jan -&gt; Feb -&gt; Mar -&gt; Apr</strong>.</li>
</ul></li>
<li><p>To resolve this problem, you will need to change the <strong>characters</strong> into <strong>factors</strong> using <code>factor()</code> function.</p></li>
</ul>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="boxplot-and-violin-plot.html#cb83-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span></code></pre></div>
<ul>
<li>Remember that <code>&lt;-</code> means equivalent.</li>
<li>Also, <code>$</code> of a data frame can extract a specific column
<ul>
<li>You can also type <code>df$Value</code> and run it to see what happens. You will get all values of the second column <strong>Value</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="boxplot-and-violin-plot.html#cb84-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Value</span></code></pre></div>
<ul>
<li>By using <code>factor()</code>, you are making the <strong>Day</strong> column of <strong>df</strong> into factor from character.</li>
<li>However, you will need to store the <strong>factored</strong> version of <code>df$Day</code> by using <code>&lt;-</code>. If not, <code>df$Day</code> will stay as <strong>character</strong>.</li>
<li><code>levels</code> argument in <code>factor()</code> allows you to specify the order of the factors.</li>
<li>For more information about <strong>factors</strong>, please check Chapter 15 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/factors.html" class="uri">https://r4ds.had.co.nz/factors.html</a>).</li>
<li><strong>Note:</strong> you do not have to understand this part 100%. However, if you do encounter similar issues, I suggest you resolve it with the solution above.</li>
</ul>
</div>
<div id="double-check-if-the-day-column-is-factor" class="section level3 unnumbered">
<h3>Double-check if the ‘Day’ column is factor</h3>
<ul>
<li>Let’s open the data frame <strong>df</strong> again.</li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="boxplot-and-violin-plot.html#cb85-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;fct&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<ul>
<li>Now we see <code>&lt;fct&gt;</code> in the <strong>Day</strong> column. This means that the column is now <strong>factor</strong>, not <strong>character</strong>.</li>
</ul>
</div>
<div id="back-to-boxplot-using-ggplot2" class="section level3 unnumbered">
<h3>Back to boxplot using ggplot2</h3>
<ul>
<li>Now let’s draw the boxplot again.</li>
</ul>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="boxplot-and-violin-plot.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-70-1.png" width="355.2" /></p>
<ul>
<li>Since we have converted the <strong>Day</strong> column of <strong>df</strong> into factor, the boxplot successfully plots each day in the correct order.</li>
</ul>
</div>
<div id="a-boxplot-with-individual-data" class="section level3 unnumbered">
<h3>A boxplot with individual data</h3>
<ul>
<li><p>Sometimes, it is preferable to plot individual data on top of the boxplot.</p></li>
<li><p>There are many ways to do this. Here is a simple solution by using <code>geom_jitter()</code>. For more information, type <code>?geom_jitter</code>.</p></li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="boxplot-and-violin-plot.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb88-2"><a href="boxplot-and-violin-plot.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-71-1.png" width="355.2" /></p>
<ul>
<li>I think the points are too spread. So let’s set the <code>width</code> of the spread in <code>geom_jitter()</code> to 0.15.</li>
<li>Also, let’s apply a different color of points for each <strong>Day</strong>.</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="boxplot-and-violin-plot.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb89-2"><a href="boxplot-and-violin-plot.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb89-3"><a href="boxplot-and-violin-plot.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-72-1.png" width="489.6" /></p>
<ul>
<li>Now we can make the boxplot prettier with <code>sm_minimal()</code>, which removes all grids in the graph. We can also set <code>legends = FALSE</code> to remove the legends.</li>
<li>Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>, which is a function from the <strong>ggplot2</strong> package.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="boxplot-and-violin-plot.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb90-2"><a href="boxplot-and-violin-plot.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb90-3"><a href="boxplot-and-violin-plot.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb90-4"><a href="boxplot-and-violin-plot.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb90-5"><a href="boxplot-and-violin-plot.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-73-1.png" width="355.2" /></p>
<ul>
<li>Now let’s set the colors using <code>sm_palette()</code>. Remember from the last lesson that we set the colors in <strong>ggplot</strong> by using <code>scale_color_manual()</code> for points without borders.</li>
<li>Let’s write <code>3</code> in <code>sm_palette()</code> because we need 3 colors (for each <strong>Day</strong>).</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="boxplot-and-violin-plot.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb91-2"><a href="boxplot-and-violin-plot.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb91-3"><a href="boxplot-and-violin-plot.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb91-4"><a href="boxplot-and-violin-plot.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb91-5"><a href="boxplot-and-violin-plot.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="boxplot-and-violin-plot.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-74-1.png" width="355.2" /></p>
<ul>
<li>If you need horizontal grids, you can simply replace <code>sm_minimal()</code> with <code>sm_hgrid()</code>. There is also <code>sm_vgrid()</code> but I will not try it here because it is not so useful in our context.</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="boxplot-and-violin-plot.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb92-2"><a href="boxplot-and-violin-plot.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb92-3"><a href="boxplot-and-violin-plot.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb92-4"><a href="boxplot-and-violin-plot.html#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="boxplot-and-violin-plot.html#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb92-6"><a href="boxplot-and-violin-plot.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-75-1.png" width="355.2" /></p>
</div>
<div id="geom_boxplot-vs-sm_boxplot" class="section level3 unnumbered">
<h3><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></h3>
<ul>
<li><code>geom_boxplot()</code> does not show individual data. You need to add <code>geom_jitter()</code>.</li>
<li><code>sm_boxplot()</code> shows both a boxplot and individual data.
<ul>
<li>It automatically uses <code>sm_hgrid()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="boxplot-and-violin-plot.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb93-2"><a href="boxplot-and-violin-plot.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb93-3"><a href="boxplot-and-violin-plot.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="boxplot-and-violin-plot.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-76-1.png" width="355.2" /></p>
<ul>
<li>Let’s keep the color of the boxplot the same across <strong>Day</strong>. So we should remove <code>color = Day</code> in <code>aes()</code>.
<ul>
<li>However, since the shape is 16 (circle without borders), this will cause the points across <strong>Day</strong> to have the same color too.</li>
</ul></li>
<li>So let’s change the shape of the points to 21, which is a circle with borders.
<ul>
<li>So <code>fill</code> decides the filling color now. Let’s set <code>fill = Day</code> in <code>aes()</code>.</li>
<li>Also, <code>color</code> here only affects the border color. Let’s set it to <code>white</code>.</li>
</ul></li>
<li>Make sure you change <code>scale_color_manual()</code> to <code>scale_fill_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="boxplot-and-violin-plot.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb94-2"><a href="boxplot-and-violin-plot.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="boxplot-and-violin-plot.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="boxplot-and-violin-plot.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-77-1.png" width="355.2" /></p>
<ul>
<li>Now, pick your favorite boxplot and store it in a variable called <strong>my_boxplot</strong> using <code>&lt;-</code>.</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="boxplot-and-violin-plot.html#cb95-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb95-2"><a href="boxplot-and-violin-plot.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb95-3"><a href="boxplot-and-violin-plot.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb95-4"><a href="boxplot-and-violin-plot.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="save-boxplot" class="section level3 unnumbered">
<h3>Save boxplot</h3>
<ul>
<li>We can save the boxplot by using <code>save_plot()</code> from the <strong>cowplot</strong> package.</li>
<li>Let’s set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="boxplot-and-violin-plot.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;boxplot.jpg&#39;</span>, my_boxplot, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>This image file should now be in your <strong>LearnR</strong> folder.</li>
</ul>
</div>
</div>
<div id="violin-plot" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Violin Plot</h2>
<ul>
<li>The boxplot represents the distribution quite well but it can still be misleading.
<ul>
<li>Also, it can be visually overwhelming (i.e., too crowded) to some readers.</li>
</ul></li>
<li>So, researchers have begun favoring the violin plot more.</li>
</ul>
<div id="structure-of-the-violin-plot" class="section level3 unnumbered">
<h3>Structure of the violin plot</h3>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-80-1.png" width="685.714285714286" /></p>
<ul>
<li>The part in the middle is the widest because it has most points. This part has the highest <strong>point density</strong>.</li>
<li>The lower and upper ends of the violin plot are thinner because there are less points.</li>
<li>Let’s draw a violin plot in R.</li>
</ul>
</div>
<div id="violin-plot-with-ggplot2" class="section level3 unnumbered">
<h3>Violin plot with ggplot2</h3>
<ul>
<li>Let’s draw the violin plot. Specify the x-axis to <strong>Day</strong> and the y-axis to <strong>Value</strong> using data frame <strong>df</strong>.</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="boxplot-and-violin-plot.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-81-1.png" width="355.2" /></p>
<ul>
<li>Notice that since we have already converted the <strong>Day</strong> column of df into <strong>factor</strong>, the violin plot’s x-axis is in the correct order.</li>
<li>Also, notice that we can just replace <code>geom_boxplot()</code> with <code>geom_violin()</code>.</li>
</ul>
</div>
<div id="violin-plot-with-individual-points" class="section level3 unnumbered">
<h3>Violin plot with individual points</h3>
<ul>
<li>Let’s add individual points to the violin plot by using <code>geom_jitter()</code>.
<ul>
<li>Set <code>width</code> of the spread to <code>0.15</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="boxplot-and-violin-plot.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb98-2"><a href="boxplot-and-violin-plot.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb98-3"><a href="boxplot-and-violin-plot.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-82-1.png" width="355.2" /></p>
<ul>
<li>Now let’s apply different color to each <strong>Day</strong> like we did in boxplot by using <code>scale_color_manual()</code>.
<ul>
<li>Let’s use <code>sm_palette(3)</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="boxplot-and-violin-plot.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb99-2"><a href="boxplot-and-violin-plot.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb99-3"><a href="boxplot-and-violin-plot.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="boxplot-and-violin-plot.html#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-83-1.png" width="460.8" /></p>
<ul>
<li>Finally, let’s make it pretty and remove the <strong>legend</strong> by applying <code>sm_hgrid()</code> theme, which only has horizontal grids.</li>
<li>Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>.</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="boxplot-and-violin-plot.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb100-2"><a href="boxplot-and-violin-plot.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb100-3"><a href="boxplot-and-violin-plot.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb100-4"><a href="boxplot-and-violin-plot.html#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb100-5"><a href="boxplot-and-violin-plot.html#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb100-6"><a href="boxplot-and-violin-plot.html#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-84-1.png" width="355.2" /></p>
</div>
<div id="geom_violin-vs-sm_violin" class="section level3 unnumbered">
<h3>geom_violin() vs sm_violin()</h3>
<ul>
<li><code>geom_violin()</code> does not show individual data. You need to add geom_jitter().</li>
<li><code>sm_violin()</code> shows both a boxplot and individual data.
<ul>
<li>It automatically uses <code>sm_hgrid()</code>.</li>
<li>It also display lines that represent the mean and +/- standard deviation.</li>
</ul></li>
<li>In <code>sm_violin()</code>, the default shape (<code>'point_shape'</code>) is 16, which is the circle without borders.</li>
<li><strong>Let’s try using <code>sm_violin()</code>.</strong></li>
<li><code>color</code> here filling color of the jittered points. Also, <code>color</code> affects the color of the lines that show the mean and +/- standard deviation.</li>
<li>Let’s set <code>color = Day</code> in <code>aes()</code> so that we can apply different colors of the lines and the points for each group.</li>
<li>Make sure you have <code>scale_color_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="boxplot-and-violin-plot.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb101-2"><a href="boxplot-and-violin-plot.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb101-3"><a href="boxplot-and-violin-plot.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb101-4"><a href="boxplot-and-violin-plot.html#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-85-1.png" width="355.2" /></p>
</div>
<div id="save-your-violin-plot" class="section level3 unnumbered">
<h3>Save your violin plot</h3>
<ul>
<li>Pick your violin plot and store it in a variable called <code>my_violin</code> using <code>&lt;-</code>.</li>
</ul>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="boxplot-and-violin-plot.html#cb102-1" aria-hidden="true" tabindex="-1"></a>my_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb102-2"><a href="boxplot-and-violin-plot.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb102-3"><a href="boxplot-and-violin-plot.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb102-4"><a href="boxplot-and-violin-plot.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<ul>
<li>We can save the violin plot by using <code>save_plot()</code> from the <strong>cowplot</strong> package.</li>
<li>Let’s set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</li>
</ul>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="boxplot-and-violin-plot.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;violin.jpg&#39;</span>, my_violin, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>This image file should now be in your <strong>LearnR</strong> folder.</li>
</ul>
</div>
</div>
<div id="summary-1" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Summary</h2>
<ul>
<li>You have learned how to convert <strong>characters</strong> to <strong>factors</strong>.</li>
<li><strong>Factor</strong> is important to order words/letters in a non-alphabetical order.</li>
<li>You can now make a <strong>boxplot</strong> and a <strong>violin plot</strong> with R.
<ul>
<li>They are more informative than a bar graph.</li>
</ul></li>
<li>You have learned to use <strong>geom</strong> functions, such <code>geom_boxplot()</code>, <code>geom_violin()</code>, and <code>geom_jitter()</code>.
<ul>
<li>These are functions from the <strong>ggplot2</strong> package.</li>
</ul></li>
<li>You can also plot individual data at the same time with functions from the <strong>smplot</strong> package.
<ul>
<li>These functions are <code>sm_boxplot()</code> and <code>sm_violin()</code>.</li>
</ul></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basics-of-ggplot2-and-correlation-plot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="manual-and-examples-of-smplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/03-violinBox.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/03-violinBox.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
