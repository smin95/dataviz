[["factor-analysis-and-csf-in-development.html", "Chapter 16 Factor Analysis and CSF (in development) 16.1 Factor Analysis 16.2 Eigenvalues", " Chapter 16 Factor Analysis and CSF (in development) library(tidyverse) library(cowplot) library(smplot2) library(smCSF) In this chapter, we will use a public dataset of achromatic contrast sensitivity from 51 normally sighted observers. df &lt;- read_csv(&#39;https://www.smin95.com/data_ACh.csv&#39;) %&gt;% group_by(Subject, SpatialFreq) %&gt;% summarise(Sensitivity = mean(Sensitivity), Repetition = &#39;avg&#39;) 16.1 Factor Analysis Factor analysis is a technique to identify latent factors that produce local patterns/correlations in a high-dimensional dataset. It aims to reduce the number of dimensions in the data. One way to extract an adequate number of factors/dimensions is to draw a scree plot. 16.2 Eigenvalues The scree plot has a y-axis of eigenvalues, which means the amount of variance of the data from the factor of interest. Essentially, the higher the eigenvalue, the more important the factor is in the dataset. Some methods for factor analysis determine the number of factors in a potential factor model based on eigenvalues. The Guttman Rule extracts all factors with eigenvalues larger than 1. However, this is problematic because in one dataset, factor A can have an eigenvalue larger than 1 but in another dataset from another population factor B can have an eigenvalue lower than 1. Therefore the number of factors that is extracted can vary depending on the local sample. This creates variability in results. Therefore, it might be better to include a range of uncertainty of eigenvalues so that one can better be informed about the possible range of eigenvalues in a population. This can be done by plotting 95% confidence interval of eigenvalues. In the method below, we will perform non-parametric bootstrapping to compute the confidence intervals of the eigenvalues. However, it turns out, if we resample the contrast sensitivity data directly, it removes the local correlation and therefore the influence of latent factors on the dataset, thereby erasing covariance from its existence. Therefore, a solution is to use a model that captures the contrast sensitivity function, compute parameters that retain the overall characteristic of the curve for each subject, and then resample the parameters by resampling. In this example, we will resample for 100 times (nSim &lt;- 100). Calculation of the parameters from a data frame that contains contrast sensitivity data can be perfomed with sm_params_list(). param_res &lt;- sm_params_list(subjects = &#39;Subject&#39;, conditions = &#39;Repetition&#39;, x = &#39;SpatialFreq&#39;, values = &#39;Sensitivity&#39;, data = df) ## [1] &quot;CSF parameters = Sensitivity ~ SpatialFreq&quot; After we compute the four parameters of the parabola model of CSF for each subject, we resample them with replacement. Note that the sample size with resampled data should be identical to the original sample size (nObs &lt;- 51). nObs &lt;- 51 nSim &lt;- 100 # 100 simulations Then, we can perform non-parametric bootstrapping and obtain 95% confidence interval of the eigenvalues using sm_np_boot(). It produces a data frame with the confidence intervals from resampling and observed eigenvalue from the original parameters. This is stored on boot_res. boot_res &lt;- sm_np_boot(param_res, n=nObs, nSim = nSim) boot_res ## # A tibble: 24 x 5 ## mean downCI upCI group nFac ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 8.51 7.36 9.75 data 1 ## 2 2.09 1.25 3.07 data 2 ## 3 0.417 0.140 0.765 data 3 ## 4 -0.0858 -0.152 -0.0413 data 4 ## 5 -0.116 -0.174 -0.0798 data 5 ## 6 -0.150 -0.214 -0.101 data 6 ## 7 -0.207 -0.296 -0.132 data 7 ## 8 -0.253 -0.378 -0.156 data 8 ## 9 -0.319 -0.438 -0.200 data 9 ## 10 -0.380 -0.539 -0.231 data 10 ## # ... with 14 more rows By using sm_plot_boot(), we can then draw the scree plot with the eigenvalues and their 95% confidence intervals. sm_plot_boot(boot_res, shapes = 16) + ylab(&#39;Eigenvalue&#39;) -&gt; eigen1 eigen1 We can then extract the number of factors where the 95% confidence intervals of the eigenvalues from the observed data do not overlap with those from randomly generated data from parallel analysis. In this example, we can develop an exploratory model with two factors. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
