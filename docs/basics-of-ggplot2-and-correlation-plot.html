<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Basics of ggplot2 and Correlation Plot | Data Analysis and Visualization in R Using smplot2</title>
  <meta name="description" content="Chapter 3 Basics of ggplot2 and Correlation Plot | Data Analysis and Visualization in R Using smplot2" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Basics of ggplot2 and Correlation Plot | Data Analysis and Visualization in R Using smplot2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Basics of ggplot2 and Correlation Plot | Data Analysis and Visualization in R Using smplot2" />
  
  
  

<meta name="author" content="Seung Hyun Min" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="download-rstudio-basics-of-r.html"/>
<link rel="next" href="boxplot-and-violin-plot.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation-of-smplot2"><i class="fa fa-check"></i>Installation of smplot2</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="opening-remarks.html"><a href="opening-remarks.html"><i class="fa fa-check"></i><b>1</b> Opening Remarks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="opening-remarks.html"><a href="opening-remarks.html#how-to-read-this-book"><i class="fa fa-check"></i><b>1.1</b> How to read this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>2</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="2.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>2.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>2.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Visualization with smplot2</b></span></li>
<li class="chapter" data-level="3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>3</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>3.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i><b>3.1.1</b> Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i><b>3.2.1</b> Let’s make some graphs</a></li>
<li class="chapter" data-level="3.2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i><b>3.2.2</b> How ggplot works</a></li>
<li class="chapter" data-level="3.2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i><b>3.2.3</b> Different color of points for each unique group</a></li>
<li class="chapter" data-level="3.2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i><b>3.2.4</b> Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="3.2.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i><b>3.2.5</b> Same shape across all groups</a></li>
<li class="chapter" data-level="3.2.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i><b>3.2.6</b> How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="3.2.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i><b>3.2.7</b> geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="3.2.8" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i><b>3.2.8</b> Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot2"><i class="fa fa-check"></i><b>3.3</b> Improve data visualization using smplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i><b>3.3.1</b> Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i><b>3.3.2</b> Reporting statistics from a paired correlation</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#changing-the-text"><i class="fa fa-check"></i><b>3.3.3</b> Changing the text</a></li>
<li class="chapter" data-level="3.3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#plotting-the-average-with-standard-errors"><i class="fa fa-check"></i><b>3.3.4</b> Plotting the average with standard errors</a></li>
<li class="chapter" data-level="3.3.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><i class="fa fa-check"></i><b>3.3.5</b> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i><b>3.3.6</b> Different color for each group but with other colors</a></li>
<li class="chapter" data-level="3.3.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1."><i class="fa fa-check"></i><b>3.3.7</b> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>4</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>4.1</b> Upload sample data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i><b>4.1.1</b> Download requirements</a></li>
<li class="chapter" data-level="4.1.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i><b>4.1.2</b> Before we get started</a></li>
<li class="chapter" data-level="4.1.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i><b>4.1.3</b> data.csv</a></li>
<li class="chapter" data-level="4.1.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><i class="fa fa-check"></i><b>4.1.4</b> <code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i><b>4.1.5</b> Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>4.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i><b>4.2.1</b> What is a boxplot?</a></li>
<li class="chapter" data-level="4.2.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i><b>4.2.2</b> Boxplot vs bar graph</a></li>
<li class="chapter" data-level="4.2.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.3</b> Boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i><b>4.2.4</b> Problem: Alphabetical order</a></li>
<li class="chapter" data-level="4.2.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i><b>4.2.5</b> Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="4.2.6" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i><b>4.2.6</b> Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="4.2.7" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.7</b> Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.8" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i><b>4.2.8</b> A boxplot with individual data</a></li>
<li class="chapter" data-level="4.2.9" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><i class="fa fa-check"></i><b>4.2.9</b> <code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="4.2.10" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i><b>4.2.10</b> Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>4.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i><b>4.3.1</b> Structure of the violin plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>4.3.2</b> Violin plot with ggplot2</a></li>
<li class="chapter" data-level="4.3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i><b>4.3.3</b> Violin plot with individual points</a></li>
<li class="chapter" data-level="4.3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i><b>4.3.4</b> geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="4.3.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i><b>4.3.5</b> Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html"><i class="fa fa-check"></i><b>5</b> Bar Graph, Slope Chart and Point plot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph"><i class="fa fa-check"></i><b>5.1</b> Bar graph</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#scaling-the-y-axis"><i class="fa fa-check"></i><b>5.1.1</b> Scaling the y-axis</a></li>
<li class="chapter" data-level="5.1.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>5.1.2</b> Plotting individual points with unique colors</a></li>
<li class="chapter" data-level="5.1.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#other-parameters"><i class="fa fa-check"></i><b>5.1.3</b> Other parameters</a></li>
<li class="chapter" data-level="5.1.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph-with-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.1.4</b> Bar graph with data of multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart"><i class="fa fa-check"></i><b>5.2</b> Slope chart</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot"><i class="fa fa-check"></i><b>5.2.1</b> Slope chart with mean plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot-and-error-bar"><i class="fa fa-check"></i><b>5.2.2</b> Slope chart with mean plot and error bar</a></li>
<li class="chapter" data-level="5.2.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-x-levels"><i class="fa fa-check"></i><b>5.2.3</b> Slope chart with multiple x levels</a></li>
<li class="chapter" data-level="5.2.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-groups-and-x-levels"><i class="fa fa-check"></i><b>5.2.4</b> Slope chart with multiple groups and x levels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot"><i class="fa fa-check"></i><b>5.3</b> Point plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#change-the-range-of-y-axis"><i class="fa fa-check"></i><b>5.3.1</b> Change the range of y-axis</a></li>
<li class="chapter" data-level="5.3.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#data-with-more-than-two-groups"><i class="fa fa-check"></i><b>5.3.2</b> Data with more than two groups</a></li>
<li class="chapter" data-level="5.3.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-one-group"><i class="fa fa-check"></i><b>5.3.3</b> Point plot with a shadow using data of one group</a></li>
<li class="chapter" data-level="5.3.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.3.4</b> Point plot with a shadow using data of multiple groups</a></li>
<li class="chapter" data-level="5.3.5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#adding-and-modifying-legends"><i class="fa fa-check"></i><b>5.3.5</b> Adding and modifying legends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html"><i class="fa fa-check"></i><b>6</b> Raincloud and Forest Plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot"><i class="fa fa-check"></i><b>6.1</b> Raincloud plot</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changing-the-x-axis-labels"><i class="fa fa-check"></i><b>6.1.1</b> Changing the x-axis labels</a></li>
<li class="chapter" data-level="6.1.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#separating-the-components-and-configuration"><i class="fa fa-check"></i><b>6.1.2</b> Separating the components and configuration</a></li>
<li class="chapter" data-level="6.1.3" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changng-the-theme-and-orientation"><i class="fa fa-check"></i><b>6.1.3</b> Changng the theme and orientation</a></li>
<li class="chapter" data-level="6.1.4" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot-with-data-from-multiple-groups"><i class="fa fa-check"></i><b>6.1.4</b> Raincloud plot with data from multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#forest-plot"><i class="fa fa-check"></i><b>6.2</b> Forest plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#plotting-the-forest-plot-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>6.2.1</b> Plotting the forest plot using data of multiple groups</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Analysis with smplot2</b></span></li>
<li class="chapter" data-level="7" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html"><i class="fa fa-check"></i><b>7</b> Creating a Composite Figure by Subplotting</a>
<ul>
<li class="chapter" data-level="7.1" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>7.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#filter-for-rows"><i class="fa fa-check"></i><b>7.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="7.1.2" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#select-for-columns"><i class="fa fa-check"></i><b>7.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="7.1.3" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>7.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#plotting-the-averaged-data-with-error-bars"><i class="fa fa-check"></i><b>7.2</b> Plotting the averaged data with error bars</a></li>
<li class="chapter" data-level="7.3" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#plotting-individual-data"><i class="fa fa-check"></i><b>7.3</b> Plotting individual data</a></li>
<li class="chapter" data-level="7.4" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#putting-multiple-plots-together-a-composite-figure"><i class="fa fa-check"></i><b>7.4</b> Putting multiple plots together (a composite figure)</a></li>
<li class="chapter" data-level="7.5" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#other-important-inputs-of-sm_put_together"><i class="fa fa-check"></i><b>7.5</b> Other important inputs of <code>sm_put_together()</code></a></li>
<li class="chapter" data-level="7.6" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#adding-annotations-to-the-composite-figure"><i class="fa fa-check"></i><b>7.6</b> Adding annotations to the composite figure</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#text-annotations"><i class="fa fa-check"></i><b>7.6.1</b> Text annotations</a></li>
<li class="chapter" data-level="7.6.2" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#point-annotations"><i class="fa fa-check"></i><b>7.6.2</b> Point annotations</a></li>
<li class="chapter" data-level="7.6.3" data-path="creating-a-composite-figure-by-subplotting.html"><a href="creating-a-composite-figure-by-subplotting.html#line-annotations"><i class="fa fa-check"></i><b>7.6.3</b> Line annotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html"><i class="fa fa-check"></i><b>8</b> Calculating Area under a Curve</a>
<ul>
<li class="chapter" data-level="8.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#pipe"><i class="fa fa-check"></i><b>8.1</b> Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="8.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#area-under-a-curve"><i class="fa fa-check"></i><b>8.2</b> Area under a curve</a></li>
<li class="chapter" data-level="8.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#reproducing-figures-in-the-paper-min-et-al.-2019"><i class="fa fa-check"></i><b>8.3</b> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3b-a-best-fit-line-with-points-and-error-bars"><i class="fa fa-check"></i><b>8.3.1</b> Figure 3B (a best-fit line with points and error bars)</a></li>
<li class="chapter" data-level="8.3.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3d-a-bar-graph"><i class="fa fa-check"></i><b>8.3.2</b> Figure 3D (a bar graph)</a></li>
<li class="chapter" data-level="8.3.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3e-modeling-in-matlab-and-plotting-in-r"><i class="fa fa-check"></i><b>8.3.3</b> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html"><i class="fa fa-check"></i><b>9</b> Calculating Linear Slopes</a>
<ul>
<li class="chapter" data-level="9.1" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#linear-relationship-using-lm"><i class="fa fa-check"></i><b>9.1</b> Linear relationship using <code>lm()</code></a></li>
<li class="chapter" data-level="9.2" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#calculating-slopes-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>9.2</b> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>10</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-statistics.html"><a href="basic-statistics.html#one-sample-t-test"><i class="fa fa-check"></i><b>10.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="10.2" data-path="basic-statistics.html"><a href="basic-statistics.html#two-sample-t-test"><i class="fa fa-check"></i><b>10.2</b> Two-sample t-test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#shapiro-wilk-test-to-test-for-normality-of-data"><i class="fa fa-check"></i><b>10.2.1</b> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basic-statistics.html"><a href="basic-statistics.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>10.3</b> Wilcoxon Signed-rank Test</a></li>
<li class="chapter" data-level="10.4" data-path="basic-statistics.html"><a href="basic-statistics.html#effect-size"><i class="fa fa-check"></i><b>10.4</b> Effect Size</a></li>
<li class="chapter" data-level="10.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.5</b> Post-hoc Power Analysis</a></li>
<li class="chapter" data-level="10.6" data-path="basic-statistics.html"><a href="basic-statistics.html#bayes-factor"><i class="fa fa-check"></i><b>10.6</b> Bayes Factor</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#issues-with-post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.6.1</b> Issues with post-hoc power analysis</a></li>
<li class="chapter" data-level="10.6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-the-bayes-factor-in-r"><i class="fa fa-check"></i><b>10.6.2</b> Computing the Bayes factor in R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>10.7</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="basic-statistics.html"><a href="basic-statistics.html#check-for-outliers"><i class="fa fa-check"></i><b>10.7.1</b> Check for Outliers</a></li>
<li class="chapter" data-level="10.7.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data"><i class="fa fa-check"></i><b>10.7.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.7.3" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-the-assumption-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>10.7.3</b> Checking the Assumption for Homogeneity of Variance</a></li>
<li class="chapter" data-level="10.7.4" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-one-way-anova"><i class="fa fa-check"></i><b>10.7.4</b> Computing One-way ANOVA</a></li>
<li class="chapter" data-level="10.7.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-tests"><i class="fa fa-check"></i><b>10.7.5</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="10.7.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>10.7.6</b> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="basic-statistics.html"><a href="basic-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>10.8</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="basic-statistics.html"><a href="basic-statistics.html#identifying-outliers"><i class="fa fa-check"></i><b>10.8.1</b> Identifying Outliers</a></li>
<li class="chapter" data-level="10.8.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data-1"><i class="fa fa-check"></i><b>10.8.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.8.3" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-two-way-anova"><i class="fa fa-check"></i><b>10.8.3</b> Computing Two-way ANOVA</a></li>
<li class="chapter" data-level="10.8.4" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-test"><i class="fa fa-check"></i><b>10.8.4</b> Post-hoc Test</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="basic-statistics.html"><a href="basic-statistics.html#friedman-test"><i class="fa fa-check"></i><b>10.9</b> Friedman Test</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="basic-statistics.html"><a href="basic-statistics.html#performing-friedman-test"><i class="fa fa-check"></i><b>10.9.1</b> Performing Friedman Test</a></li>
<li class="chapter" data-level="10.9.2" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-analysis"><i class="fa fa-check"></i><b>10.9.2</b> Post-hoc Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-resources"><i class="fa fa-check"></i><b>10.10</b> Extra Resources</a></li>
</ul></li>
<li class="part"><span><b>III Manual for smplot2</b></span></li>
<li class="chapter" data-level="11" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><i class="fa fa-check"></i><b>11</b> Themes, Colors, Correlations, Boxplots, Violins and Bars (Part 1)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#installation-of-the-package"><i class="fa fa-check"></i><b>11.1</b> Installation of the Package</a></li>
<li class="chapter" data-level="11.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#how-...-and-xxx.params-arguments-work"><i class="fa fa-check"></i><b>11.2</b> How <code>...</code> and <code>xxx.params</code> arguments work</a></li>
<li class="chapter" data-level="11.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#color-palette"><i class="fa fa-check"></i><b>11.3</b> Color palette</a></li>
<li class="chapter" data-level="11.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#graph-themes"><i class="fa fa-check"></i><b>11.4</b> Graph themes</a></li>
<li class="chapter" data-level="11.5" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot"><i class="fa fa-check"></i><b>11.5</b> Correlation plot</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_statcorr"><i class="fa fa-check"></i><b>11.5.1</b> <code>sm_statCorr()</code></a></li>
<li class="chapter" data-level="11.5.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_corr_avgerr"><i class="fa fa-check"></i><b>11.5.2</b> <code>sm_corr_avgErr()</code></a></li>
<li class="chapter" data-level="11.5.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#structure-of-data-frame"><i class="fa fa-check"></i><b>11.5.3</b> Structure of data frame</a></li>
<li class="chapter" data-level="11.5.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>11.5.4</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>11.6</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>11.6.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>11.7</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>11.7.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>11.8</b> Bar plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-3"><i class="fa fa-check"></i><b>11.8.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><i class="fa fa-check"></i><b>12</b> Slope Charts, Point plots, Bland-Altman, Forests, Rainclouds, Histograms (Part 2)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#slope-chart---sm_slope"><i class="fa fa-check"></i><b>12.1</b> Slope chart - <code>sm_slope()</code></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#drawing-the-mean-plot"><i class="fa fa-check"></i><b>12.1.1</b> Drawing the mean plot</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#point-plot---sm_pointplot"><i class="fa fa-check"></i><b>12.2</b> Point plot - <code>sm_pointplot()</code></a></li>
<li class="chapter" data-level="12.3" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>12.3</b> A Bland Altman plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="12.4" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#forest-plot---sm_forest"><i class="fa fa-check"></i><b>12.4</b> Forest plot - <code>sm_forest()</code></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#annotation-using-sm_forest_annot"><i class="fa fa-check"></i><b>12.4.1</b> Annotation using <code>sm_forest_annot()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>12.5</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="12.6" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#histogram---sm_hist"><i class="fa fa-check"></i><b>12.6</b> Histogram - <code>sm_hist()</code></a></li>
</ul></li>
<li class="part"><span><b>IV Contrast Sensitivity Function</b></span></li>
<li class="chapter" data-level="13" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>13</b> Plotting the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="13.1" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#brief-introduction"><i class="fa fa-check"></i><b>13.1</b> Brief Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#data-visualization"><i class="fa fa-check"></i><b>13.2</b> Data Visualization</a></li>
<li class="chapter" data-level="13.3" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#facetting-the-contrast-sensitivity-functions"><i class="fa fa-check"></i><b>13.3</b> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html"><i class="fa fa-check"></i><b>14</b> Area under Curve, AULCSF and R2 of the CSF</a>
<ul>
<li class="chapter" data-level="14.1" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#area-under-a-curve-1"><i class="fa fa-check"></i><b>14.1</b> Area under a Curve</a></li>
<li class="chapter" data-level="14.2" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#sm_trapz-sm_aulcsf-and-sm_r2"><i class="fa fa-check"></i><b>14.2</b> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
<li class="chapter" data-level="14.3" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#calculating-area-and-r2-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>14.3</b> Calculating area and R2 of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="14.4" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#case-study"><i class="fa fa-check"></i><b>14.4</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>15</b> Understanding the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="15.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#contrast-sensitivity-function-model"><i class="fa fa-check"></i><b>15.1</b> Contrast Sensitivity Function Model</a></li>
<li class="chapter" data-level="15.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_csf"><i class="fa fa-check"></i><b>15.2</b> Understanding <code>sm_CSF()</code></a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_params"><i class="fa fa-check"></i><b>15.2.1</b> <code>sm_params()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_cutoff"><i class="fa fa-check"></i><b>15.2.2</b> <code>sm_cutOff()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_ribboncsf"><i class="fa fa-check"></i><b>15.3</b> Understanding <code>sm_ribbonCSF()</code></a></li>
<li class="chapter" data-level="15.4" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#calculating-the-five-parameters-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>15.4</b> Calculating the five parameters of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="15.5" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#visualization-of-the-parameters"><i class="fa fa-check"></i><b>15.5</b> Visualization of the parameters</a></li>
<li class="chapter" data-level="15.6" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#case-study-1"><i class="fa fa-check"></i><b>15.6</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html"><i class="fa fa-check"></i><b>16</b> Factor Analysis and CSF</a>
<ul>
<li class="chapter" data-level="16.1" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#eigenvalues"><i class="fa fa-check"></i><b>16.1</b> Eigenvalues</a></li>
<li class="chapter" data-level="16.2" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#parallel-analysis"><i class="fa fa-check"></i><b>16.2</b> Parallel analysis</a></li>
<li class="chapter" data-level="16.3" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#non-parametric-bootstrapping"><i class="fa fa-check"></i><b>16.3</b> Non-parametric bootstrapping</a></li>
<li class="chapter" data-level="16.4" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#factor-analysis"><i class="fa fa-check"></i><b>16.4</b> Factor Analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basics-of-ggplot2-and-correlation-plot" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Basics of ggplot2 and Correlation Plot<a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2-and-correlation-plot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb22-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb22-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<div id="uploading-data" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Uploading data<a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sample-data-mpg" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Sample data: mpg<a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I will be using an example from the book <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/data-visualisation.html" class="uri">https://r4ds.had.co.nz/data-visualisation.html</a>).</p>
<ul>
<li><strong>Question: Do cars with large engines use up more fuel than the those with small ones?</strong></li>
</ul>
<p>First, let’s open <strong>mpg</strong>, which is a <strong>data frame</strong> stored in the <strong>ggplot2</strong> package.</p>
<ul>
<li><p><strong>mpg</strong> contains data about cars in the US. You can type <code>?mpg</code> for more information.</p>
<ul>
<li><strong>displ</strong>: the size of the car’s engine in liters</li>
<li><strong>hwy</strong>: fuel efficiency. If it’s high, then the car uses less fuel per distance.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb23-1" aria-hidden="true" tabindex="-1"></a>mpg</span></code></pre></div>
<pre><code>## # A tibble: 234 × 11
##    manufacturer model   displ  year   cyl trans drv     cty   hwy fl    class
##    &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
##  1 audi         a4        1.8  1999     4 auto… f        18    29 p     comp…
##  2 audi         a4        1.8  1999     4 manu… f        21    29 p     comp…
##  3 audi         a4        2    2008     4 manu… f        20    31 p     comp…
##  4 audi         a4        2    2008     4 auto… f        21    30 p     comp…
##  5 audi         a4        2.8  1999     6 auto… f        16    26 p     comp…
##  6 audi         a4        2.8  1999     6 manu… f        18    26 p     comp…
##  7 audi         a4        3.1  2008     6 auto… f        18    27 p     comp…
##  8 audi         a4 qua…   1.8  1999     4 manu… 4        18    26 p     comp…
##  9 audi         a4 qua…   1.8  1999     4 auto… 4        16    25 p     comp…
## 10 audi         a4 qua…   2    2008     4 manu… 4        20    28 p     comp…
## # ℹ 224 more rows</code></pre>
<p>Notice that some columns and rows are not shown. You can type <code>View(mpg)</code> to see the entire <strong>data frame</strong>.</p>
<ul>
<li>Each row is an unique observation.</li>
<li>Each column is an unique variable/condition.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mpg)</span></code></pre></div>
</div>
</div>
<div id="basics-of-ggplot2" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Basics of ggplot2<a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lets-make-some-graphs" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Let’s make some graphs<a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Question: Do cars with large engines use up more fuel than the those with small ones?</p>
<p>To answer our question, we need to plot <strong>mpg</strong> data. The x-axis should be <strong>displ</strong>, the y-axis should be <strong>hwy</strong>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-20-1.png" width="336" /></p>
<p>We find that a smaller car has a higher efficiency and that a larger car has a lower efficiency. In other words, we see a negative relationship.</p>
</div>
<div id="how-ggplot-works" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> How ggplot works<a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you are making a graph with <strong>ggplot2</strong>, always begin by typing the function <code>ggplot()</code>.</p>
<ul>
<li>The <strong>data</strong> you want to plot is the <strong>first argument</strong> here. Ex. <code>ggplot(data = mpg)</code>.</li>
</ul>
<p>However, <code>ggplot(data = mpg)</code> alone does not create a graph. You will need <strong>add</strong> (by typing <strong>+</strong>) more layers, such as <code>geom_point()</code>.</p>
<ul>
<li><p><code>geom_point()</code> adds points to your graphs. You will need to specify (or map) x- and y-axes in the <code>aes()</code> function, which means aesthetics. This process is called <strong>mapping</strong>.</p></li>
<li><p>As you might expect, there are other <strong>geom</strong> functions, such as <code>geom_bar()</code>, <code>geom_boxplot()</code>, <code>geom_errorbar()</code>. They plot bar graphs, boxplots and error bars, respectively.</p></li>
</ul>
<p>Here is the <strong>template</strong> for using <strong>ggplot2</strong> (copied from <em>R for Data Science</em>).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="er">&lt;</span>GEOM_FUNCTION<span class="sc">&gt;</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="sc">&lt;</span>MAPPINGS<span class="sc">&gt;</span>))</span></code></pre></div>
</div>
<div id="different-color-of-points-for-each-unique-group" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Different color of points for each unique group<a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can apply different colors by the <strong>class</strong> of each car (each car = each row of the <strong>mpg</strong> data frame).</p>
<ul>
<li><p>Include <code>class</code> variable in the <code>aes()</code> function.</p></li>
<li><p>This maps the third variable <code>class</code> into your graph.</p></li>
<li><p><code>aes()</code> means aesthetic (ex. color, shape, etc).</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-22-1.png" width="480" /></p>
<p>You can also set different shapes for each group of the data.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-23-1.png" width="480" /></p>
<p>You could also set it using aesthetic parameter such as size or transparency (not recommended) across groups. However these are not recommended as it is very hard for us to see the differences in both size and alpha as these are <strong>continuous</strong> parameters. But you get the idea. Using <code>aes()</code> in a geom function (ex. <code>geom_point()</code>), you can label different group of points.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different levels of transparency (alpha) for each group</span></span>
<span id="cb30-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb30-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-24-1.png" width="480" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different sizes of the points for each group</span></span>
<span id="cb31-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb31-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-25-1.png" width="480" /></p>
</div>
<div id="different-color-shape-for-each-group" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Different color &amp; shape for each group<a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also apply different color &amp; shape for each group of the data.</p>
<p><strong>Exercise</strong>: Try it on your own before you look at the code below.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb32-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class,</span>
<span id="cb32-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb32-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" width="480" /></p>
</div>
<div id="same-shape-across-all-groups" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Same shape across all groups<a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far, you have put variables such as <code>shape</code> and <code>color</code> inside the function <code>aes()</code>. This can enable you to apply different shape and color for each group.</p>
<p>If you put the variable for <code>shape</code>, <code>color</code>, <code>size</code> outside of <code>aes()</code> in the geom function, then all data points will have the specified <code>shape</code>, <code>color</code>, etc even if they are in different groups.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy,</span>
<span id="cb33-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb33-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">17</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-27-1.png" width="480" /></p>
<p>Notice that the <code>color</code> is different for each group because it is inside the function <code>aes()</code>. However, all the points are triangle because we have typed <code>shape = 17</code> outside the function <code>aes()</code>.</p>
<p><strong>Exercise:</strong> try changing the shape of the points to the circle with the border.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="img/shape.jpg" alt="image from http://www.sthda.com/english/wiki/ggplot2-point-shapes" width="25%" />
<p class="caption">
Figure 3.1: image from <a href="http://www.sthda.com/english/wiki/ggplot2-point-shapes" class="uri">http://www.sthda.com/english/wiki/ggplot2-point-shapes</a>
</p>
</div>
<ul>
<li><p><code>shape = 19</code>: the shape is circle without the border.</p></li>
<li><p><code>shape = 20</code>: the shape is small circle without the border.</p></li>
<li><p><code>shape = 21</code>, the shape is circle with the border.</p></li>
<li><p>So let’s set <code>shape</code> to 21.</p></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb34-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-29-1.png" width="480" /></p>
<ul>
<li>Notice that the border color is different for each group, but not the color that fills the circle.</li>
<li>Shapes without their borders (15-20) are filled with <code>color</code>.</li>
<li>Shapes with the border (21-24) are filled with <code>fill</code> and its border colored with <code>color</code>.</li>
<li>So let’s change <code>color = Class</code> to <code>fill = Class</code>.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">fill =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-30-1.png" width="480" /></p>
</div>
<div id="how-do-we-draw-the-best-fit-line-of-the-graph" class="section level3 hasAnchor" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> How do we draw the best-fit line of the graph?<a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is our graph.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-31-1.png" width="336" /></p>
<p>There seems to be a negative relationship. How do we draw the best-fit line of the graph’s negative relationship? Use another geom function <code>geom_smooth()</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-32-1.png" width="336" /></p>
</div>
<div id="geom_point-geom_smooth" class="section level3 hasAnchor" number="3.2.7">
<h3><span class="header-section-number">3.2.7</span> geom_point() + geom_smooth()<a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s combine geom_point() + geom_smooth() into one graph.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb39-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-34-1.png" width="336" /></p>
<p><code>ggplot()</code> acts as a system where you can add multiple <code>geom</code> objects, such as <code>geom_point()</code> and <code>geom_smooth()</code>. You can add multiple layers of geom in a single plot, like shown here.</p>
<p><code>ggplot()</code> and <strong>at least one geom</strong> function are necessary to draw a graph. <code>ggplot()</code> alone does not draw a graph. Try it on your own.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-35-1.png" width="336" /></p>
</div>
<div id="writing-shorter-codes" class="section level3 hasAnchor" number="3.2.8">
<h3><span class="header-section-number">3.2.8</span> Writing shorter codes<a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p>Notice that we have typed <code>mapping = aes(x = displ, y = hwy)</code> twice. This is <strong>repetitive</strong>. If you type the <code>mapping</code> argument in <code>ggplot()</code>, you won’t need to type them anymore in the subsequent <code>geom</code> functions.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-37-1.png" width="336" /></p>
<p>This is exactly the same as the previous graph. In both cases, the mapping has been set so that the x-axis is <code>displ</code> and the y-axis is <code>hwy</code> in both <code>geom_point()</code> and <code>geom_smooth()</code>.</p>
<p>Now let’s apply different color of points and the fit the line for each group.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-38-1.png" width="480" /></p>
<p>Okay, this is extremely messy and probably a bad idea.</p>
<ul>
<li>You might have gotten <code>warnings</code> but you can usually ignore them.</li>
</ul>
<p>Let’s plot the best-fit line across all groups (i.e., one best-fit line) but apply different color for each class (i.e., many colors). To do so, type <code>color = class</code> in geom_point, not <code>ggplot()</code>. This enables you to specify that you will apply different color for each class <strong>only</strong> in <code>geom_point()</code> but not in <code>geom_smooth()</code>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-39-1.png" width="480" /></p>
</div>
</div>
<div id="improve-data-visualization-using-smplot2" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Improve data visualization using smplot2<a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Although the default theme of ggplot2 graphs is clean, there are some things that I do not like:</p>
<ul>
<li><p>The fonts are too small.</p></li>
<li><p>The grey background is distracting.</p></li>
<li><p>There are too many grids.</p></li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb49-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-40-1.png" width="480" /></p>
<p>Let’s make this graph prettier by using functions from <strong>smplot2</strong>.
- In this example, let’s use <code>sm_hvgrid()</code>. I’ve made this function as a theme suitable for correlation plots.
- Disclaimer: <strong>smplot2</strong> package has been built based on my preference.
- <strong>smplot2</strong> is not necessary to make a <strong>ggplot</strong> graph or change its style.</p>
<p>It is possible to change every aspect of the graph with <strong>ggplot2</strong> but this requires about 8-20 lines of codes (based on my experience). Instead, <strong>smplot2</strong> function does so in a few lines of code.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb50-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-41-1.png" width="480" /></p>
<p>Now let’s remove the border within <code>sm_hvgrid()</code> by setting <code>borders = FALSE</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb51-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb51-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-42-1.png" width="480" /></p>
<p><strong>Exercise:</strong> You can also set <code>borders = TRUE</code> and see what happens.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb52-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb52-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>(<span class="at">borders =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>You might notice that borders come back. This is exactly what happens when you do not include <code>borders</code> argument in <code>sm_hvgrid()</code>. This is because <code>sm_hvgrid()</code> is set to <code>borders = TRUE</code> as default.</p>
<ul>
<li>I think the one with the border looks better.</li>
<li>You can also remove the legend by setting <code>legends = FALSE</code> in <code>sm_hvgrid()</code>.</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb53-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb53-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-1.png" width="336" /></p>
<p><strong>Exercise</strong> Set <code>legends = TRUE</code> and see what happens. Type <code>?sm_hvgrid</code> to see why legends appear without directly writing <code>legends = TRUE</code>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb54-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb54-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>However, in this case, I think we need a legend because there are many <strong>classes</strong>.</p>
<div id="positive-relationship-between-x--and-y-axes" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Positive relationship between x- and y-axes<a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s plot another scatterplot using <strong>mtcars</strong> data.</p>
<ul>
<li>Set the x-axis with <strong>drat</strong> and y-axis with <strong>mpg</strong>.</li>
<li>Since you are making a scatterplot, you will need to use <code>geom_point()</code>.</li>
<li>Set the <strong>size</strong> of all points to <strong>3</strong> by typing <code>size = 3</code>.</li>
<li>Set the <strong>shape</strong> of all points to the circle with a border by typing <code>shape = 21</code>.</li>
<li>Set the <strong>filled color</strong> of all points to <strong>green</strong> by typing <code>fill = '#0f993d'</code>.</li>
<li>Set the <strong>border color</strong> to <strong>white</strong> by typing <code>color = 'white'</code>.
<ul>
<li>Since <code>shape = 21</code> refers to the circle with a border, <code>fill</code> is the color that fills the points and <code>color</code> is the border color.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb55-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb55-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-46-1.png" width="336" /></p>
<p><strong>drat</strong> and <strong>mpg</strong> have a positive relationship. Now let’s make it pretty by adding <code>sm_hvgrid()</code>, which has major horizontal and vertical grids on a white background.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb56-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-47-1.png" width="336" /></p>
<p>You can remove borders too by setting <code>borders = FALSE</code> in <code>sm_hvgrid()</code>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb57-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb57-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-48-1.png" width="336" /></p>
</div>
<div id="reporting-statistics-from-a-paired-correlation" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Reporting statistics from a paired correlation<a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>smplot2</strong> also offers a function that plots the best-fit line of a scatterplot (i.e., correlation plot) and prints statistical values, such as p- and R-values.</p>
<ul>
<li>p-value is used to check for statistical significance. If it’s less than 0.05, its regarded as <strong>statistically significant</strong>. However, it gets smaller with a larger sample size.</li>
<li>R-value (correlation coefficient) measures the strength and the direction of the correlation. It ranges from -1 to 1. It does not depend on the sample size.</li>
<li>Let’s add a function <code>sm_statCorr()</code>. The statistical results are from Pearson’s correlation test.</li>
</ul>
<p><code>sm_statCorr()</code> is combined with <code>sm_hvgrid()</code> (updated in smplot2). Therefore, when you print the statstical values using <code>sm_statCorr()</code>, the correlation theme is automatically used.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-49-1.png" width="336" /></p>
<p>I don’t really like how the line color is different from that of the points.</p>
<p>Let’s change the color to green.</p>
<ul>
<li>You can also change the <code>linetype</code> by setting it as <code>linetype = 'dashed'</code> or <code>linetype = 'solid'</code>, which is the default as shown here.</li>
<li>Also let’s get results from Spearman’s correlation test rather than from Pearson’s.</li>
<li>To do so, type <code>corr_method = 'spearman'</code> in the function <code>sm_statCorr()</code>. You will get a different <strong>R</strong> value from 0.68, which is from Pearson’s correlation test.</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb60-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb60-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-50-1.png" width="336" /></p>
<ul>
<li><strong>Exercise</strong>: Set <code>corr_method = 'pearson'</code>and see what happens.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb62-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>)</span></code></pre></div>
<p>You will see that this is exactly the same as when <code>corr_method</code> argument is not included in <code>sm_statCorr()</code>. In short, the <strong>default</strong> correlation method for <code>sm_statCorr()</code> is <code>'pearson'</code>. So, if you don’t write anything for <code>corr_method</code>, it will give results from Pearson’s correlation test. Type <code>?sm_statCorr</code> to see the default of <code>line_type</code>.</p>
<ul>
<li><code>#0f993d</code> is a specific green that I like.</li>
<li>Now, let’s change the color. Replace <code>'#0f993d'</code> with <code>'green'</code> in <code>geom_point()</code> and <code>sm_statCorr</code>.
<ul>
<li>This <code>'green'</code> is the default green color of <strong>R</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb63-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;green&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb63-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-52-1.png" width="336" /></p>
<p>To precisely change the parameter for the fitted line, you can do it as shown below by filling the <code>fit.params</code> argument in the form of <code>list</code>, such as <code>fit.params = list(color = ..., linetype = ...)</code>.</p>
<ul>
<li><code>fit.params</code> feeds arguments for aesthetics into <code>geom_smooth()</code> such as <code>color</code> so that the fitted regression line can have specified aesthetics.</li>
</ul>
<p>In fact, this is the major update of <strong>smplot2</strong> across most visualizing functions from <strong>smplot</strong>. As you will notice later, this offers more aesthetic flexibility for users.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb65-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb65-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb65-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb65-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb65-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-53-1.png" width="336" /></p>
<p>You can also remove the <code>borders</code> of the plot using <code>sm_statCorr</code>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb67-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb67-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb67-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb67-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb67-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb67-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb67-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-54-1.png" width="336" /></p>
<p>Which one do you prefer? With or without the border?</p>
</div>
<div id="changing-the-text" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Changing the text<a href="basics-of-ggplot2-and-correlation-plot.html#changing-the-text" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you do not like the fact that the correlation stats are displayed as <code>R = 0.65, p &lt; 0.001</code> and that you rather show it as <code>R = 0.65</code> and <code>p &lt; 0.001</code> in separate lines, you can do it too.</p>
<p>In <code>R</code>, <code>\n</code> means addition of a new line. So you can set the argument <code>separate_by = '\n'</code>, which essentially means <code>R = 0.65\n p &lt; 0.001</code>, which will create two lines.</p>
<p>You would test this directly by typing in R console.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;R = 0.65</span><span class="sc">\n</span><span class="st">p &lt; 0.001&#39;</span>)</span></code></pre></div>
<pre><code>## R = 0.65
## p &lt; 0.001</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb71-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb71-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb71-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb71-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb71-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb71-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>), </span>
<span id="cb71-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb71-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">separate_by =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-56-1.png" width="336" /></p>
<p>Another way is just do directly compute it yourself using <code>cor()</code> or <code>cor.test()</code>, and annotate the statistical results on the plot. This might be a better alternative if you wish to precisely modify how the text is presented.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>mpg, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  mtcars$drat and mtcars$mpg
## S = 1901.7, p-value = 5.381e-05
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.6514555</code></pre>
<p>Store the results from <code>cor.test()</code> into a variable called <code>res</code>, which is short for <strong>results</strong>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb75-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>mpg, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb75-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb75-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>p.value </span></code></pre></div>
<pre><code>## [1] 5.381347e-05</code></pre>
<p>You can extract certain component of the results from <code>cor.test()</code> from the variable <code>res</code> by using <code>$</code>. <code>res$p.value</code> extracts the p-value, and <code>res$estimate</code> extracts the correlation coefficient <code>R</code>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb77-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>estimate</span></code></pre></div>
<pre><code>##       rho 
## 0.6514555</code></pre>
<p>We will round the values to 2 decimal points using <code>round(..., 2)</code>, where 2 denotes the number of decimal places. <code>paste0()</code> is used to construct strings from various vectors, such as the numerical values extracted from <code>res</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb79-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">32</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;R =&#39;</span>, </span>
<span id="cb79-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">round</span>(res<span class="sc">$</span>estimate,<span class="dv">2</span>),</span>
<span id="cb79-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-5" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">&#39;</span><span class="sc">\n</span><span class="st">   p &lt; 0.001&#39;</span>)) <span class="sc">+</span></span>
<span id="cb79-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">show_text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-7"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb79-8"><a href="basics-of-ggplot2-and-correlation-plot.html#cb79-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-60-1.png" width="336" /></p>
</div>
<div id="plotting-the-average-with-standard-errors" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Plotting the average with standard errors<a href="basics-of-ggplot2-and-correlation-plot.html#plotting-the-average-with-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>smplot2</strong> also offers <code>sm_corr_avgErr()</code>, which is a function that enables the users to plot the mean with errors, such as standard error (<code>errorbar_type = 'se'</code> as default), standard deviation (<code>errorbar_type = 'sd'</code>) or 95% confidence interval (<code>errorbar_type = 'ci'</code>).</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb81-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb81-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-61-1.png" width="336" /></p>
<p>The black point in the middle represents the mean with vertical and horizontal standard errors.</p>
<p>The <code>data</code> argument of <code>sm_corr_avgErr</code> requires the variable that stores the data frame that is used to plot the data, which is <code>mtcars</code>. <code>x</code> argument is the variable that is plotted along the x-axis. <code>y</code> argument is the variable that is plotted along the y-axis. Actually these arguments are nearly identical to what you have provided <code>ggplot(data = ..., aes(x = ..., y = ...)</code>.</p>
<p>You can control the aesthetics with a high flexibility using <code>point.params</code>, <code>errh.params</code> and <code>errv.params</code>.</p>
<ul>
<li><p><code>point.params</code> feeds the arguments to <code>geom_point()</code>, such as <code>color</code>, <code>alpha</code>, etc, to plot the average point.</p></li>
<li><p><code>errv.params</code> feeds the arguments to <code>geom_errorbar()</code>, such as <code>color</code>, <code>size</code> and <code>width</code> etc, to plot the vertical (y-axis) error bar.</p></li>
<li><p><code>errh.params</code> feeds the arguments to <code>geom_errorbarh()</code>, such as <code>color</code>, <code>size</code> and <code>height</code> etc, to plot the horizontal (x-axis) error bar.</p></li>
</ul>
<p>If you write <code>xxx.params = list()</code>, even with empty ones, you will remove the defaults of <code>sm_corr_avgErr()</code>, which has default of <code>width = 0</code> (for <code>errv.params</code>) / <code>height = 0</code> (for <code>errh.params</code>). <code>width</code> and <code>height</code> are equivalent.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb82-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb82-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb82-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb82-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(),</span>
<span id="cb82-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb82-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb82-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-62-1.png" width="336" /></p>
<p>After removing the defaults, we see that <code>width</code> of <code>errv.params</code> and <code>height</code> of <code>errh.params</code> are no longer 0. We can control both <code>width</code> and <code>height</code> separately.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb83-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb83-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb83-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb83-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>),</span>
<span id="cb83-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb83-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>)) <span class="sc">+</span></span>
<span id="cb83-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-63-1.png" width="336" /></p>
<p>In this case, <code>height</code> is much longer because the scale of y-axis is much longer than that of x-axis. We can also set unique colors to horizontal and vertical error bars.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb84-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb84-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb84-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb84-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#1262b3&quot;</span>),</span>
<span id="cb84-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb84-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">color =</span> <span class="st">&quot;#cc3d3d&quot;</span>)) <span class="sc">+</span></span>
<span id="cb84-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-64-1.png" width="336" /></p>
<p>The error bar might appear too thin and the average point too small. We can control the <code>size</code> to make it more noticeable in the plot.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb85-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb85-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb85-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb85-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#1262b3&quot;</span>,</span>
<span id="cb85-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>),</span>
<span id="cb85-7"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">color =</span> <span class="st">&quot;#cc3d3d&quot;</span>,</span>
<span id="cb85-8"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb85-9"><a href="basics-of-ggplot2-and-correlation-plot.html#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-65-1.png" width="336" /></p>
<p>We can control the transparency of the individual points and fine tune the aesthetics of the average point to make it more noticeable in the sea of individual points.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb86-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb86-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb86-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb86-5"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb86-6"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> <span class="st">&#39;black&#39;</span>),</span>
<span id="cb86-7"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#1262b3&quot;</span>,</span>
<span id="cb86-8"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>),</span>
<span id="cb86-9"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">color =</span> <span class="st">&quot;#cc3d3d&quot;</span>,</span>
<span id="cb86-10"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb86-11"><a href="basics-of-ggplot2-and-correlation-plot.html#cb86-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-66-1.png" width="336" /></p>
<p>Notice that the transparency of the individual point allows us see that there are some points with some serious overlap.</p>
</div>
<div id="fill-0f993d-vs-fill-green" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I personally like <code>#0f993d</code> more. However, <strong>R</strong> does not recognize this color as <code>green</code>. So how are you supposed to remember the color code?</p>
<p>You do not have to. You can type <code>sm_color('green')</code> instead. This is a function from the <strong>smplot</strong> package.</p>
<p><code>sm_color()</code> accepts the name of the color. If you want to get the hex codes (color codes) for red and green, type <code>sm_color('red','green')</code>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<p>Again, <code>sm_color()</code> has been built based on my preference. So it returns the hex codes of colors that I use most often.</p>
<p>There are many more color themes that are available in R. For more information, please check out Chapter 28 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/graphics-for-communication.html" class="uri">https://r4ds.had.co.nz/graphics-for-communication.html</a>).</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb88-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb88-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>() <span class="sc">+</span> </span>
<span id="cb88-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-68-1.png" width="336" /></p>
<p><strong>Exercise</strong> Change the color of the points and the best-fit line to <code>blue</code> using <code>sm_color()</code>. If you want to see all the color options for <code>sm_color()</code>, type <code>?sm_color</code>. There are 16 colors total.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb89-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb89-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>() <span class="sc">+</span> </span>
<span id="cb89-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
</div>
<div id="different-color-for-each-group-but-with-other-colors" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> Different color for each group but with other colors<a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s go back to the <strong>mpg</strong> data. Set the x-axis with <strong>displ</strong> and y-axis with <strong>hwy</strong>. Then make a scatterplot using <code>geom_point()</code>.
- Set the size of the points to 2 across all groups. So type <code>size = 2</code> outside of <code>aes()</code> in <code>geom_point()</code>.</p>
<p>Let’s apply different color for each <code>class</code> of the cars by writing <code>color = class</code> in <code>aes()</code> from <code>ggplot()</code>.</p>
<ul>
<li><code>fill = class</code> is needed when the shape of the point is set to 21-25.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb90-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-70-1.png" width="480" /></p>
<p>To use other colors, we could use a function from <strong>ggplot2</strong> called <code>scale_color_manual()</code>.</p>
<ul>
<li><code>scale_fill_manual()</code> is used when the shape of the point has borders (shape = 21-25).</li>
</ul>
<p>To find how many colors we need total, we need to find how many groups exist.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb91-1" aria-hidden="true" tabindex="-1"></a>unique_classes <span class="ot">&lt;-</span> <span class="fu">unique</span>(mpg<span class="sc">$</span>class)</span></code></pre></div>
<p>In R, you can extract data from one column by using <code>$</code>. You can try it with different variables too. <code>unique()</code> returns unique values in the selected data.
Then compute the number of unique values using <code>length()</code> function.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb92-1" aria-hidden="true" tabindex="-1"></a>number_of_classes <span class="ot">&lt;-</span> <span class="fu">length</span>(unique_classes)</span>
<span id="cb92-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb92-2" aria-hidden="true" tabindex="-1"></a>number_of_classes</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p><code>sm_palette</code> accepts the number of colors as input. It returns colors that I use most often. Now that we know we need 7 colors total, we can type <code>sm_palette(7)</code> or <code>sm_palette(number_of_classes)</code> for <code>values</code> in <code>scale_color_manual()</code>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb94-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb94-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-73-1.png" width="480" /></p>
<p>Let’s store this graph using a <strong>variable</strong> called <code>figure1</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb95-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb95-2"><a href="basics-of-ggplot2-and-correlation-plot.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb95-3"><a href="basics-of-ggplot2-and-correlation-plot.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb95-4"><a href="basics-of-ggplot2-and-correlation-plot.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hvgrid</span>()</span></code></pre></div>
<p><strong>Notice that when you store a figure into a variable, the figure is not displayed</strong> when you run the code that makes the figure, ex. <code>figure1 &lt;- ggplot(data = mpg, mapping = ...</code>. To display the figure, please type the variable name in the console.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb96-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="co"># it will appear again by calling this variable </span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-75-1.png" width="480" /></p>
</div>
<div id="lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1." class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.<a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To save the figure as an image, we will use the function <code>save_plot()</code> from the <strong>cowplot</strong> package.</p>
<ul>
<li><p>There is one important argument: <code>base_asp</code>.</p>
<ul>
<li>This is the ratio of your image (width/height). I usually set it to 1.4. So let’s type <code>base_asp = 1.4</code> in <code>save_plot()</code>.</li>
<li>If <code>base_asp</code> is larger than 1, it gets wider than its height. This is recommended when you have a legend.</li>
<li>If there is no legend, then <code>base_asp = 1</code> is recommended.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1.png&#39;</span>, figure1, <span class="at">base_asp =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<p><strong>Exercise</strong>: try to save it again with a name <strong>figure1b.png</strong> by typing:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="basics-of-ggplot2-and-correlation-plot.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1b.png&#39;</span>, figure1)</span></code></pre></div>
<p>How’s the picture? Why does it look different? Type <code>?save_plot</code> to see what the default <code>base_asp</code> is.</p>
<p>Done! The graph (in png file) should be in your <strong>LearnR</strong> folder.</p>
<p><strong>Exercise:</strong> Try to open Microsoft Word or PowerPoint and upload <strong>figure1</strong>. The figure should look the same as it appears in the slides.</p>
<p><strong>Exercise:</strong> Remove the legend and save the scatterplot with <code>base_asp = 1</code>.</p>
<p>Congratulations! You can now make <strong>correlation plots</strong> with R.</p>
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Summary<a href="basics-of-ggplot2-and-correlation-plot.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>You have learned the basics of <strong>ggplot</strong>.
<ul>
<li>You begin by writing a <code>ggplot()</code> function.</li>
<li>If aesthetics (color, shape, etc) are specified outside of <code>aes()</code> function, then there is no group difference.</li>
<li>If aesthetics are specified in <code>aes()</code>, different groups of data will have different looks.</li>
<li>You have learned to add geom layers such as <code>geom_point()</code>, which shows points, and <code>geom_smooth()</code>, which plots the best-fit function.</li>
<li>You have learned to plot <code>geom_point()</code> and <code>geom_smooth()</code> in the same graph.</li>
</ul></li>
<li><strong>smplot2</strong> functions can be used to improve <strong>ggplot2</strong> visually.
<ul>
<li>For correlation plots, add <code>sm_hvgrid()</code>.</li>
<li>You can report statistical results and plot linear regression from correlation by <code>sm_statCorr()</code>, which also provides <code>sm_hvgrid()</code>. So there is no need to write <code>sm_hvgrid()</code> when using <code>sm_statCorr()</code>.</li>
<li>You can also select colors using <code>sm_color()</code>.</li>
</ul></li>
<li>Save the graph as an image file in your working directory.
<ul>
<li>Working directory has to be set in RStudio (<strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>)</li>
<li>Then use <code>save_plot()</code> from <strong>cowplot</strong> to save the image in your directory (folder <strong>LearnR</strong>).</li>
</ul></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="download-rstudio-basics-of-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="boxplot-and-violin-plot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/corr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/corr.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
