<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bar Graph, Slope Chart and Point plot | Data Analysis and Visualization in R Using smplot2</title>
  <meta name="description" content="Chapter 5 Bar Graph, Slope Chart and Point plot | Data Analysis and Visualization in R Using smplot2" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bar Graph, Slope Chart and Point plot | Data Analysis and Visualization in R Using smplot2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bar Graph, Slope Chart and Point plot | Data Analysis and Visualization in R Using smplot2" />
  
  
  

<meta name="author" content="Seung Hyun Min" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="boxplot-and-violin-plot.html"/>
<link rel="next" href="raincloud-and-forest-plots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation-of-smplot2"><i class="fa fa-check"></i>Installation of smplot2</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="opening-remarks.html"><a href="opening-remarks.html"><i class="fa fa-check"></i><b>1</b> Opening Remarks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="opening-remarks.html"><a href="opening-remarks.html#how-to-read-this-book"><i class="fa fa-check"></i><b>1.1</b> How to read this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>2</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="2.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>2.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>2.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Visualization with smplot2</b></span></li>
<li class="chapter" data-level="3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>3</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>3.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i><b>3.1.1</b> Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i><b>3.2.1</b> Let’s make some graphs</a></li>
<li class="chapter" data-level="3.2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i><b>3.2.2</b> How ggplot works</a></li>
<li class="chapter" data-level="3.2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i><b>3.2.3</b> Different color of points for each unique group</a></li>
<li class="chapter" data-level="3.2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i><b>3.2.4</b> Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="3.2.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i><b>3.2.5</b> Same shape across all groups</a></li>
<li class="chapter" data-level="3.2.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i><b>3.2.6</b> How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="3.2.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i><b>3.2.7</b> geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="3.2.8" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i><b>3.2.8</b> Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot2"><i class="fa fa-check"></i><b>3.3</b> Improve data visualization using smplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i><b>3.3.1</b> Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i><b>3.3.2</b> Reporting statistics from a paired correlation</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#changing-the-text"><i class="fa fa-check"></i><b>3.3.3</b> Changing the text</a></li>
<li class="chapter" data-level="3.3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#plotting-the-average-with-standard-errors"><i class="fa fa-check"></i><b>3.3.4</b> Plotting the average with standard errors</a></li>
<li class="chapter" data-level="3.3.5" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><i class="fa fa-check"></i><b>3.3.5</b> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i><b>3.3.6</b> Different color for each group but with other colors</a></li>
<li class="chapter" data-level="3.3.7" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1."><i class="fa fa-check"></i><b>3.3.7</b> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>4</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>4.1</b> Upload sample data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i><b>4.1.1</b> Download requirements</a></li>
<li class="chapter" data-level="4.1.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i><b>4.1.2</b> Before we get started</a></li>
<li class="chapter" data-level="4.1.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i><b>4.1.3</b> data.csv</a></li>
<li class="chapter" data-level="4.1.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><i class="fa fa-check"></i><b>4.1.4</b> <code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i><b>4.1.5</b> Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>4.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i><b>4.2.1</b> What is a boxplot?</a></li>
<li class="chapter" data-level="4.2.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i><b>4.2.2</b> Boxplot vs bar graph</a></li>
<li class="chapter" data-level="4.2.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.3</b> Boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i><b>4.2.4</b> Problem: Alphabetical order</a></li>
<li class="chapter" data-level="4.2.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i><b>4.2.5</b> Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="4.2.6" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i><b>4.2.6</b> Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="4.2.7" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i><b>4.2.7</b> Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="4.2.8" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i><b>4.2.8</b> A boxplot with individual data</a></li>
<li class="chapter" data-level="4.2.9" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><i class="fa fa-check"></i><b>4.2.9</b> <code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="4.2.10" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i><b>4.2.10</b> Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>4.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i><b>4.3.1</b> Structure of the violin plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>4.3.2</b> Violin plot with ggplot2</a></li>
<li class="chapter" data-level="4.3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i><b>4.3.3</b> Violin plot with individual points</a></li>
<li class="chapter" data-level="4.3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i><b>4.3.4</b> geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="4.3.5" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i><b>4.3.5</b> Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html"><i class="fa fa-check"></i><b>5</b> Bar Graph, Slope Chart and Point plot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph"><i class="fa fa-check"></i><b>5.1</b> Bar graph</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#scaling-the-y-axis"><i class="fa fa-check"></i><b>5.1.1</b> Scaling the y-axis</a></li>
<li class="chapter" data-level="5.1.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>5.1.2</b> Plotting individual points with unique colors</a></li>
<li class="chapter" data-level="5.1.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#other-parameters"><i class="fa fa-check"></i><b>5.1.3</b> Other parameters</a></li>
<li class="chapter" data-level="5.1.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#bar-graph-with-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.1.4</b> Bar graph with data of multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart"><i class="fa fa-check"></i><b>5.2</b> Slope chart</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot"><i class="fa fa-check"></i><b>5.2.1</b> Slope chart with mean plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot-and-error-bar"><i class="fa fa-check"></i><b>5.2.2</b> Slope chart with mean plot and error bar</a></li>
<li class="chapter" data-level="5.2.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-x-levels"><i class="fa fa-check"></i><b>5.2.3</b> Slope chart with multiple x levels</a></li>
<li class="chapter" data-level="5.2.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-groups-and-x-levels"><i class="fa fa-check"></i><b>5.2.4</b> Slope chart with multiple groups and x levels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot"><i class="fa fa-check"></i><b>5.3</b> Point plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#change-the-range-of-y-axis"><i class="fa fa-check"></i><b>5.3.1</b> Change the range of y-axis</a></li>
<li class="chapter" data-level="5.3.2" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#data-with-more-than-two-groups"><i class="fa fa-check"></i><b>5.3.2</b> Data with more than two groups</a></li>
<li class="chapter" data-level="5.3.3" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-one-group"><i class="fa fa-check"></i><b>5.3.3</b> Point plot with a shadow using data of one group</a></li>
<li class="chapter" data-level="5.3.4" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>5.3.4</b> Point plot with a shadow using data of multiple groups</a></li>
<li class="chapter" data-level="5.3.5" data-path="bar-graph-slope-chart-and-point-plot.html"><a href="bar-graph-slope-chart-and-point-plot.html#adding-and-modifying-legends"><i class="fa fa-check"></i><b>5.3.5</b> Adding and modifying legends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html"><i class="fa fa-check"></i><b>6</b> Raincloud and Forest Plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot"><i class="fa fa-check"></i><b>6.1</b> Raincloud plot</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changing-the-x-axis-labels"><i class="fa fa-check"></i><b>6.1.1</b> Changing the x-axis labels</a></li>
<li class="chapter" data-level="6.1.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#separating-the-components-and-configuration"><i class="fa fa-check"></i><b>6.1.2</b> Separating the components and configuration</a></li>
<li class="chapter" data-level="6.1.3" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#changng-the-theme-and-orientation"><i class="fa fa-check"></i><b>6.1.3</b> Changng the theme and orientation</a></li>
<li class="chapter" data-level="6.1.4" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#raincloud-plot-with-data-from-multiple-groups"><i class="fa fa-check"></i><b>6.1.4</b> Raincloud plot with data from multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#forest-plot"><i class="fa fa-check"></i><b>6.2</b> Forest plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="raincloud-and-forest-plots.html"><a href="raincloud-and-forest-plots.html#plotting-the-forest-plot-using-data-of-multiple-groups"><i class="fa fa-check"></i><b>6.2.1</b> Plotting the forest plot using data of multiple groups</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Analysis with smplot2</b></span></li>
<li class="chapter" data-level="7" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html"><i class="fa fa-check"></i><b>7</b> Combining Plots with Common Axes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>7.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-for-rows"><i class="fa fa-check"></i><b>7.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="7.1.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#select-for-columns"><i class="fa fa-check"></i><b>7.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="7.1.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>7.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-the-averaged-data-with-error-bars"><i class="fa fa-check"></i><b>7.2</b> Plotting the averaged data with error bars</a></li>
<li class="chapter" data-level="7.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-individual-data"><i class="fa fa-check"></i><b>7.3</b> Plotting individual data</a></li>
<li class="chapter" data-level="7.4" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#putting-multiple-plots-together"><i class="fa fa-check"></i><b>7.4</b> Putting multiple plots together</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html"><i class="fa fa-check"></i><b>8</b> Calculating Area under a Curve</a>
<ul>
<li class="chapter" data-level="8.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#pipe"><i class="fa fa-check"></i><b>8.1</b> Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="8.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#area-under-a-curve"><i class="fa fa-check"></i><b>8.2</b> Area under a curve</a></li>
<li class="chapter" data-level="8.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#reproducing-figures-in-the-paper-min-et-al.-2019"><i class="fa fa-check"></i><b>8.3</b> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3b-a-best-fit-line-with-points-and-error-bars"><i class="fa fa-check"></i><b>8.3.1</b> Figure 3B (a best-fit line with points and error bars)</a></li>
<li class="chapter" data-level="8.3.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3d-a-bar-graph"><i class="fa fa-check"></i><b>8.3.2</b> Figure 3D (a bar graph)</a></li>
<li class="chapter" data-level="8.3.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3e-modeling-in-matlab-and-plotting-in-r"><i class="fa fa-check"></i><b>8.3.3</b> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html"><i class="fa fa-check"></i><b>9</b> Calculating Linear Slopes</a>
<ul>
<li class="chapter" data-level="9.1" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#linear-relationship-using-lm"><i class="fa fa-check"></i><b>9.1</b> Linear relationship using <code>lm()</code></a></li>
<li class="chapter" data-level="9.2" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#calculating-slopes-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>9.2</b> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>10</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-statistics.html"><a href="basic-statistics.html#one-sample-t-test"><i class="fa fa-check"></i><b>10.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="10.2" data-path="basic-statistics.html"><a href="basic-statistics.html#two-sample-t-test"><i class="fa fa-check"></i><b>10.2</b> Two-sample t-test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#shapiro-wilk-test-to-test-for-normality-of-data"><i class="fa fa-check"></i><b>10.2.1</b> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basic-statistics.html"><a href="basic-statistics.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>10.3</b> Wilcoxon Signed-rank Test</a></li>
<li class="chapter" data-level="10.4" data-path="basic-statistics.html"><a href="basic-statistics.html#effect-size"><i class="fa fa-check"></i><b>10.4</b> Effect Size</a></li>
<li class="chapter" data-level="10.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.5</b> Post-hoc Power Analysis</a></li>
<li class="chapter" data-level="10.6" data-path="basic-statistics.html"><a href="basic-statistics.html#bayes-factor"><i class="fa fa-check"></i><b>10.6</b> Bayes Factor</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#issues-with-post-hoc-power-analysis"><i class="fa fa-check"></i><b>10.6.1</b> Issues with post-hoc power analysis</a></li>
<li class="chapter" data-level="10.6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-the-bayes-factor-in-r"><i class="fa fa-check"></i><b>10.6.2</b> Computing the Bayes factor in R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>10.7</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="basic-statistics.html"><a href="basic-statistics.html#check-for-outliers"><i class="fa fa-check"></i><b>10.7.1</b> Check for Outliers</a></li>
<li class="chapter" data-level="10.7.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data"><i class="fa fa-check"></i><b>10.7.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.7.3" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-the-assumption-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>10.7.3</b> Checking the Assumption for Homogeneity of Variance</a></li>
<li class="chapter" data-level="10.7.4" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-one-way-anova"><i class="fa fa-check"></i><b>10.7.4</b> Computing One-way ANOVA</a></li>
<li class="chapter" data-level="10.7.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-tests"><i class="fa fa-check"></i><b>10.7.5</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="10.7.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>10.7.6</b> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="basic-statistics.html"><a href="basic-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>10.8</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="basic-statistics.html"><a href="basic-statistics.html#identifying-outliers"><i class="fa fa-check"></i><b>10.8.1</b> Identifying Outliers</a></li>
<li class="chapter" data-level="10.8.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data-1"><i class="fa fa-check"></i><b>10.8.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="10.8.3" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-two-way-anova"><i class="fa fa-check"></i><b>10.8.3</b> Computing Two-way ANOVA</a></li>
<li class="chapter" data-level="10.8.4" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-test"><i class="fa fa-check"></i><b>10.8.4</b> Post-hoc Test</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="basic-statistics.html"><a href="basic-statistics.html#friedman-test"><i class="fa fa-check"></i><b>10.9</b> Friedman Test</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="basic-statistics.html"><a href="basic-statistics.html#performing-friedman-test"><i class="fa fa-check"></i><b>10.9.1</b> Performing Friedman Test</a></li>
<li class="chapter" data-level="10.9.2" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-analysis"><i class="fa fa-check"></i><b>10.9.2</b> Post-hoc Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-resources"><i class="fa fa-check"></i><b>10.10</b> Extra Resources</a></li>
</ul></li>
<li class="part"><span><b>III Manual for smplot2</b></span></li>
<li class="chapter" data-level="11" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><i class="fa fa-check"></i><b>11</b> Themes, Colors, Correlations, Boxplots, Violins and Bars (Part 1)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#installation-of-the-package"><i class="fa fa-check"></i><b>11.1</b> Installation of the Package</a></li>
<li class="chapter" data-level="11.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#how-...-and-xxx.params-arguments-work"><i class="fa fa-check"></i><b>11.2</b> How <code>...</code> and <code>xxx.params</code> arguments work</a></li>
<li class="chapter" data-level="11.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#color-palette"><i class="fa fa-check"></i><b>11.3</b> Color palette</a></li>
<li class="chapter" data-level="11.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#graph-themes"><i class="fa fa-check"></i><b>11.4</b> Graph themes</a></li>
<li class="chapter" data-level="11.5" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot"><i class="fa fa-check"></i><b>11.5</b> Correlation plot</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_statcorr"><i class="fa fa-check"></i><b>11.5.1</b> <code>sm_statCorr()</code></a></li>
<li class="chapter" data-level="11.5.2" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#sm_corr_avgerr"><i class="fa fa-check"></i><b>11.5.2</b> <code>sm_corr_avgErr()</code></a></li>
<li class="chapter" data-level="11.5.3" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#structure-of-data-frame"><i class="fa fa-check"></i><b>11.5.3</b> Structure of data frame</a></li>
<li class="chapter" data-level="11.5.4" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>11.5.4</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>11.6</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>11.6.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>11.7</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>11.7.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>11.8</b> Bar plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="themes-colors-correlations-boxplots-violins-and-bars-part-1.html"><a href="themes-colors-correlations-boxplots-violins-and-bars-part-1.html#plotting-individual-points-with-unique-colors-3"><i class="fa fa-check"></i><b>11.8.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><i class="fa fa-check"></i><b>12</b> Slope Charts, Point plots, Bland-Altman, Forests, Rainclouds, Histograms (Part 2)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#slope-chart---sm_slope"><i class="fa fa-check"></i><b>12.1</b> Slope chart - <code>sm_slope()</code></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#drawing-the-mean-plot"><i class="fa fa-check"></i><b>12.1.1</b> Drawing the mean plot</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#point-plot---sm_pointplot"><i class="fa fa-check"></i><b>12.2</b> Point plot - <code>sm_pointplot()</code></a></li>
<li class="chapter" data-level="12.3" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>12.3</b> A Bland Altman plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="12.4" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#forest-plot---sm_forest"><i class="fa fa-check"></i><b>12.4</b> Forest plot - <code>sm_forest()</code></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#annotation-using-sm_forest_annot"><i class="fa fa-check"></i><b>12.4.1</b> Annotation using <code>sm_forest_annot()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>12.5</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="12.6" data-path="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html"><a href="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2.html#histogram---sm_hist"><i class="fa fa-check"></i><b>12.6</b> Histogram - <code>sm_hist()</code></a></li>
</ul></li>
<li class="part"><span><b>IV Contrast Sensitivity Function</b></span></li>
<li class="chapter" data-level="13" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>13</b> Plotting the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="13.1" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#brief-introduction"><i class="fa fa-check"></i><b>13.1</b> Brief Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#data-visualization"><i class="fa fa-check"></i><b>13.2</b> Data Visualization</a></li>
<li class="chapter" data-level="13.3" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#facetting-the-contrast-sensitivity-functions"><i class="fa fa-check"></i><b>13.3</b> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html"><i class="fa fa-check"></i><b>14</b> Area under Curve, AULCSF and R2 of the CSF</a>
<ul>
<li class="chapter" data-level="14.1" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#area-under-a-curve-1"><i class="fa fa-check"></i><b>14.1</b> Area under a Curve</a></li>
<li class="chapter" data-level="14.2" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#sm_trapz-sm_aulcsf-and-sm_r2"><i class="fa fa-check"></i><b>14.2</b> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
<li class="chapter" data-level="14.3" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#calculating-area-and-r2-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>14.3</b> Calculating area and R2 of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="14.4" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#case-study"><i class="fa fa-check"></i><b>14.4</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>15</b> Understanding the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="15.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#contrast-sensitivity-function-model"><i class="fa fa-check"></i><b>15.1</b> Contrast Sensitivity Function Model</a></li>
<li class="chapter" data-level="15.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_csf"><i class="fa fa-check"></i><b>15.2</b> Understanding <code>sm_CSF()</code></a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_params"><i class="fa fa-check"></i><b>15.2.1</b> <code>sm_params()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_cutoff"><i class="fa fa-check"></i><b>15.2.2</b> <code>sm_cutOff()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_ribboncsf"><i class="fa fa-check"></i><b>15.3</b> Understanding <code>sm_ribbonCSF()</code></a></li>
<li class="chapter" data-level="15.4" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#calculating-the-five-parameters-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>15.4</b> Calculating the five parameters of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="15.5" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#visualization-of-the-parameters"><i class="fa fa-check"></i><b>15.5</b> Visualization of the parameters</a></li>
<li class="chapter" data-level="15.6" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#case-study-1"><i class="fa fa-check"></i><b>15.6</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html"><i class="fa fa-check"></i><b>16</b> Factor Analysis and CSF</a>
<ul>
<li class="chapter" data-level="16.1" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#eigenvalues"><i class="fa fa-check"></i><b>16.1</b> Eigenvalues</a></li>
<li class="chapter" data-level="16.2" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#parallel-analysis"><i class="fa fa-check"></i><b>16.2</b> Parallel analysis</a></li>
<li class="chapter" data-level="16.3" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#non-parametric-bootstrapping"><i class="fa fa-check"></i><b>16.3</b> Non-parametric bootstrapping</a></li>
<li class="chapter" data-level="16.4" data-path="factor-analysis-and-csf.html"><a href="factor-analysis-and-csf.html#factor-analysis"><i class="fa fa-check"></i><b>16.4</b> Factor Analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bar-graph-slope-chart-and-point-plot" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Bar Graph, Slope Chart and Point plot<a href="bar-graph-slope-chart-and-point-plot.html#bar-graph-slope-chart-and-point-plot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These packages are required to be loaded in this chapter, where we will focus on drawing a bar graph, slope chart and point plot. I think these three plots are most commonly used in my research field (perceptual science).</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb156-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) </span>
<span id="cb156-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<div id="bar-graph" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Bar graph<a href="bar-graph-slope-chart-and-point-plot.html#bar-graph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Even if a bar graph does not provide as much information as a boxplot or a violin plot, it has been proved extremely useful due to its minimal aesthetics. Moreover, in general, providing a bar, jittered individual points and a respective error bar is enough in psychological research.</p>
<p>For this reason, I think that it is necessary to discuss in detail about the usage of bar graph.</p>
<p>Over time, I’ve learned that many users directly use the aesthetic defaults of <code>sm_bar()</code>. So in this chapter, we will discuss ways to overcome the defaults.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">211</span>) <span class="co"># generate random data</span></span>
<span id="cb157-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb157-2" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb157-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb157-3" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb157-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb157-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb157-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb157-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(group1,group2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb157-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb157-6" aria-hidden="true" tabindex="-1"></a>Group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Group 1&#39;</span>, <span class="st">&#39;Group 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(group1))</span>
<span id="cb157-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb157-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Group)</span></code></pre></div>
<p>After generating the random data, let’s plot a bar graph. In this case, there are two distinct instances / time points.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb158-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb158-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb158-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-123-1.png" width="336" /></p>
<p><code>sm_bar()</code> automatically uses <code>sm_hgrid()</code>, which provides horizontal major grids. Moreover, it has arguments <code>borders</code> and <code>legends</code> so that the user can wish to remove border or legend easily.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb159-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb159-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb159-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-124-1.png" width="336" /></p>
<p>The default of the error bar’s type is standard error, i.e., <code>errorbar_type = 'se'</code>. There are three options: standard error (<code>se</code>), standard deviation (<code>sd</code>) and 95% confidence interval (<code>ci</code>). The <code>sd</code> and <code>ci</code> are shown below.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb160-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb160-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb160-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-125-1.png" width="336" /></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb161-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>) <span class="sc">+</span></span>
<span id="cb161-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb161-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-126-1.png" width="336" /></p>
<p>You can also use <code>theme()</code> to finely modify the aesthetics. For instance, you can remove the title of the x-axis <code>Group</code>. <code>ylab()</code> and <code>xlab()</code> are functions to modify the title of y- and x-axes.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb162-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb162-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb162-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb162-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb162-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-127-1.png" width="336" /></p>
<div id="scaling-the-y-axis" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Scaling the y-axis<a href="bar-graph-slope-chart-and-point-plot.html#scaling-the-y-axis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Upon a closer look, we realize that the y-axis starts from below 0 even if all data are higher than 0. We can specify the y-axis limit manually using <code>scale_y_continuous()</code> between 0 and 8.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb163-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb163-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb163-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb163-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb163-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb163-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-128-1.png" width="336" /></p>
<p>Although we have specified that the y-axis limit begins from 0 and ends at 7, there is still a small margin below 0. What is going on here?</p>
<p>The default of <strong>ggplot2</strong> is that there is always a small margin below the lowest point of the y-axis limit and above the largest point of the y-axis.The empty space below 0 and above 7 can be removed by using <code>expand = c(0,0)</code> within <code>scale_y_continuous()</code>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb164-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb164-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb164-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb164-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb164-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb164-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb164-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-129-1.png" width="336" /></p>
<p>If you would like a small margin between the bottom of the plot and the bars, you could so by replacing <code>0</code> with <code>0.05</code>, i.e., <code>expand = c(0,0.05)</code>. Then the vertical margin will slightly increase.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb165-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb165-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb165-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb165-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb165-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb165-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/w-1.png" width="336" /></p>
</div>
<div id="plotting-individual-points-with-unique-colors" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Plotting individual points with unique colors<a href="bar-graph-slope-chart-and-point-plot.html#plotting-individual-points-with-unique-colors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting each point with distinct color is possible if each color is specified for each subject as part of the aesthetics, i.e., <code>aes(..., color = Subject)</code>, where <code>Subject</code> is the name of the data frame’s column that provides identifiers for each observation/person.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb166-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb166-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb166-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb166-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb166-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb166-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-130-1.png" width="336" /></p>
</div>
<div id="other-parameters" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Other parameters<a href="bar-graph-slope-chart-and-point-plot.html#other-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also control the jitter’s width by setting <code>point_jitter_width</code>. The default is <code>sm_bar(..., point_jitter_width = 0.12)</code>. Let’s increase it to <code>0.2</code>.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb167-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb167-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb167-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb167-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb167-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb167-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-131-1.png" width="336" /></p>
<p>You can also adjust different parameters of the bar graph using <code>bar.params</code>, <code>err.params</code> and <code>point.params</code>.</p>
<ul>
<li><p><code>bar.params = list()</code> feeds arguments, such as <code>color</code>, <code>fill</code>, <code>width</code> and <code>alpha</code> to <code>geom_bar()</code> to plot the bar.</p></li>
<li><p><code>err.params = list()</code> feeds arguments, such as <code>color</code>, to <code>geom_linerange()</code> to plot the error bar.</p></li>
<li><p><code>point.params = list()</code> feeds arguments, such as <code>color</code>, <code>fill</code>, and <code>alpha</code> to <code>geom_point()</code> to plot the jittered individual points.</p></li>
<li><p><code>...</code> is generic argument that can affect the bar graph, error bar and points if these do not have defaults set within <code>bar.params = list()</code>, <code>err.params = list()</code> and <code>point.params = list()</code>.</p></li>
</ul>
<p>In the example below, various aspects of the plot have been modified, such as the bar’s <code>width</code>, <code>alpha</code> as well as points’ <code>stroke</code>, which refers to the thickness of their border.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb168-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">&#39;gray80&#39;</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb168-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb168-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span><span class="st">&#39;white&#39;</span>, </span>
<span id="cb168-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb168-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">stroke =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb168-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb168-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-132-1.png" width="336" /></p>
<p>Now, let’s get rid of all the defaults imposed by <code>sm_bar()</code> to see what happens by including <code>bar.params = list()</code> and <code>point.params = list()</code>.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb169-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb169-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb169-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb169-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb169-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb169-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb169-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-133-1.png" width="336" /></p>
<p>Now, the <code>size</code> of the point is smaller. Let’s add <code>size</code> as a generic paramater to control for the aesthetics.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb170-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb170-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb170-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb170-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb170-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb170-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb170-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb170-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-134-1.png" width="336" /></p>
<p>In this case, <code>size</code> affects both the points and the error bar, but not the bar plot because <code>geom_bar()</code> does not accept <code>size</code> as argument.</p>
<p>How about <code>width</code>?</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb171-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb171-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb171-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb171-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb171-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb171-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb171-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb171-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<pre><code>## Warning in geom_point(position = &lt;environment&gt;, width = 0.5): Ignoring unknown
## parameters: `width`</code></pre>
<pre><code>## Warning in stat_summary(fun.data = function (x, mult = 1) : Ignoring unknown
## parameters: `width`</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-135-1.png" width="336" /></p>
<p>We see that <code>width</code> only affects the bar’s <code>width</code> because it does not affect the points and error bars as shown by the warning above <code>Ignoring unknown parameters: width</code>.</p>
<p>Let’s try <code>fill</code> and <code>color</code> next by setting them to black.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb174-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb174-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb174-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb174-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb174-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb174-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb174-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb174-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) </span></code></pre></div>
<pre><code>## Warning in stat_summary(fun.data = function (x, mult = 1) : Ignoring unknown
## parameters: `fill`</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-136-1.png" width="336" /></p>
<p>We see that everything is <code>'black'</code> now, affecting across the bar, error bar and the points. Now, as previously mentioned in the previous chapter, if we add parameters within <code>xxx.params</code>, we see that these parameters will ignore the generic ones.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb176-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb176-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb176-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.80</span>),</span>
<span id="cb176-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb176-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;gray90&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb176-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb176-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="fl">2.5</span>),</span>
<span id="cb176-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb176-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb176-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-137-1.png" width="336" /></p>
<p>You can also set to remove the points by using <code>points</code> argument.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb177-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb177-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.80</span>),</span>
<span id="cb177-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;gray90&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb177-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="fl">2.5</span>),</span>
<span id="cb177-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb177-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb177-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb177-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-138-1.png" width="336" /></p>
<p>Obviously, this is not a good bar graph because we cannot see where the error bar begins. We can change the colors to <code>blue</code> and <code>orange</code> for each x level.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb178-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>),</span>
<span id="cb178-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb178-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb178-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb178-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb178-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb178-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb178-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb178-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-139-1.png" width="336" /></p>
<p>We can see that <code>sm_bar()</code> can offer a huge flexibility for users to control over the aesthetics with relative ease while maintaining the minimalistic style.</p>
</div>
<div id="bar-graph-with-data-of-multiple-groups" class="section level3 hasAnchor" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Bar graph with data of multiple groups<a href="bar-graph-slope-chart-and-point-plot.html#bar-graph-with-data-of-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we will load data set from online. Details about the data set are described in the section below entitled <strong>Point Plot</strong>. You do not need to understand the data set to follow this section.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb179-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>)</span></code></pre></div>
<pre><code>## Rows: 200 Columns: 5
## -- Column specification ----------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (3): Subject, Group, Condition
## dbl (2): absBP, SF
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb181-1" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>)  </span>
<span id="cb181-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb181-2" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, SF <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">8</span>))</span>
<span id="cb181-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb181-3" aria-hidden="true" tabindex="-1"></a>df2a<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2a<span class="sc">$</span>SF)</span>
<span id="cb181-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb181-4" aria-hidden="true" tabindex="-1"></a>df2a<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2a<span class="sc">$</span>Group)</span>
<span id="cb181-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2a<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] Amblyopia Normal   
## Levels: Amblyopia Normal</code></pre>
<p>We see that there are two groups in the data set: <code>Amblyopia</code> and <code>Normal</code>.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2a<span class="sc">$</span>SF)</span></code></pre></div>
<pre><code>## [1] 0.5 8  
## Levels: 0.5 8</code></pre>
<p>Also there are two conditions <code>SF</code>: <code>0.5</code> and <code>8</code>.</p>
<p>Ideally, a plot that shows the data of these two groups and conditions would be very informative. Let’s attempt to plot such a bar graph.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> SF)) <span class="sc">+</span></span>
<span id="cb185-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb185-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-142-1.png" width="336" /></p>
<p>Immediately we see that something is wrong here. There seem to be too many points in this bar graph compared to the sample size of each group per condition.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb186-1" aria-hidden="true" tabindex="-1"></a>df2amb <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2a, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb186-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb186-2" aria-hidden="true" tabindex="-1"></a>df2norm <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2a, Group <span class="sc">==</span> <span class="st">&#39;Normal&#39;</span>)</span>
<span id="cb186-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(df2amb<span class="sc">$</span>Subject)) <span class="co"># 10 amblyopes</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(df2norm<span class="sc">$</span>Subject)) <span class="co"># 10 normal observers</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>There are 10 subjects per group (<code>Group</code>) and condition (<code>SF</code>) but we see about 20 points per bar. It seems that the data of <code>Amblyopia</code> and <code>Normal</code> got combined at each <code>SF</code>. This is not a good representation of the data as we are interested in the difference between the two groups of observers.</p>
<p>Let’s add <code>group = Group</code> within <code>aes()</code> to group the data based on each <code>Group</code>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> SF, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb190-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb190-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-144-1.png" width="336" /></p>
<p>We see there are two error bars in the midst of the orange plots, indicating that the data are superimpsoed on top of another. Let’s change border color of the bar to verify this observation.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> SF, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb191-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb191-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb191-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>)) <span class="sc">+</span></span>
<span id="cb191-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-145-1.png" width="336" /></p>
<p>In fact, it turns out that our observation is true. We need to separate their position (i.e., <code>dodge</code>) using <code>position_dodge()</code> across all visual components of the bar graph: <code>err.params</code>, <code>bar.params</code> and <code>point.params</code>. This can be done easily by setting it as a generic parameter <code>...</code>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb192-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb192-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>),</span>
<span id="cb192-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">legends =</span> T,</span>
<span id="cb192-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb192-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb192-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> <span class="st">&#39;gray80&#39;</span>)) <span class="sc">+</span></span>
<span id="cb192-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-146-1.png" width="432" /></p>
<p>Let’s add some jitter to the points. This part is quite complicated. In this example, <code>point.params</code> has to be set separately using <code>position_jitterdodge()</code> so that the points remained jittered and dodged at the same time.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb193-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>),</span>
<span id="cb193-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb193-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb193-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> <span class="st">&#39;gray80&#39;</span>),</span>
<span id="cb193-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>,</span>
<span id="cb193-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.12</span>,</span>
<span id="cb193-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-8" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">dodge.width =</span> <span class="dv">1</span>)),</span>
<span id="cb193-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">legends =</span> T) <span class="sc">+</span></span>
<span id="cb193-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))  <span class="sc">+</span></span>
<span id="cb193-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb193-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-147-1.png" width="432" /></p>
<p>We have now successfully plotted the bar graph using data of multiple groups and conditions. Another solution is to plot each group per panel and combine the two panels into one figure using <code>sm_common_axis()</code>, which will be described in the later part of the book.</p>
</div>
</div>
<div id="slope-chart" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Slope chart<a href="bar-graph-slope-chart-and-point-plot.html#slope-chart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A slope chart is useful to describe changes between two different time points for each measurement (ex. a participant).</p>
<p>Sometimes, it is a great alternative to showing bar graph because bar graph does not show individual trends/changes.</p>
<p>Let’s generate some random data to explore this difference.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb194-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb194-2" aria-hidden="true" tabindex="-1"></a>before <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb194-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb194-3" aria-hidden="true" tabindex="-1"></a>after <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb194-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb194-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb194-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb194-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(before,after),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb194-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb194-6" aria-hidden="true" tabindex="-1"></a>beforeAfter <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(before))</span>
<span id="cb194-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb194-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, beforeAfter)</span></code></pre></div>
<p>As mentioned in the previous, factor level is important when dealing with discrete variable. In this case, the two factor levels of the data are <code>Before</code> and <code>After</code>.</p>
<p>Since, in the context of time, <code>Before</code> is the first level followed by <code>After</code>, let’s set the level properly so that the alphabetical order is overturned.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb195-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>beforeAfter <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>beforeAfter, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>))</span>
<span id="cb195-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb195-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>beforeAfter</span></code></pre></div>
<pre><code>##  [1] Before Before Before Before Before Before Before Before Before Before Before
## [12] Before Before Before Before Before Before Before Before Before After  After 
## [23] After  After  After  After  After  After  After  After  After  After  After 
## [34] After  After  After  After  After  After  After 
## Levels: Before After</code></pre>
<p>Based on the output, we have successfully ordered the factor levels. Now, we can start plotting a slope chart.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb197-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject) <span class="sc">+</span></span>
<span id="cb197-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-150-1.png" width="288" /></p>
<p>Notice that each line is grouped for each subject. For this to properly happen, <code>group</code> argument has to be specified within <code>sm_slope()</code>. In fact, due to the update from <strong>smplot2</strong>, the user is required to specify this at the level of <code>sm_slope()</code> rather than at <code>aes()</code>.</p>
<p>Also, to assign a unique color to each discrete level in x-axis, <code>fill</code> has to be specified because the default shape of the point is <code>21</code>, which is a circle with borders.</p>
<p>Now let’s add <code>labels</code> for the x-axis tick. To do so, include <code>labels = c('Before', 'After')</code>.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb198-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>)) <span class="sc">+</span></span>
<span id="cb198-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-151-1.png" width="307.2" /></p>
<p>If you would like to do statistical test that is paired, such as a paired t-test, then the apt means to visualize the data would be to use slope chart, rather than a bar graph. This is because the p-value gets smaller as a larger proportion of the sample experiences a change in the same direction (i.e., all increase). It is the direction of the overall change that is important, rather than the difference of the means from unique groups/conditions/instances.</p>
<div id="slope-chart-with-mean-plot" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Slope chart with mean plot<a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Due to several requests from students, I have added the feature of showing a mean plot using <code>sm_slope()</code> as an update from <strong>smplot2</strong>.</p>
<p>Just by setting <code>show_mean = TRUE</code>, you can draw the mean.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb199-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb199-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb199-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb199-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-152-1.png" width="307.2" /></p>
<p>When a mean plot is included in slope chart, I personally prefer to visually emphasize the mean plot while treating the individual plots as <strong>shadow</strong>. Hence, I would use similar colors across all levels. Here is an example below using blue colors. The maen plot should be slightly larger than the individual points from the shadow.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb200-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb200-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb200-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)),</span>
<span id="cb200-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb200-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb200-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb200-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb200-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb200-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb200-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-153-1.png" width="307.2" /></p>
<ul>
<li><p><code>point.params</code> feeds arguments to <code>geom_point()</code> to plot the points with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>line.params</code> feeds arguments to <code>geom_line()</code> to plot the points with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
<li><p><code>avgPoint.params</code> feeds arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>avgLine.params</code> feeds arguments to <code>geom_line()</code> to plot the average plot (line) with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
<li><p><code>err.params</code> feeds arguments to <code>geom_linerange()</code> to plot the error bar with specified <code>color</code>, <code>size</code> etc.</p></li>
<li><p><code>xtick.params</code> feeds arguments to <code>scale_x_discrete()</code> so that the user can have control over specific aesthetics of the x-tick. Type <code>?scale_x_discrete()</code> for more information.</p></li>
<li><p><code>...</code> is generic paramater that can affect multiple components of the plot.</p></li>
</ul>
<p>You can also change the <code>stroke</code> of the points and lines (thickness of the borders) as a stylistic preference. To make the <code>stroke</code> of the average points more stand out in the midst of the colors, <code>alpha</code> of the <code>points</code> can be raised.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb201-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb201-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb201-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb201-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.6</span>),</span>
<span id="cb201-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb201-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb201-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb201-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb201-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">stroke =</span> <span class="dv">1</span>),</span>
<span id="cb201-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb201-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb201-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-154-1.png" width="307.2" /></p>
<p>As before, let’s remove the defaults by providing arguments in this format <code>xxx.param = list()</code>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb202-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb202-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb202-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb202-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb202-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(),</span>
<span id="cb202-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb202-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(),</span>
<span id="cb202-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb202-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(),</span>
<span id="cb202-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb202-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-155-1.png" width="307.2" /></p>
<p>Now we see that the mean and the individual plots are indistinguishable.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb203-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb203-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb203-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb203-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb203-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(),</span>
<span id="cb203-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb203-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(),</span>
<span id="cb203-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb203-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(),</span>
<span id="cb203-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb203-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-156-1.png" width="307.2" /></p>
<p>By specifying <code>color</code> as a generic parameter (<code>...</code>) to <code>purple</code>, we have changed all components of the plot to <code>purple</code>.</p>
<p>Now we can choose specific <code>alpha</code>s for individual plots in <code>xxx.params</code> to distinguish from the mean and the individual plots.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb204-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb204-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb204-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb204-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb204-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb204-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb204-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(),</span>
<span id="cb204-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb204-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(),</span>
<span id="cb204-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb204-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-157-1.png" width="307.2" /></p>
<p>Now we see the average plot in the midst of the purple sea. Let’s enlarge it slightly by specifying the parameters within <code>avgPoint.params</code> and <code>avgLine.params</code>. We can also change the <code>shape</code> to triangle by setting the generic parameter (<code>...</code>) as <code>shape = 17</code>.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb205-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb205-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb205-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), </span>
<span id="cb205-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb205-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb205-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb205-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb205-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb205-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb205-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-158-1.png" width="307.2" /></p>
</div>
<div id="slope-chart-with-mean-plot-and-error-bar" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Slope chart with mean plot and error bar<a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-mean-plot-and-error-bar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Error bar can also be added to show either standard error (<code>errorbar_type = 'se'</code>), standard deviation (<code>errorbar_type = 'sd'</code>, default) or 95% confidence interval (<code>errorbar_type = 'ci'</code>) by setting <code>sm_slope(..., show_err = TRUE)</code>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb206-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb206-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb206-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), </span>
<span id="cb206-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb206-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb206-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb206-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb206-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb206-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb206-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb206-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-159-1.png" width="307.2" /></p>
<p>As in <code>sm_bar()</code>, you can control the specific aesthetics of the error bar using <code>err.param</code>.</p>
<ul>
<li><code>err.params = list()</code> feeds arguments, such as <code>color</code>, to <code>geom_linerange()</code> to plot the error bar.</li>
</ul>
<p>You can control the width of the error bar by changing the <code>size</code> within <code>err.params</code>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb207-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb207-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb207-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), </span>
<span id="cb207-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb207-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb207-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb207-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb207-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb207-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb207-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb207-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb207-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-160-1.png" width="307.2" /></p>
<p>This form of slope chart highly resembles a point plot with a shadow, which we will discuss below using the function <code>sm_pointplot()</code>.</p>
</div>
<div id="slope-chart-with-multiple-x-levels" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Slope chart with multiple x levels<a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-x-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Obviously, you can plot the slope chart when there are more than two discrete x levels. Let’s generate data with 3 x levels.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb208-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb208-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb208-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">7.5</span>,<span class="dv">1</span>))</span>
<span id="cb208-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb208-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb208-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-7" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb208-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb208-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<p>Since there are 3 discrete x-levels, <code>labels</code> must be modified accordingly.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb209-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb209-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb209-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb209-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb209-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb209-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb209-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb209-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb209-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb209-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb209-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb209-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-162-1.png" width="364.8" /></p>
<p>Now we have a mean plot with error bar representing standard deviation with a shadow of individual plots behind at 3 discrete x-levels.</p>
</div>
<div id="slope-chart-with-multiple-groups-and-x-levels" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Slope chart with multiple groups and x levels<a href="bar-graph-slope-chart-and-point-plot.html#slope-chart-with-multiple-groups-and-x-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb210-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb210-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb210-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">7.5</span>,<span class="dv">1</span>))</span>
<span id="cb210-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;N&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb210-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb210-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-7" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb210-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb210-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Normal&#39;</span></span>
<span id="cb210-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">191</span>) <span class="co"># generate random data</span></span>
<span id="cb210-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-12" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb210-13"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-13" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.8</span>,<span class="dv">1</span>))</span>
<span id="cb210-14"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-14" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.3</span>,<span class="dv">1</span>))</span>
<span id="cb210-15"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-15" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb210-16"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-16" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb210-17"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-17" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb210-18"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-18" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb210-19"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-19" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Patients&#39;</span></span>
<span id="cb210-20"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-21"><a href="bar-graph-slope-chart-and-point-plot.html#cb210-21" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df2)</span></code></pre></div>
<p>This data set <code>df3</code> has two groups: <code>Normal</code> and <code>Patients</code>. Each group has 20 <code>Subjects</code> and has three days of data.</p>
<p><strong>Important</strong>: each subject has to have <strong>unique</strong> identifiers. Across multiple groups, there cannot be same identifiers such as <code>S10</code>. Therefore, in this example, all <code>Normal</code> observers are listed as <code>N1</code>, <code>N2</code> etc, and all <code>Patients</code> are listd as <code>P1</code>, <code>P2</code> etc.</p>
<p>Let’s start an example without the mean plot, where <code>show_mean = FALSE</code> (i.e., default). We will provide unique <code>color</code> and <code>shape</code> to each group.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb211-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb211-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb211-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb211-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb211-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb211-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb211-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb211-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb211-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb211-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb211-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-164-1.png" width="364.8" /></p>
<p>You can also add legends by setting <code>legends = TRUE</code> and put in the upperleft part of the plot.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb212-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb212-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb212-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb212-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb212-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb212-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb212-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb212-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb212-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb212-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb212-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb212-13"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb212-14"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb212-15"><a href="bar-graph-slope-chart-and-point-plot.html#cb212-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-165-1.png" width="364.8" /></p>
<p>Next, we can also draw the mean plot for each group by setting <code>show_mean = TRUE</code>.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb213-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb213-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb213-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb213-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb213-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb213-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb213-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb213-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb213-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>,</span>
<span id="cb213-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb213-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb213-13"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb213-14"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb213-15"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb213-16"><a href="bar-graph-slope-chart-and-point-plot.html#cb213-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-166-1.png" width="364.8" /></p>
<p>Here, we see that the average line is across all presented data (from <code>Normal</code> and <code>Patients</code>). This is not what we wanted. To resolve this issue, set <code>many_groups = TRUE</code>, which then plots the average line for each group.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb214-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb214-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb214-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb214-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb214-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb214-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb214-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb214-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb214-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>,</span>
<span id="cb214-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb214-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">many_groups =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb214-13"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb214-14"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb214-15"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb214-16"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb214-17"><a href="bar-graph-slope-chart-and-point-plot.html#cb214-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-167-1.png" width="364.8" /></p>
<p>This plot can appear quite complicated. The point of this subsection is to show the flexibility of <code>sm_slope()</code>, not necessarily to talk about my preferred practices of data visualization.</p>
<p>Another solution is to draw a separate slope chart for each group and put them together using <code>sm_common_axis()</code>, which is described in the subsequent chapter called <strong>Combining Plots with Common Axes</strong> in the <strong>Data Analysis</strong> section of the book.</p>
</div>
</div>
<div id="point-plot" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Point plot<a href="bar-graph-slope-chart-and-point-plot.html#point-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will use a fake data set that I have generated by eyeballing Figure 3 from this paper (<a href="https://www.smin95.com/pubs/mao2020.pdf">PDF</a>):</p>
<p><strong>Yu Mao, Seung Hyun Min, Shijia Chen, Ling Gong, Hao Chen, Robert F. Hess, Jiawei Zhou. Binocular imbalance in amblyopia depends on spatial frequency in binocular combination. IOVS. 2020;61(8):7.</strong></p>
<p>This data set contains both subject groups (<code>Normal</code> and <code>Amblyopia</code>) and conditions (<code>Condition</code>).</p>
<p>We will only use data from the first condition (<code>Condition = 'One'</code>) and convert the numerical column <code>SF</code> into categorical column by using the <code>as.factor()</code> function.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb215-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>)</span>
<span id="cb215-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb215-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>) </span>
<span id="cb215-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb215-3" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df1<span class="sc">$</span>SF)</span></code></pre></div>
<p><code>sm_pointplot()</code> groups each observation based on a specific variable, such as <code>Subject</code> or <code>group</code>. Therefore, when <code>sm_pointplot()</code> is used, the grouping <strong>always</strong> have to be specified like the following: <code>ggplot(aes(x = ..., y = ..., group = xxx))</code>.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb216-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb216-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb216-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-169-1.png" width="336" /></p>
<p>We can customise the colors as well in a standard way using <code>sm_color_manual()</code>. The default shape of the point is <code>16</code>, therefore it has no border.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb217-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb217-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb217-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>() <span class="sc">+</span></span>
<span id="cb217-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-170-1.png" width="336" /></p>
<p>However, we see that the position of the two plots is overlapped! Therefore, we cannot see where the error bar of the <code>darkred</code> plot (<code>Normal</code>) begins and where the <code>viridian</code> plot (<code>Amblyopia</code>) ends.</p>
<p>This is where the generic variable <code>...</code> in <strong>smplot2</strong> comes in handy. You will need to <strong>dodge</strong> all components of a plot (error bar, point, line) from another plot’s entire components along the <code>x</code> axis. This can be done using the <code>position_dodge()</code> function. Otherwise, you might have to <code>dodge</code> one component by one separately.</p>
<p>The argument <code>position_dodge(width = ...)</code> determines the size of the dodging distance between the plots.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb218-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb218-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb218-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb218-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-171-1.png" width="336" /></p>
<div id="change-the-range-of-y-axis" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Change the range of y-axis<a href="bar-graph-slope-chart-and-point-plot.html#change-the-range-of-y-axis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two functions that can be used to change the range of the y-axis: <code>scale_y_continuous()</code> and <code>coord_cartesian()</code>.</p>
<p><strong>In most cases, <code>scale_y_continuous()</code> is sufficient. But for <code>sm_pointplot()</code>, use <code>coord_cartesian()</code>.</strong></p>
<p>The difference is that, when <code>sm_pointplot()</code> computes the average point from individual observations that are supplied by the data frame, if the y-axis range does not include an individual observation, then the average is computed without the observation when the y-axis range is set with <code>scale_y_continuous()</code>. On the other hand, when <code>coord_cartesian()</code> is used, the average is still computed from all individual observations.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb219-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb219-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb219-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb219-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb219-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.35</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-172-1.png" width="336" /></p>
</div>
<div id="data-with-more-than-two-groups" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Data with more than two groups<a href="bar-graph-slope-chart-and-point-plot.html#data-with-more-than-two-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What happens if we have data more than 3 groups? Let’s make a fake dataset using <code>df1</code>.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1412</span>)</span>
<span id="cb220-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-2" aria-hidden="true" tabindex="-1"></a>df1a <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb220-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-3" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>absBP <span class="ot">&lt;-</span> df1a<span class="sc">$</span>absBP <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)) </span>
<span id="cb220-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-4" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="st">&#39;Myopia&#39;</span></span>
<span id="cb220-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-5" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;M&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">5</span>)</span>
<span id="cb220-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1, df1a)</span>
<span id="cb220-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb220-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-9" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>absBP <span class="ot">&lt;-</span> df1a<span class="sc">$</span>absBP <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>)) </span>
<span id="cb220-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-10" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="st">&#39;Aniso&#39;</span></span>
<span id="cb220-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-11" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;AN&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">5</span>)</span>
<span id="cb220-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-13"><a href="bar-graph-slope-chart-and-point-plot.html#cb220-13" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df2, df1a)</span></code></pre></div>
<p>Now we have a data frame <code>df2</code> that has four groups across five spatial frequencies (<code>SF</code>).</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] &quot;Amblyopia&quot; &quot;Normal&quot;    &quot;Myopia&quot;    &quot;Aniso&quot;</code></pre>
<p>Now let’s plot a point plot using <code>sm_pointplot()</code>.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb223-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb223-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb223-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>() <span class="sc">+</span></span>
<span id="cb223-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-175-1.png" width="336" /></p>
<p>We immediately see that the plots are noticeably overlapped. This becomes a huge issue if the user attempts to plot repeated-measures data (i.e., each participant measured across time) of multiple groups/condition in a single panel. Fortunately, we can resolve this issue by using <code>position_dodge()</code>.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb224-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb224-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb224-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb224-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-176-1.png" width="336" /></p>
<p>Let’s increase the <code>width</code> more because we still see a large overlap and not see where the error bars begin and end.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb225-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb225-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb225-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>)) <span class="sc">+</span></span>
<span id="cb225-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-177-1.png" width="336" /></p>
<p>By using the function <code>position_dodge()</code>, we can see each plot quite clearly.</p>
<p>Following is the equivalent code but it only nudges the error bar because it does not take advantage of using a generic parameter <code>...</code> to control the aesthetics. Instead it uses <code>err.params = list(position = position_dodge(width = ...))</code>.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb226-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb226-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb226-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>))) <span class="sc">+</span></span>
<span id="cb226-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-178-1.png" width="336" /></p>
<p>Notice that only the error bars have shifted, not the lines and points. We can nudge all components of the plot using <code>xxx.params</code>. These are:</p>
<ul>
<li><p><code>err.params</code> feeds arguments to <code>geom_linerange()</code> to plot the error bar with specified <code>color</code>, <code>size</code> etc.</p></li>
<li><p><code>avgPoint.params</code> feeds arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>avgLine.params</code> feeds arguments to <code>geom_line()</code> to plot the average line with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
<li><p><code>point.params</code> feeds arguments to <code>geom_point()</code> to plot the points in the shadow with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>line.params</code> feeds arguments to <code>geom_line()</code> to plot the lines in the shadow with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
</ul>
<p>Notice that these components are also found in <code>sm_slope()</code>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb227-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb227-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb227-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>)),</span>
<span id="cb227-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb227-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>)),</span>
<span id="cb227-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb227-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>))) <span class="sc">+</span></span>
<span id="cb227-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-179-1.png" width="336" /></p>
<p>Notice that the <code>size</code> of the points have become smaller as the defaults of <strong>smplot2</strong> have disappeared with the writing of <code>xxx.params</code>.</p>
<p>Now that we know how convenient it is to use the generic parameter <code>...</code> to shift the plot’s position, lets use it to <code>position_dodge</code> and change the <code>size</code> of all components of the plots. Therefore, we will use <code>size</code> as a generic argument (<code>sm_pointplot(size = ...,)</code>).</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb228-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb228-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb228-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb228-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-180-1.png" width="336" /></p>
</div>
<div id="point-plot-with-a-shadow-using-data-of-one-group" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Point plot with a shadow using data of one group<a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-one-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s say you would like to plot the mean data of one group (<code>amblyopia</code>) as well as individual plots behind the mean plot as a dim shadow by setting <code>sm_pointplot(..., show_shadow = T)</code>.</p>
<p>Let’s use the same dataset and filter for observations from <code>Condition = 'One'</code> and <code>Group = 'Amblyopia'</code>.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb229-1" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb229-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb229-2" aria-hidden="true" tabindex="-1"></a>df2a<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2a<span class="sc">$</span>SF)</span></code></pre></div>
<p>When you decide to show shadow using <code>sm_pointplot()</code>, you need to specify <code>group</code> argument in <code>sm_pointplot()</code> in this format: <code>sm_pointplot(group = xxx)</code>, where <code>xxx</code> is the name of the variable that includes identifiers for each observation.</p>
<p>In the shadow, each individual point has to be plotted, and the points have to be connected to form a line. This line has to be connected for each <code>Subject</code> in our example, therefore it should be set as <code>sm_pointplot(group = Subject, ...)</code>.</p>
<p>Therefore, notice that there are two <code>group</code> arguments in this case. The first one is for the average plot in <code>aes()</code> in this format: <code>ggplot(data, aes(x = ..., y =..., group = yyy))</code>, where <code>yyy</code> is the name of the variable that includes identifiers for condition/group of all observers from which the average can be computed. The second <code>group</code> is within <code>sm_pointplot()</code> in this format: <code>sm_pointplot(group = xxx)</code>, where <code>xxx</code> represents the name of the variable for individual identifiers.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, </span>
<span id="cb230-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb230-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">group =</span> Group)) <span class="sc">+</span> <span class="co"># grouped for average</span></span>
<span id="cb230-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="do">## grouped for shadow</span></span>
<span id="cb230-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb230-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="fl">2.5</span>),</span>
<span id="cb230-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb230-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">show_shadow =</span> T)  <span class="sc">+</span></span>
<span id="cb230-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb230-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-182-1.png" width="336" /></p>
<p>You can finely control the aesthetics of the shadow by using <code>line.params = list()</code> and <code>point.params = list()</code>.</p>
<p>First let’s remove the defaults of the shadow.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb231-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject,</span>
<span id="cb231-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb231-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="fl">2.5</span>),</span>
<span id="cb231-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb231-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(),</span>
<span id="cb231-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb231-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb231-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb231-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">show_shadow =</span> T)  <span class="sc">+</span></span>
<span id="cb231-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb231-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-183-1.png" width="336" /></p>
<p>It is a mangled mess because they all have the same color <code>viridian</code>. We can make the shadow more transparent (<code>alpha = 0.2</code>).</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb232-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject,</span>
<span id="cb232-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>),</span>
<span id="cb232-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb232-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="st">&#39;white&#39;</span>),</span>
<span id="cb232-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">alpha =</span> <span class="fl">0.65</span>),</span>
<span id="cb232-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">alpha =</span> <span class="fl">0.65</span>),</span>
<span id="cb232-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb232-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb232-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">show_shadow =</span> T)  <span class="sc">+</span></span>
<span id="cb232-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb232-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-184-1.png" width="336" /></p>
<p>Now it looks a lot better!</p>
</div>
<div id="point-plot-with-a-shadow-using-data-of-multiple-groups" class="section level3 hasAnchor" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Point plot with a shadow using data of multiple groups<a href="bar-graph-slope-chart-and-point-plot.html#point-plot-with-a-shadow-using-data-of-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now’ lets filter data from two groups <code>Amblyopia</code> and <code>Normal</code>. We can do so by using <code>|</code>, which means <strong>OR</strong>. <code>&amp;</code> means <strong>AND</strong>.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb233-1" aria-hidden="true" tabindex="-1"></a>df2b <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span> <span class="sc">|</span> Group <span class="sc">==</span> <span class="st">&#39;Normal&#39;</span>)</span>
<span id="cb233-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb233-2" aria-hidden="true" tabindex="-1"></a>df2b<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2b<span class="sc">$</span>SF)</span>
<span id="cb233-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2b<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] &quot;Amblyopia&quot; &quot;Normal&quot;</code></pre>
<p>After confirming that we have successfully filtered the data, we can plot the data of the two groups with a shadow for each group.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb235-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb235-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb235-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb235-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb235-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb235-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb235-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb235-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-186-1.png" width="336" /></p>
<p>This is a point plot that includes everything we have learned thus far, such as <code>position_dodge()</code>, the importance of generic paramter <code>...</code>, inclusion of a shadow <code>show_shadow = T</code>, and using two <code>group</code> arguments (one for the average plot, one for the individual points for the shadow).</p>
</div>
<div id="adding-and-modifying-legends" class="section level3 hasAnchor" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Adding and modifying legends<a href="bar-graph-slope-chart-and-point-plot.html#adding-and-modifying-legends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also add <code>legend</code> to label the two colors by setting <code>sm_pointplot(..., legends = TRUE)</code></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb236-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb236-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb236-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb236-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb236-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb236-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb236-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb236-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb236-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-187-1.png" width="403.2" /></p>
<p>We can move the legend to the topleft part of the plot that has most empty space using <code>theme(legend.position = ...)</code>. Also, the title of the legend can be removed with <code>theme(legend.title = element_blank</code>)</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb237-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb237-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb237-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb237-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb237-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb237-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb237-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb237-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb237-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.24</span>,<span class="fl">0.80</span>),</span>
<span id="cb237-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb237-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-188-1.png" width="336" /></p>
<p>Note that the legend includes horizontal and vertical lines around the plot. The vertical line represents the error bar, and the horizontal line represents the line that connects between the points at various x levels. The symbols in legend can be manually modified. In this case, I will remove the vertical error bar from the legend by writing <code>err.params = list(show.legend = FALSE)</code>.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb238-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb238-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb238-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb238-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb238-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb238-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb238-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>),</span>
<span id="cb238-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb238-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb238-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.24</span>,<span class="fl">0.80</span>),</span>
<span id="cb238-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb238-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-189-1.png" width="336" /></p>
<p>You can also think about controlling the ratio of the figure when saving the figure. In this example, <code>base_height</code> and <code>base_width</code> are specifically controlled.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb239-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb239-3"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb239-4"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb239-5"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb239-6"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb239-7"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb239-8"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>),</span>
<span id="cb239-9"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb239-10"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb239-11"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.24</span>,<span class="fl">0.80</span>),</span>
<span id="cb239-12"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())  <span class="ot">-&gt;</span> pointplot</span>
<span id="cb239-13"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-14"><a href="bar-graph-slope-chart-and-point-plot.html#cb239-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pointplot)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-190-1.png" width="384" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="bar-graph-slope-chart-and-point-plot.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;pointplot.png&#39;</span>, pointplot, <span class="at">base_height =</span> <span class="fl">2.8</span>,</span>
<span id="cb240-2"><a href="bar-graph-slope-chart-and-point-plot.html#cb240-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">base_width =</span> <span class="dv">4</span>)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="boxplot-and-violin-plot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="raincloud-and-forest-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/barSlopePoint.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/barSlopePoint.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
