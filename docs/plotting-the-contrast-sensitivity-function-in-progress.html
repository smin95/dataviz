<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Plotting the Contrast Sensitivity Function (in Progress) | Data Analysis and Visualization in R Using smplot</title>
  <meta name="description" content="Chapter 10 Plotting the Contrast Sensitivity Function (in Progress) | Data Analysis and Visualization in R Using smplot" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Plotting the Contrast Sensitivity Function (in Progress) | Data Analysis and Visualization in R Using smplot" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Plotting the Contrast Sensitivity Function (in Progress) | Data Analysis and Visualization in R Using smplot" />
  
  
  

<meta name="author" content="Seung Hyun Min" />


<meta name="date" content="2022-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="recreating-figures-from-front.-genetics-2021.html"/>
<link rel="next" href="data-analysis-with-the-contrast-sensitivity-function-in-progress.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#major-updates-on-smplot"><i class="fa fa-check"></i>Major updates on smplot</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#please-cite-this-paper-when-smplot-is-used"><i class="fa fa-check"></i>Please cite this paper when smplot is used</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#for-r-and-ggplot2-experts"><i class="fa fa-check"></i>For R and ggplot2 experts</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>1</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>1.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="1.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>1.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>1.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>2</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>2.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i>Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>2.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i>Let’s make some graphs</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i>How ggplot works</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i>Different color of points for each unique group</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i>Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i>Same shape across all groups</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#exercise-try-changing-the-shape-of-the-points-to-the-circle-with-the-border."><i class="fa fa-check"></i>Exercise: try changing the shape of the points to the circle with the border.</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i>How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i>geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i>Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot"><i class="fa fa-check"></i><b>2.3</b> Improve Data Visualization using smplot</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i>Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i>Reporting statistics from a paired correlation</a></li>
<li><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i>Different color for each group but with other colors</a></li>
<li><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1.">Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>3</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>3.1</b> Upload Sample Data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i>Download requirements</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i>Before we get started</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i>data.csv</a></li>
<li><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i>Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>3.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i>What is a boxplot?</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i>Boxplot vs bar graph</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i>Boxplot using ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i>Problem: Alphabetical order</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i>Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i>Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i>Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i>A boxplot with individual data</a></li>
<li><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i>Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>3.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i>Structure of the violin plot</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i>Violin plot with ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i>Violin plot with individual points</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i>geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i>Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html"><i class="fa fa-check"></i><b>4</b> Manual and Examples of smplot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#installation-of-the-package"><i class="fa fa-check"></i><b>4.1</b> Installation of the Package</a>
<ul>
<li><a href="manual-and-examples-of-smplot.html#what-is-smplot">What is <code>smplot</code>?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-color-palette-and-graph-themes"><i class="fa fa-check"></i><b>4.2</b> smplot’s Color Palette and Graph Themes</a>
<ul>
<li class="chapter" data-level="" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-color-palette"><i class="fa fa-check"></i>smplot’s color palette</a></li>
<li class="chapter" data-level="" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-graph-themes"><i class="fa fa-check"></i>smplot’s graph themes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#correlation-plot"><i class="fa fa-check"></i><b>4.3</b> Correlation Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#data-frame-for-a-correlation-plot"><i class="fa fa-check"></i><b>4.3.1</b> Data frame for a correlation plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>4.3.2</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>4.4</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>4.4.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>4.5</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>4.5.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>4.6</b> Bar Plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>4.6.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#slope-chart---sm_slope"><i class="fa fa-check"></i><b>4.7</b> Slope Chart - <code>sm_slope()</code></a></li>
<li class="chapter" data-level="4.8" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>4.8</b> A Bland Altman Plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="4.9" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>4.9</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="4.10" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#overriding-defaults-of-smplots-themes"><i class="fa fa-check"></i><b>4.10</b> Overriding Defaults of smplot’s Themes</a></li>
<li class="chapter" data-level="4.11" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#overriding-defaults-of-smplot-colors"><i class="fa fa-check"></i><b>4.11</b> Overriding Defaults of smplot Colors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html"><i class="fa fa-check"></i><b>5</b> Combining Plots with Common Axes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>5.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-for-rows"><i class="fa fa-check"></i><b>5.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="5.1.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#select-for-columns"><i class="fa fa-check"></i><b>5.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="5.1.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>5.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-average-data-with-error-bars"><i class="fa fa-check"></i><b>5.2</b> Plotting average data with error bars</a></li>
<li class="chapter" data-level="5.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-individual-data"><i class="fa fa-check"></i><b>5.3</b> Plotting Individual Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html"><i class="fa fa-check"></i><b>6</b> Calculating Area under a Curve</a>
<ul>
<li class="chapter" data-level="6.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#pipe"><i class="fa fa-check"></i><b>6.1</b> Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="6.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#area-under-a-curve"><i class="fa fa-check"></i><b>6.2</b> Area under a curve</a></li>
<li class="chapter" data-level="6.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#reproducing-figures-in-the-paper-min-et-al.-2019"><i class="fa fa-check"></i><b>6.3</b> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3b-a-best-fit-line-with-points-and-error-bars"><i class="fa fa-check"></i><b>6.3.1</b> Figure 3B (a best-fit line with points and error bars)</a></li>
<li class="chapter" data-level="6.3.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3d-a-bar-graph"><i class="fa fa-check"></i><b>6.3.2</b> Figure 3D (a bar graph)</a></li>
<li class="chapter" data-level="6.3.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3e-modeling-in-matlab-and-plotting-in-r"><i class="fa fa-check"></i><b>6.3.3</b> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html"><i class="fa fa-check"></i><b>7</b> Calculating Linear Slopes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#linear-relationship-using-lm"><i class="fa fa-check"></i><b>7.1</b> Linear relationship using <code>lm()</code></a></li>
<li class="chapter" data-level="7.2" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#calculating-slopes-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>7.2</b> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>8</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="basic-statistics.html"><a href="basic-statistics.html#one-sample-t-test"><i class="fa fa-check"></i><b>8.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="8.2" data-path="basic-statistics.html"><a href="basic-statistics.html#two-sample-t-test"><i class="fa fa-check"></i><b>8.2</b> Two-sample t-test</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#shapiro-wilk-test-to-test-for-normality-of-data"><i class="fa fa-check"></i><b>8.2.1</b> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="basic-statistics.html"><a href="basic-statistics.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>8.3</b> Wilcoxon Signed-rank Test</a></li>
<li class="chapter" data-level="8.4" data-path="basic-statistics.html"><a href="basic-statistics.html#effect-size"><i class="fa fa-check"></i><b>8.4</b> Effect Size</a></li>
<li class="chapter" data-level="8.5" data-path="basic-statistics.html"><a href="basic-statistics.html#power-analysis"><i class="fa fa-check"></i><b>8.5</b> Power Analysis</a></li>
<li class="chapter" data-level="8.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>8.6</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#check-for-outliers"><i class="fa fa-check"></i><b>8.6.1</b> Check for Outliers</a></li>
<li class="chapter" data-level="8.6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data"><i class="fa fa-check"></i><b>8.6.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="8.6.3" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-the-assumption-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>8.6.3</b> Checking the Assumption for Homogeneity of Variance</a></li>
<li class="chapter" data-level="8.6.4" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-one-way-anova"><i class="fa fa-check"></i><b>8.6.4</b> Computing One-way ANOVA</a></li>
<li class="chapter" data-level="8.6.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-tests"><i class="fa fa-check"></i><b>8.6.5</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="8.6.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>8.6.6</b> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="basic-statistics.html"><a href="basic-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>8.7</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="basic-statistics.html"><a href="basic-statistics.html#identifying-outliers"><i class="fa fa-check"></i><b>8.7.1</b> Identifying Outliers</a></li>
<li class="chapter" data-level="8.7.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data-1"><i class="fa fa-check"></i><b>8.7.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="8.7.3" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-two-way-anova"><i class="fa fa-check"></i><b>8.7.3</b> Computing Two-way ANOVA</a></li>
<li class="chapter" data-level="8.7.4" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-test"><i class="fa fa-check"></i><b>8.7.4</b> Post-hoc Test</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-resources"><i class="fa fa-check"></i><b>8.8</b> Extra Resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html"><i class="fa fa-check"></i><b>9</b> Recreating Figures from Front. Genetics (2021)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-1---correlation-plot"><i class="fa fa-check"></i><b>9.1</b> Figure 1 - Correlation Plot</a></li>
<li class="chapter" data-level="9.2" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-2---bar-plot"><i class="fa fa-check"></i><b>9.2</b> Figure 2 - Bar Plot</a></li>
<li class="chapter" data-level="9.3" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-3---boxplot"><i class="fa fa-check"></i><b>9.3</b> Figure 3 - Boxplot</a></li>
<li class="chapter" data-level="9.4" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-4---violin-plot"><i class="fa fa-check"></i><b>9.4</b> Figure 4 - Violin Plot</a></li>
<li class="chapter" data-level="9.5" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-5---slope-chart"><i class="fa fa-check"></i><b>9.5</b> Figure 5 - Slope Chart</a></li>
<li class="chapter" data-level="9.6" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-6---raincloud-plot"><i class="fa fa-check"></i><b>9.6</b> Figure 6 - Raincloud Plot</a></li>
<li class="chapter" data-level="9.7" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-7---case-study"><i class="fa fa-check"></i><b>9.7</b> Figure 7 - Case Study</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plotting-the-contrast-sensitivity-function-in-progress.html"><a href="plotting-the-contrast-sensitivity-function-in-progress.html"><i class="fa fa-check"></i><b>10</b> Plotting the Contrast Sensitivity Function (in Progress)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="plotting-the-contrast-sensitivity-function-in-progress.html"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#brief-introduction"><i class="fa fa-check"></i><b>10.1</b> Brief Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="plotting-the-contrast-sensitivity-function-in-progress.html"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#data-visualization"><i class="fa fa-check"></i><b>10.2</b> Data Visualization</a></li>
<li class="chapter" data-level="10.3" data-path="plotting-the-contrast-sensitivity-function-in-progress.html"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#facetting-the-contrast-sensitivity-functions"><i class="fa fa-check"></i><b>10.3</b> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="data-analysis-with-the-contrast-sensitivity-function-in-progress.html"><a href="data-analysis-with-the-contrast-sensitivity-function-in-progress.html"><i class="fa fa-check"></i><b>11</b> Data Analysis with the Contrast Sensitivity Function (in Progress)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-analysis-with-the-contrast-sensitivity-function-in-progress.html"><a href="data-analysis-with-the-contrast-sensitivity-function-in-progress.html#area-under-a-curve-1"><i class="fa fa-check"></i><b>11.1</b> Area under a Curve</a></li>
<li class="chapter" data-level="11.2" data-path="data-analysis-with-the-contrast-sensitivity-function-in-progress.html"><a href="data-analysis-with-the-contrast-sensitivity-function-in-progress.html#sm_trapz-sm_aulcsf-and-sm_r2"><i class="fa fa-check"></i><b>11.2</b> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-the-contrast-sensitivity-function-in-progress" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Plotting the Contrast Sensitivity Function (in Progress)</h1>
<p>In this section, we will plot the contrast sensitivity function using the <strong>smCSF</strong> package. I will complement it with <strong>smplot</strong> for aesthetics.</p>
<p>We will use data of achromatic contrast sensitivity from 51 normal observers from this paper (a subset of the entire dataset):</p>
<p><strong>Kim, Y. J., Reynaud, A., Hess, R. F., &amp; Mullen, K. T. (2017). A normative data set for the clinical assessment of achromatic and chromatic contrast sensitivity using a qCSF approach. Investigative ophthalmology &amp; visual science, 58(9), 3628-3636.</strong></p>
<p>Luckily, the data are publicly available. I have reorganized the data so that we could easily use them in the form of a data frame. Let’s load the data from online.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb377-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span>
<span id="cb377-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smCSF)</span></code></pre></div>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb378-1" aria-hidden="true" tabindex="-1"></a>ACh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Repetition SpatialFreq Sensitivity
##   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1 S1               1        0.25       23.8 
## 2 S2               1        0.25       18.0 
## 3 S3               1        0.25       14.2 
## 4 S4               1        0.25        5.14
## 5 S5               1        0.25       16.0 
## 6 S6               1        0.25       10.9</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 51 participants total in the .csv file.</p></li>
<li><p>Next, <code>Repetition</code> refers to each repetition of the measurement The participants performed two repetitions of the contrast sensitivity measurement.</p></li>
<li><p><code>SpatialFreq</code> refers to spatial frequency of the stimuli that were shown to test the observers’ contrast sensitivity. There are a total of 12 spatial frequencies.</p></li>
<li><p>The <code>Sensitivity</code> column refers to the linear values of the contrast sensitivity.</p></li>
</ul>
<div id="brief-introduction" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Brief Introduction</h2>
<p>The contrast sensitivity function (CSF) how the observer is sensitive to an image. This image could be large (low spatial frequency) or small (high spatal frequency). To obtain the CSF, the measurement test must measure the threshold. Threshold refers to the difference in stimulus magnitude between the states of presence and absence. If the observer can just barely discriminate between these two states of the visual stimulus, this can be described as the threshold for detection.</p>
</div>
<div id="data-visualization" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Data Visualization</h2>
<p>First, let’s compute the average, standard errors and standard deviation using the dataset. It is recommended that the reader has read Chapters 5 and 6 already. Understanding of <code>summarise()</code>, <code>filter()</code>, <code>mutate()</code> and <code>%&gt;%</code> is assumed.</p>
<p>The code below reorganizes the <code>ACh</code> dataset so that instead of containing the data of each subject, it now contains the averaged data across <code>Repetition</code> and <code>SpatialFreq</code> as well as their standard errors and standard deviations. We use <code>mean()</code> to compute the mean, <code>sm_stdErr()</code> the standard error, and <code>sd()</code> the standard deviation.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb381-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> </span>
<span id="cb381-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb381-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Repetition, SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb381-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb381-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb381-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb381-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb381-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb381-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb381-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb381-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb381-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb381-7" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1          1        0.25    12.6      0.743       5.31
##  2          1        0.35    14.7      0.777       5.55
##  3          1        0.49    18.6      0.993       7.09
##  4          1        0.68    23.7      1.22        8.71
##  5          1        0.94    28.7      1.36        9.68
##  6          1        1.31    32.0      1.40        9.99
##  7          1        1.83    32.4      1.43       10.2 
##  8          1        2.54    29.6      1.39        9.93
##  9          1        3.54    24.3      1.22        8.70
## 10          1        4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>Let’s create a variable that stores the data for each <code>Repetition</code>. Before we do that, however, it is important that we convert the data type of the <code>Repetition</code> column from <code>&lt;dbl&gt;</code> to <code>&lt;fct&gt;</code>, which refers from <strong>double</strong> to <strong>factor</strong>. <strong>Double</strong> refers to continuous data, whereas <strong>factor</strong> refers to categorical data.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb383-1" aria-hidden="true" tabindex="-1"></a>ACh_avg<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg<span class="sc">$</span>Repetition) <span class="co"># factor</span></span>
<span id="cb383-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb383-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb383-3" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># repetition 1</span></span>
<span id="cb383-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb383-4" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">2</span>) <span class="co"># repetition 2</span></span></code></pre></div>
<p>Let’s now plot the data for each repetition using <strong>ggplot2</strong>. Understanding of Chapters 1-4 is assumed.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb384-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb384-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb384-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb384-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb384-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb384-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb384-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb384-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-281-1.png" width="350.4" /></p>
<p>So far, this graph does not show the contrast sensitivity function, which has a rotund shape. Instead, if we connect the points, we get this plot instead.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb385-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb385-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb385-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb385-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb385-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb385-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb385-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb385-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb385-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb385-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb385-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb385-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb385-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-282-1.png" width="350.4" /></p>
<p>The function is still not a smooth, rotund shape. This is because it is standard to plot the contrast sensitivity function in log10 scales in both x and y axes. The code below shows the plot in the log scale.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb386-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb386-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb386-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb386-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb386-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb386-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb386-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb386-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb386-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-283-1.png" width="350.4" /></p>
<p>This plot shows the averaged sensitivity for each spatial frequency during the first repetition. However, the contrast sensitivity function is still missing because this plot instead shows the plot that is connected between a pair of the points. To plot the contrast sensitivity function with the data, <code>sm_CSF()</code> is required.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb387-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb387-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb387-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-284-1.png" width="350.4" /></p>
<p>Notice that even if the data frame contains data in <strong>linear units</strong>, the plotted data from <code>sm_CSF()</code> are in log10 scales. It shows a nice, rotund shape that is typical of the contrast sensitivity function. The function can also plot the linear curve by setting <code>sm_CSF(logXY = FALSE)</code>. The default is <code>sm_CSF(logXY = TRUE)</code>.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb388-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb388-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb388-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-285-1.png" width="350.4" /></p>
<p>Now let’s plot a prettier contrast sensitivity function.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb389-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb389-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb389-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>)) <span class="sc">+</span></span>
<span id="cb389-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb389-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb389-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb389-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb389-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb389-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb389-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb389-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb389-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb389-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-286-1.png" width="350.4" /></p>
<p>We can also plot the data using <code>ACh_avg2</code>, which contains data from the second repetition rather than first.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb390-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb390-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb390-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb390-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb390-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb390-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb390-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb390-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb390-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb390-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb390-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb390-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb390-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-287-1.png" width="350.4" /></p>
<p>Notice that <code>sm_CSF()</code> is written first because the curve has to appear before the points (<code>geom_point()</code>); else, the points will be covered by the CSF curve. This example is shown below.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb391-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb391-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb391-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb391-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb391-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb391-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb391-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb391-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb391-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb391-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb391-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb391-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-288-1.png" width="350.4" /></p>
<p>The curve appears later in this plot, so it covers some overlapping points.</p>
<p><strong>smCSF</strong> also offers a function that fill the area of the CSF curve. This function is <code>sm_areaCSF()</code>. The default is set to plot the area in log10 scales, <code>sm_areaCSF(logXY = TRUE)</code>.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb392-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb392-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>() <span class="sc">+</span></span>
<span id="cb392-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-289-1.png" width="350.4" /></p>
<p>To plot the linear CSF and its area, <code>logXY = FALSE</code> has to be set <code>FALSE</code> in both <code>sm_areaCSF()</code> and <code>sm_CSF()</code>. The functions of <code>smCSF</code> have defaults <code>logXY = TRUE</code>, therefore, it is recommended that the user uploads a data frame that contains the linear data of spatial frequencies and contrast sensitivities. The functions then will convert them into log scale by default.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb393-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb393-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb393-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb393-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-290-1.png" width="350.4" /></p>
<p>We can make the area plot prettier.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb394-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb394-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb394-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb394-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb394-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb394-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb394-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb394-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb394-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">0.9</span>, <span class="at">y =</span> <span class="fl">1.3</span>, <span class="at">label =</span> <span class="st">&#39;Area under Log CSF&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-291-1.png" width="350.4" /></p>
<p>You might get a warning that says <code>Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale</code>. You can ignore this warning and not be worried about it. This is because we used the function <code>scale_y_log10()</code> on top of <code>sm_CSF()</code>, which actually calls forth the function <code>scale_y_continuous()</code> to convert the plot into log scales. Hence, there are two functions that serve the same purpose here, so the warning message is printed.</p>
<p>The <strong>smCSF</strong> package also offers a function that draws a ribbon shade to denote standard error or standard deviation. This function works exactly the same as <code>geom_ribbon()</code>. It requires the uses to specify <code>ymin</code> and <code>ymax</code>. The example below plots standard error using <code>sm_ribbonCSF()</code>. As before, its default is <code>logXY = TRUE</code>. Therefore, even if <code>ACh_avg2</code> contains data in linear units, the ribbon shade that is generated by <code>sm_ribbonCSF()</code> will be in log unit.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb395-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb395-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdErrSens,</span>
<span id="cb395-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb395-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdErrSens)) <span class="sc">+</span></span>
<span id="cb395-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb395-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-292-1.png" width="350.4" /></p>
<p>Let’s make this plot prettier using functions from <strong>smplot</strong>.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb396-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdErrSens,</span>
<span id="cb396-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdErrSens),</span>
<span id="cb396-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="co"># fill controls the color of the shade</span></span>
<span id="cb396-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb396-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb396-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb396-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb396-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb396-10"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb396-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-293-1.png" width="350.4" /></p>
<p>You can also shade standard deviation instead, where <code>ymin = avgSens - stdDevSens</code> and <code>ymax = avgSens + stdDevSens</code>.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb397-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb397-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb397-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb397-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)) <span class="sc">+</span></span>
<span id="cb397-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-294-1.png" width="350.4" /></p>
<p>Let’s make the plot prettier using <strong>smplot</strong>.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb398-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb398-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens),</span>
<span id="cb398-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb398-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)) <span class="sc">+</span></span>
<span id="cb398-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb398-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb398-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb398-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb398-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-295-1.png" width="350.4" /></p>
<p>Unfortunately, in this case, the standard deviation is quite broad. Let’s plot the averaged data across all repetitions and see if the standard deviation is still too broad.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb399-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_final <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb399-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb399-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb399-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb399-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb399-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb399-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb399-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb399-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh_avg_final)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1        0.25    13.2      0.536       5.41
## 2        0.35    15.2      0.568       5.74
## 3        0.49    19.1      0.698       7.05
## 4        0.68    24.3      0.836       8.44
## 5        0.94    29.4      0.938       9.48
## 6        1.31    33.0      0.977       9.87</code></pre>
<p>Here is the new data frame <code>ACh_avg_final</code>.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_final <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb401-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb401-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens),</span>
<span id="cb401-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb401-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb401-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb401-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb401-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb401-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Contrast Sensitivity (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb401-10"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb401-11"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb401-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-297-1.png" width="350.4" /></p>
<p>The standard deviation seems to be still broad.</p>
</div>
<div id="facetting-the-contrast-sensitivity-functions" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Facetting the Contrast Sensitivity Functions</h2>
<p>To facet means to split the plot into multiple plots based on a categorical variable (i.e., <strong>factor</strong>). We will facet the contrast sensitivity function plot above (the blue curve) into two panels based on two repetitions (red and green below).</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-298-1.png" width="652.8" /></p>
<p>To facet the plot, you need to have a data frame that has data with a column that specifies the categorical variable. For instance, let’s look at the data frame <code>ACh_avg</code>.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb402-1" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##    &lt;fct&gt;            &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 1                 0.25    12.6      0.743       5.31
##  2 1                 0.35    14.7      0.777       5.55
##  3 1                 0.49    18.6      0.993       7.09
##  4 1                 0.68    23.7      1.22        8.71
##  5 1                 0.94    28.7      1.36        9.68
##  6 1                 1.31    32.0      1.40        9.99
##  7 1                 1.83    32.4      1.43       10.2 
##  8 1                 2.54    29.6      1.39        9.93
##  9 1                 3.54    24.3      1.22        8.70
## 10 1                 4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>We see that the first column of <code>Ach_avg</code> has a column named <code>Repetition</code> which stores whether the given data are from the first or second repetition. To see all the unique levels of <code>Repetition</code>, we can use the function <code>unique()</code>.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ACh_avg<span class="sc">$</span>Repetition)</span></code></pre></div>
<pre><code>## [1] 1 2
## Levels: 1 2</code></pre>
<p>To facet a plot using ggplot2, the function <code>facet_wrap()</code> has to be used.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb406-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb406-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb406-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb406-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb406-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb406-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-301-1.png" width="652.8" /></p>
<p>The argument inside <code>facet_wrap</code> has to include the tilde (<code>~</code>). The right side the tilde (<code>~</code>) should be the name of the categorical variable by which you wish to facet the plot. If the variable however happens to be continuous, <code>facet_wrap()</code> would not work properly.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb407-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb407-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb407-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb407-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb407-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb407-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb407-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> stdErrSens) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-302-1.png" width="652.8" /></p>
<p>However, I do not often use <code>facet_wrap()</code> because the plot often ends up not being pretty. Let’s try to make it prettier.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb408-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb408-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb408-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb408-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb408-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb408-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb408-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb408-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb408-10"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb408-11"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb408-12"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb408-13"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb408-14"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb408-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-303-1.png" width="652.8" /></p>
<p>Personally, I do not like the grey-filled header of each panel. Since I personally will find myself repeatedly bypassing the default grey color into a color of my choice, I have created the function myself <code>sm_facet_header()</code> as part of the <strong>smCSF</strong> package.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb409-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb409-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb409-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb409-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb409-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb409-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb409-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb409-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb409-10"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb409-11"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb409-12"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb409-13"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb409-14"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) <span class="sc">+</span></span>
<span id="cb409-15"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb409-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-304-1.png" width="652.8" /></p>
<p>Now the title of each plot has been bolded and the filled color is white. I personally think that this plot is a lot cleaner than the default one.</p>
<p>Next, I wish to change the titles of each panel because <code>1</code> and <code>2</code> are not descriptive. To do so, we need to use the argument <code>labeller</code> within <code>facet_wrap()</code> to specify the title of each panel.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb410-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb410-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb410-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb410-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb410-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb410-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb410-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb410-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>(<span class="at">font_size=</span><span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb410-10"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb410-11"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb410-12"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb410-13"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb410-14"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb410-15"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition,</span>
<span id="cb410-16"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 1&#39;</span>,</span>
<span id="cb410-17"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb410-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 2&#39;</span>))) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-305-1.png" width="652.8" /></p>
<p>We use the function <code>as_labeller()</code> as part of the argument <code>labeller()</code> inside <code>facet_wrap()</code> to specify that factor level <code>1</code> should be shown as <code>Repetition 1</code> and <code>2</code> as <code>Repetition 2</code>.</p>
<p>We can also change the number of rows and columns using <code>facet_wrap()</code>. Lets make a data frame that has 4 repetitions instead of 2.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb411-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb411-2" aria-hidden="true" tabindex="-1"></a>spatFreqNum <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(ACh_avg<span class="sc">$</span>SpatialFreq))</span>
<span id="cb411-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb411-3" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ACh_avg,ACh_avg)</span>
<span id="cb411-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb411-4" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">each=</span>spatFreqNum)</span>
<span id="cb411-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb411-5" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep[<span class="dv">25</span><span class="sc">:</span><span class="fu">nrow</span>(ACh_avg_4rep), <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> ACh_avg_4rep[<span class="dv">25</span><span class="sc">:</span><span class="fu">nrow</span>(ACh_avg_4rep), <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">+</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">24</span>),<span class="dv">1</span>) </span>
<span id="cb411-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb411-6" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg_4rep<span class="sc">$</span>Repetition)</span></code></pre></div>
<p>We can specify the number of columns (ex. <code>ncol = 2</code>) and rows (ex. <code>nrow = 2</code>) inside the function <code>facet_wrap()</code>, as shown in the example below.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep <span class="sc">%&gt;%</span></span>
<span id="cb412-2"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb412-3"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb412-4"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition,</span>
<span id="cb412-5"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb412-6"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb412-7"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)) <span class="sc">+</span></span>
<span id="cb412-8"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb412-9"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb412-10"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>(<span class="at">font_size=</span><span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb412-11"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb412-12"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>,<span class="st">&#39;yelloworange&#39;</span>, <span class="st">&#39;crimson&#39;</span>)) <span class="sc">+</span></span>
<span id="cb412-13"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>, <span class="st">&#39;orange&#39;</span>,<span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb412-14"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb412-15"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb412-16"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb412-17"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb412-18"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 1&#39;</span>,</span>
<span id="cb412-19"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 2&#39;</span>,</span>
<span id="cb412-20"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;3&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 3&#39;</span>,</span>
<span id="cb412-21"><a href="plotting-the-contrast-sensitivity-function-in-progress.html#cb412-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;4&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 4&#39;</span>))) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-307-1.png" width="652.8" /></p>
<p>Notice that when <code>facet_wrap()</code> is used, there is no need to create variable for each plot like we have done in Chapter 5 and use <code>sm_common_axis()</code>. The preference can vary depending on the user. I still prefer to store each plot so that I can have freedom to decide where to place each panel wherever I want.</p>
<p>In the next chapter, we will discuss about some techniques on how to analyze contrast sensitivity data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="recreating-figures-from-front.-genetics-2021.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-analysis-with-the-contrast-sensitivity-function-in-progress.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/10-Csf1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/10-Csf1.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
