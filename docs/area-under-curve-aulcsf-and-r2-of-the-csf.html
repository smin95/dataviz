<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Area under Curve, AULCSF and R2 of the CSF | Data Analysis and Visualization in R Using smplot</title>
  <meta name="description" content="Chapter 10 Area under Curve, AULCSF and R2 of the CSF | Data Analysis and Visualization in R Using smplot" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Area under Curve, AULCSF and R2 of the CSF | Data Analysis and Visualization in R Using smplot" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Area under Curve, AULCSF and R2 of the CSF | Data Analysis and Visualization in R Using smplot" />
  
  
  

<meta name="author" content="Seung Hyun Min" />


<meta name="date" content="2022-08-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting-the-contrast-sensitivity-function.html"/>
<link rel="next" href="understanding-the-contrast-sensitivity-function.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dataviz with smplot</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#major-updates-on-smplot-and-smcsf"><i class="fa fa-check"></i>Major updates on smplot and smCSF</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#please-cite-this-paper-when-smplot-is-used"><i class="fa fa-check"></i>Please cite this paper when smplot is used</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#for-r-and-ggplot2-experts"><i class="fa fa-check"></i>For R and ggplot2 experts</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-contact"><i class="fa fa-check"></i>Issues and contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html"><i class="fa fa-check"></i><b>1</b> Download RStudio &amp; Basics of R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#setting-up-rstudio"><i class="fa fa-check"></i><b>1.1</b> Setting up RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#why-use-r-for-data-visualization"><i class="fa fa-check"></i>Why use R for data visualization?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#other-available-resources-for-r"><i class="fa fa-check"></i>Other available resources for R</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#download-requirements-for-rstudio"><i class="fa fa-check"></i>Download requirements for RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#open-rstudio"><i class="fa fa-check"></i>Open RStudio</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-make-a-folder-and-set-it-as-working-directory"><i class="fa fa-check"></i>Let’s make a folder and set it as working directory</a></li>
<li class="chapter" data-level="1.1.1" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-to-run-your-code"><i class="fa fa-check"></i><b>1.1.1</b> How to run your code</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#basics-of-r"><i class="fa fa-check"></i><b>1.2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#lets-type-some-codes"><i class="fa fa-check"></i>Let’s type some codes</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#how-can-i-learn-most-effectively-with-the-notes"><i class="fa fa-check"></i>How can I learn most effectively with the notes?</a></li>
<li class="chapter" data-level="" data-path="download-rstudio-basics-of-r.html"><a href="download-rstudio-basics-of-r.html#more-installation"><i class="fa fa-check"></i>More installation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Visualization with smplot</b></span></li>
<li class="chapter" data-level="2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html"><i class="fa fa-check"></i><b>2</b> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#uploading-data"><i class="fa fa-check"></i><b>2.1</b> Uploading data</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#sample-data-mpg"><i class="fa fa-check"></i>Sample data: mpg</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>2.2</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#lets-make-some-graphs"><i class="fa fa-check"></i>Let’s make some graphs</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-ggplot-works"><i class="fa fa-check"></i>How ggplot works</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-of-points-for-each-unique-group"><i class="fa fa-check"></i>Different color of points for each unique group</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-shape-for-each-group"><i class="fa fa-check"></i>Different color &amp; shape for each group</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#same-shape-across-all-groups"><i class="fa fa-check"></i>Same shape across all groups</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#exercise-try-changing-the-shape-of-the-points-to-the-circle-with-the-border."><i class="fa fa-check"></i>Exercise: try changing the shape of the points to the circle with the border.</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#how-do-we-draw-the-best-fit-line-of-the-graph"><i class="fa fa-check"></i>How do we draw the best-fit line of the graph?</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#geom_point-geom_smooth"><i class="fa fa-check"></i>geom_point() + geom_smooth()</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#writing-shorter-codes"><i class="fa fa-check"></i>Writing shorter codes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#improve-data-visualization-using-smplot"><i class="fa fa-check"></i><b>2.3</b> Improve Data Visualization using smplot</a>
<ul>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#positive-relationship-between-x--and-y-axes"><i class="fa fa-check"></i>Positive relationship between x- and y-axes</a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#reporting-statistics-from-a-paired-correlation"><i class="fa fa-check"></i>Reporting statistics from a paired correlation</a></li>
<li><a href="basics-of-ggplot2-and-correlation-plot.html#fill-0f993d-vs-fill-green"><code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li class="chapter" data-level="" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#different-color-for-each-group-but-with-other-colors"><i class="fa fa-check"></i>Different color for each group but with other colors</a></li>
<li><a href="basics-of-ggplot2-and-correlation-plot.html#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1.">Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basics-of-ggplot2-and-correlation-plot.html"><a href="basics-of-ggplot2-and-correlation-plot.html#summary"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html"><i class="fa fa-check"></i><b>3</b> Boxplot and Violin Plot</a>
<ul>
<li class="chapter" data-level="3.1" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#upload-sample-data-csv-file-in-rstudio"><i class="fa fa-check"></i><b>3.1</b> Upload Sample Data (csv file) in RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#download-requirements"><i class="fa fa-check"></i>Download requirements</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#before-we-get-started"><i class="fa fa-check"></i>Before we get started</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#data.csv"><i class="fa fa-check"></i>data.csv</a></li>
<li><a href="boxplot-and-violin-plot.html#read_csvdata.csv"><code>read_csv('data.csv')</code></a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#best-way-to-plot-data"><i class="fa fa-check"></i>Best way to plot data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot"><i class="fa fa-check"></i><b>3.2</b> Boxplot</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#what-is-a-boxplot"><i class="fa fa-check"></i>What is a boxplot?</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-vs-bar-graph"><i class="fa fa-check"></i>Boxplot vs bar graph</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#boxplot-using-ggplot2"><i class="fa fa-check"></i>Boxplot using ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#problem-alphabetical-order"><i class="fa fa-check"></i>Problem: Alphabetical order</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#displaying-characters-in-a-non-alphabetical-order"><i class="fa fa-check"></i>Displaying characters in a non-alphabetical order</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#double-check-if-the-day-column-is-factor"><i class="fa fa-check"></i>Double-check if the ‘Day’ column is factor</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#back-to-boxplot-using-ggplot2"><i class="fa fa-check"></i>Back to boxplot using ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#a-boxplot-with-individual-data"><i class="fa fa-check"></i>A boxplot with individual data</a></li>
<li><a href="boxplot-and-violin-plot.html#geom_boxplot-vs-sm_boxplot"><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-boxplot"><i class="fa fa-check"></i>Save boxplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot"><i class="fa fa-check"></i><b>3.3</b> Violin Plot</a>
<ul>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#structure-of-the-violin-plot"><i class="fa fa-check"></i>Structure of the violin plot</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-ggplot2"><i class="fa fa-check"></i>Violin plot with ggplot2</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#violin-plot-with-individual-points"><i class="fa fa-check"></i>Violin plot with individual points</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#geom_violin-vs-sm_violin"><i class="fa fa-check"></i>geom_violin() vs sm_violin()</a></li>
<li class="chapter" data-level="" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#save-your-violin-plot"><i class="fa fa-check"></i>Save your violin plot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="boxplot-and-violin-plot.html"><a href="boxplot-and-violin-plot.html#summary-1"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html"><i class="fa fa-check"></i><b>4</b> Manual and Examples of smplot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#installation-of-the-package"><i class="fa fa-check"></i><b>4.1</b> Installation of the Package</a>
<ul>
<li><a href="manual-and-examples-of-smplot.html#what-is-smplot">What is <code>smplot</code>?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-color-palette-and-graph-themes"><i class="fa fa-check"></i><b>4.2</b> smplot’s Color Palette and Graph Themes</a>
<ul>
<li class="chapter" data-level="" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-color-palette"><i class="fa fa-check"></i>smplot’s color palette</a></li>
<li class="chapter" data-level="" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#smplots-graph-themes"><i class="fa fa-check"></i>smplot’s graph themes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#correlation-plot"><i class="fa fa-check"></i><b>4.3</b> Correlation Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#data-frame-for-a-correlation-plot"><i class="fa fa-check"></i><b>4.3.1</b> Data frame for a correlation plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#correlation-plot-with-both-regression-and-reference-lines"><i class="fa fa-check"></i><b>4.3.2</b> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#boxplot---sm_boxplot"><i class="fa fa-check"></i><b>4.4</b> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors"><i class="fa fa-check"></i><b>4.4.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#violin-plot---sm_violin"><i class="fa fa-check"></i><b>4.5</b> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors-1"><i class="fa fa-check"></i><b>4.5.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#bar-plot---sm_bar"><i class="fa fa-check"></i><b>4.6</b> Bar Plot - <code>sm_bar()</code></a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#plotting-individual-points-with-unique-colors-2"><i class="fa fa-check"></i><b>4.6.1</b> Plotting individual points with unique colors</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#slope-chart---sm_slope"><i class="fa fa-check"></i><b>4.7</b> Slope Chart - <code>sm_slope()</code></a></li>
<li class="chapter" data-level="4.8" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#a-bland-altman-plot---sm_bland_altman"><i class="fa fa-check"></i><b>4.8</b> A Bland Altman Plot - <code>sm_bland_altman()</code></a></li>
<li class="chapter" data-level="4.9" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#raincloud-plot---sm_raincloud"><i class="fa fa-check"></i><b>4.9</b> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li class="chapter" data-level="4.10" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#overriding-defaults-of-smplots-themes"><i class="fa fa-check"></i><b>4.10</b> Overriding Defaults of smplot’s Themes</a></li>
<li class="chapter" data-level="4.11" data-path="manual-and-examples-of-smplot.html"><a href="manual-and-examples-of-smplot.html#overriding-defaults-of-smplot-colors"><i class="fa fa-check"></i><b>4.11</b> Overriding Defaults of smplot Colors</a></li>
</ul></li>
<li class="part"><span><b>II Data Analysis with smplot</b></span></li>
<li class="chapter" data-level="5" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html"><i class="fa fa-check"></i><b>5</b> Combining Plots with Common Axes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-select-and-summarise"><i class="fa fa-check"></i><b>5.1</b> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#filter-for-rows"><i class="fa fa-check"></i><b>5.1.1</b> <code>filter()</code> for rows</a></li>
<li class="chapter" data-level="5.1.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#select-for-columns"><i class="fa fa-check"></i><b>5.1.2</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="5.1.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#summarise-for-grouped-summaries"><i class="fa fa-check"></i><b>5.1.3</b> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-the-averaged-data-with-error-bars"><i class="fa fa-check"></i><b>5.2</b> Plotting the averaged data with error bars</a></li>
<li class="chapter" data-level="5.3" data-path="combining-plots-with-common-axes.html"><a href="combining-plots-with-common-axes.html#plotting-individual-data"><i class="fa fa-check"></i><b>5.3</b> Plotting Individual Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html"><i class="fa fa-check"></i><b>6</b> Calculating Area under a Curve</a>
<ul>
<li class="chapter" data-level="6.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#pipe"><i class="fa fa-check"></i><b>6.1</b> Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="6.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#area-under-a-curve"><i class="fa fa-check"></i><b>6.2</b> Area under a curve</a></li>
<li class="chapter" data-level="6.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#reproducing-figures-in-the-paper-min-et-al.-2019"><i class="fa fa-check"></i><b>6.3</b> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3b-a-best-fit-line-with-points-and-error-bars"><i class="fa fa-check"></i><b>6.3.1</b> Figure 3B (a best-fit line with points and error bars)</a></li>
<li class="chapter" data-level="6.3.2" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3d-a-bar-graph"><i class="fa fa-check"></i><b>6.3.2</b> Figure 3D (a bar graph)</a></li>
<li class="chapter" data-level="6.3.3" data-path="calculating-area-under-a-curve.html"><a href="calculating-area-under-a-curve.html#figure-3e-modeling-in-matlab-and-plotting-in-r"><i class="fa fa-check"></i><b>6.3.3</b> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html"><i class="fa fa-check"></i><b>7</b> Calculating Linear Slopes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#linear-relationship-using-lm"><i class="fa fa-check"></i><b>7.1</b> Linear relationship using <code>lm()</code></a></li>
<li class="chapter" data-level="7.2" data-path="calculating-linear-slopes.html"><a href="calculating-linear-slopes.html#calculating-slopes-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>7.2</b> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>8</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="basic-statistics.html"><a href="basic-statistics.html#one-sample-t-test"><i class="fa fa-check"></i><b>8.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="8.2" data-path="basic-statistics.html"><a href="basic-statistics.html#two-sample-t-test"><i class="fa fa-check"></i><b>8.2</b> Two-sample t-test</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#shapiro-wilk-test-to-test-for-normality-of-data"><i class="fa fa-check"></i><b>8.2.1</b> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="basic-statistics.html"><a href="basic-statistics.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>8.3</b> Wilcoxon Signed-rank Test</a></li>
<li class="chapter" data-level="8.4" data-path="basic-statistics.html"><a href="basic-statistics.html#effect-size"><i class="fa fa-check"></i><b>8.4</b> Effect Size</a></li>
<li class="chapter" data-level="8.5" data-path="basic-statistics.html"><a href="basic-statistics.html#power-analysis"><i class="fa fa-check"></i><b>8.5</b> Power Analysis</a></li>
<li class="chapter" data-level="8.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>8.6</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#check-for-outliers"><i class="fa fa-check"></i><b>8.6.1</b> Check for Outliers</a></li>
<li class="chapter" data-level="8.6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data"><i class="fa fa-check"></i><b>8.6.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="8.6.3" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-the-assumption-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>8.6.3</b> Checking the Assumption for Homogeneity of Variance</a></li>
<li class="chapter" data-level="8.6.4" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-one-way-anova"><i class="fa fa-check"></i><b>8.6.4</b> Computing One-way ANOVA</a></li>
<li class="chapter" data-level="8.6.5" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-tests"><i class="fa fa-check"></i><b>8.6.5</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="8.6.6" data-path="basic-statistics.html"><a href="basic-statistics.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>8.6.6</b> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="basic-statistics.html"><a href="basic-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>8.7</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="basic-statistics.html"><a href="basic-statistics.html#identifying-outliers"><i class="fa fa-check"></i><b>8.7.1</b> Identifying Outliers</a></li>
<li class="chapter" data-level="8.7.2" data-path="basic-statistics.html"><a href="basic-statistics.html#checking-for-normality-of-data-1"><i class="fa fa-check"></i><b>8.7.2</b> Checking for Normality of Data</a></li>
<li class="chapter" data-level="8.7.3" data-path="basic-statistics.html"><a href="basic-statistics.html#computing-two-way-anova"><i class="fa fa-check"></i><b>8.7.3</b> Computing Two-way ANOVA</a></li>
<li class="chapter" data-level="8.7.4" data-path="basic-statistics.html"><a href="basic-statistics.html#post-hoc-test"><i class="fa fa-check"></i><b>8.7.4</b> Post-hoc Test</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-resources"><i class="fa fa-check"></i><b>8.8</b> Extra Resources</a></li>
</ul></li>
<li class="part"><span><b>III Contrast Sensitivity Function</b></span></li>
<li class="chapter" data-level="9" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>9</b> Plotting the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="9.1" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#brief-introduction"><i class="fa fa-check"></i><b>9.1</b> Brief Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#data-visualization"><i class="fa fa-check"></i><b>9.2</b> Data Visualization</a></li>
<li class="chapter" data-level="9.3" data-path="plotting-the-contrast-sensitivity-function.html"><a href="plotting-the-contrast-sensitivity-function.html#facetting-the-contrast-sensitivity-functions"><i class="fa fa-check"></i><b>9.3</b> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html"><i class="fa fa-check"></i><b>10</b> Area under Curve, AULCSF and R2 of the CSF</a>
<ul>
<li class="chapter" data-level="10.1" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#area-under-a-curve-1"><i class="fa fa-check"></i><b>10.1</b> Area under a Curve</a></li>
<li class="chapter" data-level="10.2" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#sm_trapz-sm_aulcsf-and-sm_r2"><i class="fa fa-check"></i><b>10.2</b> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
<li class="chapter" data-level="10.3" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#calculating-area-and-r2-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>10.3</b> Calculating area and R2 of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="10.4" data-path="area-under-curve-aulcsf-and-r2-of-the-csf.html"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#case-study"><i class="fa fa-check"></i><b>10.4</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html"><i class="fa fa-check"></i><b>11</b> Understanding the Contrast Sensitivity Function</a>
<ul>
<li class="chapter" data-level="11.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#contrast-sensitivity-function-model"><i class="fa fa-check"></i><b>11.1</b> Contrast Sensitivity Function Model</a></li>
<li class="chapter" data-level="11.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_csf"><i class="fa fa-check"></i><b>11.2</b> Understanding <code>sm_CSF()</code></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_params"><i class="fa fa-check"></i><b>11.2.1</b> <code>sm_params()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#sm_cutoff"><i class="fa fa-check"></i><b>11.2.2</b> <code>sm_cutOff()</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#understanding-sm_ribboncsf"><i class="fa fa-check"></i><b>11.3</b> Understanding <code>sm_ribbonCSF()</code></a></li>
<li class="chapter" data-level="11.4" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#calculating-the-five-parameters-of-all-subjects-groups-and-conditions"><i class="fa fa-check"></i><b>11.4</b> Calculating the five parameters of all subjects, groups and conditions</a></li>
<li class="chapter" data-level="11.5" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#visualization-of-the-parameters"><i class="fa fa-check"></i><b>11.5</b> Visualization of the parameters</a></li>
<li class="chapter" data-level="11.6" data-path="understanding-the-contrast-sensitivity-function.html"><a href="understanding-the-contrast-sensitivity-function.html#case-study-1"><i class="fa fa-check"></i><b>11.6</b> Case Study</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="12" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html"><i class="fa fa-check"></i><b>12</b> Recreating Figures from Front. Genetics (2021)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-1---correlation-plot"><i class="fa fa-check"></i><b>12.1</b> Figure 1 - Correlation Plot</a></li>
<li class="chapter" data-level="12.2" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-2---bar-plot"><i class="fa fa-check"></i><b>12.2</b> Figure 2 - Bar Plot</a></li>
<li class="chapter" data-level="12.3" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-3---boxplot"><i class="fa fa-check"></i><b>12.3</b> Figure 3 - Boxplot</a></li>
<li class="chapter" data-level="12.4" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-4---violin-plot"><i class="fa fa-check"></i><b>12.4</b> Figure 4 - Violin Plot</a></li>
<li class="chapter" data-level="12.5" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-5---slope-chart"><i class="fa fa-check"></i><b>12.5</b> Figure 5 - Slope Chart</a></li>
<li class="chapter" data-level="12.6" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-6---raincloud-plot"><i class="fa fa-check"></i><b>12.6</b> Figure 6 - Raincloud Plot</a></li>
<li class="chapter" data-level="12.7" data-path="recreating-figures-from-front.-genetics-2021.html"><a href="recreating-figures-from-front.-genetics-2021.html#figure-7---case-study"><i class="fa fa-check"></i><b>12.7</b> Figure 7 - Case Study</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="area-under-curve-aulcsf-and-r2-of-the-csf" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Area under Curve, AULCSF and R2 of the CSF</h1>
<p>In this section, we will analyze the contrast sensitivity function (CSF) using the <strong>smCSF</strong> package. I will complement it with smplot for aesthetics.</p>
<p>As in the previous chapter, we will use data of achromatic contrast sensitivity from 51 normal observers from this paper (a subset of the entire dataset):</p>
<p><strong>Kim, Y. J., Reynaud, A., Hess, R. F., &amp; Mullen, K. T. (2017). A normative data set for the clinical assessment of achromatic and chromatic contrast sensitivity using a qCSF approach. Investigative ophthalmology &amp; visual science, 58(9), 3628-3636.</strong></p>
<p>Without further ado, let’s load the necessary packages.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb398-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span>
<span id="cb398-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smCSF)</span></code></pre></div>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb399-1" aria-hidden="true" tabindex="-1"></a>ACh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Repetition SpatialFreq Sensitivity
##   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1 S1               1        0.25       23.8 
## 2 S2               1        0.25       18.0 
## 3 S3               1        0.25       14.2 
## 4 S4               1        0.25        5.14
## 5 S5               1        0.25       16.0 
## 6 S6               1        0.25       10.9</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 51 participants total in the .csv file.</p></li>
<li><p>Next, <code>Repetition</code> refers to each repetition of the measurement The participants performed two repetitions of the contrast sensitivity measurement.</p></li>
<li><p><code>SpatialFreq</code> refers to spatial frequency of the stimuli that were shown to test the observers’ contrast sensitivity. There are a total of 12 spatial frequencies.</p></li>
<li><p>The <code>Sensitivity</code> column refers to the linear values of the contrast sensitivity.</p></li>
</ul>
<div id="area-under-a-curve-1" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Area under a Curve</h2>
<p>Area under a curve under the contrast sensitivity function (CSF) as an index of visual performance or sensitivity. The higher the areal measure, the better the visual performance. There are two ways to calculate the area: 1) trapezoidal integration of the contrast sensitivity data as a function of spatial frequency, and 2) area under the fitted log CSF (AULCSF).</p>
<p>Let’s create a data frame <code>ACh_avg</code> that contains the averaged contrast sensitivity data for each repetition and spatial frequency across 51 subjects.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb402-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> </span>
<span id="cb402-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb402-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Repetition, SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb402-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb402-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb402-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb402-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb402-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb402-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb402-6"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb402-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-7"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb402-7" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1          1        0.25    12.6      0.743       5.31
##  2          1        0.35    14.7      0.777       5.55
##  3          1        0.49    18.6      0.993       7.09
##  4          1        0.68    23.7      1.22        8.71
##  5          1        0.94    28.7      1.36        9.68
##  6          1        1.31    32.0      1.40        9.99
##  7          1        1.83    32.4      1.43       10.2 
##  8          1        2.54    29.6      1.39        9.93
##  9          1        3.54    24.3      1.22        8.70
## 10          1        4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>As in the previous chapter, lets store the data into proper data frames for each repetition.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb404-1" aria-hidden="true" tabindex="-1"></a>ACh_avg<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg<span class="sc">$</span>Repetition) <span class="co"># factor</span></span>
<span id="cb404-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb404-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb404-3" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># repetition 1</span></span>
<span id="cb404-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb404-4" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">2</span>) <span class="co"># repetition 2</span></span></code></pre></div>
<p>Here is an example of trapezoidal integration of the contrast sensitivity function (i.e., AUC). AUC is an abbreviation of <strong>a</strong>rea <strong>u</strong>nder a <strong>c</strong>urve from trapezoidal integration.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb405-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb405-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb405-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb405-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb405-6"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb405-7"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb405-8"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb405-9"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb405-10"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb405-11"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb405-12"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb405-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">1.3</span>, <span class="at">label =</span> <span class="st">&#39;Trapezoidal AUC&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-306-1.png" width="350.4" /></p>
<p>Here is an example of the AULCSF.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb406-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb406-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb406-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb406-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb406-6"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb406-7"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb406-8"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb406-9"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb406-10"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb406-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">0.4</span>, <span class="at">y =</span> <span class="fl">1.3</span>, <span class="at">label =</span> <span class="st">&#39;AULCSF&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-307-1.png" width="350.4" /></p>
<p>Notice that these that AUC and AULCSF are slightly different. AUC denotes the area that is enclosed by the lines that connect each point. AULCSF refers to the area that is enclosed by the fitted contrast sensitivity function. The astute reader may realize that if the fit of the contrast sensitivity function is poor, then the AULCSF might not be accurate. Hence, it might be necessary to prove that the CSF fit is robust with the given data. To avoid these hassles, some researchers use AUC instead. Nevertheless, <strong>smCSF</strong> offers functions that compute both AUC and AULCSF.</p>
<p>The higher the AUC and AULCSF are, the higher the overall sensitivity of the observer. Therefore, when potential treatment is being studied, it is of interest to see an increase in AUC and AULCSF in the visually impaired after their treatment.</p>
</div>
<div id="sm_trapz-sm_aulcsf-and-sm_r2" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></h2>
<p>This section is identical to what we have seen in Chapter 6. For those who have read Chapter 6, the only difference is that these AUCs should be in log scales (both x and y scales) in the context of contrast sensitivity.</p>
<p>Recall that <code>ACh_avg</code> contains averaged contrast sensitivity for each spatial frequency across 51 observers for the first repetition.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb407-1" aria-hidden="true" tabindex="-1"></a>ACh_avg </span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##    &lt;fct&gt;            &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 1                 0.25    12.6      0.743       5.31
##  2 1                 0.35    14.7      0.777       5.55
##  3 1                 0.49    18.6      0.993       7.09
##  4 1                 0.68    23.7      1.22        8.71
##  5 1                 0.94    28.7      1.36        9.68
##  6 1                 1.31    32.0      1.40        9.99
##  7 1                 1.83    32.4      1.43       10.2 
##  8 1                 2.54    29.6      1.39        9.93
##  9 1                 3.54    24.3      1.22        8.70
## 10 1                 4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>To compute the trapezoidal AUC, we can use the function <code>sm_trapz()</code>.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_trapz</span>(ACh_avg1<span class="sc">$</span>SpatialFreq, ACh_avg1<span class="sc">$</span>avgSens)</span></code></pre></div>
<pre><code>## [1] 2.081833</code></pre>
<p>The difference between <code>sm_trapz()</code> and <code>sm_auc()</code> is that <code>sm_trapz()</code> automatically converts the <code>x</code> and <code>y</code> vectors into log10 scales. This default can be overcome when <code>logXY = FALSE</code>. When, <code>logXY = FALSE</code>, <code>sm_trapz()</code> becomes identical to <code>sm_auc()</code>. <code>sm_trapz()</code> has been created as a separate function to create a convenient and straightforward workflow for those who wish to analyze the contrast sensitivity data.</p>
<p>In addition, to compute the trapezoidal AUC, we can use the function <code>sm_AULCSF()</code>.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_AULCSF</span>(ACh_avg1<span class="sc">$</span>SpatialFreq, ACh_avg1<span class="sc">$</span>avgSens)</span></code></pre></div>
<pre><code>## [1] 2.089264</code></pre>
<p>Notice that the AULCSF is very similar to AUC. This suggests that the CSF fit (as generated by <code>sm_CSF()</code>) is very good. This can verified by computing R2 (R-squared), which ranges from 0 (worst model fit) to 1 (best model fit), using <code>sm_r2()</code>.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_r2</span>(ACh_avg1<span class="sc">$</span>SpatialFreq, ACh_avg1<span class="sc">$</span>avgSens)</span></code></pre></div>
<pre><code>## [1] 0.9672</code></pre>
<p>We see that R2 of the CSF fit is 0.9672, which is considered excellent. Note that <code>sm_r2()</code> is a function specific for CSF fit only, and the <code>x</code> and <code>y</code> arguments should contain data in linear units, not log units.</p>
<p>To visualize what R2 captures, we need to understand <strong>residuals</strong>, which is the difference or distance between the actual data and the predicted data from the given fit, such as the CSF.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb415-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb415-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb415-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)) <span class="sc">+</span></span>
<span id="cb415-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb415-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb415-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb415-6"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb415-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb415-7"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb415-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-312-1.png" width="350.4" /></p>
<p>If the residual is very low, then the distance between the actual and predicted data should be close to 0. We see that the residual is low when the spatial frequency is between 3 and 10 c/deg. In this case, the general fit is very faithful to the original data, so the residual is low and R2 is high (close to 1). In sum, the lower the residuals, the higher the R2, which ranges from 0 to 1.</p>
</div>
<div id="calculating-area-and-r2-of-all-subjects-groups-and-conditions" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Calculating area and R2 of all subjects, groups and conditions</h2>
<p>Now that we know how to calculate AUC, AULCSF and R2 for each subject, let’s calculate slopes of our entire dataset.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb416-1" aria-hidden="true" tabindex="-1"></a>ACh</span></code></pre></div>
<pre><code>## # A tibble: 1,224 x 4
##    Subject Repetition SpatialFreq Sensitivity
##    &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 S1               1        0.25       23.8 
##  2 S2               1        0.25       18.0 
##  3 S3               1        0.25       14.2 
##  4 S4               1        0.25        5.14
##  5 S5               1        0.25       16.0 
##  6 S6               1        0.25       10.9 
##  7 S7               1        0.25        8.41
##  8 S8               1        0.25       10.5 
##  9 S9               1        0.25        9.06
## 10 S10              1        0.25        3.57
## # ... with 1,214 more rows</code></pre>
<p>We see that there are 51 subjects total, each of which has completed two repetitions (i.e., conditions). So there are 102 slopes to calculate! Does that mean we need to use <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code> 102 times?</p>
<p>As the reader might expect from the previous chapters, the answer is <strong>no</strong>. <strong>smCSF</strong> has a functions <code>sm_trapz_list()</code>, <code>sm_AULCSF_list()</code> and <code>sm_r2_list()</code> that return a data frame of AUCs, AULCSFs and R2s, respectively. They works similarly to <code>sm_auc_list()</code> and <code>sm_slope_list()</code> from <strong>smplot</strong>.</p>
<ul>
<li><code>data</code> = this argument requires the variable that stores the data frame. In our case, it is <code>ACh</code>. It is recommended that the data are in linear units.</li>
<li><code>subjects</code> = this argument requires the name of the column of the data frame that contains subjects. It must strings, ex. <code>'Subject'</code>, not <code>Subject</code>.</li>
<li><code>groups</code> = this argument requires the name of the column of the data frame that contains each group. In this example, there is no group. An example would be <code>Group</code> column that contains two groups: <code>Normal</code> and <code>Amblyopia</code>.</li>
<li><code>conditions</code> = this argument requires name of the column of the data frame that contains each condition. In our example, the two conditions are <code>1</code> and <code>2</code> from the <code>Repetition</code> column.</li>
<li><code>x</code> = this argument requires the name of the column of the data frame that contains the x-axis points from which the AUC can be calculated. In our case, these are values from the <code>SpatialFreq</code> column of <code>ACh</code>. It must strings, ex. <code>'SpatialFreq'</code>, not <code>SpatialFreq</code>.</li>
<li><code>values</code> = this argument requires the name of the column of the data frame that contains the actual data, which are the y-axis points from which the AUC can be calculated. In our case, it is the change in contrast balance ratio. It must strings, ex. <code>'Sensitivity'</code>, not <code>Sensitivity</code>.</li>
<li><code>logXY</code> (for <code>sm_trapz_list()</code> and <code>sm_AULCSF_list()</code>) = thus argument’s default is <code>sm_trapz_list(logXY = TRUE)</code> and <code>sm_AULCSF_list(logXY = TRUE)</code>, so it computes the log10 units (<code>x</code> and <code>values</code> vector) of AUC and AULCSF. When <code>logXY = FALSE</code>, it computes the linear units (<code>x</code> and <code>values</code> vector) AUC and AULCSF.</li>
</ul>
<p>Let’s calculate the AUCs first. We can store the results from <code>sm_trapz_list()</code> into a new variable. I will call the new variable <code>trapz_df</code>.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb418-1" aria-hidden="true" tabindex="-1"></a>trapz_df <span class="ot">&lt;-</span> <span class="fu">sm_trapz_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb418-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb418-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb418-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb418-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb418-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb418-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb418-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb418-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh)</span></code></pre></div>
<pre><code>## [1] &quot;Trapezoid AUC = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trapz_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject Repetition AUC_Sensitivity
## 1      S1          1        2.299290
## 2      S1          2        2.032390
## 3      S2          1        2.246943
## 4      S2          2        2.215784
## 5      S3          1        1.973220
## 6      S3          2        2.204566</code></pre>
<p>Likewise, we can store the results from <code>sm_AULCSF_list()</code> in a new variable. I will call the new variable <code>aulcsf_df</code>.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb422-1" aria-hidden="true" tabindex="-1"></a>aulcsf_df <span class="ot">&lt;-</span> <span class="fu">sm_AULCSF_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb422-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb422-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb422-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb422-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb422-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb422-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb422-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb422-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh)</span></code></pre></div>
<pre><code>## [1] &quot;AULCSF = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aulcsf_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject Repetition   AULCSF
## 1      S1          1 2.307217
## 2      S1          2 2.038921
## 3      S2          1 2.254705
## 4      S2          2 2.222592
## 5      S3          1 1.979206
## 6      S3          2 2.214169</code></pre>
<p>Finally, we can store the results from <code>sm_r2_list()</code> in a new variable. I will call the new variable <code>r2</code>_df`.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb426-1" aria-hidden="true" tabindex="-1"></a>r2_df <span class="ot">&lt;-</span> <span class="fu">sm_r2_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb426-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb426-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb426-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb426-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb426-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb426-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb426-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb426-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh)</span></code></pre></div>
<pre><code>## [1] &quot;R2 (0-worst, 1-best) for each subject&quot;</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(r2_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject Repetition     R2
## 1      S1          1 0.8605
## 2      S1          2 1.0000
## 3      S2          1 0.9086
## 4      S2          2 0.8731
## 5      S3          1 0.7505
## 6      S3          2 0.9947</code></pre>
<p>We see that R2 is very good except for few observers in certain repetitions. Let’s see how many rows of the data frame contains R2 less than 0.75.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb430-1" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(r2_df<span class="sc">$</span>R2 <span class="sc">&lt;</span> <span class="fl">0.75</span>)</span>
<span id="cb430-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ind)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb432-1" aria-hidden="true" tabindex="-1"></a>r2_df[ind,]</span></code></pre></div>
<pre><code>##    Subject Repetition     R2
## 11      S6          1 0.5294
## 18      S9          2 0.6518
## 29     S15          1 0.5664
## 61     S31          1 0.6935
## 66     S33          2 0.6041
## 78     S39          2 0.5018
## 88     S44          2 0.7240
## 92     S46          2 0.5190</code></pre>
<p>Out of 102 rows of the R2s, only 8 of them contain poor R2. I think the contrast sensitivity function fit is acceptable to model the dataset of achromatic sensitivity in 51 normal observers.</p>
</div>
<div id="case-study" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Case Study</h2>
<p>If one is interested in seeing whether a clinical treatment can improve the overall contrast sensitivity of the visually impaired, one can do so by comparing the area (AUC or AULCSF) before and after the treatment.</p>
<p>Let’s generate some fake data with <code>ACh</code>. We will create a new column using <code>mutate()</code> by creating a new column <code>BeforeAfter</code>, which replaces <code>1</code> with <code>Before</code> and <code>2</code> with <code>After</code> to denote before and after receiving clinical treatment. Since <code>BeforeAfter</code> is derived from the <code>Repetition</code> column, it is a <code>&lt;fct&gt;</code> column, as it is so with the <code>Repetition</code> column. This new data frame is stored in the variable named <code>ACh1</code>. We assume that the 51 subjects are visually impaired patients who received clinical treatment for visual improvement.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb434-1" aria-hidden="true" tabindex="-1"></a>ACh<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh<span class="sc">$</span>Repetition)</span>
<span id="cb434-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb434-2" aria-hidden="true" tabindex="-1"></a>ACh1 <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">BeforeAfter =</span> <span class="fu">fct_recode</span>(Repetition,</span>
<span id="cb434-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb434-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;Before&#39;</span> <span class="ot">=</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb434-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb434-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;After&#39;</span> <span class="ot">=</span> <span class="st">&#39;2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb434-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb434-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Repetition)</span></code></pre></div>
<p>Now, lets increase the values from the <code>Sensitivity</code> column in rows that have <code>BeforeAfter == After</code> using positive random numbers from a normal distribution that has a mean of <code>31</code> and a standard deviation of <code>35</code> using <code>rnorm()</code>.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb435-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb435-2" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(ACh1<span class="sc">$</span>BeforeAfter <span class="sc">==</span> <span class="st">&#39;After&#39;</span>)</span>
<span id="cb435-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb435-3" aria-hidden="true" tabindex="-1"></a>ACh1[ind,]<span class="sc">$</span>Sensitivity <span class="ot">&lt;-</span> ACh1[ind,]<span class="sc">$</span>Sensitivity <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(ind), <span class="dv">31</span>, <span class="dv">35</span>))</span></code></pre></div>
<p>Now let’s calculate both the trapezoidal AUC and AULCSF and using <code>sm_trapz_list()</code> and <code>sm_AULCSF_list()</code>, both of which have defaults <code>logXY = TRUE</code>.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb436-1" aria-hidden="true" tabindex="-1"></a>trapz_df <span class="ot">&lt;-</span> <span class="fu">sm_trapz_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb436-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb436-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;BeforeAfter&#39;</span>,</span>
<span id="cb436-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb436-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb436-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb436-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb436-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb436-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh1)</span></code></pre></div>
<pre><code>## [1] &quot;Trapezoid AUC = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trapz_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject BeforeAfter AUC_Sensitivity
## 1      S1      Before        2.299290
## 2      S1       After        2.867173
## 3      S2      Before        2.246943
## 4      S2       After        2.817482
## 5      S3      Before        1.973220
## 6      S3       After        2.856290</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb440-1" aria-hidden="true" tabindex="-1"></a>aulcsf_df <span class="ot">&lt;-</span> <span class="fu">sm_AULCSF_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb440-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb440-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;BeforeAfter&#39;</span>,</span>
<span id="cb440-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb440-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb440-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb440-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb440-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb440-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh1)</span></code></pre></div>
<pre><code>## [1] &quot;AULCSF = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aulcsf_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject BeforeAfter   AULCSF
## 1      S1      Before 2.307217
## 2      S1       After 2.874242
## 3      S2      Before 2.254705
## 4      S2       After 2.824033
## 5      S3      Before 1.979206
## 6      S3       After 2.849016</code></pre>
<p>Now let’s plot a bar graph using <code>sm_bar()</code> that compares both the trapezoidal AUCs and AULCSFs between before and after the visually impaired patients have received the clinical treatment.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb444-1" aria-hidden="true" tabindex="-1"></a>trapz_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BeforeAfter, <span class="at">y =</span> AUC_Sensitivity,</span>
<span id="cb444-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb444-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> BeforeAfter)) <span class="sc">+</span></span>
<span id="cb444-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>,</span>
<span id="cb444-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb444-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point_alpha =</span> .<span class="dv">3</span>, <span class="at">bar_width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb444-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb444-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb444-6"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb444-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-322-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb445-1" aria-hidden="true" tabindex="-1"></a>aulcsf_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BeforeAfter, <span class="at">y =</span> AULCSF,</span>
<span id="cb445-2"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb445-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> BeforeAfter)) <span class="sc">+</span></span>
<span id="cb445-3"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb445-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>,</span>
<span id="cb445-4"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb445-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point_alpha =</span> .<span class="dv">3</span>, <span class="at">bar_width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb445-5"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb445-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb445-6"><a href="area-under-curve-aulcsf-and-r2-of-the-csf.html#cb445-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-323-1.png" width="355.2" /></p>
<p>Both graphs suggest that the visual improvement has brought a large improvement of the overall contrast sensitivity in the patients who received the visual treatment. <strong>Chapter 8 Basic Statistics</strong> covers some methods to analyze data, and the reader can attempt to use the concepts in the previous chapter to analyze whether these differences from the simulated data are statistically significant.</p>
<p>Instead of focusing on the overall sensitivity of the observers, one can focus on observing whether the sensitivity of the high-spatial frequency range has improved after receiving the treatment. This, however, requires an understanding of the parameters that are used to fit the contrast sensitivity function. We will discuss these parameters in the next chapter.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting-the-contrast-sensitivity-function.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="understanding-the-contrast-sensitivity-function.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/dataviz/edit/master/11-Csf2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/dataviz/blob/master/11-Csf2.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
