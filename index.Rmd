--- 
title: "Data Analysis and Visualization in R Using smplot"
author: "Seung Hyun Min"
date: "Last Updated: `r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
---

```{r include=FALSE,cache=FALSE,purl=FALSE}
# don't cache anything on this page
knitr::opts_chunk$set(cache = FALSE)
```

# Welcome! {-#index}

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width = 7.4, fig.height= 11.7}
library(tidyverse)
library(cowplot)
library(smplot)
df <- read_csv('https://www.smin95.com/data.csv') 
df$Day <- factor(df$Day, levels = c('One','Two','Three'))
ggplot(data = df, mapping = aes(x = Day, y = Value, fill = Day)) + 
  sm_boxplot(color = 'white', shape = 21) + 
  scale_fill_manual(values = sm_palette(3)) +
  ggtitle('Boxplot') + 
  theme(plot.title = element_text(face="bold")) -> boxplot
ggplot(data = df, mapping = aes(x = Day, y = Value, color = Day)) + 
  sm_violin() + 
  scale_color_manual(values = sm_palette(3)) + 
  ggtitle('Violin plot') + 
  theme(plot.title = element_text(face="bold"))-> violin
set.seed(1) # generate random data
day1 = rnorm(20,0,1)
day2 = rnorm(20,5,1)
Subject <- rep(paste0('S',seq(1:20)), 2)
Data <- data.frame(Value = matrix(c(day1,day2),ncol=1))
Day <- rep(c('Day 1', 'Day 2'), each = length(day1))
df1 <- cbind(Subject, Data, Day)
ggplot(data = df1, mapping = aes(x = Day, y = Value, fill = Day)) +
  sm_bar(shape = 21, color = 'white', point_alpha = 1, bar_alpha = 0.2,
          bar_fill_color = 'black') +
  scale_fill_manual(values = sm_color('blue','orange')) +
  theme(axis.title.x = element_blank()) +
  ggtitle('Bar plot') + 
  theme(plot.title = element_text(face="bold")) -> bar
ggplot(data = df1, mapping = aes(x = Day, y = Value, 
                                group = Subject, fill = Day)) +
  sm_slope(labels = c('Day 1', 'Day 2'),
            shape = 21, color = 'white', line_alpha = 0.3) +
  scale_fill_manual(values = sm_color('blue','orange')) +
  ggtitle('Slope chart') + 
  theme(plot.title = element_text(face="bold")) -> slope
# raincloud plot
set.seed(2) # generate random data
day1 = rnorm(20,0,1)
day2 = rnorm(20,5,1)
day3 = rnorm(20,6,1.5)
day4 = rnorm(20,7,2)
Subject <- rep(paste0('S',seq(1:20)), 4)
Data <- data.frame(Value = matrix(c(day1,day2,day3,day4),ncol=1))
Day <- rep(c('Day 1', 'Day 2', 'Day 3', 'Day 4'), each = length(day1))
df2 <- cbind(Subject, Data, Day)
sm_raincloud(data = df2, x = Day, y = Value,
              boxplot_alpha = 0.5, color = 'white', shape = 21,
              sep_level = 2) +
  scale_x_continuous(limits = c(0.25,4.75), 
                     labels = c('1', '2', '3', '4'),
                     breaks = c(1,2,3,4)) +
  scale_color_manual(values = rep('transparent',4)) + 
  scale_fill_manual(values = sm_palette(4)) + 
  ggtitle('Raincloud plot') + 
  xlab('Day') + 
  theme(plot.title = element_text(face="bold")) -> raincloud
add_four <- plot_grid(boxplot, violin, bar, slope,
                 ncol =2,
                 nrow = 2, rel_widths = c(1,1,1,1),
                 scale = 0.95)
all <- plot_grid(add_four, raincloud, ncol = 1, 
                 nrow = 2, rel_widths = c(1,1), 
                 rel_heights = c(2,1.05))
print(all)
```

This book (https://smin95.com/dataviz) guides the reader to be familiar with R, a programming language, for data visualization. It also introduces the R package **smplot**, which aims to make the process of data visualization simple. This book was created entirely using RMarkdown for reproducibility. 

## Major updates {-}

**smplot**: Latest updates have been made on **November 10th, 2022**. Please **re-download smplot**. These includeï¼š 

- `sm_ci()` is a new function that computes the confidence interval.
- `sm_forest()` is a new function that visualizes a forest plot.

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width = 2.8, fig.height= 4.8}
set.seed(2) # generate random data
day1 = rnorm(20,0,1)
day2 = rnorm(20,5,1)
day3 = rnorm(20,6,1.5)
day4 = rnorm(20,7,2)
Subject <- rep(paste0('S',seq(1:20)), 4)
Data <- data.frame(Value = matrix(c(day1,day2,day3,day4),ncol=1))
Day <- rep(c('Day 1', 'Day 2', 'Day 3', 'Day 4'), each = length(day1))
df2 <- cbind(Subject, Data, Day)

sm_forest(data = df2, x = Value, y = Day, alpha = 0.2,
                 error_type = 'sd',
                 range_side = 'top',
          jitter_width = 0, sep_level = 2,
           avg_point_shape= 23, shape = 21) +
  scale_color_manual(values = rep('transparent',4)) +
  scale_fill_manual(values = sm_palette(4)) +
  ylab('Day') +
  ggtitle('Forest plot')
```



```{r, eval = FALSE}
install.packages("devtools")
devtools::install_github('smin95/smplot', force = TRUE)
```

**smCSF** is under **development**. It will undergo massive changes until the **end of 2022**. If you have downloaded already and do not plan to use it in imminent future, please remove it from your computer.

```{r, eval = FALSE}
remove.packages('smCSF') 
```

## Please cite this paper when smplot is used {-}

**Seung Hyun Min, Jiawei Zhou. smplot: An R Package for Easy and Elegant Data Visualization (2021). Frontiers in Genetics, 12:802894.**

## For R and ggplot2 experts {-}

Please read Chapter 4, which is a manual for **smplot**.

## Issues and contact {-}
If you spot any mistakes in this online book, please pull-request on [Github](https://github.com/smin95/dataviz) or email me seung.min@mail.mcgill.ca. If you find issues with the 'smplot' package, please pull-request on [Github](https://github.com/smin95/smplot).

## License {-}
**smplot** is under the MIT license. This tutorial is licensed under a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/). I am the sole creator of **smplot**.

## About the author {-}
I am Assistant Professor in Dept. Ophthalmology and Optometry at Wenzhou Medical University. On June 2021, I received my PhD at McGill University under the supervision of Dr. Robert F. Hess. My research is focused on amblyopia, neural plasticity and binocular vision. During spare time, I play the clarinet and develop R packages. More details, such as my publications, are on my website: https://www.smin95.com. 
