<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Data Analysis and Visualization in R Using smplot2</title>
  <meta name="description" content="Data Analysis and Visualization in R Using smplot2" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Data Analysis and Visualization in R Using smplot2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Analysis and Visualization in R Using smplot2" />
  
  
  

<meta name="author" content="Seung Hyun Min" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Data Analysis and Visualization in R Using smplot2</h1>
<p class="author"><em>Seung Hyun Min</em></p>
<p class="date"><em>Last Updated: 2023-04-08</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#index" id="toc-index">Welcome!</a>
<ul>
<li><a href="#major-updates" id="toc-major-updates">Major updates</a></li>
<li><a href="#issues-and-contact" id="toc-issues-and-contact">Issues and contact</a></li>
<li><a href="#license" id="toc-license">License</a></li>
<li><a href="#about-the-author" id="toc-about-the-author">About the author</a></li>
</ul></li>
<li><a href="#opening-remarks" id="toc-opening-remarks"><span class="toc-section-number">1</span> Opening Remarks</a>
<ul>
<li><a href="#how-to-read-this-book" id="toc-how-to-read-this-book"><span class="toc-section-number">1.1</span> How to read this book</a></li>
</ul></li>
<li><a href="#download-rstudio-basics-of-r" id="toc-download-rstudio-basics-of-r"><span class="toc-section-number">2</span> Download RStudio &amp; Basics of R</a>
<ul>
<li><a href="#setting-up-rstudio" id="toc-setting-up-rstudio"><span class="toc-section-number">2.1</span> Setting up RStudio</a>
<ul>
<li><a href="#why-use-r-for-data-visualization" id="toc-why-use-r-for-data-visualization">Why use R for data visualization?</a></li>
<li><a href="#other-available-resources-for-r" id="toc-other-available-resources-for-r">Other available resources for R</a></li>
<li><a href="#download-requirements-for-rstudio" id="toc-download-requirements-for-rstudio">Download requirements for RStudio</a></li>
<li><a href="#open-rstudio" id="toc-open-rstudio">Open RStudio</a></li>
<li><a href="#lets-make-a-folder-and-set-it-as-working-directory" id="toc-lets-make-a-folder-and-set-it-as-working-directory">Let’s make a folder and set it as working directory</a></li>
<li><a href="#how-to-run-your-code" id="toc-how-to-run-your-code"><span class="toc-section-number">2.1.1</span> How to run your code</a></li>
</ul></li>
<li><a href="#basics-of-r" id="toc-basics-of-r"><span class="toc-section-number">2.2</span> Basics of R</a>
<ul>
<li><a href="#lets-type-some-codes" id="toc-lets-type-some-codes">Let’s type some codes</a></li>
<li><a href="#how-can-i-learn-most-effectively-with-the-notes" id="toc-how-can-i-learn-most-effectively-with-the-notes">How can I learn most effectively with the notes?</a></li>
<li><a href="#more-installation" id="toc-more-installation">More installation</a></li>
</ul></li>
</ul></li>
<li><a href="#part-data-visualization-with-smplot2" id="toc-part-data-visualization-with-smplot2">(PART) Data Visualization with smplot2</a></li>
<li><a href="#basics-of-ggplot2-and-correlation-plot" id="toc-basics-of-ggplot2-and-correlation-plot"><span class="toc-section-number">3</span> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li><a href="#uploading-data" id="toc-uploading-data"><span class="toc-section-number">3.1</span> Uploading data</a>
<ul>
<li><a href="#sample-data-mpg" id="toc-sample-data-mpg"><span class="toc-section-number">3.1.1</span> Sample data: mpg</a></li>
</ul></li>
<li><a href="#basics-of-ggplot2" id="toc-basics-of-ggplot2"><span class="toc-section-number">3.2</span> Basics of ggplot2</a>
<ul>
<li><a href="#lets-make-some-graphs" id="toc-lets-make-some-graphs"><span class="toc-section-number">3.2.1</span> Let’s make some graphs</a></li>
<li><a href="#how-ggplot-works" id="toc-how-ggplot-works"><span class="toc-section-number">3.2.2</span> How ggplot works</a></li>
<li><a href="#different-color-of-points-for-each-unique-group" id="toc-different-color-of-points-for-each-unique-group"><span class="toc-section-number">3.2.3</span> Different color of points for each unique group</a></li>
<li><a href="#different-color-shape-for-each-group" id="toc-different-color-shape-for-each-group"><span class="toc-section-number">3.2.4</span> Different color &amp; shape for each group</a></li>
<li><a href="#same-shape-across-all-groups" id="toc-same-shape-across-all-groups"><span class="toc-section-number">3.2.5</span> Same shape across all groups</a></li>
<li><a href="#how-do-we-draw-the-best-fit-line-of-the-graph" id="toc-how-do-we-draw-the-best-fit-line-of-the-graph"><span class="toc-section-number">3.2.6</span> How do we draw the best-fit line of the graph?</a></li>
<li><a href="#geom_point-geom_smooth" id="toc-geom_point-geom_smooth"><span class="toc-section-number">3.2.7</span> geom_point() + geom_smooth()</a></li>
<li><a href="#writing-shorter-codes" id="toc-writing-shorter-codes"><span class="toc-section-number">3.2.8</span> Writing shorter codes</a></li>
</ul></li>
<li><a href="#improve-data-visualization-using-smplot2" id="toc-improve-data-visualization-using-smplot2"><span class="toc-section-number">3.3</span> Improve data visualization using smplot2</a>
<ul>
<li><a href="#positive-relationship-between-x--and-y-axes" id="toc-positive-relationship-between-x--and-y-axes"><span class="toc-section-number">3.3.1</span> Positive relationship between x- and y-axes</a></li>
<li><a href="#reporting-statistics-from-a-paired-correlation" id="toc-reporting-statistics-from-a-paired-correlation"><span class="toc-section-number">3.3.2</span> Reporting statistics from a paired correlation</a></li>
<li><a href="#changing-the-text" id="toc-changing-the-text"><span class="toc-section-number">3.3.3</span> Changing the text</a></li>
<li><a href="#plotting-the-average-with-standard-errors" id="toc-plotting-the-average-with-standard-errors"><span class="toc-section-number">3.3.4</span> Plotting the average with standard errors</a></li>
<li><a href="#fill-0f993d-vs-fill-green" id="toc-fill-0f993d-vs-fill-green"><span class="toc-section-number">3.3.5</span> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li><a href="#different-color-for-each-group-but-with-other-colors" id="toc-different-color-for-each-group-but-with-other-colors"><span class="toc-section-number">3.3.6</span> Different color for each group but with other colors</a></li>
<li><a href="#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1." id="toc-lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1."><span class="toc-section-number">3.3.7</span> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li><a href="#summary" id="toc-summary"><span class="toc-section-number">3.4</span> Summary</a></li>
</ul></li>
<li><a href="#boxplot-and-violin-plot" id="toc-boxplot-and-violin-plot"><span class="toc-section-number">4</span> Boxplot and Violin Plot</a>
<ul>
<li><a href="#upload-sample-data-csv-file-in-rstudio" id="toc-upload-sample-data-csv-file-in-rstudio"><span class="toc-section-number">4.1</span> Upload sample data (csv file) in RStudio</a>
<ul>
<li><a href="#download-requirements" id="toc-download-requirements"><span class="toc-section-number">4.1.1</span> Download requirements</a></li>
<li><a href="#before-we-get-started" id="toc-before-we-get-started"><span class="toc-section-number">4.1.2</span> Before we get started</a></li>
<li><a href="#data.csv" id="toc-data.csv"><span class="toc-section-number">4.1.3</span> data.csv</a></li>
<li><a href="#read_csvdata.csv" id="toc-read_csvdata.csv"><span class="toc-section-number">4.1.4</span> <code>read_csv('data.csv')</code></a></li>
<li><a href="#best-way-to-plot-data" id="toc-best-way-to-plot-data"><span class="toc-section-number">4.1.5</span> Best way to plot data</a></li>
</ul></li>
<li><a href="#boxplot" id="toc-boxplot"><span class="toc-section-number">4.2</span> Boxplot</a>
<ul>
<li><a href="#what-is-a-boxplot" id="toc-what-is-a-boxplot"><span class="toc-section-number">4.2.1</span> What is a boxplot?</a></li>
<li><a href="#boxplot-vs-bar-graph" id="toc-boxplot-vs-bar-graph"><span class="toc-section-number">4.2.2</span> Boxplot vs bar graph</a></li>
<li><a href="#boxplot-using-ggplot2" id="toc-boxplot-using-ggplot2"><span class="toc-section-number">4.2.3</span> Boxplot using ggplot2</a></li>
<li><a href="#problem-alphabetical-order" id="toc-problem-alphabetical-order"><span class="toc-section-number">4.2.4</span> Problem: Alphabetical order</a></li>
<li><a href="#displaying-characters-in-a-non-alphabetical-order" id="toc-displaying-characters-in-a-non-alphabetical-order"><span class="toc-section-number">4.2.5</span> Displaying characters in a non-alphabetical order</a></li>
<li><a href="#double-check-if-the-day-column-is-factor" id="toc-double-check-if-the-day-column-is-factor"><span class="toc-section-number">4.2.6</span> Double-check if the ‘Day’ column is factor</a></li>
<li><a href="#back-to-boxplot-using-ggplot2" id="toc-back-to-boxplot-using-ggplot2"><span class="toc-section-number">4.2.7</span> Back to boxplot using ggplot2</a></li>
<li><a href="#a-boxplot-with-individual-data" id="toc-a-boxplot-with-individual-data"><span class="toc-section-number">4.2.8</span> A boxplot with individual data</a></li>
<li><a href="#geom_boxplot-vs-sm_boxplot" id="toc-geom_boxplot-vs-sm_boxplot"><span class="toc-section-number">4.2.9</span> <code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li><a href="#save-boxplot" id="toc-save-boxplot"><span class="toc-section-number">4.2.10</span> Save boxplot</a></li>
</ul></li>
<li><a href="#violin-plot" id="toc-violin-plot"><span class="toc-section-number">4.3</span> Violin Plot</a>
<ul>
<li><a href="#structure-of-the-violin-plot" id="toc-structure-of-the-violin-plot"><span class="toc-section-number">4.3.1</span> Structure of the violin plot</a></li>
<li><a href="#violin-plot-with-ggplot2" id="toc-violin-plot-with-ggplot2"><span class="toc-section-number">4.3.2</span> Violin plot with ggplot2</a></li>
<li><a href="#violin-plot-with-individual-points" id="toc-violin-plot-with-individual-points"><span class="toc-section-number">4.3.3</span> Violin plot with individual points</a></li>
<li><a href="#geom_violin-vs-sm_violin" id="toc-geom_violin-vs-sm_violin"><span class="toc-section-number">4.3.4</span> geom_violin() vs sm_violin()</a></li>
<li><a href="#save-your-violin-plot" id="toc-save-your-violin-plot"><span class="toc-section-number">4.3.5</span> Save your violin plot</a></li>
</ul></li>
<li><a href="#summary-1" id="toc-summary-1"><span class="toc-section-number">4.4</span> Summary</a></li>
</ul></li>
<li><a href="#bar-graph-slope-chart-and-point-plot" id="toc-bar-graph-slope-chart-and-point-plot"><span class="toc-section-number">5</span> Bar Graph, Slope Chart and Point plot</a>
<ul>
<li><a href="#bar-graph" id="toc-bar-graph"><span class="toc-section-number">5.1</span> Bar graph</a>
<ul>
<li><a href="#scaling-the-y-axis" id="toc-scaling-the-y-axis"><span class="toc-section-number">5.1.1</span> Scaling the y-axis</a></li>
<li><a href="#plotting-individual-points-with-unique-colors" id="toc-plotting-individual-points-with-unique-colors"><span class="toc-section-number">5.1.2</span> Plotting individual points with unique colors</a></li>
<li><a href="#other-parameters" id="toc-other-parameters"><span class="toc-section-number">5.1.3</span> Other parameters</a></li>
<li><a href="#bar-graph-with-data-of-multiple-groups" id="toc-bar-graph-with-data-of-multiple-groups"><span class="toc-section-number">5.1.4</span> Bar graph with data of multiple groups</a></li>
</ul></li>
<li><a href="#slope-chart" id="toc-slope-chart"><span class="toc-section-number">5.2</span> Slope chart</a>
<ul>
<li><a href="#slope-chart-with-mean-plot" id="toc-slope-chart-with-mean-plot"><span class="toc-section-number">5.2.1</span> Slope chart with mean plot</a></li>
<li><a href="#slope-chart-with-mean-plot-and-error-bar" id="toc-slope-chart-with-mean-plot-and-error-bar"><span class="toc-section-number">5.2.2</span> Slope chart with mean plot and error bar</a></li>
<li><a href="#slope-chart-with-multiple-x-levels" id="toc-slope-chart-with-multiple-x-levels"><span class="toc-section-number">5.2.3</span> Slope chart with multiple x levels</a></li>
<li><a href="#slope-chart-with-multiple-groups-and-x-levels" id="toc-slope-chart-with-multiple-groups-and-x-levels"><span class="toc-section-number">5.2.4</span> Slope chart with multiple groups and x levels</a></li>
</ul></li>
<li><a href="#point-plot" id="toc-point-plot"><span class="toc-section-number">5.3</span> Point plot</a>
<ul>
<li><a href="#change-the-range-of-y-axis" id="toc-change-the-range-of-y-axis"><span class="toc-section-number">5.3.1</span> Change the range of y-axis</a></li>
<li><a href="#data-with-more-than-two-groups" id="toc-data-with-more-than-two-groups"><span class="toc-section-number">5.3.2</span> Data with more than two groups</a></li>
<li><a href="#point-plot-with-a-shadow-using-data-of-one-group" id="toc-point-plot-with-a-shadow-using-data-of-one-group"><span class="toc-section-number">5.3.3</span> Point plot with a shadow using data of one group</a></li>
<li><a href="#point-plot-with-a-shadow-using-data-of-multiple-groups" id="toc-point-plot-with-a-shadow-using-data-of-multiple-groups"><span class="toc-section-number">5.3.4</span> Point plot with a shadow using data of multiple groups</a></li>
<li><a href="#adding-and-modifying-legends" id="toc-adding-and-modifying-legends"><span class="toc-section-number">5.3.5</span> Adding and modifying legends</a></li>
</ul></li>
</ul></li>
<li><a href="#raincloud-and-forest-plots" id="toc-raincloud-and-forest-plots"><span class="toc-section-number">6</span> Raincloud and Forest Plots</a>
<ul>
<li><a href="#raincloud-plot" id="toc-raincloud-plot"><span class="toc-section-number">6.1</span> Raincloud plot</a>
<ul>
<li><a href="#changing-the-x-axis-labels" id="toc-changing-the-x-axis-labels"><span class="toc-section-number">6.1.1</span> Changing the x-axis labels</a></li>
<li><a href="#separating-the-components-and-configuration" id="toc-separating-the-components-and-configuration"><span class="toc-section-number">6.1.2</span> Separating the components and configuration</a></li>
<li><a href="#changng-the-theme-and-orientation" id="toc-changng-the-theme-and-orientation"><span class="toc-section-number">6.1.3</span> Changng the theme and orientation</a></li>
<li><a href="#raincloud-plot-with-data-from-multiple-groups" id="toc-raincloud-plot-with-data-from-multiple-groups"><span class="toc-section-number">6.1.4</span> Raincloud plot with data from multiple groups</a></li>
</ul></li>
<li><a href="#forest-plot" id="toc-forest-plot"><span class="toc-section-number">6.2</span> Forest plot</a>
<ul>
<li><a href="#plotting-the-forest-plot-using-data-of-multiple-groups" id="toc-plotting-the-forest-plot-using-data-of-multiple-groups"><span class="toc-section-number">6.2.1</span> Plotting the forest plot using data of multiple groups</a></li>
</ul></li>
</ul></li>
<li><a href="#part-data-analysis-with-smplot2" id="toc-part-data-analysis-with-smplot2">(PART) Data Analysis with smplot2</a></li>
<li><a href="#combining-plots-with-common-axes" id="toc-combining-plots-with-common-axes"><span class="toc-section-number">7</span> Combining Plots with Common Axes</a>
<ul>
<li><a href="#filter-select-and-summarise" id="toc-filter-select-and-summarise"><span class="toc-section-number">7.1</span> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li><a href="#filter-for-rows" id="toc-filter-for-rows"><span class="toc-section-number">7.1.1</span> <code>filter()</code> for rows</a></li>
<li><a href="#select-for-columns" id="toc-select-for-columns"><span class="toc-section-number">7.1.2</span> <code>select()</code> for columns</a></li>
<li><a href="#summarise-for-grouped-summaries" id="toc-summarise-for-grouped-summaries"><span class="toc-section-number">7.1.3</span> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li><a href="#plotting-the-averaged-data-with-error-bars" id="toc-plotting-the-averaged-data-with-error-bars"><span class="toc-section-number">7.2</span> Plotting the averaged data with error bars</a></li>
<li><a href="#plotting-individual-data" id="toc-plotting-individual-data"><span class="toc-section-number">7.3</span> Plotting individual data</a></li>
<li><a href="#putting-multiple-plots-together" id="toc-putting-multiple-plots-together"><span class="toc-section-number">7.4</span> Putting multiple plots together</a></li>
</ul></li>
<li><a href="#calculating-area-under-a-curve" id="toc-calculating-area-under-a-curve"><span class="toc-section-number">8</span> Calculating Area under a Curve</a>
<ul>
<li><a href="#pipe" id="toc-pipe"><span class="toc-section-number">8.1</span> Pipe <code>%&gt;%</code></a></li>
<li><a href="#area-under-a-curve" id="toc-area-under-a-curve"><span class="toc-section-number">8.2</span> Area under a curve</a></li>
<li><a href="#reproducing-figures-in-the-paper-min-et-al.-2019" id="toc-reproducing-figures-in-the-paper-min-et-al.-2019"><span class="toc-section-number">8.3</span> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li><a href="#figure-3b-a-best-fit-line-with-points-and-error-bars" id="toc-figure-3b-a-best-fit-line-with-points-and-error-bars"><span class="toc-section-number">8.3.1</span> Figure 3B (a best-fit line with points and error bars)</a></li>
<li><a href="#figure-3d-a-bar-graph" id="toc-figure-3d-a-bar-graph"><span class="toc-section-number">8.3.2</span> Figure 3D (a bar graph)</a></li>
<li><a href="#figure-3e-modeling-in-matlab-and-plotting-in-r" id="toc-figure-3e-modeling-in-matlab-and-plotting-in-r"><span class="toc-section-number">8.3.3</span> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li><a href="#calculating-linear-slopes" id="toc-calculating-linear-slopes"><span class="toc-section-number">9</span> Calculating Linear Slopes</a>
<ul>
<li><a href="#linear-relationship-using-lm" id="toc-linear-relationship-using-lm"><span class="toc-section-number">9.1</span> Linear relationship using <code>lm()</code></a></li>
<li><a href="#calculating-slopes-of-all-subjects-groups-and-conditions" id="toc-calculating-slopes-of-all-subjects-groups-and-conditions"><span class="toc-section-number">9.2</span> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li><a href="#basic-statistics" id="toc-basic-statistics"><span class="toc-section-number">10</span> Basic Statistics</a>
<ul>
<li><a href="#one-sample-t-test" id="toc-one-sample-t-test"><span class="toc-section-number">10.1</span> One-sample t-test</a></li>
<li><a href="#two-sample-t-test" id="toc-two-sample-t-test"><span class="toc-section-number">10.2</span> Two-sample t-test</a>
<ul>
<li><a href="#shapiro-wilk-test-to-test-for-normality-of-data" id="toc-shapiro-wilk-test-to-test-for-normality-of-data"><span class="toc-section-number">10.2.1</span> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li><a href="#wilcoxon-signed-rank-test" id="toc-wilcoxon-signed-rank-test"><span class="toc-section-number">10.3</span> Wilcoxon Signed-rank Test</a></li>
<li><a href="#effect-size" id="toc-effect-size"><span class="toc-section-number">10.4</span> Effect Size</a></li>
<li><a href="#post-hoc-power-analysis" id="toc-post-hoc-power-analysis"><span class="toc-section-number">10.5</span> Post-hoc Power Analysis</a></li>
<li><a href="#bayes-factor" id="toc-bayes-factor"><span class="toc-section-number">10.6</span> Bayes Factor</a>
<ul>
<li><a href="#issues-with-post-hoc-power-analysis" id="toc-issues-with-post-hoc-power-analysis"><span class="toc-section-number">10.6.1</span> Issues with post-hoc power analysis</a></li>
<li><a href="#computing-the-bayes-factor-in-r" id="toc-computing-the-bayes-factor-in-r"><span class="toc-section-number">10.6.2</span> Computing the Bayes factor in R</a></li>
</ul></li>
<li><a href="#one-way-anova" id="toc-one-way-anova"><span class="toc-section-number">10.7</span> One-way ANOVA</a>
<ul>
<li><a href="#check-for-outliers" id="toc-check-for-outliers"><span class="toc-section-number">10.7.1</span> Check for Outliers</a></li>
<li><a href="#checking-for-normality-of-data" id="toc-checking-for-normality-of-data"><span class="toc-section-number">10.7.2</span> Checking for Normality of Data</a></li>
<li><a href="#checking-the-assumption-for-homogeneity-of-variance" id="toc-checking-the-assumption-for-homogeneity-of-variance"><span class="toc-section-number">10.7.3</span> Checking the Assumption for Homogeneity of Variance</a></li>
<li><a href="#computing-one-way-anova" id="toc-computing-one-way-anova"><span class="toc-section-number">10.7.4</span> Computing One-way ANOVA</a></li>
<li><a href="#post-hoc-tests" id="toc-post-hoc-tests"><span class="toc-section-number">10.7.5</span> Post-hoc Tests</a></li>
<li><a href="#one-way-repeated-measures-anova" id="toc-one-way-repeated-measures-anova"><span class="toc-section-number">10.7.6</span> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li><a href="#two-way-anova" id="toc-two-way-anova"><span class="toc-section-number">10.8</span> Two-way ANOVA</a>
<ul>
<li><a href="#identifying-outliers" id="toc-identifying-outliers"><span class="toc-section-number">10.8.1</span> Identifying Outliers</a></li>
<li><a href="#checking-for-normality-of-data-1" id="toc-checking-for-normality-of-data-1"><span class="toc-section-number">10.8.2</span> Checking for Normality of Data</a></li>
<li><a href="#computing-two-way-anova" id="toc-computing-two-way-anova"><span class="toc-section-number">10.8.3</span> Computing Two-way ANOVA</a></li>
<li><a href="#post-hoc-test" id="toc-post-hoc-test"><span class="toc-section-number">10.8.4</span> Post-hoc Test</a></li>
</ul></li>
<li><a href="#friedman-test" id="toc-friedman-test"><span class="toc-section-number">10.9</span> Friedman Test</a>
<ul>
<li><a href="#performing-friedman-test" id="toc-performing-friedman-test"><span class="toc-section-number">10.9.1</span> Performing Friedman Test</a></li>
<li><a href="#post-hoc-analysis" id="toc-post-hoc-analysis"><span class="toc-section-number">10.9.2</span> Post-hoc Analysis</a></li>
</ul></li>
<li><a href="#extra-resources" id="toc-extra-resources"><span class="toc-section-number">10.10</span> Extra Resources</a></li>
</ul></li>
<li><a href="#part-manual-for-smplot2" id="toc-part-manual-for-smplot2">(PART) Manual for smplot2</a></li>
<li><a href="#themes-colors-correlations-boxplots-violins-and-bars-part-1" id="toc-themes-colors-correlations-boxplots-violins-and-bars-part-1"><span class="toc-section-number">11</span> Themes, Colors, Correlations, Boxplots, Violins and Bars (Part 1)</a>
<ul>
<li><a href="#installation-of-the-package" id="toc-installation-of-the-package"><span class="toc-section-number">11.1</span> Installation of the Package</a></li>
<li><a href="#how-...-and-xxx.params-arguments-work" id="toc-how-...-and-xxx.params-arguments-work"><span class="toc-section-number">11.2</span> How <code>...</code> and <code>xxx.params</code> arguments work</a></li>
<li><a href="#color-palette" id="toc-color-palette"><span class="toc-section-number">11.3</span> Color palette</a></li>
<li><a href="#graph-themes" id="toc-graph-themes"><span class="toc-section-number">11.4</span> Graph themes</a></li>
<li><a href="#correlation-plot" id="toc-correlation-plot"><span class="toc-section-number">11.5</span> Correlation plot</a>
<ul>
<li><a href="#sm_statcorr" id="toc-sm_statcorr"><span class="toc-section-number">11.5.1</span> <code>sm_statCorr()</code></a></li>
<li><a href="#sm_corr_avgerr" id="toc-sm_corr_avgerr"><span class="toc-section-number">11.5.2</span> <code>sm_corr_avgErr()</code></a></li>
<li><a href="#structure-of-data-frame" id="toc-structure-of-data-frame"><span class="toc-section-number">11.5.3</span> Structure of data frame</a></li>
<li><a href="#correlation-plot-with-both-regression-and-reference-lines" id="toc-correlation-plot-with-both-regression-and-reference-lines"><span class="toc-section-number">11.5.4</span> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li><a href="#boxplot---sm_boxplot" id="toc-boxplot---sm_boxplot"><span class="toc-section-number">11.6</span> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors-1" id="toc-plotting-individual-points-with-unique-colors-1"><span class="toc-section-number">11.6.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#violin-plot---sm_violin" id="toc-violin-plot---sm_violin"><span class="toc-section-number">11.7</span> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors-2" id="toc-plotting-individual-points-with-unique-colors-2"><span class="toc-section-number">11.7.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#bar-plot---sm_bar" id="toc-bar-plot---sm_bar"><span class="toc-section-number">11.8</span> Bar plot - <code>sm_bar()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors-3" id="toc-plotting-individual-points-with-unique-colors-3"><span class="toc-section-number">11.8.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
</ul></li>
<li><a href="#slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2" id="toc-slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2"><span class="toc-section-number">12</span> Slope Charts, Point plots, Bland-Altman, Forests, Rainclouds, Histograms (Part 2)</a>
<ul>
<li><a href="#slope-chart---sm_slope" id="toc-slope-chart---sm_slope"><span class="toc-section-number">12.1</span> Slope chart - <code>sm_slope()</code></a>
<ul>
<li><a href="#drawing-the-mean-plot" id="toc-drawing-the-mean-plot"><span class="toc-section-number">12.1.1</span> Drawing the mean plot</a></li>
</ul></li>
<li><a href="#point-plot---sm_pointplot" id="toc-point-plot---sm_pointplot"><span class="toc-section-number">12.2</span> Point plot - <code>sm_pointplot()</code></a></li>
<li><a href="#a-bland-altman-plot---sm_bland_altman" id="toc-a-bland-altman-plot---sm_bland_altman"><span class="toc-section-number">12.3</span> A Bland Altman plot - <code>sm_bland_altman()</code></a></li>
<li><a href="#forest-plot---sm_forest" id="toc-forest-plot---sm_forest"><span class="toc-section-number">12.4</span> Forest plot - <code>sm_forest()</code></a>
<ul>
<li><a href="#annotation-using-sm_forest_annot" id="toc-annotation-using-sm_forest_annot"><span class="toc-section-number">12.4.1</span> Annotation using <code>sm_forest_annot()</code></a></li>
</ul></li>
<li><a href="#raincloud-plot---sm_raincloud" id="toc-raincloud-plot---sm_raincloud"><span class="toc-section-number">12.5</span> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li><a href="#histogram---sm_hist" id="toc-histogram---sm_hist"><span class="toc-section-number">12.6</span> Histogram - <code>sm_hist()</code></a></li>
</ul></li>
<li><a href="#part-contrast-sensitivity-function" id="toc-part-contrast-sensitivity-function">(PART) Contrast Sensitivity Function</a></li>
<li><a href="#plotting-the-contrast-sensitivity-function" id="toc-plotting-the-contrast-sensitivity-function"><span class="toc-section-number">13</span> Plotting the Contrast Sensitivity Function</a>
<ul>
<li><a href="#brief-introduction" id="toc-brief-introduction"><span class="toc-section-number">13.1</span> Brief Introduction</a></li>
<li><a href="#data-visualization" id="toc-data-visualization"><span class="toc-section-number">13.2</span> Data Visualization</a></li>
<li><a href="#facetting-the-contrast-sensitivity-functions" id="toc-facetting-the-contrast-sensitivity-functions"><span class="toc-section-number">13.3</span> Facetting the Contrast Sensitivity Functions</a></li>
</ul></li>
<li><a href="#area-under-curve-aulcsf-and-r2-of-the-csf" id="toc-area-under-curve-aulcsf-and-r2-of-the-csf"><span class="toc-section-number">14</span> Area under Curve, AULCSF and R2 of the CSF</a>
<ul>
<li><a href="#area-under-a-curve-1" id="toc-area-under-a-curve-1"><span class="toc-section-number">14.1</span> Area under a Curve</a></li>
<li><a href="#sm_trapz-sm_aulcsf-and-sm_r2" id="toc-sm_trapz-sm_aulcsf-and-sm_r2"><span class="toc-section-number">14.2</span> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code></a></li>
<li><a href="#calculating-area-and-r2-of-all-subjects-groups-and-conditions" id="toc-calculating-area-and-r2-of-all-subjects-groups-and-conditions"><span class="toc-section-number">14.3</span> Calculating area and R2 of all subjects, groups and conditions</a></li>
<li><a href="#case-study" id="toc-case-study"><span class="toc-section-number">14.4</span> Case Study</a></li>
</ul></li>
<li><a href="#understanding-the-contrast-sensitivity-function" id="toc-understanding-the-contrast-sensitivity-function"><span class="toc-section-number">15</span> Understanding the Contrast Sensitivity Function</a>
<ul>
<li><a href="#contrast-sensitivity-function-model" id="toc-contrast-sensitivity-function-model"><span class="toc-section-number">15.1</span> Contrast Sensitivity Function Model</a></li>
<li><a href="#understanding-sm_csf" id="toc-understanding-sm_csf"><span class="toc-section-number">15.2</span> Understanding <code>sm_CSF()</code></a>
<ul>
<li><a href="#sm_params" id="toc-sm_params"><span class="toc-section-number">15.2.1</span> <code>sm_params()</code></a></li>
<li><a href="#sm_cutoff" id="toc-sm_cutoff"><span class="toc-section-number">15.2.2</span> <code>sm_cutOff()</code></a></li>
</ul></li>
<li><a href="#understanding-sm_ribboncsf" id="toc-understanding-sm_ribboncsf"><span class="toc-section-number">15.3</span> Understanding <code>sm_ribbonCSF()</code></a></li>
<li><a href="#calculating-the-five-parameters-of-all-subjects-groups-and-conditions" id="toc-calculating-the-five-parameters-of-all-subjects-groups-and-conditions"><span class="toc-section-number">15.4</span> Calculating the five parameters of all subjects, groups and conditions</a></li>
<li><a href="#visualization-of-the-parameters" id="toc-visualization-of-the-parameters"><span class="toc-section-number">15.5</span> Visualization of the parameters</a></li>
<li><a href="#case-study-1" id="toc-case-study-1"><span class="toc-section-number">15.6</span> Case Study</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="index" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Welcome!<a href="#index" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-7-1.png" width="710.4" /></p>
<p>This book (<a href="https://smin95.com/dataviz" class="uri">https://smin95.com/dataviz</a>) guides the reader to be familiar with R, a programming language, for data visualization. It also introduces the R package <strong>smplot2</strong>, which aims to make the process of data visualization simple. This book was created entirely using RMarkdown for reproducibility.</p>
<p>The old website (on <strong>smplot</strong>) can be accessed using this link (<a href="https://smin95.com/dataviz0" class="uri">https://smin95.com/dataviz0</a>).</p>
<div id="major-updates" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Major updates<a href="#major-updates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>2022-11-26: <strong>smplot2</strong> has been debugged, notably <code>sm_violin()</code>, <code>sm_statCorr()</code> and <code>sm_corr_theme()</code>. Please update <em>smplot2</em> if you are a user.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&#39;tidyverse&#39;</span>,<span class="st">&#39;devtools&#39;</span>,<span class="st">&#39;gghalves&#39;</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot2&#39;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Also, for those who have been a <em>smplot</em> user, if you are capable of adapting to some changes made to <strong>smplot2</strong>, <strong>please delete smplot</strong> and then use <strong>smplot2</strong>. More information about updates is on Chapters 11 and 12.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove.packages</span>(<span class="st">&quot;smplot&quot;</span>)</span></code></pre></div>
</div>
<div id="issues-and-contact" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Issues and contact<a href="#issues-and-contact" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you spot any mistakes in this online book, please pull-request on <a href="https://github.com/smin95/dataviz">Github</a> or email me <a href="mailto:seung.min@mail.mcgill.ca" class="email">seung.min@mail.mcgill.ca</a>. If you find issues with the ‘smplot’ package, please pull-request on <a href="https://github.com/smin95/smplot">Github</a>.</p>
</div>
<div id="license" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">License<a href="#license" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>smplot2</strong> is under the MIT license. This tutorial is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. I am the sole creator of <strong>smplot2</strong>.</p>
</div>
<div id="about-the-author" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">About the author<a href="#about-the-author" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I am Assistant Professor in Dept. Ophthalmology and Optometry at Wenzhou Medical University. On June 2021, I received my PhD at McGill University under the supervision of Dr. Robert F. Hess. My research is focused on amblyopia, neural plasticity and binocular vision. During spare time, I play the clarinet and develop R packages. More details, such as my publications, are on my website: <a href="https://www.smin95.com" class="uri">https://www.smin95.com</a>.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="opening-remarks" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Opening Remarks<a href="#opening-remarks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>smplot2</strong> has been created to enable both novice and intermediate R users to perform elegant data visualization that is appropriate for scientific publications. Also, it provides tools that are important for performing data analysis that is common in medicine and psychology.</p>
<div id="how-to-read-this-book" class="section level2 hasAnchor" number="1.1">
<h2 class="hasAnchor"><span class="header-section-number">1.1</span> How to read this book<a href="#how-to-read-this-book" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you are a proficient R user, I suggest that you read Chapters 11 and 12 because all the preceding sections incorporate contents about basics of R.</p>
<p>If you are a <strong>smplot</strong> user, you can either use its tutorial website (<a href="https://www.smin95.com/dataviz0" class="uri">https://www.smin95.com/dataviz0</a>) and continue to use <strong>smplot</strong> or modify your codes so that it works with <strong>smplot2</strong>. If you decide to use <strong>smplot2</strong>, I suggest you that you delete <strong>smplot</strong>. Also, I suggest that you read Chapters 11 (especially the sub-section: How <code>...</code> parameter and <code>xxx.params</code> work) and 12 to understand the changes that have been made to the new package rather than to read the book from the beginning.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove.packages</span>(<span class="st">&quot;smplot&quot;</span>)</span></code></pre></div>
<p>If you are a newcomer, then you can just start reading from the next chapter.</p>
<!--chapter:end:updates.Rmd-->
</div>
</div>
<div id="download-rstudio-basics-of-r" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Download RStudio &amp; Basics of R<a href="#download-rstudio-basics-of-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="setting-up-rstudio" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> Setting up RStudio<a href="#setting-up-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="why-use-r-for-data-visualization" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Why use R for data visualization?<a href="#why-use-r-for-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>R is free.</li>
<li>Often, less codes are needed in R to plot an elegant graph.</li>
<li>for/while loops (basic concepts in programming) are not necessary in R to make a production-quality graph.</li>
<li>R is the best software for statistical analysis.</li>
</ul>
</div>
<div id="other-available-resources-for-r" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Other available resources for R<a href="#other-available-resources-for-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Stack Overflow: <a href="https://www.stackoverflow.com" class="uri">https://www.stackoverflow.com</a></li>
<li>R for Data Science (a bible for learning R): <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></li>
<li>R documentation: <a href="https://www.rdocumentation.org" class="uri">https://www.rdocumentation.org</a></li>
<li>Learn Statistics with R: <a href="https://learningstatisticswithr.com/" class="uri">https://learningstatisticswithr.com/</a></li>
<li>ggplot2 (a reference for plotting data in R): <a href="https://ggplot2-book.org/" class="uri">https://ggplot2-book.org/</a></li>
</ul>
</div>
<div id="download-requirements-for-rstudio" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Download requirements for RStudio<a href="#download-requirements-for-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Download R: <a href="http://cran.r-project.org/" class="uri">http://cran.r-project.org/</a></li>
<li>For Mac users: Mac: XQuartz <a href="https://www.xquartz.org/" class="uri">https://www.xquartz.org/</a></li>
<li>RStudio: <a href="http://www.rstudio.org/" class="uri">http://www.rstudio.org/</a></li>
</ul>
</div>
<div id="open-rstudio" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Open RStudio<a href="#open-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center">
<img src="img/rstudio.png" alt="Rstudio layout, image from http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" width="65%" />
<p class="caption">
(#fig:pressure)Rstudio layout, image from <a href="http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" class="uri">http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming</a>
</p>
</div>
<ul>
<li><strong>Rstudio</strong> is where people do R programming.</li>
<li>You can type codes (<strong>commands</strong>) into the <strong>console</strong> (bottom-left panel).
<ul>
<li><code>&gt;</code> means that the console is ready to receive more code.</li>
<li><code>+</code> means your code is not complete.</li>
</ul></li>
<li>You can also write (longer) codes in the <strong>script</strong> within the code editor (top-left panel).
<ul>
<li>The code editor will run the script into the console.</li>
<li>A <strong>new script</strong> can be opened by clicking: <strong>File -&gt; New -&gt; R Script</strong>.</li>
</ul></li>
<li>You can run a script by clicking <strong>’Run”</strong> with the green arrow or by typing <strong>ctrl + enter</strong>. It is labeled with the red circle.
<ul>
<li>Or you can just type your codes directly into the console.</li>
</ul></li>
</ul>
</div>
<div id="lets-make-a-folder-and-set-it-as-working-directory" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Let’s make a folder and set it as working directory<a href="#lets-make-a-folder-and-set-it-as-working-directory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center">
<img src="img/setwd.png" alt="Setting your working directory, image from https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html" width="80%" />
<p class="caption">
(#fig:unnamed-chunk-11)Setting your working directory, image from <a href="https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html" class="uri">https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html</a>
</p>
</div>
<ul>
<li>Create a folder named <strong>LearnR</strong> in Desktop.</li>
<li>Set the folder as your working directory by clicking: <strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>. Then find your <strong>LearnR</strong> folder.</li>
<li>More information about setting up a directory is here:
<a href="http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" class="uri">http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming</a></li>
<li>You will need set the directory <strong>every time</strong> you start RStudio.</li>
</ul>
</div>
<div id="how-to-run-your-code" class="section level3 hasAnchor" number="2.1.1">
<h3 class="hasAnchor"><span class="header-section-number">2.1.1</span> How to run your code<a href="#how-to-run-your-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>You can run code in 2 ways.</p></li>
<li><p>First, you can type it in the script and run it after highlighting the codes you would like to run.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/run_code.PNG" alt="How to run your code - script" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-12)How to run your code - script
</p>
</div>
<ul>
<li>Second, you can type your code directly in the console.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/run_code_console.PNG" alt="How to run your code - console" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-13)How to run your code - console
</p>
</div>
</div>
</div>
<div id="basics-of-r" class="section level2 hasAnchor" number="2.2">
<h2 class="hasAnchor"><span class="header-section-number">2.2</span> Basics of R<a href="#basics-of-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lets-type-some-codes" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Let’s type some codes<a href="#lets-type-some-codes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Capitalization, punctuations and brackets are all important.</li>
<li><code>' '</code> and <code>" "</code> mean the same.</li>
<li>However, <code>' "</code> are not paired. So they will not work.</li>
<li><code>=</code> and <code>&lt;-</code> mean equivalent.
<ul>
<li>I often use <code>&lt;-</code>.</li>
</ul></li>
<li>Type <code>?</code> when you are not sure about the code (ex. <code>?t.test</code>)</li>
<li>A code becomes comment when it is preceded by <code>#</code>.
<ul>
<li>Try typing <code># g = 3</code> and see if the number gets stored in g by typing <strong>g</strong> in the console.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">3</span> <span class="co"># x equals to 3</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># a equals to 4 </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="st">&#39;Group&#39;</span> <span class="co"># gr is equal to a character &#39;Group&#39;, which is not a number.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="st">&quot;Group&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>d <span class="sc">==</span> e <span class="co"># &#39;Group&#39; and &quot;Group&quot; are equal</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># g = 3 # its a comment</span></span></code></pre></div>
<ul>
<li>Notice that I used <code>==</code> to test if <strong>d</strong> and <strong>e</strong> are equal. Therefore, <code>==</code> and <code>=</code> mean different. <code>==</code> <strong>tests</strong> if two things are equal. <code>=</code> <strong>sets</strong> two things to be equal.
<ul>
<li><code>d == e</code> returns <code>TRUE</code> because they are both <code>'Group'</code>. <code>TRUE</code> is equivalent to 1 numerically.</li>
</ul></li>
<li>Now let’s check if <strong>x</strong> and <strong>a</strong> are equal.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> a</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<ul>
<li><p>It returns <code>FALSE</code> because <strong>x</strong> and <strong>a</strong> are not equal. This is correct because 3 and 4 are not equal. <code>FALSE</code> equals to 0 numerically.</p></li>
<li><p>Below are more examples showing that <code>TRUE</code> = 1 and <code>FALSE</code> = 0.</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="cn">FALSE</span> <span class="co"># 1 + 0</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="cn">TRUE</span> <span class="co"># 1 + 1</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">+</span> <span class="cn">FALSE</span> <span class="co"># 0 + 0</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span><span class="sc">*</span><span class="dv">2</span> <span class="co"># 1 * 2</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span><span class="sc">*</span><span class="cn">FALSE</span> <span class="co"># 1 * 0</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="how-can-i-learn-most-effectively-with-the-notes" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">How can I learn most effectively with the notes?<a href="#how-can-i-learn-most-effectively-with-the-notes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Don’t just read it.</li>
<li>Don’t just copy and paste the codes and run them in RStudio (ctrl + c &amp; ctrl + p). <strong>Make sure you type each code.</strong></li>
<li>You can also change your code and see if it still works.</li>
<li>If you are not sure of your code, you can type <code>?</code> before the function.</li>
<li>If you are still not sure after reading the notes, check out Chapter 3 of <strong>R for Data Science</strong>: <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></li>
</ul>
</div>
<div id="more-installation" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">More installation<a href="#more-installation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>R is an old programming language.</li>
<li>So, people, such as statisticians and programmers, have created more functions in R in the form of the package to update the language. They are free but they have to be downloaded separately.
<ul>
<li>A <strong>package</strong> can contain several <strong>functions</strong>.</li>
<li>In this tutorial, you will mainly be using <strong>ggplot2</strong> package, which is elegant and flexible for visualizing data.</li>
<li>Also, you will be using <strong>smplot2</strong> package. It improves ggplot2 graphs visually.</li>
</ul></li>
<li>So, you will need to install some packages, such as ggplot2 and smplot2. Please type the codes below.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot2&#39;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>) <span class="co"># requires VPN if you are in China</span></span></code></pre></div>
<ul>
<li>You only need to install them once, but you will need to reload them whenever you start a new session in RStudio using the function <code>library()</code>.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;tidyverse&#39;</span>) <span class="co"># only need to install once</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;cowplot&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># packages must be loaded every time by using library() when you run your script</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<ul>
<li>Now let’s make some graphs in the subsequent chapters.</li>
</ul>
<!--chapter:end:basics.Rmd-->
</div>
</div>
</div>
<div id="part-data-visualization-with-smplot2" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Data Visualization with smplot2<a href="#part-data-visualization-with-smplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="basics-of-ggplot2-and-correlation-plot" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> Basics of ggplot2 and Correlation Plot<a href="#basics-of-ggplot2-and-correlation-plot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<div id="uploading-data" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Uploading data<a href="#uploading-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sample-data-mpg" class="section level3 hasAnchor" number="3.1.1">
<h3 class="hasAnchor"><span class="header-section-number">3.1.1</span> Sample data: mpg<a href="#sample-data-mpg" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I will be using an example from the book <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/data-visualisation.html" class="uri">https://r4ds.had.co.nz/data-visualisation.html</a>).</p>
<ul>
<li><strong>Question: Do cars with large engines use up more fuel than the those with small ones?</strong></li>
</ul>
<p>First, let’s open <strong>mpg</strong>, which is a <strong>data frame</strong> stored in the <strong>ggplot2</strong> package.</p>
<ul>
<li><p><strong>mpg</strong> contains data about cars in the US. You can type <code>?mpg</code> for more information.</p>
<ul>
<li><strong>displ</strong>: the size of the car’s engine in liters</li>
<li><strong>hwy</strong>: fuel efficiency. If it’s high, then the car uses less fuel per distance.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mpg</span></code></pre></div>
<pre><code>## # A tibble: 234 x 11
##    manufacturer model      displ  year   cyl trans      drv     cty   hwy fl    class  
##    &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  
##  1 audi         a4           1.8  1999     4 auto(l5)   f        18    29 p     compact
##  2 audi         a4           1.8  1999     4 manual(m5) f        21    29 p     compact
##  3 audi         a4           2    2008     4 manual(m6) f        20    31 p     compact
##  4 audi         a4           2    2008     4 auto(av)   f        21    30 p     compact
##  5 audi         a4           2.8  1999     6 auto(l5)   f        16    26 p     compact
##  6 audi         a4           2.8  1999     6 manual(m5) f        18    26 p     compact
##  7 audi         a4           3.1  2008     6 auto(av)   f        18    27 p     compact
##  8 audi         a4 quattro   1.8  1999     4 manual(m5) 4        18    26 p     compact
##  9 audi         a4 quattro   1.8  1999     4 auto(l5)   4        16    25 p     compact
## 10 audi         a4 quattro   2    2008     4 manual(m6) 4        20    28 p     compact
## # ... with 224 more rows</code></pre>
<p>Notice that some columns and rows are not shown. You can type <code>View(mpg)</code> to see the entire <strong>data frame</strong>.</p>
<ul>
<li>Each row is an unique observation.</li>
<li>Each column is an unique variable/condition.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mpg)</span></code></pre></div>
</div>
</div>
<div id="basics-of-ggplot2" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> Basics of ggplot2<a href="#basics-of-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lets-make-some-graphs" class="section level3 hasAnchor" number="3.2.1">
<h3 class="hasAnchor"><span class="header-section-number">3.2.1</span> Let’s make some graphs<a href="#lets-make-some-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Question: Do cars with large engines use up more fuel than the those with small ones?</p>
<p>To answer our question, we need to plot <strong>mpg</strong> data. The x-axis should be <strong>displ</strong>, the y-axis should be <strong>hwy</strong>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-23-1.png" width="336" /></p>
<p>We find that a smaller car has a higher efficiency and that a larger car has a lower efficiency. In other words, we see a negative relationship.</p>
</div>
<div id="how-ggplot-works" class="section level3 hasAnchor" number="3.2.2">
<h3 class="hasAnchor"><span class="header-section-number">3.2.2</span> How ggplot works<a href="#how-ggplot-works" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you are making a graph with <strong>ggplot2</strong>, always begin by typing the function <code>ggplot()</code>.</p>
<ul>
<li>The <strong>data</strong> you want to plot is the <strong>first argument</strong> here. Ex. <code>ggplot(data = mpg)</code>.</li>
</ul>
<p>However, <code>ggplot(data = mpg)</code> alone does not create a graph. You will need <strong>add</strong> (by typing <strong>+</strong>) more layers, such as <code>geom_point()</code>.</p>
<ul>
<li><p><code>geom_point()</code> adds points to your graphs. You will need to specify (or map) x- and y-axes in the <code>aes()</code> function, which means aesthetics. This process is called <strong>mapping</strong>.</p></li>
<li><p>As you might expect, there are other <strong>geom</strong> functions, such as <code>geom_bar()</code>, <code>geom_boxplot()</code>, <code>geom_errorbar()</code>. They plot bar graphs, boxplots and error bars, respectively.</p></li>
</ul>
<p>Here is the <strong>template</strong> for using <strong>ggplot2</strong> (copied from <em>R for Data Science</em>).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="er">&lt;</span>GEOM_FUNCTION<span class="sc">&gt;</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="sc">&lt;</span>MAPPINGS<span class="sc">&gt;</span>))</span></code></pre></div>
</div>
<div id="different-color-of-points-for-each-unique-group" class="section level3 hasAnchor" number="3.2.3">
<h3 class="hasAnchor"><span class="header-section-number">3.2.3</span> Different color of points for each unique group<a href="#different-color-of-points-for-each-unique-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can apply different colors by the <strong>class</strong> of each car (each car = each row of the <strong>mpg</strong> data frame).</p>
<ul>
<li><p>Include <code>class</code> variable in the <code>aes()</code> function.</p></li>
<li><p>This maps the third variable <code>class</code> into your graph.</p></li>
<li><p><code>aes()</code> means aesthetic (ex. color, shape, etc).</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-25-1.png" width="480" /></p>
<p>You can also set different shapes for each group of the data.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" width="480" /></p>
<p>You could also set it using aesthetic parameter such as size or transparency (not recommended) across groups. However these are not recommended as it is very hard for us to see the differences in both size and alpha as these are <strong>continuous</strong> parameters. But you get the idea. Using <code>aes()</code> in a geom function (ex. <code>geom_point()</code>), you can label different group of points.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different levels of transparency (alpha) for each group</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-27-1.png" width="480" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different sizes of the points for each group</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-28-1.png" width="480" /></p>
</div>
<div id="different-color-shape-for-each-group" class="section level3 hasAnchor" number="3.2.4">
<h3 class="hasAnchor"><span class="header-section-number">3.2.4</span> Different color &amp; shape for each group<a href="#different-color-shape-for-each-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also apply different color &amp; shape for each group of the data.</p>
<p><strong>Exercise</strong>: Try it on your own before you look at the code below.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-29-1.png" width="480" /></p>
</div>
<div id="same-shape-across-all-groups" class="section level3 hasAnchor" number="3.2.5">
<h3 class="hasAnchor"><span class="header-section-number">3.2.5</span> Same shape across all groups<a href="#same-shape-across-all-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far, you have put variables such as <code>shape</code> and <code>color</code> inside the function <code>aes()</code>. This can enable you to apply different shape and color for each group.</p>
<p>If you put the variable for <code>shape</code>, <code>color</code>, <code>size</code> outside of <code>aes()</code> in the geom function, then all data points will have the specified <code>shape</code>, <code>color</code>, etc even if they are in different groups.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">17</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-30-1.png" width="480" /></p>
<p>Notice that the <code>color</code> is different for each group because it is inside the function <code>aes()</code>. However, all the points are triangle because we have typed <code>shape = 17</code> outside the function <code>aes()</code>.</p>
<p><strong>Exercise:</strong> try changing the shape of the points to the circle with the border.</p>
<div class="figure" style="text-align: center">
<img src="img/shape.JPG" alt="image from http://www.sthda.com/english/wiki/ggplot2-point-shapes" width="25%" />
<p class="caption">
(#fig:unnamed-chunk-31)image from <a href="http://www.sthda.com/english/wiki/ggplot2-point-shapes" class="uri">http://www.sthda.com/english/wiki/ggplot2-point-shapes</a>
</p>
</div>
<ul>
<li><p><code>shape = 19</code>: the shape is circle without the border.</p></li>
<li><p><code>shape = 20</code>: the shape is small circle without the border.</p></li>
<li><p><code>shape = 21</code>, the shape is circle with the border.</p></li>
<li><p>So let’s set <code>shape</code> to 21.</p></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-32-1.png" width="480" /></p>
<ul>
<li>Notice that the border color is different for each group, but not the color that fills the circle.</li>
<li>Shapes without their borders (15-20) are filled with <code>color</code>.</li>
<li>Shapes with the border (21-24) are filled with <code>fill</code> and its border colored with <code>color</code>.</li>
<li>So let’s change <code>color = Class</code> to <code>fill = Class</code>.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">fill =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-33-1.png" width="480" /></p>
</div>
<div id="how-do-we-draw-the-best-fit-line-of-the-graph" class="section level3 hasAnchor" number="3.2.6">
<h3 class="hasAnchor"><span class="header-section-number">3.2.6</span> How do we draw the best-fit line of the graph?<a href="#how-do-we-draw-the-best-fit-line-of-the-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is our graph.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-34-1.png" width="336" /></p>
<p>There seems to be a negative relationship. How do we draw the best-fit line of the graph’s negative relationship? Use another geom function <code>geom_smooth()</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-35-1.png" width="336" /></p>
</div>
<div id="geom_point-geom_smooth" class="section level3 hasAnchor" number="3.2.7">
<h3 class="hasAnchor"><span class="header-section-number">3.2.7</span> geom_point() + geom_smooth()<a href="#geom_point-geom_smooth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s combine geom_point() + geom_smooth() into one graph.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-37-1.png" width="336" /></p>
<p><code>ggplot()</code> acts as a system where you can add multiple <code>geom</code> objects, such as <code>geom_point()</code> and <code>geom_smooth()</code>. You can add multiple layers of geom in a single plot, like shown here.</p>
<p><code>ggplot()</code> and <strong>at least one geom</strong> function are necessary to draw a graph. <code>ggplot()</code> alone does not draw a graph. Try it on your own.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-38-1.png" width="336" /></p>
</div>
<div id="writing-shorter-codes" class="section level3 hasAnchor" number="3.2.8">
<h3 class="hasAnchor"><span class="header-section-number">3.2.8</span> Writing shorter codes<a href="#writing-shorter-codes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p>Notice that we have typed <code>mapping = aes(x = displ, y = hwy)</code> twice. This is <strong>repetitive</strong>. If you type the <code>mapping</code> argument in <code>ggplot()</code>, you won’t need to type them anymore in the subsequent <code>geom</code> functions.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-40-1.png" width="336" /></p>
<p>This is exactly the same as the previous graph. In both cases, the mapping has been set so that the x-axis is <code>displ</code> and the y-axis is <code>hwy</code> in both <code>geom_point()</code> and <code>geom_smooth()</code>.</p>
<p>Now let’s apply different color of points and the fit the line for each group.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-41-1.png" width="480" /></p>
<p>Okay, this is extremely messy and probably a bad idea.</p>
<ul>
<li>You might have gotten <code>warnings</code> but you can usually ignore them.</li>
</ul>
<p>Let’s plot the best-fit line across all groups (i.e., one best-fit line) but apply different color for each class (i.e., many colors). To do so, type <code>color = class</code> in geom_point, not <code>ggplot()</code>. This enables you to specify that you will apply different color for each class <strong>only</strong> in <code>geom_point()</code> but not in <code>geom_smooth()</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-42-1.png" width="480" /></p>
</div>
</div>
<div id="improve-data-visualization-using-smplot2" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> Improve data visualization using smplot2<a href="#improve-data-visualization-using-smplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Although the default theme of ggplot2 graphs is clean, there are some things that I do not like:</p>
<ul>
<li><p>The fonts are too small.</p></li>
<li><p>The grey background is distracting.</p></li>
<li><p>There are too many grids.</p></li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-43-1.png" width="480" /></p>
<p>Let’s make this graph prettier by using functions from <strong>smplot2</strong>.
- In this example, let’s use <code>sm_corr_theme()</code>. I’ve made this function as a theme suitable for correlation plots.
- Disclaimer: <strong>smplot2</strong> package has been built based on my preference.
- <strong>smplot2</strong> is not necessary to make a <strong>ggplot</strong> graph or change its style.</p>
<p>It is possible to change every aspect of the graph with <strong>ggplot2</strong> but this requires about 8-20 lines of codes (based on my experience). Instead, <strong>smplot2</strong> function does so in a few lines of code.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-1.png" width="480" /></p>
<p>Now let’s remove the border within <code>sm_corr_theme()</code> by setting <code>borders = FALSE</code>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-45-1.png" width="480" /></p>
<p><strong>Exercise:</strong> You can also set <code>borders = TRUE</code> and see what happens.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>You might notice that borders come back. This is exactly what happens when you do not include <code>borders</code> argument in <code>sm_corr_theme()</code>. This is because <code>sm_corr_theme()</code> is set to <code>borders = TRUE</code> as default.</p>
<ul>
<li>I think the one with the border looks better.</li>
<li>You can also remove the legend by setting <code>legends = FALSE</code> in <code>sm_corr_theme()</code>.</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-47-1.png" width="336" /></p>
<p><strong>Exercise</strong> Set <code>legends = TRUE</code> and see what happens. Type <code>?sm_corr_theme</code> to see why legends appear without directly writing <code>legends = TRUE</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>However, in this case, I think we need a legend because there are many <strong>classes</strong>.</p>
<div id="positive-relationship-between-x--and-y-axes" class="section level3 hasAnchor" number="3.3.1">
<h3 class="hasAnchor"><span class="header-section-number">3.3.1</span> Positive relationship between x- and y-axes<a href="#positive-relationship-between-x--and-y-axes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s plot another scatterplot using <strong>mtcars</strong> data.</p>
<ul>
<li>Set the x-axis with <strong>drat</strong> and y-axis with <strong>mpg</strong>.</li>
<li>Since you are making a scatterplot, you will need to use <code>geom_point()</code>.</li>
<li>Set the <strong>size</strong> of all points to <strong>3</strong> by typing <code>size = 3</code>.</li>
<li>Set the <strong>shape</strong> of all points to the circle with a border by typing <code>shape = 21</code>.</li>
<li>Set the <strong>filled color</strong> of all points to <strong>green</strong> by typing <code>fill = '#0f993d'</code>.</li>
<li>Set the <strong>border color</strong> to <strong>white</strong> by typing <code>color = 'white'</code>.
<ul>
<li>Since <code>shape = 21</code> refers to the circle with a border, <code>fill</code> is the color that fills the points and <code>color</code> is the border color.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-49-1.png" width="336" /></p>
<p><strong>drat</strong> and <strong>mpg</strong> have a positive relationship. Now let’s make it pretty by adding <code>sm_corr_theme()</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-50-1.png" width="336" /></p>
<p>You can remove borders too by setting <code>borders = FALSE</code> in <code>sm_corr_theme()</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-51-1.png" width="336" /></p>
</div>
<div id="reporting-statistics-from-a-paired-correlation" class="section level3 hasAnchor" number="3.3.2">
<h3 class="hasAnchor"><span class="header-section-number">3.3.2</span> Reporting statistics from a paired correlation<a href="#reporting-statistics-from-a-paired-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>smplot2</strong> also offers a function that plots the best-fit line of a scatterplot (i.e., correlation plot) and prints statistical values, such as p- and R-values.</p>
<ul>
<li>p-value is used to check for statistical significance. If it’s less than 0.05, its regarded as <strong>statistically significant</strong>. However, it gets smaller with a larger sample size.</li>
<li>R-value (correlation coefficient) measures the strength and the direction of the correlation. It ranges from -1 to 1. It does not depend on the sample size.</li>
<li>Let’s add a function <code>sm_statCorr()</code>. The statistical results are from Pearson’s correlation test.</li>
</ul>
<p><code>sm_statCorr()</code> is combined with <code>sm_corr_theme()</code> (updated in smplot2). Therefore, when you print the statstical values using <code>sm_statCorr()</code>, the correlation theme is automatically used.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-52-1.png" width="336" /></p>
<p>I don’t really like how the line color is different from that of the points.</p>
<p>Let’s change the color to green.</p>
<ul>
<li>You can also change the <code>linetype</code> by setting it as <code>linetype = 'dashed'</code> or <code>linetype = 'solid'</code>, which is the default as shown here.</li>
<li>Also let’s get results from Spearman’s correlation test rather than from Pearson’s.</li>
<li>To do so, type <code>corr_method = 'spearman'</code> in the function <code>sm_statCorr()</code>. You will get a different <strong>R</strong> value from 0.68, which is from Pearson’s correlation test.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-53-1.png" width="336" /></p>
<ul>
<li><strong>Exercise</strong>: Set <code>corr_method = 'pearson'</code>and see what happens.</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>)</span></code></pre></div>
<p>You will see that this is exactly the same as when <code>corr_method</code> argument is not included in <code>sm_statCorr()</code>. In short, the <strong>default</strong> correlation method for <code>sm_statCorr()</code> is <code>'pearson'</code>. So, if you don’t write anything for <code>corr_method</code>, it will give results from Pearson’s correlation test. Type <code>?sm_statCorr</code> to see the default of <code>line_type</code>.</p>
<ul>
<li><code>#0f993d</code> is a specific green that I like.</li>
<li>Now, let’s change the color. Replace <code>'#0f993d'</code> with <code>'green'</code> in <code>geom_point()</code> and <code>sm_statCorr</code>.
<ul>
<li>This <code>'green'</code> is the default green color of <strong>R</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;green&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-55-1.png" width="336" /></p>
<p>To precisely change the parameter for the fitted line, you can do it as shown below by filling the <code>fit.params</code> argument in the form of <code>list</code>, such as <code>fit.params = list(color = ..., linetype = ...)</code>.</p>
<ul>
<li><code>fit.params</code> feeds arguments for aesthetics into <code>geom_smooth()</code> such as <code>color</code> so that the fitted regression line can have specified aesthetics.</li>
</ul>
<p>In fact, this is the major update of <strong>smplot2</strong> across most visualizing functions from <strong>smplot</strong>. As you will notice later, this offers more aesthetic flexibility for users.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-56-1.png" width="336" /></p>
<p>You can also remove the <code>borders</code> of the plot using <code>sm_statCorr</code>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-57-1.png" width="336" /></p>
<p>Which one do you prefer? With or without the border?</p>
</div>
<div id="changing-the-text" class="section level3 hasAnchor" number="3.3.3">
<h3 class="hasAnchor"><span class="header-section-number">3.3.3</span> Changing the text<a href="#changing-the-text" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you do not like the fact that the correlation stats are displayed as <code>R = 0.65, p &lt; 0.001</code> and that you rather show it as <code>R = 0.65</code> and <code>p &lt; 0.001</code> in separate lines, you can do it too.</p>
<p>In <code>R</code>, <code>\n</code> means addition of a new line. So you can set the argument <code>separate_by = '\n'</code>, which essentially means <code>R = 0.65\n p &lt; 0.001</code>, which will create two lines.</p>
<p>You would test this directly by typing in R console.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;R = 0.65</span><span class="sc">\n</span><span class="st">p &lt; 0.001&#39;</span>)</span></code></pre></div>
<pre><code>## R = 0.65
## p &lt; 0.001</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>), </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">separate_by =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-59-1.png" width="336" /></p>
<p>Another way is just do directly compute it yourself using <code>cor()</code> or <code>cor.test()</code>, and annotate the statistical results on the plot. This might be a better alternative if you wish to precisely modify how the text is presented.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>mpg, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  mtcars$drat and mtcars$mpg
## S = 1901.7, p-value = 5.381e-05
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.6514555</code></pre>
<p>Store the results from <code>cor.test()</code> into a variable called <code>res</code>, which is short for <strong>results</strong>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>mpg, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>p.value </span></code></pre></div>
<pre><code>## [1] 5.381347e-05</code></pre>
<p>You can extract certain component of the results from <code>cor.test()</code> from the variable <code>res</code> by using <code>$</code>. <code>res$p.value</code> extracts the p-value, and <code>res$estimate</code> extracts the correlation coefficient <code>R</code>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>estimate</span></code></pre></div>
<pre><code>##       rho 
## 0.6514555</code></pre>
<p>We will round the values to 2 decimal points using <code>round(..., 2)</code>, where 2 denotes the number of decimal places. <code>paste0()</code> is used to construct strings from various vectors, such as the numerical values extracted from <code>res</code>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">32</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;R =&#39;</span>, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">round</span>(res<span class="sc">$</span>estimate,<span class="dv">2</span>),</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">&#39;</span><span class="sc">\n</span><span class="st">   p &lt; 0.001&#39;</span>)) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">show_text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-63-1.png" width="336" /></p>
</div>
<div id="plotting-the-average-with-standard-errors" class="section level3 hasAnchor" number="3.3.4">
<h3 class="hasAnchor"><span class="header-section-number">3.3.4</span> Plotting the average with standard errors<a href="#plotting-the-average-with-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>smplot2</strong> also offers <code>sm_corr_avgErr()</code>, which is a function that enables the users to plot the mean with errors, such as standard error (<code>errorbar_type = 'se'</code> as default), standard deviation (<code>errorbar_type = 'sd'</code>) or 95% confidence interval (<code>errorbar_type = 'ci'</code>).</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-64-1.png" width="336" /></p>
<p>The black point in the middle represents the mean with vertical and horizontal standard errors.</p>
<p>The <code>data</code> argument of <code>sm_corr_avgErr</code> requires the variable that stores the data frame that is used to plot the data, which is <code>mtcars</code>. <code>x</code> argument is the variable that is plotted along the x-axis. <code>y</code> argument is the variable that is plotted along the y-axis. Actually these arguments are nearly identical to what you have provided <code>ggplot(data = ..., aes(x = ..., y = ...)</code>.</p>
<p>You can control the aesthetics with a high flexibility using <code>point.params</code>, <code>errh.params</code> and <code>errv.params</code>.</p>
<ul>
<li><p><code>point.params</code> feeds the arguments to <code>geom_point()</code>, such as <code>color</code>, <code>alpha</code>, etc, to plot the average point.</p></li>
<li><p><code>errv.params</code> feeds the arguments to <code>geom_errorbar()</code>, such as <code>color</code>, <code>size</code> and <code>width</code> etc, to plot the vertical (y-axis) error bar.</p></li>
<li><p><code>errh.params</code> feeds the arguments to <code>geom_errorbarh()</code>, such as <code>color</code>, <code>size</code> and <code>height</code> etc, to plot the horizontal (x-axis) error bar.</p></li>
</ul>
<p>If you write <code>xxx.params = list()</code>, even with empty ones, you will remove the defaults of <code>sm_corr_avgErr()</code>, which has default of <code>width = 0</code> (for <code>errv.params</code>) / <code>height = 0</code> (for <code>errh.params</code>). <code>width</code> and <code>height</code> are equivalent.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-65-1.png" width="336" /></p>
<p>After removing the defaults, we see that <code>width</code> of <code>errv.params</code> and <code>height</code> of <code>errh.params</code> are no longer 0. We can control both <code>width</code> and <code>height</code> separately.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>)) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-66-1.png" width="336" /></p>
<p>In this case, <code>height</code> is much longer because the scale of y-axis is much longer than that of x-axis. We can also set unique colors to horizontal and vertical error bars.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#1262b3&quot;</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">color =</span> <span class="st">&quot;#cc3d3d&quot;</span>)) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-67-1.png" width="336" /></p>
<p>The error bar might appear too thin and the average point too small. We can control the <code>size</code> to make it more noticeable in the plot.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#1262b3&quot;</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>),</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">color =</span> <span class="st">&quot;#cc3d3d&quot;</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-68-1.png" width="336" /></p>
<p>We can control the transparency of the individual points and fine tune the aesthetics of the average point to make it more noticeable in the sea of individual points.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> <span class="st">&#39;black&#39;</span>),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#1262b3&quot;</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">color =</span> <span class="st">&quot;#cc3d3d&quot;</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-69-1.png" width="336" /></p>
<p>Notice that the transparency of the individual point allows us see that there are some points with some serious overlap.</p>
</div>
<div id="fill-0f993d-vs-fill-green" class="section level3 hasAnchor" number="3.3.5">
<h3 class="hasAnchor"><span class="header-section-number">3.3.5</span> <code>fill = '#0f993d'</code> vs <code>fill = 'green'</code><a href="#fill-0f993d-vs-fill-green" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I personally like <code>#0f993d</code> more. However, <strong>R</strong> does not recognize this color as <code>green</code>. So how are you supposed to remember the color code?</p>
<p>You do not have to. You can type <code>sm_color('green')</code> instead. This is a function from the <strong>smplot</strong> package.</p>
<p><code>sm_color()</code> accepts the name of the color. If you want to get the hex codes (color codes) for red and green, type <code>sm_color('red','green')</code>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<p>Again, <code>sm_color()</code> has been built based on my preference. So it returns the hex codes of colors that I use most often.</p>
<p>There are many more color themes that are available in R. For more information, please check out Chapter 28 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/graphics-for-communication.html" class="uri">https://r4ds.had.co.nz/graphics-for-communication.html</a>).</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-71-1.png" width="336" /></p>
<p><strong>Exercise</strong> Change the color of the points and the best-fit line to <code>blue</code> using <code>sm_color()</code>. If you want to see all the color options for <code>sm_color()</code>, type <code>?sm_color</code>. There are 16 colors total.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
</div>
<div id="different-color-for-each-group-but-with-other-colors" class="section level3 hasAnchor" number="3.3.6">
<h3 class="hasAnchor"><span class="header-section-number">3.3.6</span> Different color for each group but with other colors<a href="#different-color-for-each-group-but-with-other-colors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s go back to the <strong>mpg</strong> data. Set the x-axis with <strong>displ</strong> and y-axis with <strong>hwy</strong>. Then make a scatterplot using <code>geom_point()</code>.
- Set the size of the points to 2 across all groups. So type <code>size = 2</code> outside of <code>aes()</code> in <code>geom_point()</code>.</p>
<p>Let’s apply different color for each <code>class</code> of the cars by writing <code>color = class</code> in <code>aes()</code> from <code>ggplot()</code>.</p>
<ul>
<li><code>fill = class</code> is needed when the shape of the point is set to 21-25.</li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-73-1.png" width="480" /></p>
<p>To use other colors, we could use a function from <strong>ggplot2</strong> called <code>scale_color_manual()</code>.</p>
<ul>
<li><code>scale_fill_manual()</code> is used when the shape of the point has borders (shape = 21-25).</li>
</ul>
<p>To find how many colors we need total, we need to find how many groups exist.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>unique_classes <span class="ot">&lt;-</span> <span class="fu">unique</span>(mpg<span class="sc">$</span>class)</span></code></pre></div>
<p>In R, you can extract data from one column by using <code>$</code>. You can try it with different variables too. <code>unique()</code> returns unique values in the selected data.
Then compute the number of unique values using <code>length()</code> function.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>number_of_classes <span class="ot">&lt;-</span> <span class="fu">length</span>(unique_classes)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>number_of_classes</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p><code>sm_palette</code> accepts the number of colors as input. It returns colors that I use most often. Now that we know we need 7 colors total, we can type <code>sm_palette(7)</code> or <code>sm_palette(number_of_classes)</code> for <code>values</code> in <code>scale_color_manual()</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-76-1.png" width="480" /></p>
<p>Let’s store this graph using a <strong>variable</strong> called <code>figure1</code>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><strong>Notice that when you store a figure into a variable, the figure is not displayed</strong> when you run the code that makes the figure, ex. <code>figure1 &lt;- ggplot(data = mpg, mapping = ...</code>. To display the figure, please type the variable name in the console.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="co"># it will appear again by calling this variable </span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-78-1.png" width="480" /></p>
</div>
<div id="lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1." class="section level3 hasAnchor" number="3.3.7">
<h3 class="hasAnchor"><span class="header-section-number">3.3.7</span> Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.<a href="#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To save the figure as an image, we will use the function <code>save_plot()</code> from the <strong>cowplot</strong> package.</p>
<ul>
<li><p>There is one important argument: <code>base_asp</code>.</p>
<ul>
<li>This is the ratio of your image (width/height). I usually set it to 1.4. So let’s type <code>base_asp = 1.4</code> in <code>save_plot()</code>.</li>
<li>If <code>base_asp</code> is larger than 1, it gets wider than its height. This is recommended when you have a legend.</li>
<li>If there is no legend, then <code>base_asp = 1</code> is recommended.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1.png&#39;</span>, figure1, <span class="at">base_asp =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<p><strong>Exercise</strong>: try to save it again with a name <strong>figure1b.png</strong> by typing:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1b.png&#39;</span>, figure1)</span></code></pre></div>
<p>How’s the picture? Why does it look different? Type <code>?save_plot</code> to see what the default <code>base_asp</code> is.</p>
<p>Done! The graph (in png file) should be in your <strong>LearnR</strong> folder.</p>
<p><strong>Exercise:</strong> Try to open Microsoft Word or PowerPoint and upload <strong>figure1</strong>. The figure should look the same as it appears in the slides.</p>
<p><strong>Exercise:</strong> Remove the legend and save the scatterplot with <code>base_asp = 1</code>.</p>
<p>Congratulations! You can now make <strong>correlation plots</strong> with R.</p>
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="3.4">
<h2 class="hasAnchor"><span class="header-section-number">3.4</span> Summary<a href="#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>You have learned the basics of <strong>ggplot</strong>.
<ul>
<li>You begin by writing a <code>ggplot()</code> function.</li>
<li>If aesthetics (color, shape, etc) are specified outside of <code>aes()</code> function, then there is no group difference.</li>
<li>If aesthetics are specified in <code>aes()</code>, different groups of data will have different looks.</li>
<li>You have learned to add geom layers such as <code>geom_point()</code>, which shows points, and <code>geom_smooth()</code>, which plots the best-fit function.</li>
<li>You have learned to plot <code>geom_point()</code> and <code>geom_smooth()</code> in the same graph.</li>
</ul></li>
<li><strong>smplot2</strong> functions can be used to improve <strong>ggplot2</strong> visually.
<ul>
<li>For correlation plots, add <code>sm_corr_theme()</code>.</li>
<li>You can report statistical results and plot linear regression from correlation by <code>sm_statCorr()</code>, which also provides <code>sm_corr_theme()</code>. So there is no need to write <code>sm_corr_theme()</code> when using <code>sm_statCorr()</code>.</li>
<li>You can also select colors using <code>sm_color()</code>.</li>
</ul></li>
<li>Save the graph as an image file in your working directory.
<ul>
<li>Working directory has to be set in RStudio (<strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>)</li>
<li>Then use <code>save_plot()</code> from <strong>cowplot</strong> to save the image in your directory (folder <strong>LearnR</strong>).</li>
</ul></li>
</ul>
<!--chapter:end:corr.Rmd-->
</div>
</div>
<div id="boxplot-and-violin-plot" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Boxplot and Violin Plot<a href="#boxplot-and-violin-plot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<div id="upload-sample-data-csv-file-in-rstudio" class="section level2 hasAnchor" number="4.1">
<h2 class="hasAnchor"><span class="header-section-number">4.1</span> Upload sample data (csv file) in RStudio<a href="#upload-sample-data-csv-file-in-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="download-requirements" class="section level3 hasAnchor" number="4.1.1">
<h3 class="hasAnchor"><span class="header-section-number">4.1.1</span> Download requirements<a href="#download-requirements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Download <strong>data.csv</strong> from
<a href="https://www.smin95.com/data.csv" class="uri">https://www.smin95.com/data.csv</a></p>
<p>Put the file <strong>data.csv</strong> in your <strong>LearnR</strong> folder, where you will create a new script using RStudio.</p>
</div>
<div id="before-we-get-started" class="section level3 hasAnchor" number="4.1.2">
<h3 class="hasAnchor"><span class="header-section-number">4.1.2</span> Before we get started<a href="#before-we-get-started" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, within RStudio, set <strong>LearnR</strong> folder as your working directory by clicking: <strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>.</p>
<p>Then, load these three packages with the <code>library()</code> function: <strong>ggplot2</strong>, <strong>cowplot</strong> and <strong>smplot2</strong>.</p>
<p>The <strong>tidyverse</strong> package includes the <strong>ggplot2</strong> package. For this reason, instead of loading <strong>ggplot2</strong>, you can load <strong>tidyverse</strong> instead. <strong>tidyverse</strong> has other packages beside <strong>ggplot2</strong>, such as <strong>dplyr</strong>, which is also necessary to handle and manage data.</p>
<p>Remember from the last chapter that:</p>
<ul>
<li><p>Functions from the <strong>ggplot2</strong> package include <code>ggplot()</code> and other <strong>geom</strong> functions such as <code>geom_point()</code>, <code>geom_smooth()</code>, etc.</p></li>
<li><p>Functions from the <strong>smplot2</strong> package improve the <strong>ggplot2</strong> graphs visually. However, they are not required to make a graph using <strong>ggplot2</strong>.</p></li>
<li><p>The <strong>cowplot</strong> package has a function called <code>save_plot</code>, which is very useful for saving a graph as an image.</p></li>
</ul>
</div>
<div id="data.csv" class="section level3 hasAnchor" number="4.1.3">
<h3 class="hasAnchor"><span class="header-section-number">4.1.3</span> data.csv<a href="#data.csv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To start off, let’s load <strong>data.csv</strong> in R from your <strong>LearnR</strong> folder. Then store the loaded data into a variable called <code>df</code>.</p>
<p>We will use a function from the <strong>tidyverse</strong> package called <strong>read_csv()</strong>.
- For more information, type <code>?read_csv()</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data.csv&#39;</span>)</span></code></pre></div>
<p>If you get an <strong>error</strong> such as <code>object 'data.csv' not found</code>, make sure you set your working directory in the <strong>LearnR</strong> folder. Also make sure you have downloaded your data and saved it in the <strong>LearnR</strong> folder.</p>
<p>You can view the entire data frame by typing <code>View(df)</code>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df)</span></code></pre></div>
<p>There are <strong>three columns</strong> in <strong>df</strong>.</p>
<ul>
<li><p>The first column (<strong>Subject</strong>) is the subject number. S1 means the first subject, and S2 second.</p></li>
<li><p>The second column (<strong>Value</strong>) is the data. It contains numbers.</p></li>
<li><p>The third column (<strong>Day</strong>) is the day of testing. There are three days of measurement: <strong>One</strong>, <strong>Two</strong> and <strong>Three</strong>.</p></li>
</ul>
<p><strong>What is the data about?</strong></p>
<ul>
<li><p>30 patients were tested across three days to see if there was an improvement in their visual function (<strong>Value</strong>). The higher value, the better the vision.</p></li>
<li><p>Day <strong>One</strong>: first day of the study. This is the baseline value. After this measurement, patients received treatment (ex. drug, surgery, etc).</p></li>
<li><p>Day <strong>Two</strong>: second day of the study. This is the one day after receiving the treatment.</p></li>
<li><p>Day <strong>Three</strong>: third day of the study. This is two days after receiving the treatment.</p></li>
</ul>
<p>As some of you may have noticed, the data are all made from statistical simulations (i.e., fake data).</p>
</div>
<div id="read_csvdata.csv" class="section level3 hasAnchor" number="4.1.4">
<h3 class="hasAnchor"><span class="header-section-number">4.1.4</span> <code>read_csv('data.csv')</code><a href="#read_csvdata.csv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s use the variable <strong>df</strong> to store the output from <strong>data.csv</strong>.</p>
<p><strong>df</strong> is shortened from <strong>data frame</strong>, which refers to a structure of the data that is commonly used for data analysis.</p>
<p>In fact, ‘data.csv’ has the structure of a typical <strong>data frame</strong>.</p>
<ul>
<li><p>Each <strong>column</strong> is a <strong>variable</strong>.</p></li>
<li><p>Each <strong>row</strong> represents an <strong>observation</strong></p></li>
</ul>
<p>In future, I suggest you save data that has a similar structure to that of <strong>df</strong>.</p>
<ul>
<li>Put your own data in Microsoft Excel and save it as a <strong>csv file</strong> to load it on R.</li>
</ul>
<p><strong>Exercise</strong>: Open <strong>data.csv</strong> using Microsoft Excel. Change the name of third column into <strong>Group</strong>. Then, save it as <strong>data2.csv</strong>. What does this data frame indicate now?</p>
<p>It indicates there are 30 individuals for each group. Also, there are 3 groups, so there are 90 individuals total. So, it might be better to change the subject number so each person has a unique label, such as <strong>S1</strong> to <strong>S90</strong>.</p>
</div>
<div id="best-way-to-plot-data" class="section level3 hasAnchor" number="4.1.5">
<h3 class="hasAnchor"><span class="header-section-number">4.1.5</span> Best way to plot data<a href="#best-way-to-plot-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A popular way to visualize data is plotting a bar graph. However, a bar graph does not show the distribution of the data well.For this reason, boxplot and violin plots have become more popular in scientific writing.</p>
</div>
</div>
<div id="boxplot" class="section level2 hasAnchor" number="4.2">
<h2 class="hasAnchor"><span class="header-section-number">4.2</span> Boxplot<a href="#boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="what-is-a-boxplot" class="section level3 hasAnchor" number="4.2.1">
<h3 class="hasAnchor"><span class="header-section-number">4.2.1</span> What is a boxplot?<a href="#what-is-a-boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the basic structure of the boxplot.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-84-1.png" width="685.714285714286" /></p>
<ul>
<li>The line in the middle is the <strong>median</strong> of the data.</li>
<li>The <strong>first quartile</strong> is the lower 25% of the data.</li>
<li>The <strong>third quartile</strong> is the 75% percentile of the data.</li>
<li>The <strong>interquartile range</strong> is the distance between the first and third quartiles.</li>
<li>The <strong>lower whisker</strong> is the lowest data point without outliers.</li>
<li>The <strong>upper whisker</strong> is the highest data point without outliers.</li>
<li>The point that lies outside the whisker is the <strong>outlier</strong>.</li>
</ul>
</div>
<div id="boxplot-vs-bar-graph" class="section level3 hasAnchor" number="4.2.2">
<h3 class="hasAnchor"><span class="header-section-number">4.2.2</span> Boxplot vs bar graph<a href="#boxplot-vs-bar-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is the basic structure of the bar graph.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-85-1.png" width="685.714285714286" /></p>
<ul>
<li>The boxplot is more informative than bar graph.</li>
<li>The bar graph only shows the mean (average) of the data and the standard error.</li>
<li>The bar graph does not represent the distribution very well. The narrow errorbar is quite misleading here.</li>
<li>For this reason, let’s focus on drawing a boxplot.</li>
</ul>
</div>
<div id="boxplot-using-ggplot2" class="section level3 hasAnchor" number="4.2.3">
<h3 class="hasAnchor"><span class="header-section-number">4.2.3</span> Boxplot using ggplot2<a href="#boxplot-using-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We want to plot <strong>Value</strong> (y-axis) from each <strong>Day</strong> (x-axis). As always in <strong>ggplot</strong>, let’s start by writing <code>ggplot()</code>.</p>
<p>Make sure you specify the data to plot by writing <code>data = df</code> in <code>ggplot()</code>. Also, you will need to specify the x- and y-axes in the <code>mapping</code> argument within <code>ggplot()</code>.</p>
<ul>
<li><code>x = Day</code> and <code>y = Value</code>.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-86-1.png" width="336" /></p>
<p>However, as we learned in the last lesson, <strong>ggplot</strong> requires <strong>geom</strong> objects to plot something. Last time we used <strong>geom_point()</strong>, which plots points.
- Now, let’s use <strong>geom_boxplot()</strong> to plot a boxplot.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-87-1.png" width="336" /></p>
<p>Here’s the boxplot! But I think there is a problem here. Day <strong>Three</strong> precedes Day <strong>Two</strong> in the x-axis.</p>
<ul>
<li><strong>Exercise</strong>: Why do you think <strong>Three</strong> appeared first?</li>
</ul>
</div>
<div id="problem-alphabetical-order" class="section level3 hasAnchor" number="4.2.4">
<h3 class="hasAnchor"><span class="header-section-number">4.2.4</span> Problem: Alphabetical order<a href="#problem-alphabetical-order" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The issue with the boxplot is that the x-axis follows an alphabetical order.</p>
<ul>
<li><strong>Th</strong> precedes <strong>Tw</strong>. In short, R does not seem to know that we want the order to be <strong>One -&gt; Two -&gt; Three</strong>.</li>
</ul>
<p>R has decided to follow the alphabetical order is because the column <strong>Day</strong> is shown as <code>&lt;chr&gt;</code>, which means <strong>character</strong>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<ul>
<li>Note that the <strong>Subject</strong> column is also considered as <code>&lt;chr&gt;</code> (<strong>characters</strong>) because it contains texts/alphabets.</li>
<li>The <strong>Value</strong> column is categorized as <code>&lt;dbl&gt;</code>, which means <strong>double</strong>.
<ul>
<li><strong>Double</strong> basically means numbers.</li>
</ul></li>
</ul>
<p>In R, <strong>character</strong> is also referred to as <strong>string</strong>. They mean the same thing. Here are more examples of <strong>characters/strings</strong>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">&#39;R is very useful!&#39;</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="st">&#39;Dogs are so cute.&#39;</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="st">&#39;Clarinet is the best.&#39;</span></span></code></pre></div>
<p>In these examples, you have stored the <strong>characters/strings</strong> in the variables <strong>a</strong>, <strong>b</strong> and <strong>c</strong>.</p>
</div>
<div id="displaying-characters-in-a-non-alphabetical-order" class="section level3 hasAnchor" number="4.2.5">
<h3 class="hasAnchor"><span class="header-section-number">4.2.5</span> Displaying characters in a non-alphabetical order<a href="#displaying-characters-in-a-non-alphabetical-order" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Factors</strong> are important when you want to display characters in non-alphabetical order. <strong>Factors</strong> are variables that have a limited number of different values.</p>
<p>For example, if a dataset has two groups (<strong>controls</strong> and <strong>patients</strong>), these can be referred to as <strong>factors</strong>.</p>
<p>However, when you are using <code>read_csv()</code> to load data into RStudio, <code>read_csv()</code> will interpret texts/alphabets as <strong>characters</strong>, not <strong>factors</strong>.</p>
<ul>
<li>This is a problem when you need a non-alphabetical order, such as <strong>one -&gt; two -&gt; three</strong> and <strong>Jan -&gt; Feb -&gt; Mar -&gt; Apr</strong>.</li>
</ul>
<p>To resolve this problem, you will need to change the <strong>characters</strong> into <strong>factors</strong> using <code>factor()</code> function.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span></code></pre></div>
<p>Remember that <code>&lt;-</code> means equivalent. Also, <code>$</code> of a data frame can extract a specific column</p>
<ul>
<li>You can also type <code>df$Value</code> and run it to see what happens. You will get all values of the second column <strong>Value</strong>.</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Value</span></code></pre></div>
<p>By using <code>factor()</code>, you are making the <strong>Day</strong> column of <strong>df</strong> into factor from character. However, you will need to store the <strong>factored</strong> version of <code>df$Day</code> by using <code>&lt;-</code>. If not, <code>df$Day</code> will stay as <strong>character</strong>.</p>
<p><code>levels</code> argument in <code>factor()</code> allows you to specify the order of the factors.</p>
<p>For more information about <strong>factors</strong>, please check Chapter 15 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/factors.html" class="uri">https://r4ds.had.co.nz/factors.html</a>).</p>
<ul>
<li><strong>Note:</strong> you do not have to understand this part 100%. However, if you do encounter similar issues, I suggest you resolve it with the solution above.</li>
</ul>
</div>
<div id="double-check-if-the-day-column-is-factor" class="section level3 hasAnchor" number="4.2.6">
<h3 class="hasAnchor"><span class="header-section-number">4.2.6</span> Double-check if the ‘Day’ column is factor<a href="#double-check-if-the-day-column-is-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let’s open the data frame <strong>df</strong> again.</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;fct&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<p>Now we see <code>&lt;fct&gt;</code> in the <strong>Day</strong> column. This means that the column is now <strong>factor</strong>, not <strong>character</strong>.</p>
</div>
<div id="back-to-boxplot-using-ggplot2" class="section level3 hasAnchor" number="4.2.7">
<h3 class="hasAnchor"><span class="header-section-number">4.2.7</span> Back to boxplot using ggplot2<a href="#back-to-boxplot-using-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s draw the boxplot again.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-93-1.png" width="336" /></p>
<p>Since we have converted the <strong>Day</strong> column of <strong>df</strong> into factor, the boxplot successfully plots each day in the correct order.</p>
</div>
<div id="a-boxplot-with-individual-data" class="section level3 hasAnchor" number="4.2.8">
<h3 class="hasAnchor"><span class="header-section-number">4.2.8</span> A boxplot with individual data<a href="#a-boxplot-with-individual-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes, it is preferable to plot individual data on top of the boxplot. There are many ways to do this. Here is a simple solution by using <code>geom_jitter()</code>. For more information, type <code>?geom_jitter</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-94-1.png" width="336" /></p>
<p>I think the points are too spread. So let’s set the <code>width</code> of the spread in <code>geom_jitter()</code> to 0.15. Also, let’s apply a different color of points for each <strong>Day</strong>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-95-1.png" width="460.8" /></p>
<p>Now we can make the boxplot prettier with <code>sm_minimal()</code>, which removes all grids in the graph. We can also set <code>legends = FALSE</code> to remove the legends.</p>
<p>Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>, which is a function from the <strong>ggplot2</strong> package.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-96-1.png" width="336" /></p>
<p>Now let’s set the colors using <code>sm_palette()</code>. Remember from the last lesson that we set the colors in <strong>ggplot</strong> by using <code>scale_color_manual()</code> for points without borders.</p>
<ul>
<li>Let’s write <code>3</code> in <code>sm_palette()</code> because we need 3 colors (for each <strong>Day</strong>). It will automatically extract 3 different colors from the color palette in <strong>smplot2</strong>.</li>
</ul>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-97-1.png" width="336" /></p>
<p>If you need horizontal grids, you can simply replace <code>sm_minimal()</code> with <code>sm_hgrid()</code>. There is also <code>sm_vgrid()</code> but I will not try it here because it is not so useful in our context.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-98-1.png" width="336" /></p>
</div>
<div id="geom_boxplot-vs-sm_boxplot" class="section level3 hasAnchor" number="4.2.9">
<h3 class="hasAnchor"><span class="header-section-number">4.2.9</span> <code>geom_boxplot()</code> vs <code>sm_boxplot()</code><a href="#geom_boxplot-vs-sm_boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>geom_boxplot()</code> does not show individual data. You need to add <code>geom_jitter()</code>.</p>
<p><code>sm_boxplot()</code> shows both a boxplot and jittered individual data. It automatically uses <code>sm_hgrid()</code>. Also it stores defaults that are aesthetically pleasing and has flexibility with which you can entirely overturn the defaults.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-99-1.png" width="336" /></p>
<p>As you can see the default of the point is slightly transparent (<code>alpha = 0.65'</code>). If you prefer it to change it to opaque with white borders, we can by specifying the parameters of the points, <code>point.param</code>, which is an argument that is found across multiple functions of <strong>smplot2</strong>.</p>
<p>In arguments that look like<code>xxx.params = list()</code>. <code>sm_boxplot()</code> has two <code>xxx.param</code>s: <code>point.param</code> and <code>boxplot.param</code>.</p>
<ul>
<li><p>Parameters in <code>point.param</code> are used in <code>geom_point()</code> to plot the points.</p></li>
<li><p>Parameters in <code>boxplot.param</code> are used in <code>geom_boxplot()</code> to plot the boxplot.</p></li>
</ul>
<p>In the default of <code>sm_boxplot()</code>, the shape of the point is <code>16</code>. This information can be accessed by seeing the defaults within the <code>help</code> page of <code>?sm_boxplot</code>.</p>
<p>We could change the shape to <code>21</code> so that the points have the circular shape with borders. In the case of <code>shape = 21</code>, <code>fill</code> decides the filling color rather than <code>color</code>, which sets the color of the border. Therefore, the variable in <code>aes()</code> has to be changed so that there is unique filling color for each day as <code>fill = Day</code>.</p>
<p>Also, <code>scale_color_manual()</code> is now used to apply distinct border colors of the points rather than their filling colors. So now we should use <code>scale_fill_manual()</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="fl">2.5</span>)) <span class="sc">+</span> </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-100-1.png" width="336" /></p>
<p>Notice that when you leave <code>point.params = list()</code> as empty or filled, then the aesthetic defaults of <code>sm_boxplot()</code> will disappear, such as the transparency of the points (<code>alpha = 0.65</code>). To fully restore the defaults while keeping the shape of the points, you will need to specify all the parameters.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.65</span>)) <span class="sc">+</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-101-1.png" width="336" /></p>
<p>Also, this is an example that shows that the defaults (i.e., transparency) are no longer maintained when <code>point.params = list()</code> is written but not filled.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point.params =</span> <span class="fu">list</span>()) <span class="sc">+</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-102-1.png" width="336" /></p>
<p>Another way to change the shape is to not use <code>point.params = list()</code>. You could directly use <code>shape</code> argument within <code>sm_boxplot()</code> but this could affect other aesthetic components.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-103-1.png" width="336" /></p>
<p>In this case, we are lucky because <code>shape</code> is an aesthetic parameter that does not affect the boxplot, which is drawn using <code>geom_boxplot()</code>. We can set the size and transparency explicity in <code>point.params()</code>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.65</span>, </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">size =</span> <span class="fl">2.5</span>)) <span class="sc">+</span> </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-104-1.png" width="336" /></p>
<p>What happens if you explicittly write <code>boxplot.params = list()</code> in <code>sm_boxplot()</code>?</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>()) <span class="sc">+</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-105-1.png" width="336" /></p>
<p>Now the defaults of the boxplot are gone. The boxplot’s <code>fill</code> is white, and the line colors are no longer <code>black</code>. Also, the <code>width</code> is wider now than the default (<code>width = 0.5</code>).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">&#39;gray95&#39;</span>, <span class="at">width =</span> <span class="fl">0.5</span>, </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-106-1.png" width="336" /></p>
<p>You can remove the label of the outlier by specifying <code>outlier.shape = NA</code>, which is an argument within <code>geom_boxplot()</code>, in <code>boxplot.params</code>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">&#39;gray95&#39;</span>, <span class="at">width =</span> <span class="fl">0.5</span>, </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>)) <span class="sc">+</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-107-1.png" width="336" /></p>
<p>Now we are essentially back to where we were.</p>
<p>In addition, you can also change the <code>size</code> as a generic aesthetic parameter without affecting others because the <code>size</code> of the boxplot (<code>boxplot.params</code>) already has a specific default.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-108-1.png" width="336" /></p>
<p><strong>Important:</strong> The generic parameter (<code>...</code> in ex. <code>sm_boxplot()</code>) cannot overturn the smplot2’s default unless the user makes the default gone by explictly writing <code>param.xxx = list()</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot.params =</span> <span class="fu">list</span>()) <span class="sc">+</span> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-109-1.png" width="336" /></p>
<p>Now the <code>size</code> affects both the points and the boxplot because the default of <code>boxplot.params</code> is gone after we have written it in the argument.</p>
<p>Advanced users can really have much flexibility with this feature of <strong>smplot2</strong>. For example, you can essentially remove all the defaults by including empty <code>boxplot.params</code> and <code>point.params</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(),</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">point.params =</span> <span class="fu">list</span>()) <span class="sc">+</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-110-1.png" width="336" /></p>
<p>Then you can change the <code>color</code> across points and boxplot to be just <code>black</code>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">boxplot.params =</span> <span class="fu">list</span>(),</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">point.params =</span> <span class="fu">list</span>()) <span class="sc">+</span> </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-111-1.png" width="336" /></p>
<p>If you are confused about this, do not worry because you can directly set the <code>size</code> and <code>shape</code> of the points as generic parameter without affecting other aesthetic components. You could probably get by with the defaults of <strong>smplot2</strong> without specifying much.</p>
<p>Now, pick your favorite boxplot and store it in a variable called <strong>my_boxplot</strong> using <code>&lt;-</code>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color=</span><span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>)) <span class="sc">+</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="save-boxplot" class="section level3 hasAnchor" number="4.2.10">
<h3 class="hasAnchor"><span class="header-section-number">4.2.10</span> Save boxplot<a href="#save-boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can save the boxplot by using <code>save_plot()</code> from the <strong>cowplot</strong> package.</p>
<p>Let’s set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;boxplot.jpg&#39;</span>, my_boxplot, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>This image file should now be in your <strong>LearnR</strong> folder.</p>
</div>
</div>
<div id="violin-plot" class="section level2 hasAnchor" number="4.3">
<h2 class="hasAnchor"><span class="header-section-number">4.3</span> Violin Plot<a href="#violin-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The boxplot represents the distribution quite well but it can still be misleading.Also, it can be visually overwhelming (i.e., too crowded) to some readers. For this reason, researchers have begun favoring the violin plot more.</p>
<div id="structure-of-the-violin-plot" class="section level3 hasAnchor" number="4.3.1">
<h3 class="hasAnchor"><span class="header-section-number">4.3.1</span> Structure of the violin plot<a href="#structure-of-the-violin-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-114-1.png" width="685.714285714286" /></p>
<ul>
<li>The part in the middle is the widest because it has most points. This part has the highest <strong>point density</strong>.</li>
<li>The lower and upper ends of the violin plot are thinner because there are less points.</li>
<li>Let’s draw a violin plot in R.</li>
</ul>
</div>
<div id="violin-plot-with-ggplot2" class="section level3 hasAnchor" number="4.3.2">
<h3 class="hasAnchor"><span class="header-section-number">4.3.2</span> Violin plot with ggplot2<a href="#violin-plot-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s draw the violin plot. Specify the x-axis to <strong>Day</strong> and the y-axis to <strong>Value</strong> using data frame <strong>df</strong>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-115-1.png" width="336" /></p>
<p>Notice that since we have already converted the <strong>Day</strong> column of df into <strong>factor</strong>, the violin plot’s x-axis is in the correct order. Also, notice that we can just replace <code>geom_boxplot()</code> with <code>geom_violin()</code>.</p>
</div>
<div id="violin-plot-with-individual-points" class="section level3 hasAnchor" number="4.3.3">
<h3 class="hasAnchor"><span class="header-section-number">4.3.3</span> Violin plot with individual points<a href="#violin-plot-with-individual-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s add individual points to the violin plot by using <code>geom_jitter()</code>.
- Set <code>width</code> of the spread to <code>0.15</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-116-1.png" width="336" /></p>
<p>Now let’s apply different color to each <strong>Day</strong> like we did in boxplot by using <code>scale_color_manual()</code>. Let’s use <code>sm_palette(3)</code>.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-117-1.png" width="435.84" /></p>
<p>Finally, let’s make it pretty and remove the <strong>legend</strong> by applying <code>sm_hgrid()</code> theme, which only has horizontal grids.
- Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-118-1.png" width="336" /></p>
</div>
<div id="geom_violin-vs-sm_violin" class="section level3 hasAnchor" number="4.3.4">
<h3 class="hasAnchor"><span class="header-section-number">4.3.4</span> geom_violin() vs sm_violin()<a href="#geom_violin-vs-sm_violin" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>geom_violin()</code> does not show individual data. You need to add geom_jitter().</li>
<li><code>sm_violin()</code> shows both a violin plot and individual data.
<ul>
<li>It automatically uses <code>sm_hgrid()</code>.</li>
<li>It also display lines that represent the mean and +/- standard deviation.</li>
</ul></li>
</ul>
<p>In <code>sm_violin()</code>, the default shape (<code>'point_shape'</code>) is 16, which is the circle without borders. Therefore, <code>color</code> fills the color of the individual points rather than <code>fill</code>. Also, <code>color</code> affects the color of the lines that show the mean and +/- standard deviation as well as the average point.</p>
<p>Let’s set <code>color = Day</code> in <code>aes()</code> so that we can apply different colors of the lines and the points for each group.
- Make sure you use <code>scale_color_manual()</code> rather than <code>scale_fill_manual</code> to have a unique filling color for each <code>Day</code>.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-119-1.png" width="336" /></p>
<p>As in the case of <code>sm_boxplot()</code>, you can specify the aesthetics of <code>sm_violin()</code> using <code>point.params</code>, <code>err.params</code> and <code>violin.params</code>.</p>
<ul>
<li><p><code>point.params</code> feeds the arguments to <code>geom_point()</code>, such as <code>color</code>, <code>alpha</code>, etc, to plot the individual points.</p></li>
<li><p><code>err.params</code> feeds the arguments to <code>geom_linerange()</code>, such as <code>color</code>, <code>size</code> etc, to plot the error bar in either standard error (<code>errorbar_type = se</code>), standard deviation (<code>errorbar_type = sd</code>) or 95% confidence interval (<code>errorbar_type = ci</code>).</p></li>
<li><p><code>violin.params</code> feeds the arguments to <code>geom_violin()</code>, such as <code>color</code> and <code>fill</code>, to plot the violin.</p></li>
</ul>
<p>By using <code>size</code> and <code>shape</code> as generic parameter, you can easily change the mean and individual points’ color and shapes, but not those of the violin because <code>geom_violin()</code> does not use these two parameters.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-120-1.png" width="336" /></p>
<p>In this case, we have successfully changed the size (larger) and shape (circle to square) of the mean and individual points.</p>
<p>If you write <code>xxx.params = list()</code>, even with empty ones, you will remove the defaults of <code>sm_violin()</code>.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">point.params =</span> <span class="fu">list</span>(), </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">violin.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-121-1.png" width="336" /></p>
<p>Now we can add <code>color = 'black'</code> and <code>fill = 'black'</code> to affect it across all components of the graph (violin, error bar and points).</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">point.params =</span> <span class="fu">list</span>(), </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">violin.params =</span> <span class="fu">list</span>()) <span class="sc">+</span> </span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-122-1.png" width="336" /></p>
<p>Only after the defaults are gone, the generic parameters (<code>...</code>) in <code>sm_violin()</code> have power to affect different components of the violin plot. However, if we add parameters within <code>xxx.params</code>, we see that these parameters will ignore the generic ones.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">color =</span><span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>), </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">violin.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-123-1.png" width="336" /></p>
<p>You could also remove <code>borders</code> or add <code>legends</code> by setting them as <code>FALSE</code> or <code>TRUE</code> respectively (ex. <code>sm_violin(..., borders = FALSE)</code>).</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">borders =</span> <span class="st">&#39;FALSE&#39;</span>) <span class="sc">+</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-124-1.png" width="336" /></p>
</div>
<div id="save-your-violin-plot" class="section level3 hasAnchor" number="4.3.5">
<h3 class="hasAnchor"><span class="header-section-number">4.3.5</span> Save your violin plot<a href="#save-your-violin-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pick your favorite violin plot and store it in a variable called <code>my_violin</code> using <code>&lt;-</code>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>my_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p>We can save the violin plot by using <code>save_plot()</code> from the <strong>cowplot</strong> package, and set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;violin.jpg&#39;</span>, my_violin, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>This image file should now be in your <strong>LearnR</strong> folder.</p>
<p><strong>Exercise</strong>: <code>xxx.params</code> feeds arguments to <code>geom_xxx</code> functions. Understand the difference between the parameters that are within <code>xxx.params = list()</code> and <code>...</code>, which can be generic parameters.</p>
</div>
</div>
<div id="summary-1" class="section level2 hasAnchor" number="4.4">
<h2 class="hasAnchor"><span class="header-section-number">4.4</span> Summary<a href="#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>You have learned how to convert <strong>characters</strong> to <strong>factors</strong>.</li>
<li><strong>Factor</strong> is important to order words/letters in a non-alphabetical order.</li>
<li>You can now make a <strong>boxplot</strong> and a <strong>violin plot</strong> with R.
<ul>
<li>They are more informative than a bar graph.</li>
</ul></li>
<li>You have learned to use <strong>geom</strong> functions, such <code>geom_boxplot()</code>, <code>geom_violin()</code>, and <code>geom_jitter()</code>.
<ul>
<li>These are functions from the <strong>ggplot2</strong> package.</li>
</ul></li>
<li>You can also plot individual data at the same time with functions from the <strong>smplot2</strong> package.
<ul>
<li>These functions are <code>sm_boxplot()</code> and <code>sm_violin()</code>.</li>
</ul></li>
</ul>
<!--chapter:end:violinBox.Rmd-->
</div>
</div>
<div id="bar-graph-slope-chart-and-point-plot" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> Bar Graph, Slope Chart and Point plot<a href="#bar-graph-slope-chart-and-point-plot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These packages are required to be loaded in this chapter, where we will focus on drawing a bar graph, slope chart and point plot. I think these three plots are most commonly used in my research field (perceptual science).</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<div id="bar-graph" class="section level2 hasAnchor" number="5.1">
<h2 class="hasAnchor"><span class="header-section-number">5.1</span> Bar graph<a href="#bar-graph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Even if a bar graph does not provide as much information as a boxplot or a violin plot, it has been proved extremely useful due to its minimal aesthetics. Moreover, in general, providing a bar, jittered individual points and a respective error bar is enough in psychological research.</p>
<p>For this reason, I think that it is necessary to discuss in detail about the usage of bar graph.</p>
<p>Over time, I’ve learned that many users directly use the aesthetic defaults of <code>sm_bar()</code>. So in this chapter, we will discuss ways to overcome the defaults.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">211</span>) <span class="co"># generate random data</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(group1,group2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>Group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Group 1&#39;</span>, <span class="st">&#39;Group 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(group1))</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Group)</span></code></pre></div>
<p>After generating the random data, let’s plot a bar graph. In this case, there are two distinct instances / time points.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-129-1.png" width="336" /></p>
<p><code>sm_bar()</code> automatically uses <code>sm_hgrid()</code>, which provides horizontal major grids. Moreover, it has arguments <code>borders</code> and <code>legends</code> so that the user can wish to remove border or legend easily.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-130-1.png" width="336" /></p>
<p>The default of the error bar’s type is standard error, i.e., <code>errorbar_type = 'se'</code>. There are three options: standard error (<code>se</code>), standard deviation (<code>sd</code>) and 95% confidence interval (<code>ci</code>). The <code>sd</code> and <code>ci</code> are shown below.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-131-1.png" width="336" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>) <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A bar graph&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-132-1.png" width="336" /></p>
<p>You can also use <code>theme()</code> to finely modify the aesthetics. For instance, you can remove the title of the x-axis <code>Group</code>. <code>ylab()</code> and <code>xlab()</code> are functions to modify the title of y- and x-axes.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-133-1.png" width="336" /></p>
<div id="scaling-the-y-axis" class="section level3 hasAnchor" number="5.1.1">
<h3 class="hasAnchor"><span class="header-section-number">5.1.1</span> Scaling the y-axis<a href="#scaling-the-y-axis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Upon a closer look, we realize that the y-axis starts from below 0 even if all data are higher than 0. We can specify the y-axis limit manually using <code>scale_y_continuous()</code> between 0 and 8.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-134-1.png" width="336" /></p>
<p>Although we have specified that the y-axis limit begins from 0 and ends at 7, there is still a small margin below 0. What is going on here?</p>
<p>The default of <strong>ggplot2</strong> is that there is always a small margin below the lowest point of the y-axis limit and above the largest point of the y-axis.The empty space below 0 and above 7 can be removed by using <code>expand = c(0,0)</code> within <code>scale_y_continuous()</code>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-135-1.png" width="336" /></p>
<p>If you would like a small margin between the bottom of the plot and the bars, you could so by replacing <code>0</code> with <code>0.05</code>, i.e., <code>expand = c(0,0.05)</code>. Then the vertical margin will slightly increase.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/w-1.png" width="336" /></p>
</div>
<div id="plotting-individual-points-with-unique-colors" class="section level3 hasAnchor" number="5.1.2">
<h3 class="hasAnchor"><span class="header-section-number">5.1.2</span> Plotting individual points with unique colors<a href="#plotting-individual-points-with-unique-colors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting each point with distinct color is possible if each color is specified for each subject as part of the aesthetics, i.e., <code>aes(..., color = Subject)</code>, where <code>Subject</code> is the name of the data frame’s column that provides identifiers for each observation/person.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-136-1.png" width="336" /></p>
</div>
<div id="other-parameters" class="section level3 hasAnchor" number="5.1.3">
<h3 class="hasAnchor"><span class="header-section-number">5.1.3</span> Other parameters<a href="#other-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also control the jitter’s width by setting <code>point_jitter_width</code>. The default is <code>sm_bar(..., point_jitter_width = 0.12)</code>. Let’s increase it to <code>0.2</code>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>) <span class="sc">+</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Reading speed&#39;</span>) <span class="sc">+</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-137-1.png" width="336" /></p>
<p>You can also adjust different parameters of the bar graph using <code>bar.params</code>, <code>err.params</code> and <code>point.params</code>.</p>
<ul>
<li><p><code>bar.params = list()</code> feeds arguments, such as <code>color</code>, <code>fill</code>, <code>width</code> and <code>alpha</code> to <code>geom_bar()</code> to plot the bar.</p></li>
<li><p><code>err.params = list()</code> feeds arguments, such as <code>color</code>, to <code>geom_linerange()</code> to plot the error bar.</p></li>
<li><p><code>point.params = list()</code> feeds arguments, such as <code>color</code>, <code>fill</code>, and <code>alpha</code> to <code>geom_point()</code> to plot the jittered individual points.</p></li>
<li><p><code>...</code> is generic argument that can affect the bar graph, error bar and points if these do not have defaults set within <code>bar.params = list()</code>, <code>err.params = list()</code> and <code>point.params = list()</code>.</p></li>
</ul>
<p>In the example below, various aspects of the plot have been modified, such as the bar’s <code>width</code>, <code>alpha</code> as well as points’ <code>stroke</code>, which refers to the thickness of their border.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">&#39;gray80&#39;</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span><span class="st">&#39;white&#39;</span>, </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">stroke =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-138-1.png" width="336" /></p>
<p>Now, let’s get rid of all the defaults imposed by <code>sm_bar()</code> to see what happens by including <code>bar.params = list()</code> and <code>point.params = list()</code>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-139-1.png" width="336" /></p>
<p>Now, the <code>size</code> of the point is smaller. Let’s add <code>size</code> as a generic paramater to control for the aesthetics.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-140-1.png" width="336" /></p>
<p>In this case, <code>size</code> affects both the points and the error bar, but not the bar plot because <code>geom_bar()</code> does not accept <code>size</code> as argument.</p>
<p>How about <code>width</code>?</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<pre><code>## Warning in geom_point(position = &lt;environment&gt;, width = 0.5): Ignoring unknown
## parameters: `width`</code></pre>
<pre><code>## Warning in stat_summary(fun.data = function (x, mult = 1) : Ignoring unknown parameters:
## `width`</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-141-1.png" width="336" /></p>
<p>We see that <code>width</code> only affects the bar’s <code>width</code> because it does not affect the points and error bars as shown by the warning above <code>Ignoring unknown parameters: width</code>.</p>
<p>Let’s try <code>fill</code> and <code>color</code> next by setting them to black.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(),</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) </span></code></pre></div>
<pre><code>## Warning in stat_summary(fun.data = function (x, mult = 1) : Ignoring unknown parameters:
## `fill`</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-142-1.png" width="336" /></p>
<p>We see that everything is <code>'black'</code> now, affecting across the bar, error bar and the points. Now, as previously mentioned in the previous chapter, if we add parameters within <code>xxx.params</code>, we see that these parameters will ignore the generic ones.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.80</span>),</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;gray90&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="fl">2.5</span>),</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-143-1.png" width="336" /></p>
<p>You can also set to remove the points by using <code>points</code> argument.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.80</span>),</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;gray90&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="fl">2.5</span>),</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-144-1.png" width="336" /></p>
<p>Obviously, this is not a good bar graph because we cannot see where the error bar begins. We can change the colors to <code>blue</code> and <code>orange</code> for each x level.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>),</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-145-1.png" width="336" /></p>
<p>We can see that <code>sm_bar()</code> can offer a huge flexibility for users to control over the aesthetics with relative ease while maintaining the minimalistic style.</p>
</div>
<div id="bar-graph-with-data-of-multiple-groups" class="section level3 hasAnchor" number="5.1.4">
<h3 class="hasAnchor"><span class="header-section-number">5.1.4</span> Bar graph with data of multiple groups<a href="#bar-graph-with-data-of-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we will load data set from online. Details about the data set are described in the section below entitled <strong>Point Plot</strong>. You do not need to understand the data set to follow this section.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>)  </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, SF <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">8</span>))</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>df2a<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2a<span class="sc">$</span>SF)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>df2a<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2a<span class="sc">$</span>Group)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2a<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] Amblyopia Normal   
## Levels: Amblyopia Normal</code></pre>
<p>We see that there are two groups in the data set: <code>Amblyopia</code> and <code>Normal</code>.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2a<span class="sc">$</span>SF)</span></code></pre></div>
<pre><code>## [1] 0.5 8  
## Levels: 0.5 8</code></pre>
<p>Also there are two conditions <code>SF</code>: <code>0.5</code> and <code>8</code>.</p>
<p>Ideally, a plot that shows the data of these two groups and conditions would be very informative. Let’s attempt to plot such a bar graph.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> SF)) <span class="sc">+</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-148-1.png" width="336" /></p>
<p>Immediately we see that something is wrong here. There seem to be too many points in this bar graph compared to the sample size of each group per condition.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>df2amb <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2a, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>df2norm <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2a, Group <span class="sc">==</span> <span class="st">&#39;Normal&#39;</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(df2amb<span class="sc">$</span>Subject)) <span class="co"># 10 amblyopes</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(df2norm<span class="sc">$</span>Subject)) <span class="co"># 10 normal observers</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>There are 10 subjects per group (<code>Group</code>) and condition (<code>SF</code>) but we see about 20 points per bar. It seems that the data of <code>Amblyopia</code> and <code>Normal</code> got combined at each <code>SF</code>. This is not a good representation of the data as we are interested in the difference between the two groups of observers.</p>
<p>Let’s add <code>group = Group</code> within <code>aes()</code> to group the data based on each <code>Group</code>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> SF, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-150-1.png" width="336" /></p>
<p>We see there are two error bars in the midst of the orange plots, indicating that the data are superimpsoed on top of another. Let’s change border color of the bar to verify this observation.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> SF, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>)) <span class="sc">+</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-151-1.png" width="336" /></p>
<p>In fact, it turns out that our observation is true. We need to separate their position (i.e., <code>dodge</code>) using <code>position_dodge()</code> across all visual components of the bar graph: <code>err.params</code>, <code>bar.params</code> and <code>point.params</code>. This can be done easily by setting it as a generic parameter <code>...</code>.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>),</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">legends =</span> T,</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> <span class="st">&#39;gray80&#39;</span>)) <span class="sc">+</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-152-1.png" width="432" /></p>
<p>Let’s add some jitter to the points. This part is quite complicated. In this example, <code>point.params</code> has to be set separately using <code>position_jitterdodge()</code> so that the points remained jittered and dodged at the same time.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>),</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> <span class="st">&#39;gray80&#39;</span>),</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>,</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.12</span>,</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">dodge.width =</span> <span class="dv">1</span>)),</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">legends =</span> T) <span class="sc">+</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))  <span class="sc">+</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-153-1.png" width="432" /></p>
<p>We have now successfully plotted the bar graph using data of multiple groups and conditions. Another solution is to plot each group per panel and combine the two panels into one figure using <code>sm_common_axis()</code>, which will be described in the later part of the book.</p>
</div>
</div>
<div id="slope-chart" class="section level2 hasAnchor" number="5.2">
<h2 class="hasAnchor"><span class="header-section-number">5.2</span> Slope chart<a href="#slope-chart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A slope chart is useful to describe changes between two different time points for each measurement (ex. a participant).</p>
<p>Sometimes, it is a great alternative to showing bar graph because bar graph does not show individual trends/changes.</p>
<p>Let’s generate some random data to explore this difference.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>before <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>after <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(before,after),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>beforeAfter <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(before))</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, beforeAfter)</span></code></pre></div>
<p>As mentioned in the previous, factor level is important when dealing with discrete variable. In this case, the two factor levels of the data are <code>Before</code> and <code>After</code>.</p>
<p>Since, in the context of time, <code>Before</code> is the first level followed by <code>After</code>, let’s set the level properly so that the alphabetical order is overturned.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>beforeAfter <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>beforeAfter, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>))</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>beforeAfter</span></code></pre></div>
<pre><code>##  [1] Before Before Before Before Before Before Before Before Before Before Before Before
## [13] Before Before Before Before Before Before Before Before After  After  After  After 
## [25] After  After  After  After  After  After  After  After  After  After  After  After 
## [37] After  After  After  After 
## Levels: Before After</code></pre>
<p>Based on the output, we have successfully ordered the factor levels. Now, we can start plotting a slope chart.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject) <span class="sc">+</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-156-1.png" width="288" /></p>
<p>Notice that each line is grouped for each subject. For this to properly happen, <code>group</code> argument has to be specified within <code>sm_slope()</code>. In fact, due to the update from <strong>smplot2</strong>, the user is required to specify this at the level of <code>sm_slope()</code> rather than at <code>aes()</code>.</p>
<p>Also, to assign a unique color to each discrete level in x-axis, <code>fill</code> has to be specified because the default shape of the point is <code>21</code>, which is a circle with borders.</p>
<p>Now let’s add <code>labels</code> for the x-axis tick. To do so, include <code>labels = c('Before', 'After')</code>.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>)) <span class="sc">+</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-157-1.png" width="307.2" /></p>
<p>If you would like to do statistical test that is paired, such as a paired t-test, then the apt means to visualize the data would be to use slope chart, rather than a bar graph. This is because the p-value gets smaller as a larger proportion of the sample experiences a change in the same direction (i.e., all increase). It is the direction of the overall change that is important, rather than the difference of the means from unique groups/conditions/instances.</p>
<div id="slope-chart-with-mean-plot" class="section level3 hasAnchor" number="5.2.1">
<h3 class="hasAnchor"><span class="header-section-number">5.2.1</span> Slope chart with mean plot<a href="#slope-chart-with-mean-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Due to several requests from students, I have added the feature of showing a mean plot using <code>sm_slope()</code> as an update from <strong>smplot2</strong>.</p>
<p>Just by setting <code>show_mean = TRUE</code>, you can draw the mean.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-158-1.png" width="307.2" /></p>
<p>When a mean plot is included in slope chart, I personally prefer to visually emphasize the mean plot while treating the individual plots as <strong>shadow</strong>. Hence, I would use similar colors across all levels. Here is an example below using blue colors. The maen plot should be slightly larger than the individual points from the shadow.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)),</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-159-1.png" width="307.2" /></p>
<ul>
<li><p><code>point.params</code> feeds arguments to <code>geom_point()</code> to plot the points with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>line.params</code> feeds arguments to <code>geom_line()</code> to plot the points with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
<li><p><code>avgPoint.params</code> feeds arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>avgLine.params</code> feeds arguments to <code>geom_line()</code> to plot the average plot (line) with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
<li><p><code>err.params</code> feeds arguments to <code>geom_linerange()</code> to plot the error bar with specified <code>color</code>, <code>size</code> etc.</p></li>
<li><p><code>xtick.params</code> feeds arguments to <code>scale_x_discrete()</code> so that the user can have control over specific aesthetics of the x-tick. Type <code>?scale_x_discrete()</code> for more information.</p></li>
<li><p><code>...</code> is generic paramater that can affect multiple components of the plot.</p></li>
</ul>
<p>You can also change the <code>stroke</code> of the points and lines (thickness of the borders) as a stylistic preference. To make the <code>stroke</code> of the average points more stand out in the midst of the colors, <code>alpha</code> of the <code>points</code> can be raised.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.6</span>),</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">stroke =</span> <span class="dv">1</span>),</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-160-1.png" width="307.2" /></p>
<p>As before, let’s remove the defaults by providing arguments in this format <code>xxx.param = list()</code>.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(),</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(),</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(),</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-161-1.png" width="307.2" /></p>
<p>Now we see that the mean and the individual plots are indistinguishable.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(),</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(),</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(),</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-162-1.png" width="307.2" /></p>
<p>By specifying <code>color</code> as a generic parameter (<code>...</code>) to <code>purple</code>, we have changed all components of the plot to <code>purple</code>.</p>
<p>Now we can choose specific <code>alpha</code>s for individual plots in <code>xxx.params</code> to distinguish from the mean and the individual plots.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), <span class="at">group =</span> Subject,</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(),</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(),</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-163-1.png" width="307.2" /></p>
<p>Now we see the average plot in the midst of the purple sea. Let’s enlarge it slightly by specifying the parameters within <code>avgPoint.params</code> and <code>avgLine.params</code>. We can also change the <code>shape</code> to triangle by setting the generic parameter (<code>...</code>) as <code>shape = 17</code>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), </span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-164-1.png" width="307.2" /></p>
</div>
<div id="slope-chart-with-mean-plot-and-error-bar" class="section level3 hasAnchor" number="5.2.2">
<h3 class="hasAnchor"><span class="header-section-number">5.2.2</span> Slope chart with mean plot and error bar<a href="#slope-chart-with-mean-plot-and-error-bar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Error bar can also be added to show either standard error (<code>errorbar_type = 'se'</code>), standard deviation (<code>errorbar_type = 'sd'</code>, default) or 95% confidence interval (<code>errorbar_type = 'ci'</code>) by setting <code>sm_slope(..., show_err = TRUE)</code>.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), </span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-165-1.png" width="307.2" /></p>
<p>As in <code>sm_bar()</code>, you can control the specific aesthetics of the error bar using <code>err.param</code>.</p>
<ul>
<li><code>err.params = list()</code> feeds arguments, such as <code>color</code>, to <code>geom_linerange()</code> to plot the error bar.</li>
</ul>
<p>You can control the width of the error bar by changing the <code>size</code> within <code>err.params</code>.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>), </span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-166-1.png" width="307.2" /></p>
<p>This form of slope chart highly resembles a point plot with a shadow, which we will discuss below using the function <code>sm_pointplot()</code>.</p>
</div>
<div id="slope-chart-with-multiple-x-levels" class="section level3 hasAnchor" number="5.2.3">
<h3 class="hasAnchor"><span class="header-section-number">5.2.3</span> Slope chart with multiple x levels<a href="#slope-chart-with-multiple-x-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Obviously, you can plot the slope chart when there are more than two discrete x levels. Let’s generate data with 3 x levels.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">7.5</span>,<span class="dv">1</span>))</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<p>Since there are 3 discrete x-levels, <code>labels</code> must be modified accordingly.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>), </span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-168-1.png" width="364.8" /></p>
<p>Now we have a mean plot with error bar representing standard deviation with a shadow of individual plots behind at 3 discrete x-levels.</p>
</div>
<div id="slope-chart-with-multiple-groups-and-x-levels" class="section level3 hasAnchor" number="5.2.4">
<h3 class="hasAnchor"><span class="header-section-number">5.2.4</span> Slope chart with multiple groups and x levels<a href="#slope-chart-with-multiple-groups-and-x-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">7.5</span>,<span class="dv">1</span>))</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;N&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Normal&#39;</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">191</span>) <span class="co"># generate random data</span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.8</span>,<span class="dv">1</span>))</span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.3</span>,<span class="dv">1</span>))</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Patients&#39;</span></span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df2)</span></code></pre></div>
<p>This data set <code>df3</code> has two groups: <code>Normal</code> and <code>Patients</code>. Each group has 20 <code>Subjects</code> and has three days of data.</p>
<p><strong>Important</strong>: each subject has to have <strong>unique</strong> identifiers. Across multiple groups, there cannot be same identifiers such as <code>S10</code>. Therefore, in this example, all <code>Normal</code> observers are listed as <code>N1</code>, <code>N2</code> etc, and all <code>Patients</code> are listd as <code>P1</code>, <code>P2</code> etc.</p>
<p>Let’s start an example without the mean plot, where <code>show_mean = FALSE</code> (i.e., default). We will provide unique <code>color</code> and <code>shape</code> to each group.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-170-1.png" width="364.8" /></p>
<p>You can also add legends by setting <code>legends = TRUE</code> and put in the upperleft part of the plot.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-171-1.png" width="364.8" /></p>
<p>Next, we can also draw the mean plot for each group by setting <code>show_mean = TRUE</code>.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-172-1.png" width="364.8" /></p>
<p>Here, we see that the average line is across all presented data (from <code>Normal</code> and <code>Patients</code>). This is not what we wanted. To resolve this issue, set <code>many_groups = TRUE</code>, which then plots the average line for each group.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>,</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">many_groups =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-173-1.png" width="364.8" /></p>
<p>This plot can appear quite complicated. The point of this subsection is to show the flexibility of <code>sm_slope()</code>, not necessarily to talk about my preferred practices of data visualization.</p>
<p>Another solution is to draw a separate slope chart for each group and put them together using <code>sm_common_axis()</code>, which is described in the subsequent chapter called <strong>Combining Plots with Common Axes</strong> in the <strong>Data Analysis</strong> section of the book.</p>
</div>
</div>
<div id="point-plot" class="section level2 hasAnchor" number="5.3">
<h2 class="hasAnchor"><span class="header-section-number">5.3</span> Point plot<a href="#point-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will use a fake data set that I have generated by eyeballing Figure 3 from this paper (<a href="https://www.smin95.com/pubs/mao2020.pdf">PDF</a>):</p>
<p><strong>Yu Mao, Seung Hyun Min, Shijia Chen, Ling Gong, Hao Chen, Robert F. Hess, Jiawei Zhou. Binocular imbalance in amblyopia depends on spatial frequency in binocular combination. IOVS. 2020;61(8):7.</strong></p>
<p>This data set contains both subject groups (<code>Normal</code> and <code>Amblyopia</code>) and conditions (<code>Condition</code>).</p>
<p>We will only use data from the first condition (<code>Condition = 'One'</code>) and convert the numerical column <code>SF</code> into categorical column by using the <code>as.factor()</code> function.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>) </span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df1<span class="sc">$</span>SF)</span></code></pre></div>
<p><code>sm_pointplot()</code> groups each observation based on a specific variable, such as <code>Subject</code> or <code>group</code>. Therefore, when <code>sm_pointplot()</code> is used, the grouping <strong>always</strong> have to be specified like the following: <code>ggplot(aes(x = ..., y = ..., group = xxx))</code>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-175-1.png" width="336" /></p>
<p>We can customise the colors as well in a standard way using <code>sm_color_manual()</code>. The default shape of the point is <code>16</code>, therefore it has no border.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>() <span class="sc">+</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-176-1.png" width="336" /></p>
<p>However, we see that the position of the two plots is overlapped! Therefore, we cannot see where the error bar of the <code>darkred</code> plot (<code>Normal</code>) begins and where the <code>viridian</code> plot (<code>Amblyopia</code>) ends.</p>
<p>This is where the generic variable <code>...</code> in <strong>smplot2</strong> comes in handy. You will need to <strong>dodge</strong> all components of a plot (error bar, point, line) from another plot’s entire components along the <code>x</code> axis. This can be done using the <code>position_dodge()</code> function. Otherwise, you might have to <code>dodge</code> one component by one separately.</p>
<p>The argument <code>position_dodge(width = ...)</code> determines the size of the dodging distance between the plots.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-177-1.png" width="336" /></p>
<div id="change-the-range-of-y-axis" class="section level3 hasAnchor" number="5.3.1">
<h3 class="hasAnchor"><span class="header-section-number">5.3.1</span> Change the range of y-axis<a href="#change-the-range-of-y-axis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two functions that can be used to change the range of the y-axis: <code>scale_y_continuous()</code> and <code>coord_cartesian()</code>.</p>
<p><strong>In most cases, <code>scale_y_continuous()</code> is sufficient. But for <code>sm_pointplot()</code>, use <code>coord_cartesian()</code>.</strong></p>
<p>The difference is that, when <code>sm_pointplot()</code> computes the average point from individual observations that are supplied by the data frame, if the y-axis range does not include an individual observation, then the average is computed without the observation when the y-axis range is set with <code>scale_y_continuous()</code>. On the other hand, when <code>coord_cartesian()</code> is used, the average is still computed from all individual observations.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.35</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-178-1.png" width="336" /></p>
</div>
<div id="data-with-more-than-two-groups" class="section level3 hasAnchor" number="5.3.2">
<h3 class="hasAnchor"><span class="header-section-number">5.3.2</span> Data with more than two groups<a href="#data-with-more-than-two-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What happens if we have data more than 3 groups? Let’s make a fake dataset using <code>df1</code>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1412</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>df1a <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>absBP <span class="ot">&lt;-</span> df1a<span class="sc">$</span>absBP <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)) </span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="st">&#39;Myopia&#39;</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;M&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">5</span>)</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1, df1a)</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>absBP <span class="ot">&lt;-</span> df1a<span class="sc">$</span>absBP <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>)) </span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="st">&#39;Aniso&#39;</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>df1a<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;AN&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">5</span>)</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df2, df1a)</span></code></pre></div>
<p>Now we have a data frame <code>df2</code> that has four groups across five spatial frequencies (<code>SF</code>).</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] &quot;Amblyopia&quot; &quot;Normal&quot;    &quot;Myopia&quot;    &quot;Aniso&quot;</code></pre>
<p>Now let’s plot a point plot using <code>sm_pointplot()</code>.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>() <span class="sc">+</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-181-1.png" width="336" /></p>
<p>We immediately see that the plots are noticeably overlapped. This becomes a huge issue if the user attempts to plot repeated-measures data (i.e., each participant measured across time) of multiple groups/condition in a single panel. Fortunately, we can resolve this issue by using <code>position_dodge()</code>.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-182-1.png" width="336" /></p>
<p>Let’s increase the <code>width</code> more because we still see a large overlap and not see where the error bars begin and end.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>)) <span class="sc">+</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-183-1.png" width="336" /></p>
<p>By using the function <code>position_dodge()</code>, we can see each plot quite clearly.</p>
<p>Following is the equivalent code but it only nudges the error bar because it does not take advantage of using a generic parameter <code>...</code> to control the aesthetics. Instead it uses <code>err.params = list(position = position_dodge(width = ...))</code>.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>))) <span class="sc">+</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-184-1.png" width="336" /></p>
<p>Notice that only the error bars have shifted, not the lines and points. We can nudge all components of the plot using <code>xxx.params</code>. These are:</p>
<ul>
<li><p><code>err.params</code> feeds arguments to <code>geom_linerange()</code> to plot the error bar with specified <code>color</code>, <code>size</code> etc.</p></li>
<li><p><code>avgPoint.params</code> feeds arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>avgLine.params</code> feeds arguments to <code>geom_line()</code> to plot the average line with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
<li><p><code>point.params</code> feeds arguments to <code>geom_point()</code> to plot the points in the shadow with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>line.params</code> feeds arguments to <code>geom_line()</code> to plot the lines in the shadow with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
</ul>
<p>Notice that these components are also found in <code>sm_slope()</code>.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>)),</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>)),</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>))) <span class="sc">+</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-185-1.png" width="336" /></p>
<p>Notice that the <code>size</code> of the points have become smaller as the defaults of <strong>smplot2</strong> have disappeared with the writing of <code>xxx.params</code>.</p>
<p>Now that we know how convenient it is to use the generic parameter <code>...</code> to shift the plot’s position, lets use it to <code>position_dodge</code> and change the <code>size</code> of all components of the plots. Therefore, we will use <code>size</code> as a generic argument (<code>sm_pointplot(size = ...,)</code>).</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;purple&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-186-1.png" width="336" /></p>
</div>
<div id="point-plot-with-a-shadow-using-data-of-one-group" class="section level3 hasAnchor" number="5.3.3">
<h3 class="hasAnchor"><span class="header-section-number">5.3.3</span> Point plot with a shadow using data of one group<a href="#point-plot-with-a-shadow-using-data-of-one-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s say you would like to plot the mean data of one group (<code>amblyopia</code>) as well as individual plots behind the mean plot as a dim shadow by setting <code>sm_pointplot(..., show_shadow = T)</code>.</p>
<p>Let’s use the same dataset and filter for observations from <code>Condition = 'One'</code> and <code>Group = 'Amblyopia'</code>.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>df2a<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2a<span class="sc">$</span>SF)</span></code></pre></div>
<p>When you decide to show shadow using <code>sm_pointplot()</code>, you need to specify <code>group</code> argument in <code>sm_pointplot()</code> in this format: <code>sm_pointplot(group = xxx)</code>, where <code>xxx</code> is the name of the variable that includes identifiers for each observation.</p>
<p>In the shadow, each individual point has to be plotted, and the points have to be connected to form a line. This line has to be connected for each <code>Subject</code> in our example, therefore it should be set as <code>sm_pointplot(group = Subject, ...)</code>.</p>
<p>Therefore, notice that there are two <code>group</code> arguments in this case. The first one is for the average plot in <code>aes()</code> in this format: <code>ggplot(data, aes(x = ..., y =..., group = yyy))</code>, where <code>yyy</code> is the name of the variable that includes identifiers for condition/group of all observers from which the average can be computed. The second <code>group</code> is within <code>sm_pointplot()</code> in this format: <code>sm_pointplot(group = xxx)</code>, where <code>xxx</code> represents the name of the variable for individual identifiers.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">group =</span> Group)) <span class="sc">+</span> <span class="co"># grouped for average</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="do">## grouped for shadow</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="fl">2.5</span>),</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">show_shadow =</span> T)  <span class="sc">+</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-188-1.png" width="336" /></p>
<p>You can finely control the aesthetics of the shadow by using <code>line.params = list()</code> and <code>point.params = list()</code>.</p>
<p>First let’s remove the defaults of the shadow.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject,</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="fl">2.5</span>),</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(),</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">show_shadow =</span> T)  <span class="sc">+</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-189-1.png" width="336" /></p>
<p>It is a mangled mess because they all have the same color <code>viridian</code>. We can make the shadow more transparent (<code>alpha = 0.2</code>).</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2a, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject,</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>),</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="st">&#39;white&#39;</span>),</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">alpha =</span> <span class="fl">0.65</span>),</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">alpha =</span> <span class="fl">0.65</span>),</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">show_shadow =</span> T)  <span class="sc">+</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-190-1.png" width="336" /></p>
<p>Now it looks a lot better!</p>
</div>
<div id="point-plot-with-a-shadow-using-data-of-multiple-groups" class="section level3 hasAnchor" number="5.3.4">
<h3 class="hasAnchor"><span class="header-section-number">5.3.4</span> Point plot with a shadow using data of multiple groups<a href="#point-plot-with-a-shadow-using-data-of-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now’ lets filter data from two groups <code>Amblyopia</code> and <code>Normal</code>. We can do so by using <code>|</code>, which means <strong>OR</strong>. <code>&amp;</code> means <strong>AND</strong>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>df2b <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span> <span class="sc">|</span> Group <span class="sc">==</span> <span class="st">&#39;Normal&#39;</span>)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>df2b<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2b<span class="sc">$</span>SF)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2b<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] &quot;Amblyopia&quot; &quot;Normal&quot;</code></pre>
<p>After confirming that we have successfully filtered the data, we can plot the data of the two groups with a shadow for each group.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-192-1.png" width="336" /></p>
<p>This is a point plot that includes everything we have learned thus far, such as <code>position_dodge()</code>, the importance of generic paramter <code>...</code>, inclusion of a shadow <code>show_shadow = T</code>, and using two <code>group</code> arguments (one for the average plot, one for the individual points for the shadow).</p>
</div>
<div id="adding-and-modifying-legends" class="section level3 hasAnchor" number="5.3.5">
<h3 class="hasAnchor"><span class="header-section-number">5.3.5</span> Adding and modifying legends<a href="#adding-and-modifying-legends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also add <code>legend</code> to label the two colors by setting <code>sm_pointplot(..., legends = TRUE)</code></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-193-1.png" width="403.2" /></p>
<p>We can move the legend to the topleft part of the plot that has most empty space using <code>theme(legend.position = ...)</code>. Also, the title of the legend can be removed with <code>theme(legend.title = element_blank</code>)</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.24</span>,<span class="fl">0.80</span>),</span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-194-1.png" width="336" /></p>
<p>Note that the legend includes horizontal and vertical lines around the plot. The vertical line represents the error bar, and the horizontal line represents the line that connects between the points at various x levels. The symbols in legend can be manually modified. In this case, I will remove the vertical error bar from the legend by writing <code>err.params = list(show.legend = FALSE)</code>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.24</span>,<span class="fl">0.80</span>),</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-195-1.png" width="336" /></p>
<p>You can also think about controlling the ratio of the figure when saving the figure. In this example, <code>base_height</code> and <code>base_width</code> are specifically controlled.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df2b, <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, </span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">group =</span> Subject, <span class="at">show_shadow =</span> T,</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>),</span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.24</span>,<span class="fl">0.80</span>),</span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())  <span class="ot">-&gt;</span> pointplot</span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pointplot)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-196-1.png" width="384" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;pointplot.png&#39;</span>, pointplot, <span class="at">base_height =</span> <span class="fl">2.8</span>,</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">base_width =</span> <span class="dv">4</span>)</span></code></pre></div>
<!--chapter:end:barSlopePoint.Rmd-->
</div>
</div>
</div>
<div id="raincloud-and-forest-plots" class="section level1 hasAnchor" number="6">
<h1 class="hasAnchor"><span class="header-section-number">6</span> Raincloud and Forest Plots<a href="#raincloud-and-forest-plots" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Please load these three packages to go through the chapter.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) </span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
<div id="raincloud-plot" class="section level2 hasAnchor" number="6.1">
<h2 class="hasAnchor"><span class="header-section-number">6.1</span> Raincloud plot<a href="#raincloud-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A raincloud plot shows the raw data, probability density and summary statistics such as the median, quantiles etc by presenting individual data, a violin plot and a boxplot together.</p>
<p>It might be appealing to present all these components simultaneously to ensure that the data are shown transparently. However, whether this is truly necessary in the field of psychological/neuroscience research has not been entirely resolved because showing all at the same time can be visually overwhelming.</p>
<p>Nevertheless, I have decided to create a function <code>sm_raincloud()</code>. It is flexible and enables users to fine-control the aesthetics of the raincloud plot. I will leave it up to users to decide whether using raincloud is appropriate. Most importantly, this can depend on the type and nature of data set that is used.</p>
<p>Let’s generate random data to explore this function.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">211</span>) <span class="co"># generate random data</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(group1,group2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>Group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Group 1&#39;</span>, <span class="st">&#39;Group 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(group1))</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Group)</span></code></pre></div>
<p>In this data set, there are two distinct groups.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>() <span class="sc">+</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-199-1.png" width="336" /></p>
<p>The default of the individual points’ <code>shape</code> is 21, which is circle with borders. Therefore <code>fill</code> parameter has to be specified to change the filling colors.</p>
<p>After removing the defaults from <strong>smplot2</strong> by including <code>xxx.param = list()</code>, you can set the color of all visual components by setting <code>color = 'black'</code> as a generic parameter. Note that the boxplot and violin have both <code>fill</code> and <code>color</code> parameters. When <code>color = 'black'</code> is included as a generic parameter, <code>shape</code> of the point becomes 16 because the default of <em>smplot2</em> is overridden. Therefore, now that the point has no border, <code>color</code> affects the filling color rather than <code>fill</code>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">boxplot.params =</span> <span class="fu">list</span>(),</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">violin.params =</span> <span class="fu">list</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-200-1.png" width="336" /></p>
<p>The limitation of this function is that you cannot assign unique to the boxplot for each group using <code>scale_color_manual()</code>. We can test this using the script below.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">boxplot.params =</span> <span class="fu">list</span>(),</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">violin.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-201-1.png" width="336" /></p>
<p>In this example, the <code>color</code> affects the border color of the violin. However, the boxplot’s line color is still black even with <code>scale_color_manual()</code>.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">point.params =</span> <span class="fu">list</span>(),</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">boxplot.params =</span> <span class="fu">list</span>(),</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">violin.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-202-1.png" width="336" /></p>
<p>In this example, the <code>fill</code> affects the filling color of the violin but not points.</p>
<p>In most cases, users might not need to manually tweak the defaults of <em>smplot2</em>. This is the default appearance with two custom colors <code>darkred</code> and <code>viridian</code>.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>() <span class="sc">+</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-203-1.png" width="336" /></p>
<p>Notice that there is an outlier in Group 2. The black circle at the top that is aligned to the top <code>viridian</code> point indicates that the <code>viridian</code> point is an outlier. This option of indicating outlier can be removed setting <code>boxplot.params = list(outlier.shape = NA)</code>.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-204-1.png" width="336" /></p>
<p>To truly modify each component of the raincloud plot that is generated using <code>sm_raincloud()</code>, you have to understand these <code>xxx.param = list()</code>:</p>
<ul>
<li><p><code>boxplot.params</code> feeds arguments to <code>geom_half_boxplot()</code> (almost identical to <code>geom_boxplot()</code>) to plot the boxplot with specified <code>color</code>, <code>fill</code>, <code>outlier.shape</code> etc.</p></li>
<li><p><code>violin.params</code> feeds arguments to <code>geom_half_violin()</code> (almost identical to <code>geom_violin()</code>) to plot the violin plot with specified <code>color</code>, <code>alpha</code> and <code>fill</code>, etc</p></li>
<li><p><code>point.params</code> feeds arguments to <code>geom_point()</code> to plot the points in the shadow with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
</ul>
<div id="changing-the-x-axis-labels" class="section level3 hasAnchor" number="6.1.1">
<h3 class="hasAnchor"><span class="header-section-number">6.1.1</span> Changing the x-axis labels<a href="#changing-the-x-axis-labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that the x-axis title is <code>Group</code> and the x-axis tick also says <code>Group 1</code> and <code>Group 2</code>, making the labels repetitive. Therefore we can consider to modify the tick labels as <code>One</code> and <code>Two</code> using <code>scale_x_discrete()</code>.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>, <span class="st">&#39;Two&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-205-1.png" width="336" /></p>
<p>Note that in <strong>smplot</strong>, <code>scale_x_continous()</code> was used to modify the label at each x level. In <strong>smplot2</strong>, <code>scale_x_discrete()</code> is used instead because <code>sm_raincloud()</code> keeps the x-axis <code>discrete</code> rather than forcibly converting it to becoming <code>continuous</code>.</p>
<p><code>scale_x_discrete()</code> is used here because the data frame that is used to plot the data has categorical x variables as shown below.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Group</span></code></pre></div>
<pre><code>##  [1] &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot;
##  [9] &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot;
## [17] &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 1&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot;
## [25] &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot;
## [33] &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot; &quot;Group 2&quot;</code></pre>
<p>This shows that <code>df$Group</code> is discrete and has two unique levels.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] &quot;Group 1&quot; &quot;Group 2&quot;</code></pre>
<p>Instead of changing the x-tick label, we can remove the x-axis title instead by writing <code>theme(axis.title.x = element_blank())</code>.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-208-1.png" width="336" /></p>
</div>
<div id="separating-the-components-and-configuration" class="section level3 hasAnchor" number="6.1.2">
<h3 class="hasAnchor"><span class="header-section-number">6.1.2</span> Separating the components and configuration<a href="#separating-the-components-and-configuration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sm_raincloud()</code> has an interesting parameter <code>sep_level</code>. It enables users to separate components of the raincloud plot. It is a reduced word of separation level and has a range between 0 and 4.</p>
<p>When <code>sep_level = 0</code>, all components are overlapped. If <code>sep_level = 4</code>, all components are separated. The default of <code>sm_raincloud()</code> is set to <code>sep_level = 2</code>.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>),</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep_level =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-209-1.png" width="336" /></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>),</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep_level =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-210-1.png" width="336" /></p>
<p>You also change the configuration of the raincloud plot so that it faces to the left rather than to the right using the argument <code>which_side</code>.</p>
<ul>
<li><code>which_side</code> controls the configuration of the raincloud plot. It accepts <code>'r'</code> and <code>'right'</code> for right configuration (violin plot facing to the right), and <code>'l'</code> and <code>'left'</code> for left configuration.</li>
</ul>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>),</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep_level =</span> <span class="dv">0</span>,</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">which_side =</span> <span class="st">&#39;l&#39;</span>) <span class="sc">+</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-211-1.png" width="336" /></p>
</div>
<div id="changng-the-theme-and-orientation" class="section level3 hasAnchor" number="6.1.3">
<h3 class="hasAnchor"><span class="header-section-number">6.1.3</span> Changng the theme and orientation<a href="#changng-the-theme-and-orientation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sm_raincloud()</code> uses <code>sm_hgrid()</code> automatically and receives <code>legends</code> and <code>borders</code> as arguments as all other visualizing functions of <strong>smplot2</strong>.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>() <span class="sc">+</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-212-1.png" width="336" /></p>
<p>We can remove the borders by setting <code>borders = FALSE</code>.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">borders =</span> F) <span class="sc">+</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-213-1.png" width="336" /></p>
<p>Also, you can bypass <code>sm_hgrid()</code> by adding another theme, such as <code>sm_minimal()</code>.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>() <span class="sc">+</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-214-1.png" width="336" /></p>
<p>You can also change the orientation of the raincloud plot from vertical to horizontal by setting <code>vertical = FALSE</code>.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">vertical =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-215-1.png" width="336" /></p>
<p>We can remove the y-axis title of the plot by using <code>theme(axis.title.y = element_blank())</code> instead <code>theme(axis.title.x = element_blank())</code>.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">vertical =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-216-1.png" width="336" /></p>
</div>
<div id="raincloud-plot-with-data-from-multiple-groups" class="section level3 hasAnchor" number="6.1.4">
<h3 class="hasAnchor"><span class="header-section-number">6.1.4</span> Raincloud plot with data from multiple groups<a href="#raincloud-plot-with-data-from-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sm_raincloud()</code> can also raincloud plots for data from multiple groups. Let’s load this fake data set.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>)</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>)  </span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>df2a <span class="ot">&lt;-</span> <span class="fu">filter</span>(df2, SF <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">8</span>))</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>df2a<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2a<span class="sc">$</span>SF)</span></code></pre></div>
<p>Make sure <code>SF</code> is converted to <code>factor</code> first because the x-scale has to be <strong>discrete</strong>, not continuous. In this example, we have filtered for <code>SF</code> that equals <code>0.5</code> or <code>8</code>.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2a, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">fill =</span> Group,</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">sep_level =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-218-1.png" width="336" /></p>
<p>We immediately see that the plot is extremely crowded because there are four violin plots, four boxplots and overlapping individual points.</p>
<p>We could still try to make it visually neat, however. In the upcoming approach, we will use two separate data frames, one for each group (<code>Normal</code> and <code>Amblyopia</code>).</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>df2amb <span class="ot">&lt;-</span>  <span class="fu">filter</span>(df2a, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>df2norm <span class="ot">&lt;-</span>  <span class="fu">filter</span>(df2a, Group <span class="sc">==</span> <span class="st">&#39;Normal&#39;</span>)</span></code></pre></div>
<p>Next we first plot the data from one of the data frames. Make sure that the first set of raincloud plot is faced slightly to the right using <code>position_nudge()</code>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2amb, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">+</span><span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-220-1.png" width="336" /></p>
<p>Next, we plot the <code>viridian</code> (<code>Normal</code>) data on the figure which <code>left</code> configuration.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2amb, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">+</span><span class="fl">0.15</span>),</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position =</span> sdamr<span class="sc">::</span><span class="fu">position_jitternudge</span>(<span class="at">nudge.x =</span> <span class="fl">0.06</span>, </span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">jitter.width =</span> <span class="fl">0.06</span>))) <span class="sc">+</span></span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2norm, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>,</span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.15</span>),</span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position =</span> sdamr<span class="sc">::</span><span class="fu">position_jitternudge</span>(<span class="at">nudge.x =</span> <span class="sc">-</span><span class="fl">0.06</span>, </span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">jitter.width =</span> <span class="fl">0.06</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-221-1.png" width="336" /></p>
<p>I think this attempt is somewhat acceptable. Let’s improve the aesthetics slightly by adjusting the <code>size</code> of the point and adding <code>legends</code>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SF, <span class="at">y =</span> absBP, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2amb, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">+</span><span class="fl">0.15</span>),</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>, </span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">show.legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position =</span> sdamr<span class="sc">::</span><span class="fu">position_jitternudge</span>(<span class="at">nudge.x =</span> <span class="fl">0.06</span>, <span class="at">seed =</span> <span class="dv">10</span>,</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">jitter.width =</span> <span class="fl">0.06</span>))) <span class="sc">+</span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2norm, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>,</span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.15</span>),</span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">show.legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position =</span> sdamr<span class="sc">::</span><span class="fu">position_jitternudge</span>(<span class="at">nudge.x =</span> <span class="sc">-</span><span class="fl">0.06</span>, <span class="at">seed =</span> <span class="dv">10</span>,</span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">jitter.width =</span> <span class="fl">0.06</span>))) <span class="sc">+</span></span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.24</span>,<span class="fl">0.85</span>),</span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb242-21"><a href="#cb242-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb242-22"><a href="#cb242-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Raincloud plot of two groups&#39;</span>) <span class="sc">+</span></span>
<span id="cb242-23"><a href="#cb242-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-222-1.png" width="336" /></p>
<p>Another solution is to plot the raincloud plot for each group per panel, and put two panels together. In fact, I don’t recommend the reader to plot data of multiple groups within the same figure when drawing a raincloud plot.</p>
<p><strong>Exercise</strong>: By using this script above with some minor changes, you can also generate boxplot (<code>sm_boxplot()</code>) and violin (<code>sm_violin()</code>) using data from multiple groups. You can try them on your own.</p>
</div>
</div>
<div id="forest-plot" class="section level2 hasAnchor" number="6.2">
<h2 class="hasAnchor"><span class="header-section-number">6.2</span> Forest plot<a href="#forest-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A forest plot is commonly known as a visualization method to summarise data across multiple studies or experiments. For this reason, it has been widely used in meta analysis studies that aim to summarise the results of tens or hundreds of studies into a few figures. I believe that forest plot’s usage can exceed beyond simple meta analysis, all the way to describing results from a single study with numerous experimental conditions.</p>
<p>Let’s generate some random data first and draw a forest plot using <code>sm_forest()</code> to explore what the function provides.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<p>When using <code>sm_forest()</code>, <code>x</code> is required to be a continuous variable. <code>y</code> should be a categorical variable (i.e., <code>factor</code>).</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-224-1.png" width="297.6" /></p>
<p><code>sm_forest()</code> has various <code>xxx.params</code> arguments as well as <code>...</code> generic parameter to control the aesthetics across various components of the plot.</p>
<ul>
<li><p><code>avgPoint.params</code> sends arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>err.params = list()</code> sends arguments, such as <code>color</code>, to <code>geom_linerange()</code> to plot the error bar.</p></li>
<li><p><code>point.params = list()</code> sends arguments, such as <code>color</code>, <code>fill</code>, and <code>alpha</code> to <code>geom_point()</code> to plot the individual points.</p></li>
<li><p><code>refLine.params = list()</code> sends arguments, such as <code>color</code> and <code>size</code> to <code>geom_vline()</code> to plot the reference line.</p></li>
</ul>
<p>We can reset all the defaults by listing these parameters as <code>xxx.params = list()</code>.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">avgPoint.params =</span> <span class="fu">list</span>(),</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">err.params =</span> <span class="fu">list</span>(),</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">point.params =</span> <span class="fu">list</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-225-1.png" width="297.6" /></p>
<p>Let’s restore the defaults and change colors now using <code>scale_color_manual()</code>.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>() <span class="sc">+</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-226-1.png" width="297.6" /></p>
<p>These points could be jittered (<code>point_jitter_width</code>) and increase the separation level between the average point and the individual points (<code>sep_level</code>), which has no limited range as opposed to 0-4 in <code>sm_raincloud()</code>.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-227-1.png" width="297.6" /></p>
<p>If <code>sep_level</code> is positive, the average point is above the individual points. If <code>sep_level</code> is negative, then the average point is below the individual points.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-228-1.png" width="297.6" /></p>
<p>The default error bar type is 95% confidence interval (<code>errorbar_type = 'ci'</code>). You can change it to either standard error (<code>'se'</code>) or standard deviation (<code>'sd'</code>). Here is standard deviation.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="dv">3</span>,</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-229-1.png" width="297.6" /></p>
<p>A common practice is to annotate the error range (95% confidence interval) in text on on the forest plot. This could be done using <code>sm_forest_annot()</code>.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">sep_level =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-230-1.png" width="297.6" /></p>
<p><code>sm_forest_annot()</code> has various arguments. These arguments should be identical to what you have provided <code>ggplot(data = ..., aes(x = ..., y = ...)</code>.</p>
<ul>
<li><p>The <code>data</code> argument requires the variable that stores the data frame that is used to plot the data, which is <code>df2</code> in this example.</p></li>
<li><p><code>x</code> argument is the variable that is plotted along the x-axis.</p></li>
<li><p><code>y</code> argument is the variable that is plotted along the y-axis.</p></li>
</ul>
<p>Also, there are some additional arguments.</p>
<ul>
<li><p><code>sep_level</code> refers to the separation level between the text annotation and the average point. If it is positive, the text will be above the mean point. <strong>In practice, put the same value of</strong> <code>sep_level</code> <strong>in both</strong> <code>sm_forest()</code> <strong>and </strong><code>sm_forest_annot()</code>. The default is <code>sep_level = 2</code>, which is also found in <code>sm_forest()</code>.</p></li>
<li><p><code>errorbar_type</code> refers to the type of error by which the text annotation should be written. <strong>In practice, put the same argument of</strong> <code>sep_level</code> <strong>in both</strong> <code>sm_forest()</code> <strong>and </strong><code>sm_forest_annot()</code>. The default is set to confidence interval (<code>errorbar_type = 'ci'</code>).</p></li>
<li><p><code>text.params</code> feeds arguments to <code>geom_text()</code> to set the aesthetics of the texts such as <code>color</code> and <code>size</code>.</p></li>
</ul>
<p>We can try <code>sep_level = -3</code> across <code>sm_forest()</code> and <code>sm_forest_annot()</code> to see what happens.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-231-1.png" width="297.6" /></p>
<p>We see that the positions of the individual points and texts have been flipped in relation to the average points.</p>
<p>You can also draw a vertical reference line by setting <code>refLine = TRUE</code>.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">refLine =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-232-1.png" width="297.6" /></p>
<p>We could change the reference line’s location using the argument <code>xintercept</code>.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">refLine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">xintercept =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-233-1.png" width="297.6" /></p>
<p>We could change the aesthetics of the reference line using <code>refLine.params</code>.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.12</span>, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">refLine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">xintercept =</span> <span class="dv">4</span>,</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">ref.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>))) <span class="sc">+</span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-234-1.png" width="297.6" /></p>
<div id="plotting-the-forest-plot-using-data-of-multiple-groups" class="section level3 hasAnchor" number="6.2.1">
<h3 class="hasAnchor"><span class="header-section-number">6.2.1</span> Plotting the forest plot using data of multiple groups<a href="#plotting-the-forest-plot-using-data-of-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting the forest plot using data of multiple groups is also possible with <code>sm_forest()</code>. To explore this feature, lets upload data from online.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>)</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>SF <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>SF)</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>) </span></code></pre></div>
<p>Now let’s plot these data using <code>sm_forest()</code>. Make sure that group the data for each group <code>group = Group</code>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Forest plot of two groups&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-236-1.png" width="297.6" /></p>
<p>We could also set the transparency of the points so that the <code>alpha</code> increases over <code>SF</code>.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">alpha =</span> SF, <span class="at">group =</span>Group)) <span class="sc">+</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.85</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Forest plot of two groups&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-237-1.png" width="297.6" /></p>
<p>The issue with this plot is that the individual points are overlapped, as well as the mean points at <code>0.5</code> on the y-axis <code>SF</code>. You could use <code>position_dodge()</code> to <code>dodge</code> the position of one group to prevent the overlap.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">alpha =</span> SF, <span class="at">group =</span>Group)) <span class="sc">+</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> <span class="dv">3</span>,</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.85</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Forest plot of two groups&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-238-1.png" width="297.6" /></p>
<p>As in <code>sm_raincloud()</code>, we could split the data frames into two and plot them separately.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>df1amb <span class="ot">&lt;-</span> <span class="fu">filter</span>(df1, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>df1norm <span class="ot">&lt;-</span> <span class="fu">filter</span>(df1, Group <span class="sc">==</span> <span class="st">&#39;Normal&#39;</span>)</span></code></pre></div>
<p>We could plot each group separately using the two data frames. First, plot the <code>Amblyopia</code> group.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">data =</span> df1amb) <span class="sc">+</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-240-1.png" width="297.6" /></p>
<p>Next, apply <code>position_nudge()</code> to move all the components.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">data =</span> df1amb, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">+</span><span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-241-1.png" width="297.6" /></p>
<p>We see that <code>sep_level = 2</code> no longer works when we apply <code>position_nudge()</code> here because <code>sep_level</code> also controls the position of the components using <code>position_nudge()</code>. We have bypassed its control by explicitly writing <code>position_nudge()</code>. Therefore, we will need to separate the points from the mean points manually by using <code>point.params</code>.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">data =</span> df1amb, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">+</span><span class="fl">0.4</span>),</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-242-1.png" width="297.6" /></p>
<p>Then, we can plot the data of <code>Normal</code> on top of the <code>Amblyopia</code> plot.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">data =</span> df1amb, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">+</span><span class="fl">0.3</span>),</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">data =</span> df1norm,</span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">0.3</span>),</span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">0.1</span>)))  <span class="sc">+</span></span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Forest plot of two groups&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-243-1.png" width="297.6" /></p>
<p>This looks acceptable. Another solution is to just remove the individual points altogether by setting <code>sm_forest(points = FALSE)</code>. In this method, we do not need to split the data frame into two.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group, <span class="at">alpha =</span> SF, <span class="at">group =</span> Group)) <span class="sc">+</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> <span class="dv">3</span>,</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">8</span>), <span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.85</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Forest plot of two groups&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-244-1.png" width="297.6" /></p>
<p>Also, <code>sm_forest_annot()</code> can be used to provide text annotations for the error range when presenting data of multiple groups. However, first, we will need to separate the two data frames as shown below for each group: <code>Amblyopia</code> and <code>Normal</code>.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>df1amb <span class="ot">&lt;-</span> <span class="fu">filter</span>(df1, Group <span class="sc">==</span> <span class="st">&#39;Amblyopia&#39;</span>)</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>df1norm <span class="ot">&lt;-</span> <span class="fu">filter</span>(df1, Group <span class="sc">==</span> <span class="st">&#39;Normal&#39;</span>)</span></code></pre></div>
<p>Next, we will have to <code>position_nudge</code> for each annotation and group. There are five numbers that are provided in <code>position_nudge()</code>; the first one is for <code>SF = 0.5</code>, and the last one is for <code>SF = 8</code>.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> absBP, <span class="at">y =</span> SF, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">data =</span> df1amb, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">+</span><span class="fl">0.2</span>),</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df1amb, <span class="at">x =</span> absBP, <span class="at">y =</span> SF,</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.2</span>), </span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">text.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>), </span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">data =</span> df1norm,</span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">0.2</span>),</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">points =</span> <span class="cn">FALSE</span>)  <span class="sc">+</span></span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df1norm, <span class="at">x =</span> absBP, <span class="at">y =</span> SF,</span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.18</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>), </span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">0</span>)), </span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">text.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>),</span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Forest plot of two groups&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-246-1.png" width="297.6" /></p>
<p>Here is the forest plot with data from multiple groups with text annotations but without individual points. As you may realize, text annotations can be extremely tedious so much so that I personally think using Adobe Illustrator might be better in this case.</p>
<!--chapter:end:forestRaincloud.Rmd-->
</div>
</div>
</div>
<div id="part-data-analysis-with-smplot2" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Data Analysis with smplot2<a href="#part-data-analysis-with-smplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="combining-plots-with-common-axes" class="section level1 hasAnchor" number="7">
<h1 class="hasAnchor"><span class="header-section-number">7</span> Combining Plots with Common Axes<a href="#combining-plots-with-common-axes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>First, you need to load data (.csv file). When you are loading your own .csv file for your data analysis, make sure you place the .csv file of your interest in the folder that has been set to the <strong>working directory</strong>.</p>
<p>In this example, we will be using data from this paper:</p>
<p><strong>Seung Hyun Min, Alex S. Baldwin and Robert F. Hess. Ocular dominance plasticity: A binocular combination task finds no cumulative effect with repeated patching (2019). Vision Research, 161, 36-42.</strong></p>
<p>We will be creating similar figures to those in the paper (ex. <strong>Figure 3A</strong> and <strong>Figure A2</strong>) using <strong>smplot</strong>. For the PDF copy, please visit <a href="https://www.smin95.com/pubs/min2019.pdf">this link</a>.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S2      1         0   2.82 
## 3 S3      1         0   1.69 
## 4 S4      1         0   2.55 
## 5 S5      1         0  -0.217
## 6 S6      1         0   0.626</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 10 participants total.</p></li>
<li><p>Next, <code>Day</code> refers to the day of testing. The participants were tested on Day 1, 2, 3, 4 and 5. We will only use Day from 1 and 5.</p></li>
<li><p><code>Time</code> refers to the number of minutes after an experimental manipulation (ex. monocular deprivation). These are 0, 3, 6, 12, 24 and 48 minutes, but in the data frame, it says 0, 1, 2, 3, 4 and 5; we will change the labels manually.</p></li>
<li><p>The <code>Cbratio</code> column refers to the actual data that will be plotted here.</p></li>
</ul>
<p>In the example below, the plots will have different colors based on Day (1 or 5). Therefore, the values in <code>Day</code> column have to be discrete, not continuous. To make them discrete, one needs to convert the <code>Day</code> column from <strong>double</strong> (continuous variable) to <strong>factor</strong> (discrete variable).</p>
<div id="filter-select-and-summarise" class="section level2 hasAnchor" number="7.1">
<h2 class="hasAnchor"><span class="header-section-number">7.1</span> <code>filter()</code>, <code>select()</code> and <code>summarise()</code><a href="#filter-select-and-summarise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="filter-for-rows" class="section level3 hasAnchor" number="7.1.1">
<h3 class="hasAnchor"><span class="header-section-number">7.1.1</span> <code>filter()</code> for rows<a href="#filter-for-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To plot data of each subject separately, we need the data frame to show data only from one subject. This can be achieved as using <code>filter()</code>:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S1      1         1   0.802
##  3 S1      1         2   1.01 
##  4 S1      1         3   0.634
##  5 S1      1         4  -0.245
##  6 S1      1         5  -0.834
##  7 S1      5         0   2.42 
##  8 S1      5         1   1.76 
##  9 S1      5         2   1.91 
## 10 S1      5         3   0.609
## 11 S1      5         4   0.811
## 12 S1      5         5   0.363</code></pre>
<ul>
<li>The first argument of <code>filter()</code>, <code>select()</code>, <code>summarise()</code> and <code>mutate()</code> is a data frame.</li>
<li>The subsequent argument specifies how the data frame should be treated.</li>
<li>The new printed result is a new data frame.</li>
</ul>
<p><code>filter()</code> is used to filter for rows that meet the requirement of your interest.</p>
<p>Here is another example.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ... with 50 more rows</code></pre>
<p>The above code can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column.</p>
<p>Notice that S1 is a <strong>character</strong> because it has an alphabet. Therefore, it needs to be written as <code>'S1'</code>. However, <code>1</code> of <code>Day</code> is <strong>double</strong>, which is essentially just a number digit. Therefore, it can be written as <code>1</code> with no quotation mark.</p>
<p>Let’s try another example.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># save the new data frame into a new variable</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(day1, Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>) <span class="co"># this new data frame contains Day 1 and Subject 1 data only.</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S1      1         1   0.802
## 3 S1      1         2   1.01 
## 4 S1      1         3   0.634
## 5 S1      1         4  -0.245
## 6 S1      1         5  -0.834</code></pre>
<p>The above code can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column. Save this new data frame as <code>day1</code>. Then, <strong>filter</strong> for all rows of the data frame <code>day1</code> that have <code>S1</code> in the <code>Subject</code> column.</p>
<p>The above can also be written like the one below:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S1      1         1   0.802
## 3 S1      1         2   1.01 
## 4 S1      1         3   0.634
## 5 S1      1         4  -0.245
## 6 S1      1         5  -0.834</code></pre>
<p>The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>AND</strong> have <code>S1</code> in the <code>Subject</code> column.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 66 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ... with 56 more rows</code></pre>
<p>The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>OR</strong> have <code>S1</code> in the <code>Subject</code> column. <code>|</code> represents <strong>OR</strong>, <code>&amp;</code> represents <strong>AND</strong>.</p>
</div>
<div id="select-for-columns" class="section level3 hasAnchor" number="7.1.2">
<h3 class="hasAnchor"><span class="header-section-number">7.1.2</span> <code>select()</code> for columns<a href="#select-for-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you wish to see the <code>Cbratio</code> column only (i.e., data only) for rows of <strong>df</strong> that have <code>Day ==  1</code> and <code>Time == 0</code>, you can write it like this:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>day1_time0 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Time <span class="sc">==</span> <span class="dv">0</span>) <span class="co"># save the new data frame in the day1_time0 variable </span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(day1_time0, Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 1
##    Cbratio
##      &lt;dbl&gt;
##  1  -0.421
##  2   2.82 
##  3   1.69 
##  4   2.55 
##  5  -0.217
##  6   0.626
##  7   2.62 
##  8   1.42 
##  9   1.54 
## 10   3.05</code></pre>
<p>There are 10 rows (i.e., 10 subjects) in this filtered data frame and 1 column, which is <code>Cbratio</code>. The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>AND</strong> have <code>0</code> in the <code>Time</code> column. Then, store the new data frame in <code>day1_time0</code>. Then, select for <code>Cbratio</code> column from <code>day1_time0</code>.</p>
<p><code>select()</code> is used to filter for columns that meet the requirement of your interest.</p>
</div>
<div id="summarise-for-grouped-summaries" class="section level3 hasAnchor" number="7.1.3">
<h3 class="hasAnchor"><span class="header-section-number">7.1.3</span> <code>summarise()</code> for grouped summaries<a href="#summarise-for-grouped-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>df</strong> contains individual data for all subjects on Days 1 and 5 across all time points. However, it does not contain average data either for each <strong>Day</strong> or <strong>Time</strong>.</p>
<p><code>summarise()</code> can collapse multiple rows of observations into values such as the mean.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(df, <span class="at">average =</span> <span class="fu">mean</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   average
##     &lt;dbl&gt;
## 1    1.35</code></pre>
<p>However, in this case, we get an example of <code>Cbratio</code> across <code>Subject</code>, <code>Day</code> and <code>Time</code>. This average value itself is not so meaningful. If we wish to obtain the average for each <code>Day</code> and <code>Time</code>, we can use the function <code>group_by()</code> to group data for each day and time.</p>
<ul>
<li><p>As it was the case before, the first argument of <code>group_by()</code> is a data frame.</p></li>
<li><p>The second argument of <code>group_by()</code> is the name of the column through which you would like to group the data.</p></li>
</ul>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>by_day_time <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df, Day, Time)</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_day_time)</span></code></pre></div>
<pre><code>## # A tibble: 120 x 4
## # Groups:   Day, Time [12]
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ... with 110 more rows</code></pre>
<p>The output of <code>group_by()</code> is a new data frame (it might appear exactly the same as before, ex. <strong>df</strong>). However, it will respond differently to <code>summarise()</code> because the rows of the data frame are now grouped based on day and time, as we have specified.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_day_time, <span class="at">Average_Cbratio =</span> <span class="fu">mean</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
## # Groups:   Day [2]
##    Day    Time Average_Cbratio
##    &lt;fct&gt; &lt;dbl&gt;           &lt;dbl&gt;
##  1 1         0           1.57 
##  2 1         1           2.21 
##  3 1         2           2.32 
##  4 1         3           0.979
##  5 1         4           1.25 
##  6 1         5           1.14 
##  7 5         0           1.85 
##  8 5         1           1.49 
##  9 5         2           1.02 
## 10 5         3           1.15 
## 11 5         4           0.759
## 12 5         5           0.452</code></pre>
<p>This new data frame yields average for each Day and Time. We have now created a new column <code>Average_Cbratio</code> which stores all the average data of <code>Cbratio</code>.</p>
<p>Therefore, <code>group_by()</code> and <code>summarise()</code> are very useful together. They provide grouped summaries, such as the average. However, <code>summarise()</code> alone may not be so useful. <code>group_by()</code> alone is also rarely used.</p>
<p>Besides the <strong>average</strong>, one might also be interested in obtaining either <strong>standard deviation</strong> or <strong>standard error</strong>.</p>
<p>However, our <strong>df</strong> does not contain any data about the <strong>standard deviation</strong> or <strong>standard error</strong> per Day or Time, etc. Standard deviation can be calculated via <code>sd()</code> and standard error can be computed with <code>sm_stdErr()</code>.</p>
<p>Below, we obtain standard error with the help of the <code>summarise()</code> function for each <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(df, <span class="at">standard_error =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   standard_error
##            &lt;dbl&gt;
## 1          0.115</code></pre>
<p>As we have seen before, we see that <code>standard_error</code> has been calculated across all subjects, day and time. This is not so useful. We should use <code>summarise()</code> with <code>group_by()</code> so that each standard error could be for each <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>by_day_time <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df, Day, Time)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_day_time, <span class="at">standard_error =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
## # Groups:   Day [2]
##    Day    Time standard_error
##    &lt;fct&gt; &lt;dbl&gt;          &lt;dbl&gt;
##  1 1         0          0.393
##  2 1         1          0.363
##  3 1         2          0.400
##  4 1         3          0.352
##  5 1         4          0.266
##  6 1         5          0.438
##  7 5         0          0.563
##  8 5         1          0.422
##  9 5         2          0.462
## 10 5         3          0.224
## 11 5         4          0.292
## 12 5         5          0.193</code></pre>
<p>This standard error is for each <code>Day</code> and <code>Time</code> across all subjects.</p>
<p>Now let’s obtain the <strong>mean</strong> and <strong>standard error</strong> of <code>Cbratio</code> for each <code>Day</code> and <code>Time</code> across all subjects using the data frame that has been grouped by <code>Day</code> and <code>Time</code> via <code>group_by()</code>.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>by_day_time1 <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_day_time, <span class="at">Average =</span> <span class="fu">mean</span>(Cbratio),</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">StdError =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_day_time1)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
## # Groups:   Day [2]
##    Day    Time Average StdError
##    &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 1         0   1.57     0.393
##  2 1         1   2.21     0.363
##  3 1         2   2.32     0.400
##  4 1         3   0.979    0.352
##  5 1         4   1.25     0.266
##  6 1         5   1.14     0.438
##  7 5         0   1.85     0.563
##  8 5         1   1.49     0.422
##  9 5         2   1.02     0.462
## 10 5         3   1.15     0.224
## 11 5         4   0.759    0.292
## 12 5         5   0.452    0.193</code></pre>
<p>The original <strong>df</strong>, which contains data for each subject, has now been transformed to a new data frame that contains grouped summaries, such as group averages and standard errors.</p>
<p>If you are interested in learning more about this topic (data transformation), please check out Chapter 5 of R for Data Science by Hadley Wickham (<a href="https://r4ds.had.co.nz/transform.html" class="uri">https://r4ds.had.co.nz/transform.html</a>).</p>
</div>
</div>
<div id="plotting-the-averaged-data-with-error-bars" class="section level2 hasAnchor" number="7.2">
<h2 class="hasAnchor"><span class="header-section-number">7.2</span> Plotting the averaged data with error bars<a href="#plotting-the-averaged-data-with-error-bars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plotting the averaged data can be done with a data frame that contains individual observation (ex. each subject, condition, etc). This data frame can be modified to only contain summary values, such as mean and standard error, using <code>group_by()</code> and <code>summarise()</code> together as shown above.</p>
<p>We will plot a similar graph to <strong>Figure 3A</strong> in the Vision Research paper (Min et al., 2019) in this section.</p>
<ul>
<li>A data frame that has grouped summary information (<code>group_by()</code> and <code>summarise()</code>), such as average and standard error across subject, is needed to plot a graph that shows the average data with error bars.</li>
<li><code>geom_errorbar()</code> is required to plot the error bar of the sample.</li>
<li>Legend title has been removed with the <code>theme()</code> function.</li>
<li>Greek letter <strong>Delta</strong> is printed with <code>\u0394</code>.</li>
<li>X-tick labels are originally 0, 1, 2, 3, 4, 5 (as specified in the <strong>df</strong> data frame). However, they can be manually changed using <code>labels =</code> argument in the <code>scale_x_continuous()</code> function.</li>
<li>Legend label can also be changed in <code>labels =</code> from the <code>scale_color_manual()</code> function because each <code>Day</code> has been defined by each <code>color</code>; this is the case because <code>color = Day</code> in <code>aes(..., ..., color = Day)</code>.</li>
</ul>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> by_day_time1, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Average, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Average <span class="sc">-</span> StdError, <span class="at">ymax =</span> Average <span class="sc">+</span> StdError), <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">width =</span> .<span class="dv">05</span>) <span class="sc">+</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb295-9"><a href="#cb295-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>),</span>
<span id="cb295-10"><a href="#cb295-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Day 1&quot;</span>, <span class="st">&quot;Day 5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb295-11"><a href="#cb295-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Recovery of the patching effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb295-12"><a href="#cb295-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time after monocular deprivation (min)&quot;</span>) <span class="sc">+</span></span>
<span id="cb295-13"><a href="#cb295-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb295-14"><a href="#cb295-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb295-15"><a href="#cb295-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.67</span>), </span>
<span id="cb295-16"><a href="#cb295-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-263-1.png" width="336" /></p>
</div>
<div id="plotting-individual-data" class="section level2 hasAnchor" number="7.3">
<h2 class="hasAnchor"><span class="header-section-number">7.3</span> Plotting individual data<a href="#plotting-individual-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we will plot a similar graph to <strong>Figure A2</strong> in the Vision Research paper (Min et al., 2019).</p>
<p>First, you will need several packages for this section.</p>
<ul>
<li>If you do not have the <strong>gridExtra</strong> and <strong>grid</strong> packages in your RStudio, please install them using the codes below. It might take less than a minute.</li>
</ul>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;gridExtra&#39;</span>)</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;grid&#39;</span>)</span></code></pre></div>
<ul>
<li>Then load all these packages below.</li>
</ul>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span></code></pre></div>
<p>Now let’s plot data for each subject (S1-S9) except S10. Each panel shows the data of each subject for both Days 1 and 5.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>df_s1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>) </span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rows of df that only contain S1 in the Subject column</span></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use df_s1 to plot the data of S1</span></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>plot_s1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s1, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb298-17"><a href="#cb298-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-18"><a href="#cb298-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s1)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-266-1.png" width="336" /></p>
<p>Then make each one for the other subjects (S2-S9).</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>df_s2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S2&#39;</span>) </span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>plot_s2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s2, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s2)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-267-1.png" width="336" /></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>df_s3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S3&#39;</span>)</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>plot_s3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s3, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s3)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-268-1.png" width="336" /></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>df_s4 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S4&#39;</span>)</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>plot_s4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s4, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s4)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-269-1.png" width="336" /></p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subject 5</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>df_s5 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S5&#39;</span>) </span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rows of df that only contain S5 in the Subject column</span></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>plot_s5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s5, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># show legends for the color</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> <span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.65</span>)) </span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="co"># location of legend (color label)</span></span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s5)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-270-1.png" width="336" /></p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subject 6</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>df_s6 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S6&#39;</span>) </span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rows of df that only contain S6 in the Subject column</span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>plot_s6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s5, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb303-10"><a href="#cb303-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb303-11"><a href="#cb303-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb303-12"><a href="#cb303-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb303-13"><a href="#cb303-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))  <span class="sc">+</span></span>
<span id="cb303-14"><a href="#cb303-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb303-15"><a href="#cb303-15" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb303-16"><a href="#cb303-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-17"><a href="#cb303-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s6)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-271-1.png" width="336" /></p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>df_s7 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S7&#39;</span>)</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>plot_s7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s7, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s7)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-272-1.png" width="336" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>df_s8 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S8&#39;</span>)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>plot_s8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s8, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s8)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-273-1.png" width="336" /></p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subject 9</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>df_s9 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S9&#39;</span>) </span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>plot_s9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s9, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb306-12"><a href="#cb306-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb306-13"><a href="#cb306-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb306-14"><a href="#cb306-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb306-15"><a href="#cb306-15" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb306-16"><a href="#cb306-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-17"><a href="#cb306-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s9)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-274-1.png" width="336" /></p>
</div>
<div id="putting-multiple-plots-together" class="section level2 hasAnchor" number="7.4">
<h2 class="hasAnchor"><span class="header-section-number">7.4</span> Putting multiple plots together<a href="#putting-multiple-plots-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s put them together in a 3x3 figure (3 rows, 3 columns) using the function <code>plot_grid</code> from the <strong>cowplot</strong> package. Here is the illustration of what we are going to do.</p>
<div class="figure" style="text-align: center">
<img src="img/rc33.png" alt="3x3 figure. It has 3 columns and 3 rows" width="75%" />
<p class="caption">
(#fig:unnamed-chunk-275)3x3 figure. It has 3 columns and 3 rows
</p>
</div>
<p>When you are saving the graph as an image file, <code>nrow</code> and <code>ncol</code> in <code>save_plot()</code> have to match the values in <code>plot_grid()</code> as shown below.</p>
<p><code>plot_grid()</code> is a function that puts different graphs together (ex. 3x3 structure). For more information about the function <code>plot_grid</code>, please type <code>?plot_grid</code> in the console.</p>
<p><code>save_plot()</code> is a function that saves a selected graph into an image or PDF file (or eps, etc).</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>together1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(plot_s1, plot_s2, plot_s3,</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>                       plot_s4, plot_s5, plot_s6, </span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>                       plot_s7, plot_s8, plot_s9, </span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="co"># 3 columns in the final figure</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">3</span>, <span class="co"># 3 rows in the final figure </span></span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">align =</span> <span class="st">&#39;hv&#39;</span>,<span class="co"># set to the same horizontal and vertical                             # lengths of each panel. </span></span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;S1&#39;</span>,<span class="st">&#39;S2&#39;</span>, <span class="st">&#39;S3&#39;</span>, <span class="st">&#39;S4&#39;</span>,<span class="st">&#39;S5&#39;</span>,<span class="st">&#39;S6&#39;</span>,</span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;S7&#39;</span>,<span class="st">&#39;S8&#39;</span>,<span class="st">&#39;S9&#39;</span>), <span class="co"># each panel label</span></span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_x =</span> <span class="fl">0.14</span>,<span class="co"># horizontal position of the panel&#39;s </span></span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>          <span class="co"># label relative to each panel. 0 is the very </span></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>          <span class="co"># left of the plot.</span></span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_y =</span> <span class="fl">0.97</span>)  <span class="co"># vertical position of the panel&#39;s </span></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>          <span class="co"># label relative to each panel. 1 is the very </span></span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a>          <span class="co"># top of the plot. </span></span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(together1)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-276-1.png" width="1094.4" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;together1.png&#39;</span>,together1,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">base_asp=</span><span class="fl">0.95</span>) </span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="co"># save as an image. ncol and nrow in save_plot() </span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow and ncol in save_plot() have to match the values in plot_grid() as shown above. </span></span></code></pre></div>
<p>Open <code>together1.png</code> in your directory folder. Notice that the <strong>png</strong> file may look different from the one printed in your RStudio screen or on the browser as shown in this guide. As long as your <strong>png</strong> file looks good, it should be okay.</p>
<p>Note that there are some repeating x and y-axes labels. <strong>We can remove them in this example because the y-axis and x-axis scales are set to the same limit</strong> using <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code>. In other words, the maximum and minimum values of the axes are the same across the panels. For example, the top left panel’s x-axis labels can be removed because the bottom left panel also has the same x-axis labels. In addition, the horizontal grids are located at the same places. Each grid line represents the same x-axis value. The range of the x-axis of the panels is also the same. Moreover, the y-axis labels of the top right panel can be removed because the top left panel has the same label.</p>
<p>In short, to combine multiple plots together, you must ensure that:</p>
<ul>
<li><p>The scales of the x and y are equal between plots.</p></li>
<li><p>The grids are identical. Otherwise, you won’t be able to decipher what the points mean in panels without x- or y-tick labels.</p></li>
</ul>
<p>After confirming these and combining the plots by removing the common x-axis and y-axis labels, you will realize that there will be a lot of empty space between the panels. This has to be reduced.</p>
<ul>
<li><p>We will use the function <code>sm_common_axis()</code> to resolve these issues.</p></li>
<li><p><code>sm_common_axis()</code> has an argument called <code>location</code>. This refers to the location of each panel in the combined figure that you will make.</p></li>
<li><p>The picture here illustrates what you will need to write for <code>location</code> in the function <code>sm_common_axis()</code>.</p></li>
<li><p>Example: <code>sm_common_axis(location = 'topleft')</code> for the very top left panel of the 3x3 combined figure.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/rc_arg.png" alt="Arguments for location in sm_common_axis for 3x3 figure." width="75%" />
<p class="caption">
(#fig:unnamed-chunk-277)Arguments for location in sm_common_axis for 3x3 figure.
</p>
</div>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>plot_s1_b <span class="ot">&lt;-</span> plot_s1 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topleft&#39;</span>)</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>plot_s2_b <span class="ot">&lt;-</span> plot_s2 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topcenter&#39;</span>)</span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>plot_s3_b <span class="ot">&lt;-</span> plot_s3 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topright&#39;</span>)</span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>plot_s4_b <span class="ot">&lt;-</span> plot_s4 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topleft&#39;</span>)</span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a>plot_s5_b <span class="ot">&lt;-</span> plot_s5 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topcenter&#39;</span>)</span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-11"><a href="#cb309-11" aria-hidden="true" tabindex="-1"></a>plot_s6_b <span class="ot">&lt;-</span> plot_s6 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topright&#39;</span>)</span>
<span id="cb309-12"><a href="#cb309-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-13"><a href="#cb309-13" aria-hidden="true" tabindex="-1"></a>plot_s7_b <span class="ot">&lt;-</span> plot_s7 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;bottomleft&#39;</span>)</span>
<span id="cb309-14"><a href="#cb309-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-15"><a href="#cb309-15" aria-hidden="true" tabindex="-1"></a>plot_s8_b <span class="ot">&lt;-</span> plot_s8 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;bottomcenter&#39;</span>)</span>
<span id="cb309-16"><a href="#cb309-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-17"><a href="#cb309-17" aria-hidden="true" tabindex="-1"></a>plot_s9_b <span class="ot">&lt;-</span> plot_s9 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;bottomright&#39;</span>)</span>
<span id="cb309-18"><a href="#cb309-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-19"><a href="#cb309-19" aria-hidden="true" tabindex="-1"></a>together2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(plot_s1_b, plot_s2_b, plot_s3_b,</span>
<span id="cb309-20"><a href="#cb309-20" aria-hidden="true" tabindex="-1"></a>                       plot_s4_b, plot_s5_b, plot_s6_b, </span>
<span id="cb309-21"><a href="#cb309-21" aria-hidden="true" tabindex="-1"></a>                       plot_s7_b, plot_s8_b, plot_s9_b, </span>
<span id="cb309-22"><a href="#cb309-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="co"># 3 columns in the final figure</span></span>
<span id="cb309-23"><a href="#cb309-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">3</span>, <span class="co"># 3 rows in the final figure </span></span>
<span id="cb309-24"><a href="#cb309-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">align =</span> <span class="st">&#39;hv&#39;</span>,<span class="co"># set to the same horizontal and vertical </span></span>
<span id="cb309-25"><a href="#cb309-25" aria-hidden="true" tabindex="-1"></a>          <span class="co"># lengths of each panel. </span></span>
<span id="cb309-26"><a href="#cb309-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;S1&#39;</span>,<span class="st">&#39;S2&#39;</span>, <span class="st">&#39;S3&#39;</span>, <span class="st">&#39;S4&#39;</span>,<span class="st">&#39;S5&#39;</span>,<span class="st">&#39;S6&#39;</span>,</span>
<span id="cb309-27"><a href="#cb309-27" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;S7&#39;</span>,<span class="st">&#39;S8&#39;</span>,<span class="st">&#39;S9&#39;</span>), <span class="co"># each panel label</span></span>
<span id="cb309-28"><a href="#cb309-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_x =</span> <span class="fl">0.07</span>) <span class="co"># horizontal position of the panel&#39;s </span></span>
<span id="cb309-29"><a href="#cb309-29" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># label relative to each panel. </span></span>
<span id="cb309-30"><a href="#cb309-30" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># 0 is the very left of the plot. </span></span>
<span id="cb309-31"><a href="#cb309-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-32"><a href="#cb309-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(together2)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-278-1.png" width="1065.6" /></p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;together2.png&#39;</span>,together2,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">base_asp=</span><span class="fl">0.95</span>)</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="co"># save as an image. ncol and nrow in save_plot() </span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow and ncol in save_plot() have to match the </span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co"># values in plot_grid() as shown above. </span></span></code></pre></div>
<p>Open <code>together2.png</code> in your directory folder. I think it looks a lot cleaner!</p>
<p>The figure shows how to make a 1x3 figure (1 row, 3 columns).</p>
<div class="figure" style="text-align: center">
<img src="img/rc13.png" alt="Arguments for location in sm_common_axis for 1x3 figure." width="75%" />
<p class="caption">
(#fig:unnamed-chunk-279)Arguments for location in sm_common_axis for 1x3 figure.
</p>
</div>
<p>If you are planning to make a 2x2 figure (2 rows, 2 columns), please understand the diagram below.</p>
<div class="figure" style="text-align: center">
<img src="img/rc22.png" alt="Arguments for location in sm_common_axis for 2x2 figure." width="55%" />
<p class="caption">
(#fig:unnamed-chunk-280)Arguments for location in sm_common_axis for 2x2 figure.
</p>
</div>
<p>We are almost done now. Now, you will need to add the y-axis label (<code>'Contrast balance ratio\n '</code>), x-axis label (<code>'Minutes after monocular deprivation\n '</code>) and the title (<code>'Recovery of the patching effect'</code>) as shown in the original paper (Vision Research 2019).</p>
<p><code>\n</code> is added to have more space in the x and y axes title.</p>
<p>You can do this in <strong>Adobe Illustrator</strong> or directly in <strong>R</strong>. Here, I present a solution with <strong>R</strong>.</p>
<p>You don’t have to understand the codes below to use the codes.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span> </span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">&#39;Recovery of the patching effect&#39;</span>,</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="dv">17</span>, <span class="at">hjust =</span> <span class="fl">0.45</span>, <span class="at">vjust =</span> <span class="fl">1.2</span>,</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>) <span class="co"># title of the 3x3 figure. </span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="co"># vjust controls the vertical position of the title. </span></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="co"># hjust controls the horizontal position of the title.</span></span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>plot_with_title <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(title, together2, <span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span> ,<span class="dv">1</span>)) </span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add the title and the 3x3 figure together </span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">add_sub</span>(plot_with_title, </span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; </span><span class="sc">\n</span><span class="st">Minutes after monocular deprivation</span><span class="sc">\n</span><span class="st"> &quot;</span>, </span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">4</span>, <span class="at">size =</span> <span class="dv">17</span>) </span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a><span class="co"># add x-axis title to the 3x3 figure</span></span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add y-axis title to the 3x3 figure</span></span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(combined_plot, </span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;\u0394 Contrast Balance Ratio (dB)</span><span class="sc">\n</span><span class="st"> &quot;</span>,</span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">17</span>), </span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rot =</span> <span class="dv">90</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-281-1.png" width="1104" /></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;combined_plot.png&quot;</span>, combined_plot, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">base_aspect_ratio =</span> .<span class="dv">9</span>, <span class="at">limitsize =</span> F)</span></code></pre></div>
<p>To be honest, for adding the titles of the axes and the graph, using <strong>Adobe Illustrator</strong> might be much easier. I have just included the codes here to demonstrate that everything, however, could be done in R.</p>
<p>If you do not understand some of these functions, you can type in your console <code>?add_sub</code>, <code>?grid.arrange</code> to learn about these functions.</p>
<p>An astute reader will realize that the codes are quite repetitive. Could the codes be shortened? The answer is yes! However, this method is quite complex and beyond the scope of this book.</p>
<!--chapter:end:CommonAxis.Rmd-->
</div>
</div>
<div id="calculating-area-under-a-curve" class="section level1 hasAnchor" number="8">
<h1 class="hasAnchor"><span class="header-section-number">8</span> Calculating Area under a Curve<a href="#calculating-area-under-a-curve" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we will continue to use data from this paper (<a href="https://www.smin95.com/pubs/min2019.pdf">PDF</a>):</p>
<p><strong>Seung Hyun Min, Alex S. Baldwin and Robert F. Hess. Ocular dominance plasticity: A binocular combination task finds no cumulative effect with repeated patching (2019). Vision Research, 161, 36-42.</strong></p>
<p>In Chapter 5, we only dealt with data from Days 1 and 5. In this chapter, we will use data from Days 1, 2, 3, 4 and 5.</p>
<p>Let’s begin by loading the <code>tidyverse</code> and other libraries, and uploading the csv file <code>min2019b.csv</code> using <code>read_csv()</code> from the <code>tidyverse</code> package.</p>
<p><code>head()</code> returns the first 6 rows of the data frame. <code>tail()</code> returns the last 6 rows of the data frame.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject   Day  Time Cbratio
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 a           1     0  -0.421
## 2 b           1     0   2.82 
## 3 c           1     0   1.69 
## 4 d           1     0   2.55 
## 5 e           1     0  -0.217
## 6 f           1     0   0.626</code></pre>
<p><code>unique()</code> returns unique values in the data set. Let’s see how many unique values there are in the <code>Day</code> column of the data set. A column can be extracted by using <code>$</code>.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Day)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5
## Levels: 1 2 3 4 5</code></pre>
<p>Notice that there are now five different days in the data set.</p>
<p>As previously mentioned, there are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 10 participants total.</p></li>
<li><p>Next, <code>Day</code> refers to the day of testing. The participants were tested on Days 1, 2, 3, 4 and 5, ad we will using all data.</p></li>
<li><p><code>Time</code> refers to the number of minutes after an experimental manipulation (ex. monocular deprivation). These are 0, 3, 6, 12, 24 and 48 minutes, but in the data frame, it says 0, 1, 2, 3, 4 and 5; we will change the labels manually.</p></li>
<li><p>The <code>Cbratio</code> column refers to the actual data that will be used for
data analysis.</p></li>
</ul>
<div id="pipe" class="section level2 hasAnchor" number="8.1">
<h2 class="hasAnchor"><span class="header-section-number">8.1</span> Pipe <code>%&gt;%</code><a href="#pipe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s plot data from Day 1 only.</p>
<p>To do so, we will need to first filter for data from Day 1 using <code>filter()</code>, compute the average and standard error across subjects using <code>summarise()</code> and <code>sm_stdErr()</code>, and save the changed
format of the dataframe into a new variable using <code>&lt;-</code> or <code>-&gt;</code>.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>df_day1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>by_time_day1 <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df_day1, Time)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>avg_day1 <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_time_day1, <span class="at">Average =</span> <span class="fu">mean</span>(Cbratio),</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">StdError =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<p>The steps above (<code>filter()</code>, <code>group_by()</code> and <code>summarise()</code>) are coded separately. Each line has one of these steps. However, these can be combined in one line by using pipe <code>%&gt;%</code> as shown below.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>avg_day1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average =</span> <span class="fu">mean</span>(Cbratio),</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">StdError =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<p>Now the steps (<code>filter()</code>, <code>group_by()</code> and <code>summarise()</code>) are written from left-to-right in a continuous fashion, rather than a separate step.</p>
<p>Pipe <code>%&gt;%</code> is part of the <code>tidyverse</code> package, and it is deemed a necessary tool for data analysis using R. It is extremely useful because it allows you to write codes that are easier to understand. Notice that if you use <code>%&gt;%</code>, the input does not have to written because the input is actually the code that is written just before. For example:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 a       1         0  -0.421
##  2 b       1         0   2.82 
##  3 c       1         0   1.69 
##  4 d       1         0   2.55 
##  5 e       1         0  -0.217
##  6 f       1         0   0.626
##  7 g       1         0   2.62 
##  8 h       1         0   1.42 
##  9 u       1         0   1.54 
## 10 j       1         0   3.05 
## # ... with 50 more rows</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 a       1         0  -0.421
##  2 b       1         0   2.82 
##  3 c       1         0   1.69 
##  4 d       1         0   2.55 
##  5 e       1         0  -0.217
##  6 f       1         0   0.626
##  7 g       1         0   2.62 
##  8 h       1         0   1.42 
##  9 u       1         0   1.54 
## 10 j       1         0   3.05 
## # ... with 50 more rows</code></pre>
<p>These two are identical. But notice that if you do not use pipe,
you might have to save the intermediate variables (such as <code>df_day1</code> and <code>by_time_day1</code>) multiple times, which can be tedious. Notice that when pipe <code>%&gt;%</code> is used, the need to save these variables disappears.</p>
<p>I will use <code>%&gt;%</code> from now on due to my personal preference.</p>
</div>
<div id="area-under-a-curve" class="section level2 hasAnchor" number="8.2">
<h2 class="hasAnchor"><span class="header-section-number">8.2</span> Area under a curve<a href="#area-under-a-curve" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s use the data set <code>avg_day1</code> to plot data only from Day 1.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>avg_day1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Average)) <span class="sc">+</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Average <span class="sc">-</span> StdError, <span class="at">ymax =</span> Average <span class="sc">+</span> StdError), <span class="at">size =</span> .<span class="dv">75</span>, <span class="at">width =</span> .<span class="dv">05</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">13</span>, <span class="at">y =</span> <span class="fl">0.3</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-288-1.png" width="336" /></p>
<p>One way to show data is to calculate the area under a curve (as shown by the colored area) in the figure above. Area under a curve is useful because it reduces a number of data points (6 in this case due to 6 time points) into one. In our context, a large area under a curve represents a large change in contrast balance ratio over time. In short, it captures both the magnitude and longevity of the effect.</p>
<p>Let’s calculate area under a curve for each subject and day across 0 to 48 minutes in the x-axis (minutes after monocular deprivation) using <code>sm_auc()</code>.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">24</span>,<span class="dv">48</span>)</span></code></pre></div>
<p>On the x-axis of the graph, there are six time points. You will need to store these values in a new variable, which I will call <code>x</code> here because it represents the x-axis. Instead of manually writing them down, you could extract the unique number of <code>Time</code> from the data frame.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time) <span class="co"># this is my preferred way</span></span></code></pre></div>
<p>Now let’s filter for one subject’s data (subject <code>b</code>) on Day 1 using <code>filter()</code> and pipe <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>subj_b_day1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>subj_b_day1</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 b       1         0   2.82 
## 2 b       1         3   0.881
## 3 b       1         6   1.83 
## 4 b       1        12   0.877
## 5 b       1        24   0.693
## 6 b       1        48   2.09</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>subj_b_day1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 1, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">13</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = ?&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-292-1.png" width="336" /></p>
<p>The variable <code>subj_b_day1</code> now stores the data of subject <code>b</code> on Day 1. Now let’s calculate the area under a curve (AUC) from <code>subj_b_day1</code> using <code>sm_auc()</code>.</p>
<p><code>sm_auc()</code> calculates the AUC using the method of trapezoid integration; this is equivalent to <code>trapz</code> function in Matlab and <code>numpy.trapz</code> in Python. It has two arguments:
- The first argument is the x point. In this case, it is the minutes after monocular deprivation (0, 3, 6, 12, 24 and 48). If this argument is left empty, it will use 0, 1, 2, 3 etc as default. For more information, please type <code>?sm_auc</code> in the command console.
- The second argument is the data, which is shown by the y-axis in the blue graph. In this case, it is the change of contrast balance ratio (dB). These values can be extracted from <code>subj_b_day1</code> using <code>$</code>.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_auc</span>(x, subj_b_day1<span class="sc">$</span>Cbratio)</span></code></pre></div>
<pre><code>## [1] 60.5286</code></pre>
<p>The AUC equals 60.53. This shows that for subject <code>b</code>, the effect is large and long-lasting.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>subj_b_day1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 1, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">14.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = 60.5&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-294-1.png" width="336" /></p>
<p>Now let’s visualize the data of subject <code>b</code> from Day 2.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 2, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">13</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = ?&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-295-1.png" width="336" /></p>
<p>Now, let’s calculate the AUC for subject <code>b</code> from Day 2.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_auc</span>(x, subj_b_day2<span class="sc">$</span>Cbratio)</span></code></pre></div>
<pre><code>## [1] 80.38215</code></pre>
<p>The AUC equals 80.38. In the case of subject <code>b</code>, the effect seems to have increased on Day 2 relative to Day 1.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 2, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">14.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = 80.4&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-297-1.png" width="336" /></p>
<p>So far,we have 9 more subjects across five days and subject <code>b</code> from three other days. This will require us to compute 48 more AUCs total. This process is rater repetitive. Should we manually compute AUC for each one? Luckily, the answer is no. Let’s use <code>sm_auc_all()</code>.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_auc_all</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<pre><code>##    Subject Day AUC_Cbratio
## 1        a   1    -2.36910
## 2        a   2     0.68265
## 3        a   3    -9.54795
## 4        a   4    27.12165
## 5        a   5    41.95680
## 6        b   1    60.52860
## 7        b   2    80.38215
## 8        b   3    94.68870
## 9        b   4    34.05225
## 10       b   5    86.51805
## 11       c   1    94.84035
## 12       c   2     1.78695
## 13       c   3    44.94750
## 14       c   4    24.83535
## 15       c   5    67.99770
## 16       d   1   100.62510
## 17       d   2   -19.60125
## 18       d   3    85.39140
## 19       d   4     9.37800
## 20       d   5   -16.12920
## 21       e   1    55.32240
## 22       e   2   132.99825
## 23       e   3    67.24410
## 24       e   4    -0.93135
## 25       e   5    27.36150
## 26       f   1   108.13770
## 27       f   2    31.14285
## 28       f   3    21.66375
## 29       f   4   116.81430
## 30       f   5    48.95040
## 31       g   1    63.27840
## 32       g   2    80.24685
## 33       g   3    33.71850
## 34       g   4   131.84340
## 35       g   5    32.61525
## 36       h   1    48.71625
## 37       h   2    75.98130
## 38       h   3    73.61250
## 39       h   4    21.84735
## 40       h   5    71.04780
## 41       u   1    39.11865
## 42       u   2    64.56690
## 43       u   3    15.80355
## 44       u   4    28.84035
## 45       u   5    15.56220
## 46       j   1    74.90610
## 47       j   2   101.06550
## 48       j   3    52.90590
## 49       j   4    40.73910
## 50       j   5    36.71595</code></pre>
<p><code>sm_auc_all()</code> creates a new data frame with AUC for each subject and condition (in this case, Day). It has six arguments:</p>
<ul>
<li><code>data</code> = this argument requires the variable that stores the data frame. In our case, it is <code>df</code>.</li>
<li><code>subjects</code> = this argument requires the name of the column of the data frame that contains subjects. It must strings, ex. <code>'Subject'</code>, not <code>Subject</code>.</li>
<li><code>groups</code> = this argument requires the name of the column of the data frame that contains each group. In this example, there is no group. An example would be <code>Group</code> column that contains two groups: <code>Normal</code> and <code>Amblyopia</code> (see next chapter on Slope Analysis).</li>
<li><code>conditions</code> = this argument requires name of the column of the data frame that contains each condition. In our example, the condition is the day. It must strings, ex. <code>'Day'</code>, not <code>Day</code>.</li>
<li><code>x</code> = this argument requires the name of the column of the data frame that contains the x-axis points from which the AUC can be calculated. In our case, these are 0, 3, 6, 12, 24 minutes. It must be strings, ex. <code>'Time'</code>, not <code>Time</code>. Also, it must be <strong>numeric</strong>/<strong>double</strong>, NOT <strong>factor</strong>. Make sure you check that the column is numeric. If its not, convert the column of the dataframe into <strong>double</strong> beforehand. ex. <code>df$Time &lt;- as.numeric(df$Time)</code> or <code>df$SpatialFreq &lt;- as.numeric(df$Time)</code>.</li>
<li><code>values</code> = this argument requires the name of the column of the data frame that contains the actual data, which are the y-axis points from which the AUC can be calculated. In our case, it is the change in contrast balance ratio. It must strings, ex. <code>'Cbratio'</code>, not <code>Cbratio</code>.</li>
</ul>
<p>Before using <code>sm_auc_all()</code>, you will need to check for a few things. First, check if the x column is numeric, not factor, by using <code>is.numeric()</code> function. If it is numeric, proceed with using <code>sm_auc_all()</code>. Second, see if the x levels (ex. 0, 3, 6, 12, 24 and 48 etc) are identical for each subject and condition (ex. no 7, 16, 29 minutes for subject 10).</p>
<p><strong>Note</strong>: If you have a column for <code>condition</code> (as an example) but you only have one identifier for condition (and hence one condition total), you will still need to include it as <code>sm_auc_all(..., conditions='condition')</code>. If you do not want to include the <code>condition</code> column in <code>sm_auc_all()</code>, then you should remove the column from the data frame altogether. This also applies to <code>sm_slope_all()</code>.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the x column is numeric</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(df<span class="sc">$</span>Time) </span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the x column is factor</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df<span class="sc">$</span>Time)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if it is factor and not numeric:</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>Time)</span></code></pre></div>
<p>After checking, we can store the results from <code>sm_auc_all()</code> into a new variable. I will call the new variable <code>auc_df</code>.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="ot">&lt;-</span> <span class="fu">sm_auc_all</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<p>Now we can plot the AUCs using <code>sm_bar()</code>, <code>sm_boxplot</code> etc. Let’s have a try.</p>
<p>Here is a bar graph showing <code>auc_df</code>’s data. This figure is similar to Figure 3E in the original paper (Min, Baldwin and Hess, 2019).</p>
<ul>
<li>re: means relative to X. The data are the differences compared to the baseline (re: Baseline).</li>
</ul>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;\u0394 AUC re: Each day</span><span class="sc">\&#39;</span><span class="st">s baseline&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-301-1.png" width="336" /></p>
<p>Here is a box plot showing <code>auc_df</code>’s data.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.2</span>)) <span class="sc">+</span> </span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;\u0394 AUC re: Each day</span><span class="sc">\&#39;</span><span class="st">s baseline&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-302-1.png" width="336" /></p>
</div>
<div id="reproducing-figures-in-the-paper-min-et-al.-2019" class="section level2 hasAnchor" number="8.3">
<h2 class="hasAnchor"><span class="header-section-number">8.3</span> Reproducing figures in the paper (Min et al., 2019)<a href="#reproducing-figures-in-the-paper-min-et-al.-2019" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s redraw some of the figures in the paper. In 2019, when the paper was published, there was no smplot. However, the themes I developed during then have become part of smplot. So, I have incorporated functions from smplot to reproduce the figures here.</p>
<div id="figure-3b-a-best-fit-line-with-points-and-error-bars" class="section level3 hasAnchor" number="8.3.1">
<h3 class="hasAnchor"><span class="header-section-number">8.3.1</span> Figure 3B (a best-fit line with points and error bars)<a href="#figure-3b-a-best-fit-line-with-points-and-error-bars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="co"># filter data from Days 2-4. | means OR.</span></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="dv">3</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(Cbratio), <span class="at">se =</span> <span class="fu">sm_stdErr</span>(Cbratio)) </span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and standard error computed for each day and time, both of which have been grouped.</span></span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df1<span class="sc">$</span>Time)</span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df1<span class="sc">$</span>Day) <span class="co"># Day has to be factored here because they will be labelled as different colors. Factor means categorical variables. </span></span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#55A868&quot;</span>, <span class="st">&quot;#C44E52&quot;</span>, <span class="st">&quot;#8172B2&quot;</span>)</span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-12"><a href="#cb348-12" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> avg, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb348-13"><a href="#cb348-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb348-14"><a href="#cb348-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avg <span class="sc">-</span> se, <span class="at">ymax =</span> avg <span class="sc">+</span> se), <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb348-15"><a href="#cb348-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb348-16"><a href="#cb348-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb348-17"><a href="#cb348-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb348-18"><a href="#cb348-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb348-19"><a href="#cb348-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb348-20"><a href="#cb348-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors,</span>
<span id="cb348-21"><a href="#cb348-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Day 2&quot;</span>, <span class="st">&quot;Day 3&quot;</span>, <span class="st">&quot;Day 4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb348-22"><a href="#cb348-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Recovery of the patching effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-23"><a href="#cb348-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time after monocular deprivation (min)&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-24"><a href="#cb348-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-25"><a href="#cb348-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb348-26"><a href="#cb348-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.67</span>), </span>
<span id="cb348-27"><a href="#cb348-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-303-1.png" width="350.4" /></p>
</div>
<div id="figure-3d-a-bar-graph" class="section level3 hasAnchor" number="8.3.2">
<h3 class="hasAnchor"><span class="header-section-number">8.3.2</span> Figure 3D (a bar graph)<a href="#figure-3d-a-bar-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This a bar graph that has been plotted with <code>sm_bar()</code>. The y-axis has been set with the function <code>coord_cartesian()</code>.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/baseline.csv&#39;</span>) </span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#4C72B0&quot;</span>, <span class="st">&quot;#55A868&quot;</span>, <span class="st">&quot;#C44E52&quot;</span>,</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;#8172B2&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>)</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>baseline<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(baseline<span class="sc">$</span>Day)</span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a>baseline <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y=</span> Baseline, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">points =</span> <span class="cn">FALSE</span>,</span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">0.4</span>),</span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>()) <span class="sc">+</span> <span class="co"># remove defaults of bar.params</span></span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span> </span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Baseline across days&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-14"><a href="#cb349-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))  <span class="sc">+</span></span>
<span id="cb349-15"><a href="#cb349-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-16"><a href="#cb349-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Patching day&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-304-1.png" width="336" /></p>
</div>
<div id="figure-3e-modeling-in-matlab-and-plotting-in-r" class="section level3 hasAnchor" number="8.3.3">
<h3 class="hasAnchor"><span class="header-section-number">8.3.3</span> Figure 3E (modeling in Matlab and plotting in R)<a href="#figure-3e-modeling-in-matlab-and-plotting-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The grey shades have actually been approximated using Matlab. The results have been saved in the .csv file <code>fit_error_shade.csv</code>. They are then imported into R, where the final figure is plotted.</p>
<p>Notice that two data frames are used to create this plot, <code>df_shade1</code> and <code>auc_df1</code>. The former contains the values from the modeling in Matlab, the latter contains AUC values.</p>
<p>So do not worry if your field does not use R for data analysis. One can still perform data visualization using R.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>df_shade <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/fit_error_shade.csv&#39;</span>)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>df_shade1 <span class="ot">&lt;-</span> df_shade <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">yUpp =</span> y_mean <span class="sc">+</span> y_se, <span class="at">yLow =</span> y_mean <span class="sc">-</span> y_se)</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>auc_df <span class="ot">&lt;-</span> <span class="fu">sm_auc_all</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>auc_df1 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span> </span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y_mean =</span> <span class="fu">mean</span>(AUC_Cbratio), <span class="at">std_err =</span> <span class="fu">sm_stdErr</span>(AUC_Cbratio))</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>auc_df1<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(auc_df1<span class="sc">$</span>Day)</span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#4C72B0&quot;</span>, <span class="st">&quot;#55A868&quot;</span>, <span class="st">&quot;#C44E52&quot;</span>,</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;#8172B2&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>)</span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a>df_shade1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y_mean)) <span class="sc">+</span> </span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> yLow, <span class="at">ymax =</span> yUpp), <span class="at">alpha =</span> .<span class="dv">08</span>) <span class="sc">+</span></span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="at">data =</span> auc_df1, <span class="fu">aes</span>(Day, <span class="at">ymin =</span> y_mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> y_mean <span class="sc">+</span> std_err), <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb352-12"><a href="#cb352-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> auc_df1, <span class="fu">aes</span>(Day, y_mean, <span class="at">color =</span> <span class="fu">as.factor</span>(Day), <span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb352-13"><a href="#cb352-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb352-14"><a href="#cb352-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb352-15"><a href="#cb352-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb352-16"><a href="#cb352-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb352-17"><a href="#cb352-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Area Under Curve (dB min)&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-18"><a href="#cb352-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Patching Day&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb352-19"><a href="#cb352-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;\u0394 AUC re: Each Day&#39;s Baseline&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-20"><a href="#cb352-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;y = -5.8(Day) + 67.8&quot;</span>, <span class="at">x =</span> <span class="fl">2.0</span>, <span class="at">y=</span>  <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb352-21"><a href="#cb352-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">82</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-22"><a href="#cb352-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-23"><a href="#cb352-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">68</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-24"><a href="#cb352-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">65</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-25"><a href="#cb352-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">60</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-305-1.png" width="336" /></p>
<!--chapter:end:AreaUC.Rmd-->
</div>
</div>
</div>
<div id="calculating-linear-slopes" class="section level1 hasAnchor" number="9">
<h1 class="hasAnchor"><span class="header-section-number">9</span> Calculating Linear Slopes<a href="#calculating-linear-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we will use a fake data set that I have generated by eyeballing Figure 3 from this paper (<a href="https://www.smin95.com/pubs/mao2020.pdf">PDF</a>):</p>
<p><strong>Yu Mao, Seung Hyun Min, Shijia Chen, Ling Gong, Hao Chen, Robert F. Hess, Jiawei Zhou. Binocular imbalance in amblyopia depends on spatial frequency in binocular combination. IOVS. 2020;61(8):7.</strong></p>
<p>This data set contains both subject groups (<code>Normal</code> and <code>Amblyopia</code>) and conditions (<code>Condition</code>).</p>
<p>Let’s begin by loading the <code>tidyverse</code> and other libraries, and uploading the csv file <code>amblyopia_random.csv</code> using <code>read_csv()</code> from the <code>tidyverse</code> package.</p>
<p>It is always a good habit to make sure that the data set you intended to load uploads properly by using <code>head()</code>, which returns the first 6 rows of the data frame.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>) </span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   Subject  absBP    SF Group     Condition
##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    
## 1 A1      0.0747   0.5 Amblyopia One      
## 2 A1      0.678    1   Amblyopia One      
## 3 A1      0.868    2   Amblyopia One      
## 4 A1      1.45     4   Amblyopia One      
## 5 A1      0.868    8   Amblyopia One      
## 6 A10     0.139    0.5 Amblyopia One</code></pre>
<p>In this dataset, there are five columns.</p>
<ul>
<li>First, <code>Subject</code> column has all the subjects. People with amblyopia (a visual disorder) are labelled with <code>A</code>. First subject with amblyopia is written as <code>A1</code>. Normal subject is written with <code>N</code>; first normal subject is <code>N1</code>. We see that there are 10 subjects per group, so there are 20 subjects total.</li>
</ul>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Subject)</span></code></pre></div>
<pre><code>##  [1] &quot;A1&quot;  &quot;A10&quot; &quot;A2&quot;  &quot;A3&quot;  &quot;A4&quot;  &quot;A5&quot;  &quot;A6&quot;  &quot;A7&quot;  &quot;A8&quot;  &quot;A9&quot;  &quot;N1&quot;  &quot;N10&quot; &quot;N2&quot;  &quot;N3&quot; 
## [15] &quot;N4&quot;  &quot;N5&quot;  &quot;N6&quot;  &quot;N7&quot;  &quot;N8&quot;  &quot;N9&quot;</code></pre>
<ul>
<li><p>Second, <code>absBP</code> is the data of our interest.</p></li>
<li><p>Third, <code>SF</code> refers to spatial frequency. We will be calculating slopes of <code>absBP</code> as a function of <code>SF</code>. So these are our x-coordinates for slope calculations (see sections below). Each unit increases by a factor of 2, so it is also helpful to convert the values into log2 units.</p></li>
</ul>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>SF))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">logSF =</span> <span class="fu">log2</span>(SF))</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   Subject  absBP    SF Group     Condition logSF
##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
## 1 A1      0.0747   0.5 Amblyopia One          -1
## 2 A1      0.678    1   Amblyopia One           0
## 3 A1      0.868    2   Amblyopia One           1
## 4 A1      1.45     4   Amblyopia One           2
## 5 A1      0.868    8   Amblyopia One           3
## 6 A10     0.139    0.5 Amblyopia One          -1</code></pre>
<ul>
<li>Fourth, <code>Group</code> refers to as the subject gruop. There are two groups: <code>Amblyopia</code> and <code>Normal</code>.</li>
</ul>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] &quot;Amblyopia&quot; &quot;Normal&quot;</code></pre>
<ul>
<li>Lastly, <code>Condition</code> refers to the testing condition. In this dataset, there are two conditions.</li>
</ul>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Condition)</span></code></pre></div>
<pre><code>## [1] &quot;One&quot; &quot;Two&quot;</code></pre>
<p>The columns <code>Group</code> and <code>Condition</code> are categorical variable and must therefore be factors. <code>head(df)</code> shows that <code>Group</code> and <code>Condition</code> are <code>&lt;chr&gt;</code>, which mean characters. Lets change them to factors <code>&lt;fct&gt;</code>.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Group)</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Condition)</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   Subject  absBP    SF Group     Condition logSF
##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;
## 1 A1      0.0747   0.5 Amblyopia One          -1
## 2 A1      0.678    1   Amblyopia One           0
## 3 A1      0.868    2   Amblyopia One           1
## 4 A1      1.45     4   Amblyopia One           2
## 5 A1      0.868    8   Amblyopia One           3
## 6 A10     0.139    0.5 Amblyopia One          -1</code></pre>
<p>We see that <code>Group</code> and <code>Condition</code> columns are now factor <code>&lt;fct&gt;</code>.</p>
<div id="linear-relationship-using-lm" class="section level2 hasAnchor" number="9.1">
<h2 class="hasAnchor"><span class="header-section-number">9.1</span> Linear relationship using <code>lm()</code><a href="#linear-relationship-using-lm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Linear relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> can be described as <span class="math inline">\(y = mx + b\)</span>, where y is the dependent variable, x is the independent variable, m is the slope, and b is the y-intercept.</p>
<p>Let’s try calculate <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> using the data of <code>A3</code>, which is the 3rd amblyopic observer.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">==</span> <span class="st">&#39;A3&#39;</span>)</span></code></pre></div>
<p>There are two conditions here. Let’s filter for data from the second condition only (<code>Condition == Two</code>).</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>A3_second <span class="ot">&lt;-</span> A3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;Two&#39;</span>)</span></code></pre></div>
<p>Now, we will use the function <code>lm()</code> to compute <span class="math inline">\(m\)</span> (slope) and <span class="math inline">\(b\)</span> (y-intercept).</p>
<p>In R, the relationship between <span class="math inline">\(y\)</span> (dependent variable) and <span class="math inline">\(x\)</span> (independent variable) is written as <code>y~x</code> using tilde (<code>~</code>). In other words, instead of directly writing <span class="math inline">\(y = mx + b\)</span> in R, we use <code>~</code> to describe the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>. Let’s write the relationship between <code>absBP</code> (dependent variable) and <code>logSF</code> (independent variable) within the function <code>lm()</code>.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(df<span class="sc">$</span>absBP <span class="sc">~</span> df<span class="sc">$</span>logSF)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = df$absBP ~ df$logSF)
## 
## Coefficients:
## (Intercept)     df$logSF  
##      0.3205       0.1249</code></pre>
<p>This yields two main outputs. Let’s store this result using a new variable <code>res</code>, which is short for <strong>results</strong>.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(A3_second<span class="sc">$</span>absBP <span class="sc">~</span> A3_second<span class="sc">$</span>logSF)</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = A3_second$absBP ~ A3_second$logSF)
## 
## Residuals:
##       1       2       3       4       5 
##  0.1930 -0.1310 -0.1270 -0.1251  0.1900 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)      0.30461    0.11058   2.755  0.07046 . 
## A3_second$logSF  0.45815    0.06384   7.176  0.00557 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2019 on 3 degrees of freedom
## Multiple R-squared:  0.945,  Adjusted R-squared:  0.9266 
## F-statistic:  51.5 on 1 and 3 DF,  p-value: 0.005574</code></pre>
<p><code>summary()</code> is a function that prints all the outputs from a given model object. Here, the model object is <code>res</code>, which has been created using the <code>lm()</code> function. When using <code>lm()</code>, it is advisable to always store the results and print the results using <code>summary()</code>. For more information about <code>summary()</code>, please check out <code>?summary</code>.</p>
<p>We see that the y-intercept <span class="math inline">\(b\)</span> is 0.3046 under the column <code>Estimate</code>. We also see that the slope <span class="math inline">\(m\)</span> is 0.4582 under the column <code>Estimate</code>. You can ignore all the other values for now.</p>
<p>Let’s visualize the data of A3 and fit a linear slope.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>A3_second <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> logSF, <span class="at">y =</span> absBP)) <span class="sc">+</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fl">0.4582</span>, <span class="at">intercept =</span> <span class="fl">0.3046</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-316-1.png" width="336" /></p>
<p>Instead of writing the slope and intercept manually, we can subset these values using <code>$</code>.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##     (Intercept) A3_second$logSF 
##       0.3046126       0.4581507</code></pre>
<p>The first value is the intercept. Therefore use <code>[[1]]</code> to subset the intercept.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 0.3046126</code></pre>
<p>You can also subset the slope using <code>[[2]]</code>.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## [1] 0.4581507</code></pre>
<p>Now let’s plot the graph again and label the y-intercept as well.
A separate data frame <code>y_int</code> containing the y-intercept is created below. The code below is a bit challenging, so please use <code>?</code> to figure out each function if you are not sure.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>y_int <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">logSF =</span> <span class="dv">0</span>, <span class="at">absBP =</span> res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>A3_second <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> logSF, <span class="at">y =</span> absBP)) <span class="sc">+</span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]], </span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]]) <span class="sc">+</span></span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> y_int, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span></span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&#39;Slope =&#39;</span>,<span class="fu">round</span>(res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]],<span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&#39;Intercept =&#39;</span>, <span class="fu">round</span>(res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]],<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-320-1.png" width="336" /></p>
<p>In summary, you can compute the slope of a linear function between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> and using <code>lm()</code>, where you use <code>~</code> to describe the relationship. You also need to use <code>$</code> to subset the slopes directly.</p>
</div>
<div id="calculating-slopes-of-all-subjects-groups-and-conditions" class="section level2 hasAnchor" number="9.2">
<h2 class="hasAnchor"><span class="header-section-number">9.2</span> Calculating slopes of all subjects, groups and conditions<a href="#calculating-slopes-of-all-subjects-groups-and-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we know how to compute slope for each subject, let’s calculate slopes of our entire dataset.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 200 x 6
##    Subject  absBP    SF Group     Condition logSF
##    &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;
##  1 A1      0.0747   0.5 Amblyopia One          -1
##  2 A1      0.678    1   Amblyopia One           0
##  3 A1      0.868    2   Amblyopia One           1
##  4 A1      1.45     4   Amblyopia One           2
##  5 A1      0.868    8   Amblyopia One           3
##  6 A10     0.139    0.5 Amblyopia One          -1
##  7 A10     0.448    1   Amblyopia One           0
##  8 A10     0.667    2   Amblyopia One           1
##  9 A10     1.12     4   Amblyopia One           2
## 10 A10     1.70     8   Amblyopia One           3
## # ... with 190 more rows</code></pre>
<p>We see that there are 20 subjects total, each of which has completed two conditions. So there are 40 slopes to calculate! Does that mean we need to use <code>lm()</code> 40 times?</p>
<p>The answer is <strong>no</strong>. <strong>smplot</strong> has a function <code>sm_slope_all()</code> that returns a dataframe of slopes from <strong>linear regression</strong>. It works similarly to <code>sm_auc_all()</code>.</p>
<ul>
<li><code>data</code> = this argument requires the variable that stores the data frame. In our case, it is <code>df</code>.</li>
<li><code>subjects</code> = this argument requires the name of the column of the data frame that contains subjects. It must strings, ex. <code>'Subject'</code>, not <code>Subject</code>.</li>
<li><code>groups</code> = this argument requires the name of the column of the data frame that contains each group. In this example, there is no group. An example would be <code>Group</code> column that contains two groups: <code>Normal</code> and <code>Amblyopia</code>.</li>
<li><code>conditions</code> = this argument requires name of the column of the data frame that contains each condition. In our example, the two conditions are <code>One</code> and <code>Two</code>.</li>
<li><code>x</code> = this argument requires the name of the column of the data frame that contains the x-axis points from which the AUC can be calculated. In our case, these are values from the <code>logSF</code> column of <code>df</code>. It must be strings, ex. <code>'logSF'</code>, not <code>logSF</code>. Also, it must be <strong>numeric</strong>/<strong>double</strong>, NOT <strong>factor</strong>. Make sure you check that the column is numeric. If its not, convert the column of the dataframe into <strong>double</strong> beforehand. ex. <code>df$logSF &lt;- as.numeric(df$logSF)</code> or <code>df$SpatialFreq &lt;- as.numeric(df$SpatialFreq)</code>.</li>
<li><code>values</code> = this argument requires the name of the column of the data frame that contains the actual data, which are the y-axis points from which the AUC can be calculated. In our case, it is the change in contrast balance ratio. It must strings, ex. <code>'absBP'</code>, not <code>absBP</code>.</li>
</ul>
<p>Before using <code>sm_slope_all()</code>, you will need to check for a few things. First, check if the x column is numeric, not factor, by using <code>is.numeric()</code> function. If it is numeric, proceed with using <code>sm_slope_all()</code>. Second, see if the x levels (ex. 0, 3, 6, 12, 24 and 48 etc) are identical for each subject and condition (ex. no 7, 16, 29 minutes for subject 10).</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the x column is numeric</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(df<span class="sc">$</span>logSF) </span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the x column is factor</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df<span class="sc">$</span>logSF)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if it is factor and not numeric:</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>logSF <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>logSF)</span></code></pre></div>
<p>After checking, we can store the results from <code>sm_slope_all()</code> into a new variable. I will call the new variable <code>slope_df</code>.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>slope_df <span class="ot">&lt;-</span> <span class="fu">sm_slope_all</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Condition&#39;</span>,</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">groups =</span> <span class="st">&#39;Group&#39;</span>,</span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;logSF&#39;</span>, <span class="at">values =</span> <span class="st">&#39;absBP&#39;</span>, </span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;Slope =  absBP  ~  logSF&quot;</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>slope_df</span></code></pre></div>
<pre><code>##    Subject Condition     Group        Slope
## 2       A1       One Amblyopia  0.235667223
## 3       A1       Two Amblyopia  0.282800668
## 6      A10       One Amblyopia  0.380319905
## 7      A10       Two Amblyopia  0.456383886
## 10      A2       One Amblyopia  0.136716992
## 11      A2       Two Amblyopia  0.164060391
## 14      A3       One Amblyopia  0.381792237
## 15      A3       Two Amblyopia  0.458150685
## 18      A4       One Amblyopia  0.226928105
## 19      A4       Two Amblyopia  0.272313727
## 22      A5       One Amblyopia -0.015766219
## 23      A5       Two Amblyopia -0.018919463
## 26      A6       One Amblyopia  0.097918149
## 27      A6       Two Amblyopia  0.117501779
## 30      A7       One Amblyopia  0.217554761
## 31      A7       Two Amblyopia  0.261065713
## 34      A8       One Amblyopia  0.266574138
## 35      A8       Two Amblyopia  0.319888965
## 38      A9       One Amblyopia  0.198964218
## 39      A9       Two Amblyopia  0.238757061
## 43      N1       One    Normal  0.080372285
## 44      N1       Two    Normal  0.096446741
## 47     N10       One    Normal -0.038881222
## 48     N10       Two    Normal -0.046657466
## 51      N2       One    Normal  0.071885539
## 52      N2       Two    Normal  0.086262647
## 55      N3       One    Normal  0.018219466
## 56      N3       Two    Normal  0.021863359
## 59      N4       One    Normal  0.004361030
## 60      N4       Two    Normal  0.005233235
## 63      N5       One    Normal  0.043098286
## 64      N5       Two    Normal  0.051717943
## 67      N6       One    Normal -0.066678839
## 68      N6       Two    Normal -0.080014607
## 71      N7       One    Normal  0.082798046
## 72      N7       Two    Normal  0.099357656
## 75      N8       One    Normal -0.049344920
## 76      N8       Two    Normal -0.059213905
## 79      N9       One    Normal -0.001135896
## 80      N9       Two    Normal -0.001363075</code></pre>
<p>We see that the slope of A3 in <code>Two</code> condition is identical to the one we have obtained from the <code>lm()</code> function.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]] </span></code></pre></div>
<pre><code>## [1] 0.4581507</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>slope_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">==</span> <span class="st">&#39;A3&#39;</span> <span class="sc">&amp;</span> Condition <span class="sc">==</span> <span class="st">&#39;Two&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Slope)</span></code></pre></div>
<pre><code>##       Slope
## 1 0.4581507</code></pre>
<p>Now we can plot all the slopes from <code>One</code> condition using <code>sm_bar()</code>, <code>sm_boxplot</code> etc. Let’s have a try.</p>
<p>The factor level of <code>slope_df_one$Group</code> is changed below so that bar plot of normal observer is plotted first, then amblyopia (rather than amblyopia -&gt; normals as per alphabetical order).</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>slope_df_one <span class="ot">&lt;-</span> slope_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>)</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>slope_df_one<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(slope_df_one<span class="sc">$</span>Group, </span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Amblyopia&#39;</span>))</span></code></pre></div>
<p>Here is a boxplot showing <code>slope_df_one</code>’s data.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>slope_df_one <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Slope, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.2</span>, </span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha =</span> <span class="fl">0.6</span>)) <span class="sc">+</span> </span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Binocular imbalance&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-327-1.png" width="336" /></p>
<p>Here is a bar graph showing <code>slope_df</code>’s data for <code>One</code> condition only. This figure is similar to Figure 3B in the paper (Mao et al., 2020).</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>slope_df_one <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Slope, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Binocular imbalance&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-328-1.png" width="336" /></p>
<!--chapter:end:Slope.Rmd-->
</div>
</div>
<div id="basic-statistics" class="section level1 hasAnchor" number="10">
<h1 class="hasAnchor"><span class="header-section-number">10</span> Basic Statistics<a href="#basic-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As in the previous two chapters, we will continue to use data from this paper (<a href="https://www.smin95.com/pubs/min2019.pdf">PDF</a>):</p>
<p><strong>Seung Hyun Min, Alex S. Baldwin and Robert F. Hess. Ocular dominance plasticity: A binocular combination task finds no cumulative effect with repeated patching (2019). Vision Research, 161, 36-42.</strong></p>
<p>Load the <code>tidyverse</code> and other libraries, and the csv file <code>min2019b.csv</code> using <code>read_csv()</code> from the <code>tidyverse</code> package.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject   Day  Time Cbratio
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 a           1     0  -0.421
## 2 b           1     0   2.82 
## 3 c           1     0   1.69 
## 4 d           1     0   2.55 
## 5 e           1     0  -0.217
## 6 f           1     0   0.626</code></pre>
<div id="one-sample-t-test" class="section level2 hasAnchor" number="10.1">
<h2 class="hasAnchor"><span class="header-section-number">10.1</span> One-sample t-test<a href="#one-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One sample t-test compares the mean of a sample to a hypothesized mean (often 0).</p>
<p>For example, here is Figure 3E from the paper. What do the *** mean? How about ** and *? Let’s take a look.</p>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-330-1.png" width="336" /></p>
<p>For instance, to determine if the area under curve (changes in contrast balance ratio over time) after patching is significant, so much so that one can confidently say that it is different from 0, we can perform a one-sample t-test using <code>t.test()</code>.</p>
<p>Let’s use data from the same paper. We import the data from online using <code>read_csv()</code> and store them into a variable (in this case, <code>df</code>). Then, we compute the area under a curve using <code>sm_auc_list()</code> and store the values in the variable <code>auc_df</code>.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>auc_df <span class="ot">&lt;-</span> <span class="fu">sm_auc_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(auc_df)</span></code></pre></div>
<pre><code>##   Subject Day AUC_Cbratio
## 1       a   1    -2.36910
## 2       a   2     0.68265
## 3       a   3    -9.54795
## 4       a   4    27.12165
## 5       a   5    41.95680
## 6       b   1    60.52860</code></pre>
<p>The <code>Day</code> column of <code>df</code> has to be factored using <code>as.factor()</code> because <code>Day</code> here is a categorical, rather than, continuous variable.</p>
<p>To determine if the area under curve data on Day 1 were significantly different from 0, we could use one-sample t-test. First, let’s filter for data from only Day 1.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>auc_df_day1 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>auc_df_day1</span></code></pre></div>
<pre><code>##    Subject Day AUC_Cbratio
## 1        a   1    -2.36910
## 2        b   1    60.52860
## 3        c   1    94.84035
## 4        d   1   100.62510
## 5        e   1    55.32240
## 6        f   1   108.13770
## 7        g   1    63.27840
## 8        h   1    48.71625
## 9        u   1    39.11865
## 10       j   1    74.90610</code></pre>
<p>Then, lets extract the values from the <code>AUC_Cbratio</code> column and perform one-sample t-test using <code>t.test()</code>.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  auc_df_day1$AUC_Cbratio
## t = 6.1934, df = 9, p-value = 0.0001601
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  40.82072 87.80017
## sample estimates:
## mean of x 
##  64.31045</code></pre>
<p><code>mu = 0</code> is included as an argument when performing one-sample <code>t.test</code>; this means an average of 0. In this case, you are comparing the data from <code>auc_df_day1$AUC_Cbratio</code> to <code>mu = 0</code>.</p>
<p>The p-value must be less than <strong>0.05</strong> to be considered statistically significant. It is labelled with one asterisk *. 0.001 &lt; p &lt; 0.01 is denoted with two asterisks **, and p &lt; 0.001 is denoted with three asterisks ***. Since the p-value reported here is less than 0.001, Figure 3E has *** for Day 1’s area under a curve.</p>
<p>We can repeat this for Days 2-5. For brevity, we repeat the example with Days 2 and 4 only.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>auc_df_day2 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day2<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  auc_df_day2$AUC_Cbratio
## t = 3.5182, df = 9, p-value = 0.006534
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  19.60882 90.24161
## sample estimates:
## mean of x 
##  54.92521</code></pre>
<p>The p value is 0.0065, which is less than 0.01 but larger than 0.001. In this case, the statistical significance is denoted as **. Likewise, Figure 3E shows the AUC of Day 2 with **.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>auc_df_day4 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day4<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  auc_df_day4$AUC_Cbratio
## t = 3.0973, df = 9, p-value = 0.01278
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  11.71639 75.19169
## sample estimates:
## mean of x 
##  43.45404</code></pre>
<p>The p-value is 0.013, which is less than 0.05 but larger than 0.01. Therefore one asterisk * is used to label the statistical significance.</p>
</div>
<div id="two-sample-t-test" class="section level2 hasAnchor" number="10.2">
<h2 class="hasAnchor"><span class="header-section-number">10.2</span> Two-sample t-test<a href="#two-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A two-sample t-test is used to compare the mean of one sample to that of another sample.</p>
<p>For example, let’s compare changes in sensory eye dominance after short-term monocular deprivation in Day 1 vs Day 5. These values are shown in the <code>Cbratio</code> column.</p>
<p>Let’s filter only for AUC data from Days 1 and 5.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>auc_df_day1 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>auc_df_day5 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>auc_df_day15 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="dv">5</span>)</span></code></pre></div>
<p>Now, let’s plot a bar graph to display the AUC from Days 1 and 5 using <code>sm_bar()</code>.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> auc_df_day15, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;AUC in Days 1 and 5&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-337-1.png" width="355.2" /></p>
<p>There seems to be a difference in the AUC <code>AUC_Cbratio</code> between Days 1 and 5. The error bars (in this case, standard error) are barely overlapping. If the error bars are clearly overlapping, there is often no significant difference (p &lt; 0.05) between the two data sets. If there is no overlap, it is highly likely that a statistical test will show a significant difference (p &lt; 0.05). Let’s take a look using <strong>t-test</strong> using the function <code>t.test()</code>.</p>
<p><code>t.test()</code> allows us to compare whether data between two different groups are significantly different. Here, <code>$</code> is used to <strong>extract</strong> data from a specific column within a data frame. You could type <code>df_0min$</code>, press the <strong>Tab</strong> button from the keyboard, and see what happens. Since we will only compare values in the <code>AUC_Cbratio</code> column, let’s select for the <code>AUC_Cbratio</code> column and use these values in our <code>t.test()</code>.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day5<span class="sc">$</span>AUC_Cbratio, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  auc_df_day1$AUC_Cbratio and auc_df_day5$AUC_Cbratio
## t = 1.5694, df = 9, p-value = 0.151
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -10.17563  56.27723
## sample estimates:
## mean of the differences 
##                 23.0508</code></pre>
<p>In this case, the subjects are <strong>paired</strong> because the 10 subjects performed on both Days 1 and 5. If your data are not paired (ex. patients vs controls) and you want to perform a t-test, you can set <code>paired = FALSE</code>.</p>
<p>If we are reporting the results, we should report it as such, t(9) = 1.57, p = 0.15. The difference between Days 1 and 5 is not statistically significant.</p>
<div id="shapiro-wilk-test-to-test-for-normality-of-data" class="section level3 hasAnchor" number="10.2.1">
<h3 class="hasAnchor"><span class="header-section-number">10.2.1</span> Shapiro-Wilk Test to test for Normality of Data<a href="#shapiro-wilk-test-to-test-for-normality-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>T-test can only be used when the data assume normality. In other word, the data that are to be analyzed using <code>t.test()</code> must have a normal distribution (shown below).</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-339-1.png" width="355.2" /></p>
<p>Whether the data have a normal distribution can be checked using a Shapiro-Wilk test (<code>shapiro.test()</code>). If p &gt; 0.05, then the data have a normal distribution, and therefore, t-test can be used to analyze the data. If p &lt; 0.05, the data are not normally distributed, and t-test cannot be used.</p>
<p>For example, let’s check whether the AUC data from Day 1 have a normal distribution.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  auc_df_day1$AUC_Cbratio
## W = 0.95039, p-value = 0.6732</code></pre>
<p>P value is 0.67, which is larger than 0.05. Therefore, the AUCs from Day 1 have a normal distribution.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(auc_df_day5<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  auc_df_day5$AUC_Cbratio
## W = 0.97531, p-value = 0.9353</code></pre>
<p>P value is 0.935, which is larger than 0.05. Therefore, the AUCs from Day 5 have a normal distribution. More information about <code>shapiro.test()</code> can be found in this link: <a href="http://www.sthda.com/english/wiki/normality-test-in-r" class="uri">http://www.sthda.com/english/wiki/normality-test-in-r</a>.</p>
<p>T-test is a type of <strong>parametric</strong> statistical test, which is used to analyze data that are normally distributed. If the data are not normally distributed, <strong>non-parametric</strong> statistical test can be used.</p>
</div>
</div>
<div id="wilcoxon-signed-rank-test" class="section level2 hasAnchor" number="10.3">
<h2 class="hasAnchor"><span class="header-section-number">10.3</span> Wilcoxon Signed-rank Test<a href="#wilcoxon-signed-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Wilcoxon Signed-rank Test is a <strong>non-parametric</strong> statistical test that is used instead of a t-test when the data are <strong>not normally distributed</strong>.</p>
<p>If Shapiro-Wilk test yields p &lt; 0.05 for the following datasets, a Wilcoxon Signed Rank Test must be used for both one-sample and two-sample tests.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sample Wilcoxon Signed-rank Test</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  auc_df_day1$AUC_Cbratio
## V = 54, p-value = 0.003906
## alternative hypothesis: true location is not equal to 0</code></pre>
<p>The p-value is 0.0039, which is less than 0.05. Therefore, according to the Wilcoxon test, the AUCs from Day 1 are significantly different from 0.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two-sample Wilcoxon test</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day5<span class="sc">$</span>AUC_Cbratio, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  auc_df_day1$AUC_Cbratio and auc_df_day5$AUC_Cbratio
## V = 43, p-value = 0.1309
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>The p-value is 0.13, which is larger than 0.05. Therefore, according to the Wilcoxon test, the AUCs from Days 1 and 5 are not significantly different.</p>
</div>
<div id="effect-size" class="section level2 hasAnchor" number="10.4">
<h2 class="hasAnchor"><span class="header-section-number">10.4</span> Effect Size<a href="#effect-size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>However, even if p-value is larger than 0.05, this does not mean that there is no significant difference between the two groups/conditions. In fact, even a strong drug effect in a study that compares placebo vs. drug can result in p &gt; 0.05 if the sample size is too small.</p>
<p>On the other hand, if a study is conducted with a very large sample size (1000 patients per group) to examine the effect of a very weak drug, the data between weak drug and control can give us a p &lt; 0.05, which indicates a statistically significant difference.</p>
<p>In short, <strong>p-value is not everything because it depends on the sample size.</strong></p>
<p>If the sample size is small, p-value can be larger than 0.05. But as the sample gets larger, p-value will decrease even if the mean difference between the two groups remains the same.</p>
<p>In this example, the sample size is not large (n=10). Therefore, one might ask whether our conclusion that there is no significant difference between Days 1 and 5 is truly valid. One might also believe that if our sample size was larger (ex. n=50), we would have found a significant difference between Days 1 and 5.</p>
<p>To respond to this concern, we might need to calculate the <strong>effect size</strong>. If the effect size is large, there is a large difference between the sample groups. <strong>Unlike the p-value, the effect size does not depend on the sample size.</strong></p>
<p>One measure to capture the effect size is <strong>Cohen’s d</strong>. We can use <code>sm_effsize()</code> to calculate Cohen’s d as a measure for the effect size.</p>
<ul>
<li><strong>Small</strong> effect size: Cohen’s d around <strong>0.2</strong></li>
<li><strong>Medium</strong> effect size: Cohen’s d around <strong>0.5</strong></li>
<li><strong>Large</strong> effect size: Cohen’s d &gt; <strong>0.8</strong>.</li>
</ul>
<p>The inputs for <code>sm_effsize()</code> are the data of two sample groups, just as they were in <code>t.test()</code>.</p>
<p>Let’s compute the effect size (Cohen’s d) using AUC data from Days 1 and 2.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_effsize</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day2<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## [1] 0.2238542</code></pre>
<p>Cohen’s d equals <strong>0.224</strong>, which is a very small effect size. This indicates that there is a very small difference in AUC between Days 1 and 2.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day2<span class="sc">$</span>AUC_Cbratio,</span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  auc_df_day1$AUC_Cbratio and auc_df_day2$AUC_Cbratio
## t = 0.46312, df = 9, p-value = 0.6543
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -36.45777  55.22823
## sample estimates:
## mean of the differences 
##                 9.38523</code></pre>
<p>Also, it is recommended that <strong>both p-value and effect size are reported</strong> at all times. In this example, I would report the results as: <strong>t(9) = 0.46, p = 0.65, Cohen’s d = 0.22</strong>.</p>
<p>Let’s see what happens in the effect size and p-value from t-test if there are 1000 subjects.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>auc_df_day1b <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&#39;rbind&#39;</span>, <span class="fu">replicate</span>(<span class="dv">100</span>, auc_df_day1, <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>auc_df_day1b<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(auc_df_day1b, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##    Subject Day AUC_Cbratio
## 1       S1   1    -2.36910
## 2       S2   1    60.52860
## 3       S3   1    94.84035
## 4       S4   1   100.62510
## 5       S5   1    55.32240
## 6       S6   1   108.13770
## 7       S7   1    63.27840
## 8       S8   1    48.71625
## 9       S9   1    39.11865
## 10     S10   1    74.90610
## 11     S11   1    -2.36910
## 12     S12   1    60.52860
## 13     S13   1    94.84035
## 14     S14   1   100.62510
## 15     S15   1    55.32240
## 16     S16   1   108.13770
## 17     S17   1    63.27840
## 18     S18   1    48.71625
## 19     S19   1    39.11865
## 20     S20   1    74.90610
## 21     S21   1    -2.36910
## 22     S22   1    60.52860
## 23     S23   1    94.84035
## 24     S24   1   100.62510
## 25     S25   1    55.32240
## 26     S26   1   108.13770
## 27     S27   1    63.27840
## 28     S28   1    48.71625
## 29     S29   1    39.11865
## 30     S30   1    74.90610</code></pre>
<p>We have replicated all the rows of the data frame <code>auc_df_day1</code> by 100 times to create 1000 rows total (i.e., 1000 subjects).</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>auc_df_day2b <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&#39;rbind&#39;</span>, <span class="fu">replicate</span>(<span class="dv">100</span>, auc_df_day2, <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>auc_df_day2b<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(auc_df_day2b, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##    Subject Day AUC_Cbratio
## 1       S1   2     0.68265
## 2       S2   2    80.38215
## 3       S3   2     1.78695
## 4       S4   2   -19.60125
## 5       S5   2   132.99825
## 6       S6   2    31.14285
## 7       S7   2    80.24685
## 8       S8   2    75.98130
## 9       S9   2    64.56690
## 10     S10   2   101.06550
## 11     S11   2     0.68265
## 12     S12   2    80.38215
## 13     S13   2     1.78695
## 14     S14   2   -19.60125
## 15     S15   2   132.99825
## 16     S16   2    31.14285
## 17     S17   2    80.24685
## 18     S18   2    75.98130
## 19     S19   2    64.56690
## 20     S20   2   101.06550
## 21     S21   2     0.68265
## 22     S22   2    80.38215
## 23     S23   2     1.78695
## 24     S24   2   -19.60125
## 25     S25   2   132.99825
## 26     S26   2    31.14285
## 27     S27   2    80.24685
## 28     S28   2    75.98130
## 29     S29   2    64.56690
## 30     S30   2   101.06550</code></pre>
<p>We have replicated all the rows of the data frame <code>auc_df_day2</code> by 100 times to create 1000 rows total (i.e., 1000 subjects).</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_effsize</span>(auc_df_day1b<span class="sc">$</span>AUC_Cbratio, auc_df_day2b<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## [1] 0.2358451</code></pre>
<p>The effect size is 0.24. It has barely changed despite the significantly larger sample size.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1b<span class="sc">$</span>AUC_Cbratio, auc_df_day2b<span class="sc">$</span>AUC_Cbratio,</span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> T)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  auc_df_day1b$AUC_Cbratio and auc_df_day2b$AUC_Cbratio
## t = 4.8793, df = 999, p-value = 1.239e-06
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   5.610696 13.159764
## sample estimates:
## mean of the differences 
##                 9.38523</code></pre>
<p>Now, the p-value is <strong>much less than 0.001</strong>, rather than staying at 0.65. Therefore, we can now observe that p-value is heavily affected by the sample size, whereas the effect size (Cohen’s d) does not. In short, as the sample size increases, the p-value decreases even if the effect size stays the same.</p>
</div>
<div id="post-hoc-power-analysis" class="section level2 hasAnchor" number="10.5">
<h2 class="hasAnchor"><span class="header-section-number">10.5</span> Post-hoc Power Analysis<a href="#post-hoc-power-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We got p &gt; 0.05 with our small sample size (n = 10). As we previously mentioned, we know that p-value gets smaller with an increasing sample size. <strong>Therefore, given the mean difference between two sample groups (i.e., same effect size), the p-value can change depending on the sample size</strong>. So, it is important to report both the p-value and the effect size.</p>
<p>So, one might be concerned with what would be the minimal sample size to detect a statistically significant difference between the two groups (Days 1 and 5). This can be achieved using <strong>post-hoc power analysis</strong> (post-hoc means <em>after</em> the study has been completed). A <em>prior</em> power analysis is used to estimate the sample size before one performs the study and collects data. Note that p can always be less than 0.05 as long as the sample size meets the requirement (i.e., very large).</p>
<p>If the effect size was large but the data yielded p &gt; 0.05, then we could predict that the minimal sample size from power analysis would be not large. If the effect size was small and the data yielded p &gt; 0.05, as it was for my data, the minimal sample size to yield p &lt; 0.05 would need to be very large.</p>
<p>If the minimal sample size from power analysis was not large (hence, large effect size), then one could conclude that I did not collect enough data and incorrectly concluded that there was no significant difference between the two groups. This would be so because if the sample size was larger, I would have gotten p &lt; 0.05.</p>
<p><strong>Post-hoc power analysis</strong> can be performed using <code>sm_power()</code>. The inputs for <code>sm_power()</code> are data of two sample groups, just as they were in <code>t.test()</code>.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_power</span>(auc_df_day1b<span class="sc">$</span>AUC_Cbratio, auc_df_day2b<span class="sc">$</span>AUC_Cbratio,</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 143.0411
##               d = 0.2358451
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<p>According to our power analysis (significant level = 0.05, power = 80%), we would need about <strong>143 subjects</strong> per group (<code>n = 143.0411</code>) for the p-value to reach below 0.05 and, therefore, for us to detect a statistically significant difference in AUCs between Days 1 and 2. In other words, the difference between Days 1 and 2 is very small. Also, the conclusion that there was no difference between the days seems to be valid even though the sample size is small.</p>
<p>Although using post-hoc power analysis has been under dispute, since the technique is straightforward, it has been discussed here. Power analysis is often used <em>prior</em> to a study, not <em>after</em>. A better alternative to post-hoc power analysis that has gained in popularity is to compute <em>Bayes factor</em>.</p>
<p><em>Prior power analysis</em> can be computed using the <em>pwr</em> package’s functions, such as <code>pwr.t.test</code>.</p>
</div>
<div id="bayes-factor" class="section level2 hasAnchor" number="10.6">
<h2 class="hasAnchor"><span class="header-section-number">10.6</span> Bayes Factor<a href="#bayes-factor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="issues-with-post-hoc-power-analysis" class="section level3 hasAnchor" number="10.6.1">
<h3 class="hasAnchor"><span class="header-section-number">10.6.1</span> Issues with post-hoc power analysis<a href="#issues-with-post-hoc-power-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If p-value is smaller than 0.05, we can say that there is a statistical significance between two samples. However, if p = 0.99, we cannot say that there are 99% similar. They are just <strong>not</strong> significantly different.</p>
<p>For this reason, computing the effect size and performing post-hoc power analysis can help. However, the issue with post-hoc power analysis is that it is directly related with the p-value from your data. As the p-value gets larger, the sample size that is needed to detect a statistical significance directly increases. Therefore, post-hoc power analysis might not provide any additional information because it merely depends on your data’s p-value.</p>
<p>Here is a simulation using random numbers.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="fl">0.2</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(day1, day2, <span class="at">paired =</span> T)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  day1 and day2
## t = 1.231, df = 14, p-value = 0.2386
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.2090158  0.7721466
## sample estimates:
## mean of the differences 
##               0.2815654</code></pre>
<p>The p-value is 0.24, which is large. Let’s compute the needed sample size (power = 0.8, alpha = 0.05) to reach a statistical significant difference between <code>day1</code> and <code>day5</code>.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_power</span>(day1,day2,<span class="at">paired =</span> T)</span></code></pre></div>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 72.84649
##               d = 0.3327153
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<p>In this case, we will need at least 73 individuals per group to detect a statistical significant difference at a 80% rate.</p>
<p>Now, by decreasing the p-value, we can decrease the needed sample size.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5123</span>)</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="fl">0.2</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(day1, day2, <span class="at">paired =</span> T)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  day1 and day2
## t = -1.3865, df = 14, p-value = 0.1873
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.0801390  0.2319369
## sample estimates:
## mean of the differences 
##               -0.424101</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_power</span>(day1, day2, <span class="at">paired =</span> T)</span></code></pre></div>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 27.53267
##               d = 0.5542505
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<p>Now that the p-value has decreased, the needed sample size has also decreased <em>despite</em> the fact that the difference between <code>day1</code> and <code>day2</code> has remained at 0.2. Therefore, we can see that the result of post-hoc power analysis is directly related to your sample data and does not provide much additional information.</p>
<p>Here is a series of 1000 simulations. A following iteration has a larger difference between <code>day1</code> and <code>day2</code> samples than the previous iteration.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># number of simulations</span></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span>nSim, <span class="at">ncol=</span><span class="dv">2</span>))</span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;pval&#39;</span>,<span class="st">&#39;power_sample&#39;</span>) </span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSim) {</span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true" tabindex="-1"></a>  day1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true" tabindex="-1"></a>  day2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="fl">0.2</span>, <span class="at">sd=</span><span class="dv">1</span>) <span class="sc">+</span> i<span class="sc">*</span><span class="fl">0.001</span></span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true" tabindex="-1"></a>  res[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(day1, day2, <span class="at">paired=</span>T)<span class="sc">$</span>p.value</span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true" tabindex="-1"></a>  res[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sm_power</span>(day1, day2, <span class="at">paired=</span>T)<span class="sc">$</span>n</span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb448-12"><a href="#cb448-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-13"><a href="#cb448-13" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> res[<span class="fu">which</span>(res[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">200</span>),]</span></code></pre></div>
<p>After running the simulations, I have excluded rows that included sample size from power analysis larger than 200.</p>
<p>Here is the plot showing the relationship between p-value and sample size obtained from post-hoc power analysis.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="sc">%&gt;%</span> </span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pval, <span class="at">y =</span> power_sample)) <span class="sc">+</span></span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-355-1.png" width="350.4" /></p>
<p>We see that these two are directly related. Therefore, it is enough just to report the p-value on its own without providing the sample size obtained from post-hoc power analysis.</p>
<p>Unlike p-value, Bayes factor can be used to <em>support</em> the null hypothesis. In other words, it can be used to support the finding that there is no difference between Day 1 and Day 2, rather than just saying that there is no significant difference between these two days.</p>
</div>
<div id="computing-the-bayes-factor-in-r" class="section level3 hasAnchor" number="10.6.2">
<h3 class="hasAnchor"><span class="header-section-number">10.6.2</span> Computing the Bayes factor in R<a href="#computing-the-bayes-factor-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor) <span class="co"># install.packages(&#39;BayesFactor&#39;)</span></span></code></pre></div>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(auc_df_day1b<span class="sc">$</span>AUC_Cbratio, auc_df_day2b<span class="sc">$</span>AUC_Cbratio,</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Alt., r=0.707 : 4423.327 ±0%
## 
## Against denominator:
##   Null, mu = 0 
## ---
## Bayes factor type: BFoneSample, JZS</code></pre>
<p>We have run a Bayesian t-test using the <code>BayesFactor</code> package and obtained a Bayes factor of <code>0.71</code>. Note that <code>sm_power()</code> performs a power analysis that is related to a t-test. So these two are quite similar. As a general rule, a Bayes factor less than 1 supports that there is no difference between the two samples and therefore <em>supports</em> the null hypothesis.</p>
<p>A Bayes Factor above 10 is a strong evidence that there is a statistical difference between two samples (as in p &lt; 0.05). It is related to both sample size per group and effect size (Cohen’s <em>d</em>).</p>
<p>When you are reporting results, I suggest you that report results such as p-value, effect size, and Bayes Factor. Post-hoc power analysis can be additionally provided but its usage has gained less traction.</p>
</div>
</div>
<div id="one-way-anova" class="section level2 hasAnchor" number="10.7">
<h2 class="hasAnchor"><span class="header-section-number">10.7</span> One-way ANOVA<a href="#one-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One-way analysis of variance (ANOVA) is used to compare the mean of multiple groups (2 groups or more). It can also be referred to as one-factor ANOVA. The data are separated into multiple groups based on one categorical variable (such as patching days, conditions or subject groups).</p>
<p>When one is comparing two groups, one-way ANOVA and two-sample t-test can yield the same results because both of these tests would compare two groups.</p>
<p>To do ANOVA, we will use <code>rstatix</code> package. Install the package if you have not done so.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;rstatix&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code></pre></div>
<p><strong>Note:</strong> We will use <code>rstatix</code> to perform some statistical tests. However, both <code>tidyverse</code> and <code>rstatix</code> packages have the function called <code>filter()</code>. To use <code>filter()</code> from the <code>tidyverse</code> (or <code>dplyr</code>) package, as we have done so before, you will need to type <code>dplyr::filter</code> rather than <code>filter</code> instead to specify <code>filter()</code> from the <code>dplyr</code> package.</p>
<p>To perform ANOVA, we have to make some assumptions about the data:</p>
<ul>
<li><p>Data should be normally distributed. This can be confirmed by using a Shapiro-Wilk test.</p></li>
<li><p>No outliers.</p></li>
<li><p>Homogeneity of variance. The variance of the data should be consistent as a function of the predictor (x-axis). This can be examined with the Levene’s test.</p></li>
<li><p>Observations should be independent: The data from one group should have no relationship with other data within the same group. In short, each observation should be unique and come from an unique individual.</p></li>
</ul>
<p>Let’s investigate whether AUC data differ significantly across days (Days 1 to 5). To do so, we will need to perform one-way ANOVA where the factor is <code>Day</code>.</p>
<div id="check-for-outliers" class="section level3 hasAnchor" number="10.7.1">
<h3 class="hasAnchor"><span class="header-section-number">10.7.1</span> Check for Outliers<a href="#check-for-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will check for outliers in the <code>auc_df</code> data frame, which stores the results of AUCs. Since we will compare the AUCs across different days (factor: <code>Day</code>), we will group each observation (each row) of the data frame by <code>Day</code>. Next, we will use the function <code>identify_outliers()</code> from the <code>rstatix</code> package to see if there are any outliers in the data set.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span></span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify_outliers</span>(AUC_Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   Day   Subject AUC_Cbratio is.outlier is.extreme
##   &lt;fct&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
## 1 4     f              117. TRUE       TRUE      
## 2 4     g              132. TRUE       TRUE</code></pre>
<p>In this case, we have <strong>2 outliers</strong> of AUC data on Day 4. Since Figure 3E indicates that Day 4 is not outrageously different than the averaged AUCs of other days, I will infer that these 2 outliers do not significantly affect the data. Therefore, I will include these 2 outliers in my data analysis.</p>
<p>However, if your data set has too many outliers, then it might be inappropriate to proceed to one-way ANOVA.</p>
<p>Let’s visually confirm whether there are 2 outliers in the AUC data from Day 4 by plotting a boxplot using <code>sm_boxplot()</code>.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.2</span>)) <span class="sc">+</span> </span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;\u0394 AUC re: Each day</span><span class="sc">\&#39;</span><span class="st">s baseline&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-361-1.png" width="336" /></p>
<p>We see that there are two orange points that reside outside the whiskers of the boxplot. Points that are outside the whiskers represent outliers. Therefore, we confirm visually that there are two outliers on Day 4, and no outliers on any other days.</p>
</div>
<div id="checking-for-normality-of-data" class="section level3 hasAnchor" number="10.7.2">
<h3 class="hasAnchor"><span class="header-section-number">10.7.2</span> Checking for Normality of Data<a href="#checking-for-normality-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rather than using <code>shapiro.test()</code>, we will be using <code>shapiro_test()</code> from the <code>rstatix</code> package because we will be sorting data (<code>group_by()</code> by <code>Day</code>) using the pipe <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(AUC_Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   Day   variable    statistic       p
##   &lt;fct&gt; &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;
## 1 1     AUC_Cbratio     0.950 0.673  
## 2 2     AUC_Cbratio     0.944 0.599  
## 3 3     AUC_Cbratio     0.977 0.947  
## 4 4     AUC_Cbratio     0.770 0.00620
## 5 5     AUC_Cbratio     0.975 0.935</code></pre>
<p>In this data set, Days 1, 2, 3 and 5 have normally distributed data sets. However, the data from Day 4 do not seem to be normally distributed. This could because there are 2 outliers on Day 4. Since bulk of the data are normally distributed, I will use <strong>parametric</strong> method to analyze the data, i.e., one-way ANOVA. If most of your data are not normally distributed, then one-way ANOVA should not be used.</p>
</div>
<div id="checking-the-assumption-for-homogeneity-of-variance" class="section level3 hasAnchor" number="10.7.3">
<h3 class="hasAnchor"><span class="header-section-number">10.7.3</span> Checking the Assumption for Homogeneity of Variance<a href="#checking-the-assumption-for-homogeneity-of-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can examine whether the variance of the response values (y values) is homogeneous using <code>levene_test()</code>.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(AUC_Cbratio <span class="sc">~</span> Day)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##     df1   df2 statistic     p
##   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1     4    45     0.638 0.638</code></pre>
<p>The Levene’s test shows that the p-value is 0.64, which is larger than 0.05. Therefore, we can assume that the variance is homogeneous across different days. Therefore, we can proceed to using ANOVA.</p>
</div>
<div id="computing-one-way-anova" class="section level3 hasAnchor" number="10.7.4">
<h3 class="hasAnchor"><span class="header-section-number">10.7.4</span> Computing One-way ANOVA<a href="#computing-one-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We perform one-way ANOVA by comparing whether <code>AUC_Cbratio</code> values significantly differ across <code>Day</code>. <code>~</code> (tilde) defines the relationship between dependent and independent variables. <code>y = m*x + b</code> can be described with <code>~</code> as <code>y~x</code>, where the value of x can affect the value of y. In the example below, it is written as <code>AUC_Cbratio ~ Day</code> because <code>AUC_Cbratio</code> (dependent variable) is affected by <code>Day</code> (independent variable).</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> AUC_Cbratio <span class="sc">~</span> Day, <span class="at">data =</span> auc_df)</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## Day          4   3513   878.3   0.588  0.673
## Residuals   45  67191  1493.1</code></pre>
<p><code>aov()</code> is used to perform <strong>a</strong>nalysis <strong>o</strong>f <strong>v</strong>ariance. In this example, the result from <code>aov()</code> is stored in the variable <code>res</code>. The summary of the results can be displayed using the function <code>summary()</code>.</p>
<p>The p-value is 0.67, which is larger than 0.05. This indicates that there is no significant difference across days in AUCs.</p>
<p>If your data show a p value less than 0.05, then you should proceed to the next step of performing post-hoc pairwise comparison tests.</p>
</div>
<div id="post-hoc-tests" class="section level3 hasAnchor" number="10.7.5">
<h3 class="hasAnchor"><span class="header-section-number">10.7.5</span> Post-hoc Tests<a href="#post-hoc-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If one-way ANOVA shows a significant difference (p &lt; 0.05), then the reader should perform <strong>Tukey HSD</strong> post-hoc pairwise comparison (<strong>H</strong>onestly <strong>S</strong>ignificant <strong>D</strong>ifference) tests to see which two specific groups vary significantly. In the example, I have saved the results in the variable <code>res</code> (short for results).</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = AUC_Cbratio ~ Day, data = auc_df)
## 
## $Day
##           diff       lwr      upr     p adj
## 2-1  -9.385230 -58.48783 39.71737 0.9822382
## 3-1 -16.267650 -65.37025 32.83495 0.8791429
## 4-1 -20.856405 -69.95900 28.24619 0.7473960
## 5-1 -23.050800 -72.15340 26.05180 0.6718799
## 3-2  -6.882420 -55.98502 42.22018 0.9945038
## 4-2 -11.471175 -60.57377 37.63142 0.9630859
## 5-2 -13.665570 -62.76817 35.43703 0.9319698
## 4-3  -4.588755 -53.69135 44.51384 0.9988648
## 5-3  -6.783150 -55.88575 42.31945 0.9948024
## 5-4  -2.194395 -51.29699 46.90820 0.9999390</code></pre>
<p>As expected from one-way ANOVA, which shows no significant difference across days, the post-hoc pairwise tests (Tukey HSD test) yield p-values higher than 0.05 between any combinations of two different days.</p>
<p>If one-way ANOVA yielded p &lt; 0.05, then we could expect to see a p-value lower than 0.05 in the Tukey HSD post-hoc test. Therefore, when one-way ANOVA yields p &gt; 0.05, it is not necessary to perform a pairwise post-hoc comparison (Tukey HSD) using the data set.</p>
</div>
<div id="one-way-repeated-measures-anova" class="section level3 hasAnchor" number="10.7.6">
<h3 class="hasAnchor"><span class="header-section-number">10.7.6</span> One-way Repeated Measures ANOVA<a href="#one-way-repeated-measures-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If the subjects are identical across the factor (ex. <code>Day</code>), then <code>anova_test()</code> (from the <code>rstatix</code> package) can be used to perform repeated measures ANOVA.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">anova_test</span>(AUC_Cbratio <span class="sc">~</span> Day, <span class="at">wid =</span> Subject,</span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">within =</span> Day)</span></code></pre></div>
<pre><code>## ANOVA Table (type II tests)
## 
##   Effect DFn DFd     F     p p&lt;.05  ges
## 1    Day   4  45 0.588 0.673       0.05</code></pre>
<p><code>wid</code> is the column name containing individuals/subjects identifiers. It should be unique to each individual. <code>within</code> is an <strong>optional</strong> argument that contains within subject variable, which in this case is <code>Day</code> as the same subjects were tested across days.</p>
<p>If different subjects were tested on each day, then <code>wid</code> should be empty. In both occasions, the p-value is the same because the subject identifiers (ex. <code>S1</code>, <code>S2</code>) are unique to each subject. Therefore, <code>R</code> just recognizes that it should perform repeated measures ANOVA.</p>
</div>
</div>
<div id="two-way-anova" class="section level2 hasAnchor" number="10.8">
<h2 class="hasAnchor"><span class="header-section-number">10.8</span> Two-way ANOVA<a href="#two-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In a two-way ANOVA, the effects of two factors are examined. In our example, we will use the data set from the paper, and examine the effects of <code>Day</code> and <code>Time</code>, which is the time point after short-term monocular deprivation (minutes).</p>
<p>Since we will be investigating whether the effects of <code>Day</code> and <code>Time</code> as variables significantly affect the values of <code>Cbratio</code>, we need to convert the columns <code>Day</code> and <code>Time</code> of <code>df</code> as factor using <code>as.factor()</code>.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Time)</span></code></pre></div>
<p>As before, let’s check for some of the assumptions that are required to perform ANOVA.</p>
<div id="identifying-outliers" class="section level3 hasAnchor" number="10.8.1">
<h3 class="hasAnchor"><span class="header-section-number">10.8.1</span> Identifying Outliers<a href="#identifying-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span></span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify_outliers</span>(Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 13 x 6
##    Day   Time  Subject Cbratio is.outlier is.extreme
##    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
##  1 1     12    f         3.43  TRUE       FALSE     
##  2 2     24    d        -0.916 TRUE       FALSE     
##  3 2     24    e         5.20  TRUE       TRUE      
##  4 2     48    j         2.75  TRUE       FALSE     
##  5 3     24    b         2.79  TRUE       FALSE     
##  6 3     24    u        -0.389 TRUE       FALSE     
##  7 4     0     f         7.47  TRUE       FALSE     
##  8 4     3     e         8.70  TRUE       TRUE      
##  9 4     6     f         2.38  TRUE       FALSE     
## 10 4     24    g         3.45  TRUE       FALSE     
## 11 4     48    e        -2.37  TRUE       FALSE     
## 12 4     48    g         3.21  TRUE       FALSE     
## 13 5     6     d        -2.88  TRUE       TRUE</code></pre>
<p>We observe that there are 13 outliers, 2 of which are considered to be extreme points. <code>identify_outliers()</code> pinpoint outliers based on the definition of boxplots. Outliers in boxplots can be ignored. However, extreme points can be considered to be slightly troublesome. In this example, 2 out of 230 (<code>nrow(df)</code>) observations seem to be extreme points. Therefore, the data set meets the requirement to be analyzed using two-way ANOVA.</p>
</div>
<div id="checking-for-normality-of-data-1" class="section level3 hasAnchor" number="10.8.2">
<h3 class="hasAnchor"><span class="header-section-number">10.8.2</span> Checking for Normality of Data<a href="#checking-for-normality-of-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s check for the normality of the data using <code>shapiro_test()</code> from the <code>rstatix</code> package for each <code>Day</code> and <code>Time</code>. To do so, we will have to group our data using <code>group_by()</code> for <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 30 x 5
##    Day   Time  variable statistic     p
##    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
##  1 1     0     Cbratio      0.913 0.306
##  2 1     3     Cbratio      0.947 0.630
##  3 1     6     Cbratio      0.899 0.213
##  4 1     12    Cbratio      0.897 0.201
##  5 1     24    Cbratio      0.918 0.341
##  6 1     48    Cbratio      0.964 0.831
##  7 2     0     Cbratio      0.925 0.398
##  8 2     3     Cbratio      0.912 0.292
##  9 2     6     Cbratio      0.900 0.221
## 10 2     12    Cbratio      0.934 0.493
## # ... with 20 more rows</code></pre>
<p>Only the first 10 rows are shown. To view the entire results, store the results into a variable and use <code>View()</code>.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span></span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Cbratio)</span></code></pre></div>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(res)</span></code></pre></div>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(res<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>We see that there are 3 p-values (out of 30 combinations of <code>Day</code> and <code>Time</code>) that are smaller than 0.05. Ideally, we would want all of them to have a p-value higher than 0.05 for the data to be considered as normally distributed. However, since most data seem to be normally distributed in our example, it is okay to proceed to use a two-way ANOVA, which is a parametric procedure.</p>
</div>
<div id="computing-two-way-anova" class="section level3 hasAnchor" number="10.8.3">
<h3 class="hasAnchor"><span class="header-section-number">10.8.3</span> Computing Two-way ANOVA<a href="#computing-two-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As before, let’s use <code>aov()</code> function to compute ANOVA.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> Cbratio <span class="sc">~</span> Day <span class="sc">+</span> Time <span class="sc">+</span> Day<span class="sc">:</span>Time,</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df)</span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Day           4    7.2   1.796   0.948    0.437    
## Time          5   74.2  14.832   7.825 6.77e-07 ***
## Day:Time     20   18.4   0.921   0.486    0.971    
## Residuals   270  511.8   1.896                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>As before, we specify the <code>formula</code> using tilde (<code>~</code>); its left side is the dependent variable (<code>Cbratio</code>), and the right side includes the independent variables (or predictors, ex. <code>Day</code> and <code>Time</code>). <code>+</code> is used to add more independent variables in the model formula. Interaction between the effects of <code>Day</code> and <code>Time</code> should also be included by <code>:</code>.</p>
<p>Another way of writing the model formula is shown below. It uses <code>*</code> as a shortcut to include the effects of <code>Day</code>, <code>Time</code> and their interactions. Notice that the results of both ANOVAs are identical because the model formulas are the same.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> Cbratio <span class="sc">~</span> Day<span class="sc">*</span>Time, <span class="at">data =</span> df)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res2)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Day           4    7.2   1.796   0.948    0.437    
## Time          5   74.2  14.832   7.825 6.77e-07 ***
## Day:Time     20   18.4   0.921   0.486    0.971    
## Residuals   270  511.8   1.896                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>It appears that there is a statistically significant effect of <code>Time</code>, F(5, 270) = 7.83, p &lt; 0.001. But the effect of <code>Day</code> seems to be not significant, F(4,270) = 0.49, p = 0.44. Also the effect of interaction between <code>Day</code> and <code>Time</code> is not significant, F(20,270) = 0.97, p &gt; 0.05.</p>
<p>An interaction effect between A and B exists when the effect of factor A (ex. <code>Day</code>) is different at different levels of factor B (ex. <code>Time</code>). Let’s understand how the effect of interaction could affect the data.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-375-1.png" width="336" /></p>
<p>We see that best-fit regression slopes of the green, red and purple lines are almost identical. This is because the factor <code>Time</code> affects <code>Cbratio</code> at different levels of the factor <code>Day</code> (i.e., different days). This suggests that the slope of decay (decrease in changes in Contrast balance ratio) over time is similar across days. In other words, the interaction effect between <code>Time</code> and <code>Day</code> is not significant (p &lt; 0.05).</p>
<p>Conversely, if <code>Time</code> affects <code>Cbratio</code> differently across different days, we would see that the best-fit regression slopes would be different among days.</p>
</div>
<div id="post-hoc-test" class="section level3 hasAnchor" number="10.8.4">
<h3 class="hasAnchor"><span class="header-section-number">10.8.4</span> Post-hoc Test<a href="#post-hoc-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The procedure for post-hoc analysis differs depending on whether the interaction effect is statistically significant (p &lt; 0.05) or not (p &gt; 0.05).</p>
<p>Post-hoc test should be performed when there is a significant main effect from one of the factors (ex. <code>Time</code> or <code>Day</code>) in the two-way ANOVA. If not, it should not be performed.</p>
<p>If there is a significant main effect but the interaction effect is not significant, only interpret the results of post-hoc analysis that are related to the main effects. For example, if <code>Time</code> was a significant main effect, we could analyze the data as following.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res, <span class="at">which =</span> <span class="st">&#39;Time&#39;</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Cbratio ~ Day + Time + Day:Time, data = df)
## 
## $Time
##            diff        lwr         upr     p adj
## 3-0    0.106096 -0.6842609  0.89645292 0.9988910
## 6-0   -0.378016 -1.1683729  0.41234092 0.7432954
## 12-0  -0.887696 -1.6780529 -0.09733908 0.0176431
## 24-0  -0.876150 -1.6665069 -0.08579308 0.0201057
## 48-0  -1.257262 -2.0476189 -0.46690508 0.0001098
## 6-3   -0.484112 -1.2744689  0.30624492 0.4946934
## 12-3  -0.993792 -1.7841489 -0.20343508 0.0048793
## 24-3  -0.982246 -1.7726029 -0.19188908 0.0056524
## 48-3  -1.363358 -2.1537149 -0.57300108 0.0000191
## 12-6  -0.509680 -1.3000369  0.28067692 0.4349141
## 24-6  -0.498134 -1.2884909  0.29222292 0.4616410
## 48-6  -0.879246 -1.6696029 -0.08888908 0.0194170
## 24-12  0.011546 -0.7788109  0.80190292 1.0000000
## 48-12 -0.369566 -1.1599229  0.42079092 0.7611911
## 48-24 -0.381112 -1.1714689  0.40924492 0.7366165</code></pre>
<p>If there is a significant interaction effect between <code>Day</code> and <code>Time</code>, we can examine how the effect of <code>Time</code> varies across different days.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span></span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cbratio <span class="sc">~</span> Time, <span class="at">wid =</span> Subject, <span class="at">within =</span> Day) <span class="sc">%&gt;%</span></span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_anova_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 9
##   Day   Effect   DFn   DFd     F     p `p&lt;.05`   ges p.adj
##   &lt;fct&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 1     Time       5    54  2.33 0.054 &quot;&quot;      0.178  0.27
## 2 2     Time       5    54  1.52 0.2   &quot;&quot;      0.123  1   
## 3 3     Time       5    54  4.01 0.004 &quot;*&quot;     0.271  0.02
## 4 4     Time       5    54  1.45 0.221 &quot;&quot;      0.118  1   
## 5 5     Time       5    54  1.72 0.146 &quot;&quot;      0.137  0.73</code></pre>
<p><code>within</code> refers to the within-subject factor, which in this case <code>Day</code>. If there are different subjects associated with each <code>Day</code>, then <code>between</code> argument can be filled instead of <code>within</code> in the <code>anova_test()</code> function.</p>
<p>It seems that the effect of <code>Time</code> is not statistically significant at different levels of the factor <code>Day</code>, except for Day 3. This means that the decrease of <code>Cbratio</code> over time does not differ significantly across most days. This (sort of) agrees with our results that the interaction effect is not statistically significant.</p>
<p>Let’s pretend that the interaction effect is still significant. If so, we can examine whether the second independent variable (<code>Day</code> in our case) differs across different levels of the first independent variable (<code>Time</code> in our example).</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cbratio <span class="sc">~</span> Day, <span class="at">wid =</span> Subject, <span class="at">within =</span> Time) <span class="sc">%&gt;%</span></span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_anova_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##   Time  Effect   DFn   DFd     F     p `p&lt;.05`   ges p.adj
##   &lt;fct&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 0     Day        4    45 0.228 0.921 &quot;&quot;      0.02  1    
## 2 3     Day        4    45 0.339 0.85  &quot;&quot;      0.029 1    
## 3 6     Day        4    45 2.02  0.107 &quot;&quot;      0.152 0.642
## 4 12    Day        4    45 0.116 0.976 &quot;&quot;      0.01  1    
## 5 24    Day        4    45 0.416 0.796 &quot;&quot;      0.036 1    
## 6 48    Day        4    45 0.734 0.574 &quot;&quot;      0.061 1</code></pre>
<p>It seems that the effect of <code>Day</code> remains insignificant across all time points.</p>
<p>You may realize that this result from the above is strange. Indeed, it is inappropriate to report these two results because the interaction effect is not statistically significant. Therefore, it is more appropriate to just report the post-hoc analysis that is only concerned with the effect of <code>Time</code>.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res, <span class="at">which =</span> <span class="st">&#39;Time&#39;</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Cbratio ~ Day + Time + Day:Time, data = df)
## 
## $Time
##            diff        lwr         upr     p adj
## 3-0    0.106096 -0.6842609  0.89645292 0.9988910
## 6-0   -0.378016 -1.1683729  0.41234092 0.7432954
## 12-0  -0.887696 -1.6780529 -0.09733908 0.0176431
## 24-0  -0.876150 -1.6665069 -0.08579308 0.0201057
## 48-0  -1.257262 -2.0476189 -0.46690508 0.0001098
## 6-3   -0.484112 -1.2744689  0.30624492 0.4946934
## 12-3  -0.993792 -1.7841489 -0.20343508 0.0048793
## 24-3  -0.982246 -1.7726029 -0.19188908 0.0056524
## 48-3  -1.363358 -2.1537149 -0.57300108 0.0000191
## 12-6  -0.509680 -1.3000369  0.28067692 0.4349141
## 24-6  -0.498134 -1.2884909  0.29222292 0.4616410
## 48-6  -0.879246 -1.6696029 -0.08888908 0.0194170
## 24-12  0.011546 -0.7788109  0.80190292 1.0000000
## 48-12 -0.369566 -1.1599229  0.42079092 0.7611911
## 48-24 -0.381112 -1.1714689  0.40924492 0.7366165</code></pre>
</div>
</div>
<div id="friedman-test" class="section level2 hasAnchor" number="10.9">
<h2 class="hasAnchor"><span class="header-section-number">10.9</span> Friedman Test<a href="#friedman-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="performing-friedman-test" class="section level3 hasAnchor" number="10.9.1">
<h3 class="hasAnchor"><span class="header-section-number">10.9.1</span> Performing Friedman Test<a href="#performing-friedman-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Friedman test is essentially a non-parametric version of one-way repeated measures ANOVA. This means that if a data set/sample has p &lt; 0.05 from a Shapiro-Wilk test, then you should run this test rather than the ANOVA.</p>
<p>Let’s assume that the <code>df</code> has a non-normal distribution and requires the use of a non-parametric test. Since <code>df</code> has two within-subject factors (<code>Time</code> and <code>Day</code>), <code>df</code> cannot be used in the Friedman test. So, let’s create a new data frame <code>day3</code> that contains data from <code>Day 3</code>, which only contains one factor <code>Time</code>.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="st">&#39;3&#39;</span>)</span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a>day3 <span class="sc">%&gt;%</span> <span class="fu">friedman_test</span>(Cbratio <span class="sc">~</span> Time <span class="sc">|</span> Subject)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 6
##   .y.         n statistic    df      p method       
## * &lt;chr&gt;   &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        
## 1 Cbratio    10      14.7     5 0.0115 Friedman test</code></pre>
<p>It seems that the effect of <code>Time</code> is significant (p = 0.012). So, we should run a multiple pairwise comparisons as post-hoc analysis with p-value correction.</p>
</div>
<div id="post-hoc-analysis" class="section level3 hasAnchor" number="10.9.2">
<h3 class="hasAnchor"><span class="header-section-number">10.9.2</span> Post-hoc Analysis<a href="#post-hoc-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In ANOVA, we used pairwise t-tests as post-hoc analysis with p-value correction. In Friedman test, we will use the wilcoxon test with the function <code>wilcox_test()</code>.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>day3 <span class="sc">%&gt;%</span> </span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_test</span>(Cbratio <span class="sc">~</span> Time, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">p.adjust.method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 9
##    .y.     group1 group2    n1    n2 statistic     p p.adj p.adj.signif
##  * &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       
##  1 Cbratio 0      3         10    10        33 0.625 1     ns          
##  2 Cbratio 0      6         10    10        41 0.193 1     ns          
##  3 Cbratio 0      12        10    10        46 0.064 0.968 ns          
##  4 Cbratio 0      24        10    10        53 0.006 0.088 ns          
##  5 Cbratio 0      48        10    10        53 0.006 0.088 ns          
##  6 Cbratio 3      6         10    10        42 0.16  1     ns          
##  7 Cbratio 3      12        10    10        43 0.131 1     ns          
##  8 Cbratio 3      24        10    10        45 0.084 1     ns          
##  9 Cbratio 3      48        10    10        52 0.01  0.147 ns          
## 10 Cbratio 6      12        10    10        34 0.557 1     ns          
## 11 Cbratio 6      24        10    10        38 0.322 1     ns          
## 12 Cbratio 6      48        10    10        46 0.064 0.968 ns          
## 13 Cbratio 12     24        10    10        26 0.922 1     ns          
## 14 Cbratio 12     48        10    10        46 0.064 0.968 ns          
## 15 Cbratio 24     48        10    10        45 0.084 1     ns</code></pre>
<p>The argument <code>p.adjust.method</code> specifies the method that is used to correct for the p-value to avoid false positives.</p>
<p>We see that the post-hoc analysis does not yield any pair that has a statistical significance. If this is the case, reporting the results of the Friedman test can be sufficient.</p>
</div>
</div>
<div id="extra-resources" class="section level2 hasAnchor" number="10.10">
<h2 class="hasAnchor"><span class="header-section-number">10.10</span> Extra Resources<a href="#extra-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, mixed two-way and three-way ANOVAs are not discussed.</p>
<p>For detailed information about ANOVAs in R, please check out this link: <a href="https://www.datanovia.com/en/lessons/anova-in-r/" class="uri">https://www.datanovia.com/en/lessons/anova-in-r/</a>.</p>
<p>To learn more about performing statistical tests in R, please check out the book entitled <strong>YaRrr! The Pirate’s Guide to R</strong> by Nathaniel Phillips (<a href="https://bookdown.org/ndphillips/YaRrr/" class="uri">https://bookdown.org/ndphillips/YaRrr/</a>).</p>
<!--chapter:end:statistics.Rmd-->
</div>
</div>
<div id="part-manual-for-smplot2" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Manual for smplot2<a href="#part-manual-for-smplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="themes-colors-correlations-boxplots-violins-and-bars-part-1" class="section level1 hasAnchor" number="11">
<h1 class="hasAnchor"><span class="header-section-number">11</span> Themes, Colors, Correlations, Boxplots, Violins and Bars (Part 1)<a href="#themes-colors-correlations-boxplots-violins-and-bars-part-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This and the next chapters discuss in brief of all visualization functions of <strong>smplot2</strong>. Most of these functions have already been described in depth in the preceding chapters. Those that have not, such as <code>sm_hgrid()</code>, <code>sm_hist()</code> and <code>sm_bland_altman()</code> will be discussed in detail.</p>
<p>If you seek certain bits of information about the package on this page, the best is to use it via <strong>CTRL + F</strong> and type certain key words as this page will be long. This page is meant to be a manual, not a linear tutorial. So I recommend that the reader not read this page linearly.</p>
<p>This chapter does not describe analysis functions of <strong>smplot2</strong>, such as <code>sm_effsize()</code>, <code>sm_power()</code> and <code>sm_auc()</code>; these functions are described in the <strong>Data Analysis</strong> section of the book.</p>
<p>If you are still not sure about any of the functions, please type <code>?</code> before the function names, ex. <code>?sm_bar</code>.</p>
<div id="installation-of-the-package" class="section level2 hasAnchor" number="11.1">
<h2 class="hasAnchor"><span class="header-section-number">11.1</span> Installation of the Package<a href="#installation-of-the-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot2&#39;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>To use the package, load it in RStudio.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span></code></pre></div>
</div>
<div id="how-...-and-xxx.params-arguments-work" class="section level2 hasAnchor" number="11.2">
<h2 class="hasAnchor"><span class="header-section-number">11.2</span> How <code>...</code> and <code>xxx.params</code> arguments work<a href="#how-...-and-xxx.params-arguments-work" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure" style="text-align: center">
<img src="img/parameters.png" alt="smplot2's parameters" width="90%" />
<p class="caption">
(#fig:unnamed-chunk-384)smplot2’s parameters
</p>
</div>
<p>These are both additional arguments in the visualizing functions of <em>smplot2</em>. <code>xxx.params</code> comes in various forms, such as:</p>
<ul>
<li><code>err.params</code>: controls the error bar’s appearance.</li>
<li><code>point.params</code>: controls the points’ appearance.</li>
<li><code>line.params</code>: controls the lines’ appearance.</li>
<li><code>avgLine.params</code>: controls the mean line’s appearance.</li>
<li><code>avgPoint.params</code>: controls the average point’s appearance.</li>
<li><code>bar.params</code>: controls the bar’s appearance.</li>
<li><code>boxplot.params</code>: controls the boxplot’s appearance.</li>
<li><code>violin.params</code>: controls the violin’s appearance.</li>
</ul>
<p><code>...</code> is another additional argument that I refer to as the <em>generic parameter</em>. It can affect different components of a graph all at once if there is no default.</p>
<ul>
<li>However, these <code>xxx.params</code> can have defaults on their own depending on the function. To remove the defaults, arguments have to be written in this format <code>xxx.params = list()</code> within the functions.</li>
</ul>
<p>This is probably the most substantial difference between <strong>smplot</strong> and <strong>smplot2</strong>.</p>
</div>
<div id="color-palette" class="section level2 hasAnchor" number="11.3">
<h2 class="hasAnchor"><span class="header-section-number">11.3</span> Color palette<a href="#color-palette" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unlike some other visualization packages, <strong>smplot2</strong> only offers single color palette (only up to 20 colors). This choice of design was partly motivated by the fact that too many choices would often confuse the users, as I have found myself doing so.</p>
<p>These 20 colors can be accessed using the function <code>sm_palette()</code>.</p>
<ul>
<li><code>sm_palette()</code> accepts the <strong>number of colors</strong> (up to <strong>20</strong>) and returns the hex codes accordingly.</li>
</ul>
<p>A specific color can be called upon by the function <code>sm_color()</code>.</p>
<ul>
<li><code>sm_color()</code> accepts the <strong>character string</strong> of the color name.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/color.png" alt="smplot2's color palette" width="85%" />
<p class="caption">
(#fig:unnamed-chunk-385)smplot2’s color palette
</p>
</div>
<p>These colors make up the entire palette of <strong>smplot2</strong>.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_palette</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;#7f404a&quot; &quot;#5b4080&quot; &quot;#408073&quot; &quot;#8c994d&quot; &quot;#cc9666&quot; &quot;#cc1489&quot; &quot;#1262b3&quot; &quot;#cc3d3d&quot;
##  [9] &quot;#da73e6&quot; &quot;#66b1cc&quot; &quot;#0f993d&quot; &quot;#7f5d0d&quot; &quot;#7b3dcc&quot; &quot;#45e0e6&quot; &quot;#63e617&quot; &quot;#e57717&quot;
## [17] &quot;#c9b9c6&quot; &quot;#ffe764&quot; &quot;#ffb359&quot; &quot;#9ee1a8&quot;</code></pre>
<p>If you only need <code>5</code> colors, then type this instead.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_palette</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#cc1489&quot; &quot;#1262b3&quot; &quot;#5b4080&quot; &quot;#e57717&quot; &quot;#0f993d&quot;</code></pre>
<p>This is the hex code for <code>darkred</code>.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#7f404a&quot;</code></pre>
<p>You can also call two (same / different) colors at the same time.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;darkred&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#7f404a&quot; &quot;#7f404a&quot;</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;viridian&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#7f404a&quot; &quot;#408073&quot;</code></pre>
<p>If you want to use 1 color (ex. <code>darkred</code>) from <strong>smplot2</strong> and another color (<code>#b37982</code>) from somewhere else, you will need to resort to using their hex codes.</p>
<p>Create a variable that stores these two colors using <code>&lt;-</code>.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>),<span class="st">&#39;#b37982&#39;</span>)</span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a>my_colors</span></code></pre></div>
<pre><code>## [1] &quot;#7f404a&quot; &quot;#b37982&quot;</code></pre>
<p><code>my_colors</code> have two colors: one from <strong>smplot2</strong> and another from somewhere else.</p>
</div>
<div id="graph-themes" class="section level2 hasAnchor" number="11.4">
<h2 class="hasAnchor"><span class="header-section-number">11.4</span> Graph themes<a href="#graph-themes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>smplot2</strong> offers many graph themes. They are minimalistic and have similar font size across titles and texts. They are most ideal when the panel is square (ratio = 0.95- 1.05). They also have arguments <code>borders</code> and <code>legends</code>, which could be used to remove / add borders (<code>borders = FALSE</code> / <code>borders = TRUE</code>) or remove / add legends (<code>legends = FALSE</code> / <code>legends = TRUE</code>). These are most appropriate for scientific publications.</p>
<ul>
<li><p><code>sm_hgrid()</code> is the default theme for most visualizing functions of <strong>smplot2</strong>, such as <code>sm_boxplot()</code>, <code>sm_bar()</code>, <code>sm_forest()</code> etc. It has major horizontal grids.</p></li>
<li><p><code>sm_vgrid()</code> has major vertical grids and is not used as default for the visualizing functions.</p></li>
<li><p><code>sm_hvgrid()</code> has both major horizontal and vertical grids. This is identical to <code>sm_corr_theme()</code>.</p></li>
<li><p>This theme is most appropriate when the x- and y-axes have the same range.</p></li>
<li><p><code>sm_hvgrid_minor()</code> has vertical and horizontal major and minor grids.</p></li>
<li><p><code>sm_classic()</code> has no grid and half-border. This is a classic <strong>ㄴ</strong> shape. This is useful for all types of plots. The default theme of <code>sm_bland_altman()</code> is <code>sm_classic()</code>.</p></li>
<li><p><code>sm_minimal</code> has no grid. This is useful when a graph has a lot of annotation, such as texts and arrows.</p></li>
<li><p><code>sm_slope_theme()</code> is a theme for a slope chart. It removes everything except the y-axis. This is the default theme of <code>sm_slope()</code>.</p></li>
</ul>
<p>Let’s explore these themes one-by-one. First, let’s create <code>p1</code>, which has the default theme of <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-392-1.png" width="470.4" /></p>
<p>We can incorporate <code>sm_corr_theme()</code>.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-393-1.png" width="480" /></p>
<p>We can also remove <code>borders</code> and <code>legends</code> by setting them as <code>FALSE</code>.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>, <span class="at">legends =</span> <span class="cn">FALSE</span>)</span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-394-1.png" width="336" /></p>
<p>You can also apply smplot’s colors by using <code>scale_color_manual()</code>.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">7</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-395-1.png" width="336" /></p>
<p>We can also apply <code>sm_hgrid()</code>.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_hgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-396-1.png" width="336" /></p>
<p>Let’s try <code>sm_vgrid()</code>.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_vgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-397-1.png" width="480" /></p>
<p>You can remove the legend as shown below.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_vgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-398-1.png" width="336" /></p>
<p><code>sm_classic()</code> looks very clean as well.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-399-1.png" width="336" /></p>
<p>You can add a legend.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_classic</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-400-1.png" width="480" /></p>
<p>Another choice is <code>sm_minimal()</code>, which has no grids.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-401-1.png" width="336" /></p>
<p>You can choose to include the legend in <code>sm_minimal()</code>.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-402-1.png" width="480" /></p>
</div>
<div id="correlation-plot" class="section level2 hasAnchor" number="11.5">
<h2 class="hasAnchor"><span class="header-section-number">11.5</span> Correlation plot<a href="#correlation-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When using <strong>ggplot2</strong> to plot correlation, the data frame has to have at least two columns, each of which for x and y axes.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-403-1.png" width="336" /></p>
<p>In the data frame <code>mtcars</code>, one column is for the x-axis (<code>drat</code>), another column is for y-axis (<code>mpg</code>). In short, the data frame structure is different to the one used to plot bar <code>sm_bar()</code>, <code>sm_boxplot()</code>, <code>sm_raincloud()</code> etc.</p>
<p>There are two associated functions in <strong>smplot2</strong> with correlation.</p>
<ul>
<li><code>sm_statCorr()</code> draws the fitted linear regression line, prints the <code>R</code> and <code>p</code> values from the specified <code>method</code> of correlation test. It also calls <code>sm_corr_theme()</code>.
<ul>
<li><strong>Important:</strong> <code>sm_statCorr()</code> recognizes the data for the y- and x-axes from the <code>mapping = aes()</code> in <code>ggplot()</code> function. Therefore there is no need to provide <code>data</code>, <code>x</code> and <code>y</code> arguments in this function.</li>
</ul></li>
<li><code>sm_corr_avgErr()</code> draws the average point with vertical and horizontal error bars. The arguments <code>sm_corr_avgErr(data = ..., x = ..., y = ...)</code> have to be included; these are identical to what are provided in <code>ggplot()</code>.
<ul>
<li><strong>Important:</strong> <code>sm_corr_avgErr()</code> does not recognize the data from <code>mapping = aes()</code> in <code>ggplot()</code>. Therefore, you should specify the three arguments.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_statCorr</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-404-1.png" width="336" /></p>
<div id="sm_statcorr" class="section level3 hasAnchor" number="11.5.1">
<h3 class="hasAnchor"><span class="header-section-number">11.5.1</span> <code>sm_statCorr()</code><a href="#sm_statcorr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sm_statCorr()</code> has various arguments.</p>
<ul>
<li><code>fit.params</code> feeds arguments to <code>geom_smooth()</code>control the aesthetics such as <code>color</code>, <code>linetype</code>, <code>fullrange</code> etc. These parameters can be used as part of <code>...</code> the generic parameter.</li>
</ul>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_statCorr</span>(<span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-405-1.png" width="336" /></p>
<ul>
<li><code>fullrange</code> controls whether the fitted line spans the entire length of the x-axis. If <code>fullrange = TRUE</code>, it will do so. If not, it will only span between the minimum and maximum x points of the dataset.</li>
</ul>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_statCorr</span>(<span class="at">fullrange =</span> T) <span class="sc">+</span></span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-406-1.png" width="336" /></p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_statCorr</span>(<span class="at">fullrange =</span> F) <span class="sc">+</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-407-1.png" width="336" /></p>
<ul>
<li><code>corr_method</code> is the method of correlation test that is to be used. The default is set to the pearson correlation test (<code>corr_method = 'pearson'</code>).</li>
</ul>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_statCorr</span>(<span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-408-1.png" width="336" /></p>
<ul>
<li><code>separate_by</code> is the string that separates between the <code>R</code> print and <code>p</code> print.</li>
</ul>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_statCorr</span>(<span class="at">separate_by =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-409-1.png" width="336" /></p>
<ul>
<li><code>label_x</code> and <code>label_y</code> controls the location of the statistical annotations. <code>text_size</code> controls their size.</li>
</ul>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_statCorr</span>(<span class="at">fit.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label_x =</span> <span class="dv">2</span>, <span class="at">label_y =</span> <span class="dv">0</span>, <span class="at">text_size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-410-1.png" width="336" /></p>
</div>
<div id="sm_corr_avgerr" class="section level3 hasAnchor" number="11.5.2">
<h3 class="hasAnchor"><span class="header-section-number">11.5.2</span> <code>sm_corr_avgErr()</code><a href="#sm_corr_avgerr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><code>data</code> is the variable that contains the data frame.</p></li>
<li><p><code>x</code> is the column name of the variable that is plotted in the x-axis.</p></li>
<li><p><code>y</code> is the column name of the variable that is plotted in the y-axis.</p></li>
</ul>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg) <span class="sc">+</span></span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-411-1.png" width="336" /></p>
<ul>
<li><p><code>point.params()</code> feeds arguments to <code>geom_point()</code> to set <code>color</code>, <code>alpha</code>, <code>size</code> etc for the average point.</p></li>
<li><p><code>errv.params</code> feeds the arguments to <code>geom_errorbar()</code>, such as <code>color</code>, <code>size</code> and <code>width</code> etc, to plot the vertical (y-axis) error bar.</p></li>
<li><p><code>errh.params</code> feeds the arguments to <code>geom_errorbarh()</code>, such as <code>color</code>, <code>size</code> and <code>height</code> etc, to plot the horizontal (x-axis) error bar.</p></li>
</ul>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb527-4"><a href="#cb527-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb527-5"><a href="#cb527-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errh.params =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#1262b3&quot;</span>,</span>
<span id="cb527-6"><a href="#cb527-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>),</span>
<span id="cb527-7"><a href="#cb527-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errv.params =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">color =</span> <span class="st">&quot;#cc3d3d&quot;</span>,</span>
<span id="cb527-8"><a href="#cb527-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb527-9"><a href="#cb527-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-412-1.png" width="336" /></p>
<ul>
<li><code>errorbar_type</code> sets the type of the error bar, such as standard error (<code>errorbar_type = 'se'</code> as default), standard deviation (<code>errorbar_type = 'sd'</code>) or 95% confidence interval (<code>errorbar_type = 'ci'</code>).</li>
</ul>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errorbar_type =</span> <span class="st">&#39;se&#39;</span>) <span class="sc">+</span></span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-413-1.png" width="336" /></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb529-3"><a href="#cb529-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_avgErr</span>(<span class="at">data =</span> mtcars, <span class="at">x =</span> drat, <span class="at">y =</span> mpg,</span>
<span id="cb529-4"><a href="#cb529-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>) <span class="sc">+</span></span>
<span id="cb529-5"><a href="#cb529-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-414-1.png" width="336" /></p>
</div>
<div id="structure-of-data-frame" class="section level3 hasAnchor" number="11.5.3">
<h3 class="hasAnchor"><span class="header-section-number">11.5.3</span> Structure of data frame<a href="#structure-of-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As previously mentioned, the structure of a data frame is unique for correlation plot.</p>
<ul>
<li>Column 1 has to be the data for x-axis.</li>
<li>Column 2 has to be the data for y-axis. .</li>
</ul>
<p>Let’s explore this difference by generating fake dataset and reorganizing it for different plot types.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>) <span class="co"># generate random data</span></span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a>method1 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb530-4"><a href="#cb530-4" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb530-5"><a href="#cb530-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb530-6"><a href="#cb530-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(method1,method2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb530-7"><a href="#cb530-7" aria-hidden="true" tabindex="-1"></a>Method <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Method 1&#39;</span>, <span class="st">&#39;Method 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(method1))</span>
<span id="cb530-8"><a href="#cb530-8" aria-hidden="true" tabindex="-1"></a>df_general <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Method) <span class="co"># used for sm_bar(), sm_boxplot(), sm_violin(), etc</span></span>
<span id="cb530-9"><a href="#cb530-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-10"><a href="#cb530-10" aria-hidden="true" tabindex="-1"></a>df_corr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first =</span> method1, <span class="at">second =</span> method2) <span class="co"># used for correlation</span></span></code></pre></div>
<p>We have created two data frames: <code>df_general</code> and <code>df_corr</code>. Let’s take a look at their structures.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_general)</span></code></pre></div>
<pre><code>##   Subject       Value   Method
## 1      S1 -0.59103110 Method 1
## 2      S2  0.02659437 Method 1
## 3      S3 -1.51655310 Method 1
## 4      S4 -1.36265335 Method 1
## 5      S5  1.17848916 Method 1
## 6      S6 -0.93415132 Method 1</code></pre>
<p>Notice that <code>df_general</code> has three columns. The first column is subject, second column is data (i.e., <code>Value</code>) and third column is measurement group.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_corr)</span></code></pre></div>
<pre><code>##         first      second
## 1 -0.59103110 -0.65571812
## 2  0.02659437 -0.68251762
## 3 -1.51655310 -0.01585819
## 4 -1.36265335 -0.44260479
## 5  1.17848916  0.35255750
## 6 -0.93415132  0.07317058</code></pre>
<p>Notice that <code>df_corr</code> has two columns, each of which represents a measurement group.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot using data frame &#39;df_corr&#39; </span></span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_corr, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> first, <span class="at">y =</span> second)) <span class="sc">+</span> </span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb535-6"><a href="#cb535-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb535-7"><a href="#cb535-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">fullrange =</span> <span class="cn">TRUE</span>,</span>
<span id="cb535-8"><a href="#cb535-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">label_y =</span> <span class="fl">2.3</span>,</span>
<span id="cb535-9"><a href="#cb535-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb535-10"><a href="#cb535-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb535-11"><a href="#cb535-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Method 1&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Method 2&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-418-1.png" width="336" /></p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bar graph using data frame &#39;df_general&#39;</span></span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_general, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Value, </span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb536-4"><a href="#cb536-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb536-5"><a href="#cb536-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>,<span class="st">&#39;green&#39;</span>)) <span class="sc">+</span></span>
<span id="cb536-6"><a href="#cb536-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-419-1.png" width="336" /></p>
</div>
<div id="correlation-plot-with-both-regression-and-reference-lines" class="section level3 hasAnchor" number="11.5.4">
<h3 class="hasAnchor"><span class="header-section-number">11.5.4</span> Correlation plot with both regression and reference lines<a href="#correlation-plot-with-both-regression-and-reference-lines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also add a reference line (slope = 1) in a correlation plot.</p>
<p>This can be done with <code>geom_abline()</code>. In this example, the reference line’s slope is set to 1 and it has a dashed line style.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot using data frame &#39;df_corr&#39; </span></span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_corr, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> first, <span class="at">y =</span> second)) <span class="sc">+</span> </span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb537-5"><a href="#cb537-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb537-6"><a href="#cb537-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="fl">2.8</span>),  <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb537-7"><a href="#cb537-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="fl">2.8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb537-8"><a href="#cb537-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">fullrange =</span> <span class="cn">TRUE</span>,</span>
<span id="cb537-9"><a href="#cb537-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">label_y =</span> <span class="fl">2.3</span>,</span>
<span id="cb537-10"><a href="#cb537-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb537-11"><a href="#cb537-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb537-12"><a href="#cb537-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Method 1&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Method 2&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-420-1.png" width="336" /></p>
</div>
</div>
<div id="boxplot---sm_boxplot" class="section level2 hasAnchor" number="11.6">
<h2 class="hasAnchor"><span class="header-section-number">11.6</span> Boxplot - <code>sm_boxplot()</code><a href="#boxplot---sm_boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sm_boxplot()</code> generates a boxplot and individual points at the same time.</p>
<ul>
<li>It automatically uses <code>sm_hgrid()</code> as its default theme.
<ul>
<li>It also has arguments <code>borders</code> and <code>legends</code> as part of <code>sm_hgrid()</code>.</li>
</ul></li>
</ul>
<p>It has several arguments. To explore them, let’s generate some random data first.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)), <span class="dv">3</span>)</span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb538-7"><a href="#cb538-7" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb538-8"><a href="#cb538-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<p>Here is the default boxplot.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-422-1.png" width="336" /></p>
<ul>
<li><p><code>point.param</code> sends arguments to <code>geom_point()</code> such as <code>color</code>, <code>size</code> and <code>alpha</code> to plot the jittered individual points.</p></li>
<li><p><code>boxplot.param</code> sends arguments to <code>geom_boxplot()</code> such as <code>fill</code>, <code>color</code>, <code>width</code> and <code>notch</code> to plot the boxplot.</p></li>
</ul>
<p>In this example, <code>...</code> is fed into <code>point.params</code> to control the <code>color</code> of the points, but not of the boxplot because <code>boxplot.params</code> already has a <code>color</code> default (type <code>?sm_boxplot</code> to see the defaults).</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-423-1.png" width="336" /></p>
<p>Notice that in the example below, the points are no longer transparent as the default <code>alpha</code> has been reset by explicitly writing <code>point.params = list(color = ...)</code>.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-424-1.png" width="336" /></p>
<p>You can be quite flexible with the aesthetics.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&#39;white&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-425-1.png" width="336" /></p>
<p>You can also change the border <code>color</code> of the boxplot using <code>boxplot.params</code>.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)),</span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.65</span>,</span>
<span id="cb543-4"><a href="#cb543-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="fl">2.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-426-1.png" width="336" /></p>
<p>Notice that the default <code>width = 0.5</code> boxplot is gone in the example below because we have explicitly written <code>boxplot.params = list()</code>.</p>
<p>Now let’s apply different color for each Day.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>() <span class="sc">+</span></span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-427-1.png" width="336" /></p>
<p>You can change the shape of the boxplot by setting <code>notch = TRUE</code> within <code>boxplot.params</code>.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb545-3"><a href="#cb545-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb545-4"><a href="#cb545-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-428-1.png" width="336" /></p>
<p>A notched boxplot shows the confidence interval around the median (+/- 1.58 * interquartile range / sqrt(n)).</p>
<ul>
<li><p>The notches are used for group comparison.
-If the notch of each box does not overlap, there is a strong likelihood that the medians are significantly different between groups.</p></li>
<li><p><code>point_jitter_width</code> lets you control the width of the jitter of the individual points.</p></li>
</ul>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-429-1.png" width="336" /></p>
<ul>
<li><code>points = FALSE</code> removes all the individual points.</li>
</ul>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-430-1.png" width="336" /></p>
<p>This is obviously not acceptable partly because each x-level has the same color and the plot is too empty. So we can add the points back with unique colors.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb548-4"><a href="#cb548-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&#39;white&#39;</span>)) <span class="sc">+</span></span>
<span id="cb548-5"><a href="#cb548-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-431-1.png" width="336" /></p>
<div id="plotting-individual-points-with-unique-colors-1" class="section level3 hasAnchor" number="11.6.1">
<h3 class="hasAnchor"><span class="header-section-number">11.6.1</span> Plotting individual points with unique colors<a href="#plotting-individual-points-with-unique-colors-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sm_boxplot()</code> can draw individual points with unique colors if you set <code>color = Subject</code> within <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>() <span class="sc">+</span></span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-432-1.png" width="336" /></p>
<p>We can increase the size of the points.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">size =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-433-1.png" width="336" /></p>
</div>
</div>
<div id="violin-plot---sm_violin" class="section level2 hasAnchor" number="11.7">
<h2 class="hasAnchor"><span class="header-section-number">11.7</span> Violin Plot - <code>sm_violin()</code><a href="#violin-plot---sm_violin" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sm_violin()</code> plots a violin plot, individual points and lines that indicate means and +/- 1 standard deviation at the same time.</p>
<ul>
<li>It is very similar to <code>sm_boxplot()</code> except there is no option for <code>notch = TRUE</code> in <code>sm_violin()</code>.</li>
<li><code>sm_violin()</code> automatically uses <code>sm_hgrid()</code> as its default theme.
<ul>
<li>It also has arguments <code>borders</code> and <code>legends</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-434-1.png" width="336" /></p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a violin plot with different colored points and lines</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb552-4"><a href="#cb552-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-435-1.png" width="336" /></p>
<p>You can specify the aesthetics of <code>sm_violin()</code> using <code>point.params</code>, <code>err.params</code> and <code>violin.params</code>.</p>
<ul>
<li><p><code>point.params</code> feeds the arguments to <code>geom_point()</code>, such as <code>color</code>, <code>alpha</code>, etc, to plot the individual points.</p></li>
<li><p><code>err.params</code> feeds the arguments to <code>geom_linerange()</code>, such as <code>color</code>, <code>size</code> etc, to plot the error bar in either standard error (<code>errorbar_type = se</code>), standard deviation (<code>errorbar_type = sd</code>) or 95% confidence interval (<code>errorbar_type = ci</code>).</p>
<ul>
<li><code>err.params</code> can be used to control the average point as well because it is connected to the error bar.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day,</span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Day)) <span class="sc">+</span></span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb553-4"><a href="#cb553-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="fl">1.2</span>)) <span class="sc">+</span> </span>
<span id="cb553-5"><a href="#cb553-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-436-1.png" width="336" /></p>
<ul>
<li><p><code>violin.params</code> feeds the arguments to <code>geom_violin()</code>, such as <code>color</code> and <code>fill</code>, to plot the violin.</p></li>
<li><p><code>point_jitter_width</code> lets you control the width of the jitter of the individual points.</p></li>
</ul>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-437-1.png" width="336" /></p>
<ul>
<li><code>points = FALSE</code> removes all the individual points.</li>
</ul>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-438-1.png" width="336" /></p>
<div id="plotting-individual-points-with-unique-colors-2" class="section level3 hasAnchor" number="11.7.1">
<h3 class="hasAnchor"><span class="header-section-number">11.7.1</span> Plotting individual points with unique colors<a href="#plotting-individual-points-with-unique-colors-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Set <code>color = Subject</code> to plot individual points with unique colors.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject,</span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Day)) <span class="sc">+</span></span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-439-1.png" width="336" /></p>
</div>
</div>
<div id="bar-plot---sm_bar" class="section level2 hasAnchor" number="11.8">
<h2 class="hasAnchor"><span class="header-section-number">11.8</span> Bar plot - <code>sm_bar()</code><a href="#bar-plot---sm_bar" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sm_bar()</code> automatically uses <code>sm_hgrid()</code>.</p>
<ul>
<li>It also has arguments <code>borders</code> and <code>legends</code>, the latter of which has been set to <code>FALSE</code> as default.</li>
</ul>
<p>Let’s use data (<code>df</code>) we generated before to explore this function.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-440-1.png" width="336" /></p>
<p>In this case, the error bar represents <strong>standard error</strong>. If you prefer to show <strong>standard deviation</strong>, then you should set <code>errorbar_type  = 'sd'</code> in <code>sm_bar()</code>.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-441-1.png" width="336" /></p>
<p>95% confidence interval can also be displayed with <code>errorbar_type  = 'ci'</code>.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>) <span class="sc">+</span></span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-442-1.png" width="336" /></p>
<p>Jitter’s width can be controlled using <code>point_jitter_width</code>.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>,</span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">point_jitter_width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-443-1.png" width="336" /></p>
<p>You can also adjust different parameters of the bar graph using <code>bar.params</code>, <code>err.params</code> and <code>point.params</code>.</p>
<ul>
<li><code>bar.params = list()</code> sends arguments, such as <code>color</code>, <code>fill</code>, <code>width</code> and <code>alpha</code> to <code>geom_bar()</code> so that a bar is plotted.</li>
</ul>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb561-3"><a href="#cb561-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb561-4"><a href="#cb561-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;gray80&#39;</span>,</span>
<span id="cb561-5"><a href="#cb561-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb561-6"><a href="#cb561-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-444-1.png" width="336" /></p>
<ul>
<li><code>err.params = list()</code> sends arguments, such as <code>color</code>, to <code>geom_linerange()</code> so that an error bar is plotted.</li>
</ul>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>,</span>
<span id="cb562-3"><a href="#cb562-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb562-4"><a href="#cb562-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb562-5"><a href="#cb562-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;gray80&#39;</span>,</span>
<span id="cb562-6"><a href="#cb562-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">width =</span> <span class="fl">0.5</span>),</span>
<span id="cb562-7"><a href="#cb562-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;gray40&#39;</span>,</span>
<span id="cb562-8"><a href="#cb562-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb562-9"><a href="#cb562-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-445-1.png" width="336" /></p>
<ul>
<li><code>point.params = list()</code> feeds arguments, such as <code>color</code>, <code>fill</code>, and <code>alpha</code> to <code>geom_point()</code> to so that individual points are plotted.</li>
</ul>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>,</span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&#39;gray80&#39;</span>,</span>
<span id="cb563-6"><a href="#cb563-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">width =</span> <span class="fl">0.5</span>),</span>
<span id="cb563-7"><a href="#cb563-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;gray40&#39;</span>,</span>
<span id="cb563-8"><a href="#cb563-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb563-9"><a href="#cb563-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">15</span>,</span>
<span id="cb563-10"><a href="#cb563-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alpha =</span> <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb563-11"><a href="#cb563-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-446-1.png" width="336" /></p>
<ul>
<li><code>...</code> is generic parameter that can affect different components of the bar graph, error bar and points if these do not have defaults set within <code>bar.params = list()</code>, <code>err.params = list()</code> and <code>point.params = list()</code>.</li>
</ul>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb564-4"><a href="#cb564-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-447-1.png" width="336" /></p>
<p>Notice that <code>fill</code> of the bar is still <code>gray80</code>, as well as <code>color</code> (border color) not being <code>black</code>, because <code>bar.params</code> has defaults, You can remove it by writing <code>bar.params = list()</code>.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb565-4"><a href="#cb565-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">bar.params =</span> <span class="fu">list</span>()) <span class="sc">+</span></span>
<span id="cb565-5"><a href="#cb565-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-448-1.png" width="336" /></p>
<p>Note that <code>width</code> as a generic parameters get applied to <code>geom_bar()</code> only because none other visual components recognize <code>width</code> parameter.</p>
<div id="plotting-individual-points-with-unique-colors-3" class="section level3 hasAnchor" number="11.8.1">
<h3 class="hasAnchor"><span class="header-section-number">11.8.1</span> Plotting individual points with unique colors<a href="#plotting-individual-points-with-unique-colors-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As before with <code>sm_boxplot()</code> and <code>sm_violin()</code>, to plot individual points with unique colors, set <code>color = Subject</code>.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb566-3"><a href="#cb566-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-449-1.png" width="336" /></p>
<p><code>sm_bar()</code> can also print distinct box colors across distinct x levels. This requires the defaults of <code>bar.params</code> to be reset. Therefore, it needs to be written as <code>bar.params = list()</code>.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject,</span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>)) <span class="sc">+</span></span>
<span id="cb567-4"><a href="#cb567-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb567-5"><a href="#cb567-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-450-1.png" width="336" /></p>
<p>To set one color across all points, you need to remove <code>color = Subject</code>. <code>point.params</code> can be specified to control the aesthetics of the points.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb568-4"><a href="#cb568-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;gray90&#39;</span>,</span>
<span id="cb568-5"><a href="#cb568-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="fl">2.2</span>)) <span class="sc">+</span></span>
<span id="cb568-6"><a href="#cb568-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-451-1.png" width="336" /></p>
<p>This is an example where the bar and points have unique colors per group.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb569-4"><a href="#cb569-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb569-5"><a href="#cb569-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb569-6"><a href="#cb569-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> <span class="st">&#39;white&#39;</span>)) <span class="sc">+</span></span>
<span id="cb569-7"><a href="#cb569-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-452-1.png" width="336" /></p>
<!--chapter:end:smplot2a.Rmd-->
</div>
</div>
</div>
<div id="slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2" class="section level1 hasAnchor" number="12">
<h1 class="hasAnchor"><span class="header-section-number">12</span> Slope Charts, Point plots, Bland-Altman, Forests, Rainclouds, Histograms (Part 2)<a href="#slope-charts-point-plots-bland-altman-forests-rainclouds-histograms-part-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As in the previous chapter, if you want to find certain bits of information about the package on this page, the best way to do so is to <strong>CTRL + F</strong> certain key words.</p>
<div id="slope-chart---sm_slope" class="section level2 hasAnchor" number="12.1">
<h2 class="hasAnchor"><span class="header-section-number">12.1</span> Slope chart - <code>sm_slope()</code><a href="#slope-chart---sm_slope" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A slope chart is popular when changes between two different time points for each measurement (ex. a participant) are described.</p>
<p>We will generate some random data to discuss <code>sm_slope()</code>.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-4"><a href="#cb570-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb570-5"><a href="#cb570-5" aria-hidden="true" tabindex="-1"></a>before <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb570-6"><a href="#cb570-6" aria-hidden="true" tabindex="-1"></a>after <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb570-7"><a href="#cb570-7" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb570-8"><a href="#cb570-8" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(before,after),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb570-9"><a href="#cb570-9" aria-hidden="true" tabindex="-1"></a>beforeAfter <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(before))</span>
<span id="cb570-10"><a href="#cb570-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, beforeAfter)</span></code></pre></div>
<p>Each level of <code>x</code> has to be categorical to use <code>sm_slope()</code>. In other words, the x-axis cannot be <strong>continuous</strong>. It has to be <strong>discrete</strong>.</p>
<ul>
<li>It should take the form of <code>character</code> or <code>factor</code> (ex. ‘One’, ‘Two’, ‘Three’), not <code>double</code>.</li>
<li>If x-axis only has number (i.e., <code>double</code> form, such as 1.02, 1.05, 1.5), then <code>sm_slope()</code> will produce an error.</li>
</ul>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>beforeAfter <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>beforeAfter, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>,<span class="st">&#39;After&#39;</span>))</span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>beforeAfter</span></code></pre></div>
<pre><code>##  [1] Before Before Before Before Before Before Before Before Before Before Before Before
## [13] Before Before Before Before Before Before Before Before After  After  After  After 
## [25] After  After  After  After  After  After  After  After  After  After  After  After 
## [37] After  After  After  After 
## Levels: Before After</code></pre>
<p><code>sm_slope()</code> draws a slope chart.</p>
<ul>
<li>It has the argument <code>legends</code>, which has been set to <code>FALSE</code> as the default.</li>
<li>It automatically uses <code>sm_slope_theme()</code>.</li>
</ul>
<p>First and foremost, <code>group</code> argument has to be specified within <code>sm_slope()</code>.</p>
<ul>
<li>ex. <code>group = Subject</code>, where <code>Subject</code> is the name of the column carrying identifers for individuals, means that each individual line will be grouped for each observation.</li>
</ul>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-455-1.png" width="307.2" /></p>
<p><code>labels</code> argument decides the x-axis tick <code>sm_slope()</code>. If it is empty, it will choose alphabetical <code>letters</code>.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb574-3"><a href="#cb574-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>)) <span class="sc">+</span></span>
<span id="cb574-4"><a href="#cb574-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-456-1.png" width="307.2" /></p>
<p>Same color can also be set across the factors (x-level).</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>)) <span class="sc">+</span></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-457-1.png" width="307.2" /></p>
<div id="drawing-the-mean-plot" class="section level3 hasAnchor" number="12.1.1">
<h3 class="hasAnchor"><span class="header-section-number">12.1.1</span> Drawing the mean plot<a href="#drawing-the-mean-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When <code>show_mean = TRUE</code>, then the average plot will be shown.</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb576-3"><a href="#cb576-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb576-4"><a href="#cb576-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb576-5"><a href="#cb576-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-458-1.png" width="307.2" /></p>
<p>If <code>show_err = TRUE</code>, then the error bar will be displayed.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value, <span class="at">fill =</span> beforeAfter)) <span class="sc">+</span></span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb577-3"><a href="#cb577-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb577-4"><a href="#cb577-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb577-5"><a href="#cb577-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb577-6"><a href="#cb577-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>  <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-459-1.png" width="307.2" /></p>
<p><code>sm_slope()</code> has many several arguments:</p>
<ul>
<li><code>point.params</code> feeds arguments to <code>geom_point()</code> to plot the individual points with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb578-4"><a href="#cb578-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb578-5"><a href="#cb578-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb578-6"><a href="#cb578-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb578-7"><a href="#cb578-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.65</span>,</span>
<span id="cb578-8"><a href="#cb578-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-460-1.png" width="288" /></p>
<ul>
<li><code>line.params</code> feeds arguments to <code>geom_line()</code> to plot the points with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb579-2"><a href="#cb579-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb579-3"><a href="#cb579-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb579-4"><a href="#cb579-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb579-5"><a href="#cb579-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb579-6"><a href="#cb579-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb579-7"><a href="#cb579-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.65</span>,</span>
<span id="cb579-8"><a href="#cb579-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb579-9"><a href="#cb579-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb579-10"><a href="#cb579-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb579-11"><a href="#cb579-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-461-1.png" width="307.2" /></p>
<ul>
<li><code>avgPoint.params</code> feeds arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb580-2"><a href="#cb580-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb580-3"><a href="#cb580-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb580-4"><a href="#cb580-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb580-5"><a href="#cb580-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb580-6"><a href="#cb580-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb580-7"><a href="#cb580-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb580-8"><a href="#cb580-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.65</span>,</span>
<span id="cb580-9"><a href="#cb580-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb580-10"><a href="#cb580-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb580-11"><a href="#cb580-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb580-12"><a href="#cb580-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb580-13"><a href="#cb580-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb580-14"><a href="#cb580-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-462-1.png" width="307.2" /></p>
<ul>
<li><code>avgLine.params</code> feeds arguments to <code>geom_line()</code> to plot the average plot (line) with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb581-3"><a href="#cb581-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb581-4"><a href="#cb581-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb581-5"><a href="#cb581-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb581-6"><a href="#cb581-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb581-7"><a href="#cb581-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb581-8"><a href="#cb581-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.65</span>,</span>
<span id="cb581-9"><a href="#cb581-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb581-10"><a href="#cb581-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb581-11"><a href="#cb581-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb581-12"><a href="#cb581-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb581-13"><a href="#cb581-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb581-14"><a href="#cb581-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb581-15"><a href="#cb581-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-463-1.png" width="307.2" /></p>
<ul>
<li><code>err.params</code> feeds arguments to <code>geom_linerange()</code> to plot the error bar with specified <code>color</code>, <code>size</code> etc.</li>
</ul>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb582-3"><a href="#cb582-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>, </span>
<span id="cb582-4"><a href="#cb582-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>,</span>
<span id="cb582-5"><a href="#cb582-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb582-6"><a href="#cb582-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb582-7"><a href="#cb582-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb582-8"><a href="#cb582-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb582-9"><a href="#cb582-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.65</span>,</span>
<span id="cb582-10"><a href="#cb582-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb582-11"><a href="#cb582-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb582-12"><a href="#cb582-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb582-13"><a href="#cb582-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb582-14"><a href="#cb582-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb582-15"><a href="#cb582-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb582-16"><a href="#cb582-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb582-17"><a href="#cb582-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-464-1.png" width="307.2" /></p>
<ul>
<li><p><code>xtick.params</code> feeds arguments to <code>scale_x_discrete()</code> so that the user can have control over specific aesthetics of the x-tick. Type <code>?scale_x_discrete()</code> for more information.</p></li>
<li><p><code>errorbar_type</code> can be used to set the error bar type in the mean plot. The default is <code>errorbar_type = 'sd'</code>. Two other types are <code>ci</code> (95% confidence interval) and <code>se</code> (standard error).</p></li>
</ul>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb583-2"><a href="#cb583-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb583-3"><a href="#cb583-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>, </span>
<span id="cb583-4"><a href="#cb583-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>,</span>
<span id="cb583-5"><a href="#cb583-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb583-6"><a href="#cb583-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb583-7"><a href="#cb583-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb583-8"><a href="#cb583-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb583-9"><a href="#cb583-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.65</span>,</span>
<span id="cb583-10"><a href="#cb583-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb583-11"><a href="#cb583-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb583-12"><a href="#cb583-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb583-13"><a href="#cb583-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb583-14"><a href="#cb583-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb583-15"><a href="#cb583-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb583-16"><a href="#cb583-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb583-17"><a href="#cb583-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb583-18"><a href="#cb583-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-465-1.png" width="307.2" /></p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> beforeAfter, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">group =</span> Subject,</span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>, </span>
<span id="cb584-4"><a href="#cb584-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_err =</span> <span class="cn">TRUE</span>,</span>
<span id="cb584-5"><a href="#cb584-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>),</span>
<span id="cb584-6"><a href="#cb584-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb584-7"><a href="#cb584-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb584-8"><a href="#cb584-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb584-9"><a href="#cb584-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">stroke =</span> <span class="fl">0.65</span>,</span>
<span id="cb584-10"><a href="#cb584-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb584-11"><a href="#cb584-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb584-12"><a href="#cb584-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb584-13"><a href="#cb584-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb584-14"><a href="#cb584-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb584-15"><a href="#cb584-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb584-16"><a href="#cb584-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb584-17"><a href="#cb584-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)),</span>
<span id="cb584-18"><a href="#cb584-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">errorbar_type =</span> <span class="st">&#39;se&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-466-1.png" width="307.2" /></p>
<ul>
<li><code>many_groups</code> decides whether the average plot is based on all individual data across groups or per group.</li>
</ul>
<p>To show how this function works, we will need to use data with multiple groups and timepoints.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb585-2"><a href="#cb585-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb585-3"><a href="#cb585-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb585-4"><a href="#cb585-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">7.5</span>,<span class="dv">1</span>))</span>
<span id="cb585-5"><a href="#cb585-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;N&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb585-6"><a href="#cb585-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb585-7"><a href="#cb585-7" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb585-8"><a href="#cb585-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb585-9"><a href="#cb585-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Normal&#39;</span></span>
<span id="cb585-10"><a href="#cb585-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb585-11"><a href="#cb585-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">191</span>) <span class="co"># generate random data</span></span>
<span id="cb585-12"><a href="#cb585-12" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb585-13"><a href="#cb585-13" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.8</span>,<span class="dv">1</span>))</span>
<span id="cb585-14"><a href="#cb585-14" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.3</span>,<span class="dv">1</span>))</span>
<span id="cb585-15"><a href="#cb585-15" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb585-16"><a href="#cb585-16" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb585-17"><a href="#cb585-17" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb585-18"><a href="#cb585-18" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb585-19"><a href="#cb585-19" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Patients&#39;</span></span>
<span id="cb585-20"><a href="#cb585-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb585-21"><a href="#cb585-21" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df2)</span></code></pre></div>
<p>If we plot a slope chart, <code>sm_slope(..., show_mean = TRUE)</code> using data of multiple groups while <code>many_groups = FALSE</code>, we will draw a single average plot across all groups.</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb586-2"><a href="#cb586-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb586-3"><a href="#cb586-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb586-4"><a href="#cb586-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb586-5"><a href="#cb586-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb586-6"><a href="#cb586-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb586-7"><a href="#cb586-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb586-8"><a href="#cb586-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb586-9"><a href="#cb586-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb586-10"><a href="#cb586-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>,</span>
<span id="cb586-11"><a href="#cb586-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb586-12"><a href="#cb586-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;darkred&#39;</span>)) <span class="sc">+</span></span>
<span id="cb586-13"><a href="#cb586-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb586-14"><a href="#cb586-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb586-15"><a href="#cb586-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb586-16"><a href="#cb586-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-468-1.png" width="364.8" /></p>
<p>To prevent this from happening, set <code>many_groups = TRUE</code>.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> group, </span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), </span>
<span id="cb587-4"><a href="#cb587-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Subject,</span>
<span id="cb587-5"><a href="#cb587-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb587-6"><a href="#cb587-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb587-7"><a href="#cb587-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb587-8"><a href="#cb587-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb587-9"><a href="#cb587-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb587-10"><a href="#cb587-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">many_groups =</span> <span class="cn">TRUE</span>,</span>
<span id="cb587-11"><a href="#cb587-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">legends =</span> <span class="cn">TRUE</span>,</span>
<span id="cb587-12"><a href="#cb587-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_mean =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb587-13"><a href="#cb587-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>,<span class="st">&#39;darkred&#39;</span>)) <span class="sc">+</span></span>
<span id="cb587-14"><a href="#cb587-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb587-15"><a href="#cb587-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.85</span>),</span>
<span id="cb587-16"><a href="#cb587-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb587-17"><a href="#cb587-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-469-1.png" width="364.8" /></p>
</div>
</div>
<div id="point-plot---sm_pointplot" class="section level2 hasAnchor" number="12.2">
<h2 class="hasAnchor"><span class="header-section-number">12.2</span> Point plot - <code>sm_pointplot()</code><a href="#point-plot---sm_pointplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A point plot is typically an average plot with error bars. <code>sm_pointplot()</code> is useful if the data has many groups or if the user wants to include a shadow of individual points behind the (average) point plot. The function accepts <code>legends</code> and <code>borders</code> like other <strong>smplot2</strong> functions.</p>
<p>Let’s generate some random data. .</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">201</span>) <span class="co"># generate random data</span></span>
<span id="cb588-2"><a href="#cb588-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb588-3"><a href="#cb588-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb588-4"><a href="#cb588-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">4.1</span>,<span class="fl">2.2</span>))</span>
<span id="cb588-5"><a href="#cb588-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;N&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb588-6"><a href="#cb588-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb588-7"><a href="#cb588-7" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb588-8"><a href="#cb588-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb588-9"><a href="#cb588-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Normal&#39;</span></span>
<span id="cb588-10"><a href="#cb588-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-11"><a href="#cb588-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">191</span>) <span class="co"># generate random data</span></span>
<span id="cb588-12"><a href="#cb588-12" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb588-13"><a href="#cb588-13" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.8</span>,<span class="dv">1</span>))</span>
<span id="cb588-14"><a href="#cb588-14" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.3</span>,<span class="fl">1.5</span>))</span>
<span id="cb588-15"><a href="#cb588-15" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;M&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb588-16"><a href="#cb588-16" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb588-17"><a href="#cb588-17" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb588-18"><a href="#cb588-18" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb588-19"><a href="#cb588-19" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Myopia&#39;</span></span>
<span id="cb588-20"><a href="#cb588-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-21"><a href="#cb588-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1291</span>) <span class="co"># generate random data</span></span>
<span id="cb588-22"><a href="#cb588-22" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb588-23"><a href="#cb588-23" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.2</span>,<span class="dv">1</span>))</span>
<span id="cb588-24"><a href="#cb588-24" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">3.3</span>,<span class="fl">1.8</span>))</span>
<span id="cb588-25"><a href="#cb588-25" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;A&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">3</span>)</span>
<span id="cb588-26"><a href="#cb588-26" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb588-27"><a href="#cb588-27" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb588-28"><a href="#cb588-28" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb588-29"><a href="#cb588-29" aria-hidden="true" tabindex="-1"></a>df3<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&#39;Amblyopia&#39;</span></span>
<span id="cb588-30"><a href="#cb588-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-31"><a href="#cb588-31" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df2,df3) <span class="co"># three groups of individuals, three time points</span></span></code></pre></div>
<p><code>sm_pointplot()</code> groups each observation to plot the line. So, the grouping <strong>always</strong> needs to be specified: <code>ggplot(aes(x = ..., y = ..., group = xxx))</code>.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-471-1.png" width="336" /></p>
<p>We can customise the colors using <code>sm_color_manual()</code>.</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">sm_palette</span>(<span class="dv">20</span>),<span class="dv">3</span>) <span class="co"># pick random 3 colors</span></span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-4"><a href="#cb590-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb590-5"><a href="#cb590-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb590-6"><a href="#cb590-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">legends =</span> T) <span class="sc">+</span></span>
<span id="cb590-7"><a href="#cb590-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span></span>
<span id="cb590-8"><a href="#cb590-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.22</span>,<span class="fl">0.83</span>), <span class="co"># add legend</span></span>
<span id="cb590-9"><a href="#cb590-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-472-1.png" width="336" /></p>
<p>The problem with this plot is that we do not clearly see the error bars, especially the ones of the <code>Amblyopia</code> plot.</p>
<p>To resolve this, we will need to explore the parameters of <code>sm_pointplot()</code>.</p>
<ul>
<li><code>...</code> is the generic parameter that controls all aspects of the plot.
<ul>
<li>This will be important to apply <code>position_dodge()</code> to prevent the overlap of the plots.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb591-3"><a href="#cb591-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">legends =</span> T,</span>
<span id="cb591-4"><a href="#cb591-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">05</span>)) <span class="sc">+</span></span>
<span id="cb591-5"><a href="#cb591-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span></span>
<span id="cb591-6"><a href="#cb591-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.22</span>,<span class="fl">0.83</span>), <span class="co"># add legend</span></span>
<span id="cb591-7"><a href="#cb591-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-473-1.png" width="336" /></p>
<ul>
<li><code>avgPoint.params</code> feeds arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</li>
</ul>
<p>Remember that in this case, all three plots show the average, not the individual data.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb592-3"><a href="#cb592-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">legends =</span> T,</span>
<span id="cb592-4"><a href="#cb592-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">05</span>),</span>
<span id="cb592-5"><a href="#cb592-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb592-6"><a href="#cb592-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">shape =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb592-7"><a href="#cb592-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span></span>
<span id="cb592-8"><a href="#cb592-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.22</span>,<span class="fl">0.83</span>), <span class="co"># add legend</span></span>
<span id="cb592-9"><a href="#cb592-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-474-1.png" width="336" /></p>
<ul>
<li><code>avgLine.params</code> feeds arguments to <code>geom_line()</code> to plot the average line with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb593-2"><a href="#cb593-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb593-3"><a href="#cb593-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">legends =</span> T,</span>
<span id="cb593-4"><a href="#cb593-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">05</span>),</span>
<span id="cb593-5"><a href="#cb593-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb593-6"><a href="#cb593-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">shape =</span> <span class="dv">15</span>),</span>
<span id="cb593-7"><a href="#cb593-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb593-8"><a href="#cb593-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span></span>
<span id="cb593-9"><a href="#cb593-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.22</span>,<span class="fl">0.83</span>), <span class="co"># add legend</span></span>
<span id="cb593-10"><a href="#cb593-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-475-1.png" width="336" /></p>
<ul>
<li><p><code>point.params</code> feeds arguments to <code>geom_point()</code> to plot the points in the shadow with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</p></li>
<li><p><code>line.params</code> feeds arguments to <code>geom_line()</code> to plot the lines in the shadow with specified <code>color</code>, <code>size</code> and <code>alpha</code>.</p></li>
</ul>
<p>To show these parameters, we will need to plot data only from one group.</p>
<p>Let’s display the shadow by setting <code>show_shadow = TRUE</code>. To show the <code>shadow</code>, <code>group</code> argument has to be included, which represents the variable by which each individual observation is grouped across the x-axis. In this case, it would be <code>group = Subject</code>.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb594-2"><a href="#cb594-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">show_shadow =</span> T,</span>
<span id="cb594-3"><a href="#cb594-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">group =</span> Subject)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-476-1.png" width="336" /></p>
<p>By using <code>point.params</code> and <code>line.params</code>, you can control the aesthetics of the shadow.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">show_shadow =</span> T,</span>
<span id="cb595-3"><a href="#cb595-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">group =</span> Subject,</span>
<span id="cb595-4"><a href="#cb595-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb595-5"><a href="#cb595-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>),</span>
<span id="cb595-6"><a href="#cb595-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb595-7"><a href="#cb595-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb595-8"><a href="#cb595-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>),</span>
<span id="cb595-9"><a href="#cb595-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">alpha =</span> <span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-477-1.png" width="336" /></p>
<p>Now let’s control the aesthetics of the average plot using <code>avgPoint.params</code>, <code>avgLine.params</code> and <code>err.params</code>.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb596-2"><a href="#cb596-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">show_shadow =</span> T,</span>
<span id="cb596-3"><a href="#cb596-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">group =</span> Subject,</span>
<span id="cb596-4"><a href="#cb596-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb596-5"><a href="#cb596-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>),</span>
<span id="cb596-6"><a href="#cb596-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb596-7"><a href="#cb596-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb596-8"><a href="#cb596-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>),</span>
<span id="cb596-9"><a href="#cb596-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb596-10"><a href="#cb596-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb596-11"><a href="#cb596-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb596-12"><a href="#cb596-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb596-13"><a href="#cb596-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">stroke =</span> <span class="fl">0.8</span>,</span>
<span id="cb596-14"><a href="#cb596-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>)),</span>
<span id="cb596-15"><a href="#cb596-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb596-16"><a href="#cb596-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb596-17"><a href="#cb596-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>)),</span>
<span id="cb596-18"><a href="#cb596-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb596-19"><a href="#cb596-19" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb596-20"><a href="#cb596-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-478-1.png" width="336" /></p>
<ul>
<li><code>errorbar_type</code> can control the type of the error that is shown on the point plot. The three choices are standard error (<code>se</code>), standard deviation (<code>sd</code>) and 95% confidence interval (<code>ci</code>).</li>
</ul>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_pointplot</span>(<span class="at">show_shadow =</span> T,</span>
<span id="cb597-3"><a href="#cb597-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">group =</span> Subject,</span>
<span id="cb597-4"><a href="#cb597-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>,</span>
<span id="cb597-5"><a href="#cb597-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb597-6"><a href="#cb597-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>),</span>
<span id="cb597-7"><a href="#cb597-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb597-8"><a href="#cb597-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">line.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb597-9"><a href="#cb597-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>),</span>
<span id="cb597-10"><a href="#cb597-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">alpha =</span> <span class="fl">0.2</span>),</span>
<span id="cb597-11"><a href="#cb597-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb597-12"><a href="#cb597-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb597-13"><a href="#cb597-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb597-14"><a href="#cb597-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">stroke =</span> <span class="fl">0.8</span>,</span>
<span id="cb597-15"><a href="#cb597-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>)),</span>
<span id="cb597-16"><a href="#cb597-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">avgLine.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb597-17"><a href="#cb597-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb597-18"><a href="#cb597-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>)),</span>
<span id="cb597-19"><a href="#cb597-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb597-20"><a href="#cb597-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb597-21"><a href="#cb597-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;purple&#39;</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-479-1.png" width="336" /></p>
</div>
<div id="a-bland-altman-plot---sm_bland_altman" class="section level2 hasAnchor" number="12.3">
<h2 class="hasAnchor"><span class="header-section-number">12.3</span> A Bland Altman plot - <code>sm_bland_altman()</code><a href="#a-bland-altman-plot---sm_bland_altman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sm_bland_altman()</code> and <code>sm_statBlandAlt()</code> functions can be used to create a Bland-Altman plot.</p>
<ul>
<li>The plot is used to measure agreement between two different measurements.</li>
<li>It is also used to measure test-retest variability of a method.</li>
</ul>
<p>Let’s generate some random data to explore these two functions.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb598-2"><a href="#cb598-2" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb598-3"><a href="#cb598-3" aria-hidden="true" tabindex="-1"></a>second <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb598-4"><a href="#cb598-4" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(first,second)) <span class="co"># requires library(tidyverse)</span></span></code></pre></div>
<p>Now let’s draw a Bland Altman plot using <code>sm_bland_altman()</code>, which requires two arguments: first dataset, second dataset. They have to be numerical vectors of equal length.
- This function automatically uses <code>sm_classic()</code> theme.</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb599-2"><a href="#cb599-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-481-1.png" width="336" /></p>
<ul>
<li><p>The upper dashed line represents the upper limit of the difference between two measurements (mean difference + 1.96 * standard deviation of the difference).</p></li>
<li><p>The lower dashed line represents the lower limit of the difference between two measurements (mean difference - 1.96 * standard deviation of the difference).</p></li>
<li><p>The middle dashed line represents the mean difference.</p></li>
<li><p>The shaded region is the 95% confidence interval of the difference between the two measurements from one-sample t-test (difference vs 0).</p>
<ul>
<li>If the shaded region includes 0 in the y-axis, then there is no significant difference (p &gt; 0.05) between 0 and the difference.</li>
<li>If it does not include 0, then there is a significant difference. This indicates that the two measurement results are considerably different.</li>
</ul></li>
<li><p>I usually label them with <code>annotate()</code>, which is a function
from <strong>ggplot2</strong>. This process can be tedious.</p></li>
<li><p>Also, <code>sm_statBlandAlt()</code> calculates the statistical values that are
necessary to draw a Bland-Altman plot, such as the mean difference, upper and lower limits. This function is used to annotate the values in the plot.</p>
<ul>
<li>The arguments for this function are first and second datasets, just like in <code>sm_bland_altman()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">sm_statBlandAlt</span>(df3<span class="sc">$</span>first,df3<span class="sc">$</span>second) <span class="co"># store the results in res variable </span></span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb600-3"><a href="#cb600-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb600-4"><a href="#cb600-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb600-5"><a href="#cb600-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb600-6"><a href="#cb600-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb600-7"><a href="#cb600-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb600-8"><a href="#cb600-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb600-9"><a href="#cb600-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit<span class="fl">-0.4</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-482-1.png" width="336" /></p>
<ul>
<li>Let’s change the border color of the circles to white. To do so, we will have to change their shape to 21.</li>
</ul>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb601-2"><a href="#cb601-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb601-3"><a href="#cb601-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb601-4"><a href="#cb601-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb601-5"><a href="#cb601-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb601-6"><a href="#cb601-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb601-7"><a href="#cb601-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb601-8"><a href="#cb601-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit<span class="fl">-0.4</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-483-1.png" width="336" /></p>
</div>
<div id="forest-plot---sm_forest" class="section level2 hasAnchor" number="12.4">
<h2 class="hasAnchor"><span class="header-section-number">12.4</span> Forest plot - <code>sm_forest()</code><a href="#forest-plot---sm_forest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A forest plot can summarise data across multiple studies or experiments.</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb602-5"><a href="#cb602-5" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb602-6"><a href="#cb602-6" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb602-7"><a href="#cb602-7" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb602-8"><a href="#cb602-8" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb602-9"><a href="#cb602-9" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<p>When using <code>sm_forest()</code>, <code>x</code> is required to be a continuous variable. <code>y</code> should be a categorical variable (i.e., <code>factor</code>).</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb603-2"><a href="#cb603-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-485-1.png" width="297.6" /></p>
<p><code>sm_forest()</code> has many parameters.</p>
<ul>
<li><p><code>point_jitter_width</code> controls the width of the jitter in individual points.</p></li>
<li><p><code>sep_level</code> controls the separation level between the average point and the individual points.</p>
<ul>
<li>The difference between <code>sm_raincloud</code> and <code>sm_forest()</code> is that <code>sep_level</code> in <code>sm_forest()</code> does not have a limit to its range compared to 0-4 in <code>sm_raincloud()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb604-2"><a href="#cb604-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>, <span class="at">sep_level =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb604-3"><a href="#cb604-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-486-1.png" width="297.6" /></p>
<p><code>sep_level</code> can also be negative. The position of the points relative to the average points will be opposite (individual points above average points).</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb605-2"><a href="#cb605-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>, <span class="at">sep_level =</span> <span class="sc">-</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb605-3"><a href="#cb605-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-487-1.png" width="297.6" /></p>
<ul>
<li><code>errorbar_type</code> controls the type of the error bar.
<ul>
<li>The default error bar type is 95% confidence interval (<code>errorbar_type = 'ci'</code>). You can change it to either standard error (<code>'se'</code>) or standard deviation (<code>'sd'</code>). Here is standard deviation.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>, <span class="at">sep_level =</span> <span class="dv">3</span>,</span>
<span id="cb606-3"><a href="#cb606-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb606-4"><a href="#cb606-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-488-1.png" width="297.6" /></p>
<ul>
<li>If <code>points = FALSE</code>, the points will not be shown.</li>
</ul>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb607-2"><a href="#cb607-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>, <span class="at">sep_level =</span> <span class="dv">3</span>,</span>
<span id="cb607-3"><a href="#cb607-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb607-4"><a href="#cb607-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-489-1.png" width="297.6" /></p>
<ul>
<li>If <code>refLine = TRUE</code>, the reference line will be shown. Its location along the x-axis can be controlled by <code>xintercept</code> (default: <code>xintercept = 0</code>).</li>
</ul>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">point_jitter_width =</span> <span class="fl">0.2</span>, <span class="at">sep_level =</span> <span class="dv">3</span>,</span>
<span id="cb608-3"><a href="#cb608-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">refLine =</span> <span class="cn">TRUE</span>, <span class="at">xintercept =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb608-4"><a href="#cb608-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-490-1.png" width="297.6" /></p>
<p><code>sm_forest()</code> has <code>xxx.params</code> arguments as well as <code>...</code> generic parameter:</p>
<ul>
<li><code>avgPoint.params</code> feeds arguments to <code>geom_point()</code> to plot the average point with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb609-2"><a href="#cb609-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb609-3"><a href="#cb609-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb609-4"><a href="#cb609-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-491-1.png" width="297.6" /></p>
<ul>
<li><code>err.params = list()</code> feeds arguments, such as <code>color</code> and <code>size</code>, to <code>geom_linerange()</code> to plot the error bar.</li>
</ul>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb610-3"><a href="#cb610-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb610-4"><a href="#cb610-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb610-5"><a href="#cb610-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-492-1.png" width="297.6" /></p>
<p>Notice that the default color of <code>err.params = list(color = 'black')</code> has disappeared. You could manually include it to restore the default.</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb611-3"><a href="#cb611-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb611-4"><a href="#cb611-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb611-5"><a href="#cb611-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)) <span class="sc">+</span></span>
<span id="cb611-6"><a href="#cb611-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-493-1.png" width="297.6" /></p>
<ul>
<li><code>point.params = list()</code> feeds arguments, such as <code>color</code>, <code>fill</code>, and <code>alpha</code> to <code>geom_point()</code> to plot the individual points.</li>
</ul>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb612-4"><a href="#cb612-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb612-5"><a href="#cb612-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">color =</span> <span class="st">&#39;black&#39;</span>),</span>
<span id="cb612-6"><a href="#cb612-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb612-7"><a href="#cb612-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb612-8"><a href="#cb612-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size =</span> <span class="fl">2.2</span>)) <span class="sc">+</span></span>
<span id="cb612-9"><a href="#cb612-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-494-1.png" width="297.6" /></p>
<ul>
<li><code>refLine.params = list()</code> feeds arguments, such as <code>color</code> and <code>size</code> to <code>geom_vline()</code> to plot the reference line.</li>
</ul>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">refLine =</span> <span class="cn">TRUE</span>, </span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">avgPoint.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb613-4"><a href="#cb613-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">4</span>),</span>
<span id="cb613-5"><a href="#cb613-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">err.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb613-6"><a href="#cb613-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">color =</span> <span class="st">&#39;black&#39;</span>),</span>
<span id="cb613-7"><a href="#cb613-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb613-8"><a href="#cb613-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb613-9"><a href="#cb613-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size =</span> <span class="fl">2.2</span>),</span>
<span id="cb613-10"><a href="#cb613-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">ref.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb613-11"><a href="#cb613-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>)) <span class="sc">+</span></span>
<span id="cb613-12"><a href="#cb613-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-495-1.png" width="297.6" /></p>
<div id="annotation-using-sm_forest_annot" class="section level3 hasAnchor" number="12.4.1">
<h3 class="hasAnchor"><span class="header-section-number">12.4.1</span> Annotation using <code>sm_forest_annot()</code><a href="#annotation-using-sm_forest_annot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Annotations about the error range (ex. 95% confidence interval) in texts can be done using <code>sm_forest_annot()</code>.</p>
<p><code>sm_forest_annot()</code> has various arguments:</p>
<ul>
<li><p>The <code>data</code> refers to the name of the data frame that is used in <code>ggplot()</code>.</p></li>
<li><p><code>x</code> argument is the x variable that is used in <code>ggplot()</code>.</p></li>
<li><p><code>y</code> argument is the variable that is used in <code>ggplot()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb614-2"><a href="#cb614-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>() <span class="sc">+</span></span>
<span id="cb614-3"><a href="#cb614-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb614-4"><a href="#cb614-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-496-1.png" width="297.6" /></p>
<ul>
<li><code>sep_level</code> refers to the separation level between the text annotation and the average point. If it is positive, the text will be above the mean point. <strong>In practice, put the same value of</strong> <code>sep_level</code> <strong>in both</strong> <code>sm_forest()</code> <strong>and </strong><code>sm_forest_annot()</code>. The default is <code>sep_level = 2</code>, which is also found in <code>sm_forest()</code>.</li>
</ul>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a>sep_distance <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb615-2"><a href="#cb615-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb615-3"><a href="#cb615-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> sep_distance) <span class="sc">+</span></span>
<span id="cb615-4"><a href="#cb615-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb615-5"><a href="#cb615-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day,</span>
<span id="cb615-6"><a href="#cb615-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep_level =</span> sep_distance)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-497-1.png" width="297.6" /></p>
<ul>
<li><code>errorbar_type</code> refers to the type of error by which the text annotation should be written. <strong>In practice, put the same argument of</strong> <code>sep_level</code> <strong>in both</strong> <code>sm_forest()</code> <strong>and </strong><code>sm_forest_annot()</code>. The default is set to confidence interval (<code>errorbar_type = 'ci'</code>).</li>
</ul>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a>sep_distance <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true" tabindex="-1"></a>errType <span class="ot">&lt;-</span> <span class="st">&#39;sd&#39;</span></span>
<span id="cb616-3"><a href="#cb616-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-4"><a href="#cb616-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb616-5"><a href="#cb616-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> sep_distance,</span>
<span id="cb616-6"><a href="#cb616-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">errorbar_type =</span> errType) <span class="sc">+</span></span>
<span id="cb616-7"><a href="#cb616-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb616-8"><a href="#cb616-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day,</span>
<span id="cb616-9"><a href="#cb616-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep_level =</span> sep_distance,</span>
<span id="cb616-10"><a href="#cb616-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">errorbar_type =</span> errType)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-498-1.png" width="297.6" /></p>
<ul>
<li><code>text.params</code> feeds arguments to <code>geom_text()</code> to set the aesthetics of the texts such as <code>color</code> and <code>size</code>.</li>
</ul>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a>sep_distance <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a>errType <span class="ot">&lt;-</span> <span class="st">&#39;sd&#39;</span></span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb617-5"><a href="#cb617-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> sep_distance,</span>
<span id="cb617-6"><a href="#cb617-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">errorbar_type =</span> errType) <span class="sc">+</span></span>
<span id="cb617-7"><a href="#cb617-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb617-8"><a href="#cb617-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day,</span>
<span id="cb617-9"><a href="#cb617-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep_level =</span> sep_distance,</span>
<span id="cb617-10"><a href="#cb617-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">errorbar_type =</span> errType,</span>
<span id="cb617-11"><a href="#cb617-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">text.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">3.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-499-1.png" width="297.6" /></p>
<p>Notice that <code>text.params = list(color = 'black'</code>) has been removed because we have specifically wirtten <code>text.params = list()</code>. Therefore, there is now unique color to each <code>Day</code> as set within <code>ggplot(...,aes(color = Day))</code>.</p>
<p><code>sep_level</code> that is negative will shift the positions of the annotations and points.</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a>sep_distance <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true" tabindex="-1"></a>errType <span class="ot">&lt;-</span> <span class="st">&#39;sd&#39;</span></span>
<span id="cb618-3"><a href="#cb618-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-4"><a href="#cb618-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb618-5"><a href="#cb618-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest</span>(<span class="at">sep_level =</span> sep_distance,</span>
<span id="cb618-6"><a href="#cb618-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">errorbar_type =</span> errType) <span class="sc">+</span></span>
<span id="cb618-7"><a href="#cb618-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb618-8"><a href="#cb618-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_forest_annot</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Value, <span class="at">y =</span> Day,</span>
<span id="cb618-9"><a href="#cb618-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep_level =</span> sep_distance,</span>
<span id="cb618-10"><a href="#cb618-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">errorbar_type =</span> errType,</span>
<span id="cb618-11"><a href="#cb618-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">text.params =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">3.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-500-1.png" width="297.6" /></p>
</div>
</div>
<div id="raincloud-plot---sm_raincloud" class="section level2 hasAnchor" number="12.5">
<h2 class="hasAnchor"><span class="header-section-number">12.5</span> Raincloud plot - <code>sm_raincloud()</code><a href="#raincloud-plot---sm_raincloud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sm_raincloud()</code> generates the raincloud plot.</p>
<ul>
<li>It also has arguments <code>borders</code> and <code>legends</code> as it uses <code>sm_hgrid()</code> automatically.</li>
</ul>
<p>In this section, we will use this random data.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2343</span>) <span class="co"># generate random data</span></span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="fl">2.5</span>,<span class="dv">1</span>))</span>
<span id="cb619-3"><a href="#cb619-3" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb619-4"><a href="#cb619-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb619-5"><a href="#cb619-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(group1,group2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb619-6"><a href="#cb619-6" aria-hidden="true" tabindex="-1"></a>Group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Group 1&#39;</span>, <span class="st">&#39;Group 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(group1))</span>
<span id="cb619-7"><a href="#cb619-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Group)</span></code></pre></div>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb620-2"><a href="#cb620-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-502-1.png" width="336" /></p>
<p><code>fill</code> can be customised using <code>scale_fill_manual()</code>.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>() <span class="sc">+</span></span>
<span id="cb621-3"><a href="#cb621-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-503-1.png" width="336" /></p>
<p>Here, <code>x</code> has to be a categorical variable. <code>y</code> should be a continuous variable.</p>
<p><code>sm_raincloud()</code> has various parameters.</p>
<ul>
<li><p><code>point_jitter_width</code> controls the width of the jitter of individual points.</p></li>
<li><p><code>sep_level</code> (0-4) controls the separation level among the boxplot, violin plot and the points. The default is set to <code>sep_level = 2</code>.</p>
<ul>
<li><code>sep_level = 0</code> overlaps them. <code>sep_level = 4</code> separates them.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb622-2"><a href="#cb622-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">sep_level =</span> <span class="dv">4</span>,</span>
<span id="cb622-3"><a href="#cb622-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_jitter_width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb622-4"><a href="#cb622-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-504-1.png" width="336" /></p>
<ul>
<li><code>which_side</code> refers to the side where the distribution plot faces.
<ul>
<li><code>r</code> or <code>right</code> will face the distribution to the right (default).</li>
<li><code>l</code> or <code>left</code> will face the distribution to the left.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>) <span class="sc">+</span></span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-505-1.png" width="336" /></p>
<ul>
<li><code>vertical</code> controls the orientation of the raincloud plot. The default is set to <code>vertical = TRUE</code>. It refers to the fact that the distribution is vertically oriented.</li>
</ul>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb624-2"><a href="#cb624-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">vertical =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb624-3"><a href="#cb624-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-506-1.png" width="336" /></p>
<p><code>vertical = FALSE</code> and <code>which_side = 'right'</code> gives the true raincloud shape, the distribution plot being the cloud and the individual points being the rain.</p>
<ul>
<li><code>points</code> is an argument that determines whether the jittered individual points are shown on the plot.
<ul>
<li>The default is set to <code>points = TRUE</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb625-3"><a href="#cb625-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-507-1.png" width="336" /></p>
<p>Lastly, it has <code>xxx.params</code> to control the aesthetics of boxplots, violins and the points:</p>
<ul>
<li><code>boxplot.params</code> sends arguments to <code>geom_half_boxplot()</code> (almost identical to <code>geom_boxplot()</code>) to plot the boxplot with specified <code>color</code>, <code>fill</code>, <code>outlier.shape</code> etc.</li>
</ul>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb626-2"><a href="#cb626-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>)) <span class="sc">+</span></span>
<span id="cb626-3"><a href="#cb626-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-508-1.png" width="336" /></p>
<p>By setting the <code>color</code> (border of the boxplot) as <code>white</code>, I think the raincloud plot looks more elegant and minimalistic.</p>
<ul>
<li><code>violin.params</code> sends arguments to <code>geom_half_violin()</code> (almost identical to <code>geom_violin()</code>) to plot the violin plot with specified <code>color</code>, <code>alpha</code> and <code>fill</code>, etc</li>
</ul>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>),</span>
<span id="cb627-3"><a href="#cb627-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">violin.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb627-4"><a href="#cb627-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>)) <span class="sc">+</span></span>
<span id="cb627-5"><a href="#cb627-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-509-1.png" width="336" /></p>
<ul>
<li><code>point.params</code> sends arguments to <code>geom_point()</code> to plot the points in the shadow with specified <code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb628-2"><a href="#cb628-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>),</span>
<span id="cb628-3"><a href="#cb628-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">violin.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb628-4"><a href="#cb628-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb628-5"><a href="#cb628-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">stroke =</span> <span class="fl">0.8</span>,</span>
<span id="cb628-6"><a href="#cb628-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb628-7"><a href="#cb628-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb628-8"><a href="#cb628-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="fl">2.6</span>)) <span class="sc">+</span></span>
<span id="cb628-9"><a href="#cb628-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-510-1.png" width="336" /></p>
<p>You can also change the label of the x-axis tick using <code>scale_x_discrete()</code> rather than <code>scale_x_continuous()</code> from the original <strong>smplot</strong>.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_raincloud</span>(<span class="at">boxplot.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>),</span>
<span id="cb629-3"><a href="#cb629-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">violin.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb629-4"><a href="#cb629-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">color =</span> <span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb629-5"><a href="#cb629-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">stroke =</span> <span class="fl">0.8</span>,</span>
<span id="cb629-6"><a href="#cb629-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb629-7"><a href="#cb629-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb629-8"><a href="#cb629-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="fl">2.6</span>)) <span class="sc">+</span></span>
<span id="cb629-9"><a href="#cb629-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb629-10"><a href="#cb629-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>, <span class="st">&#39;Two&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-511-1.png" width="336" /></p>
</div>
<div id="histogram---sm_hist" class="section level2 hasAnchor" number="12.6">
<h2 class="hasAnchor"><span class="header-section-number">12.6</span> Histogram - <code>sm_hist()</code><a href="#histogram---sm_hist" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Histogram is used to show the distribution of data.</p>
<p>Using this random data, I will demonstrate <code>sm_hist()</code>.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb630-2"><a href="#cb630-2" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">value=</span><span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb630-3"><a href="#cb630-3" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">value=</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb630-4"><a href="#cb630-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="st">&#39;day1&#39;</span></span>
<span id="cb630-5"><a href="#cb630-5" aria-hidden="true" tabindex="-1"></a>data2<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="st">&#39;day2&#39;</span></span>
<span id="cb630-6"><a href="#cb630-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(data,data2) <span class="ot">-&gt;</span> df</span></code></pre></div>
<p>Let’s generate histogram just for <code>data</code>.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb631-2"><a href="#cb631-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-514-1.png" width="336" /></p>
<p><code>sm_hist()</code> has many arguments.</p>
<ul>
<li><code>histogram</code> can be used to show or not show the histogram.
<ul>
<li>The default is set to <code>histogram = TRUE</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb632-2"><a href="#cb632-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">histogram =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-515-1.png" width="336" /></p>
<ul>
<li><code>density</code> can be used to show or not show the density estimation plot.
<ul>
<li>The default is set to <code>density = TRUE</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">density =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-516-1.png" width="336" /></p>
<ul>
<li><code>rug</code> can be used to show or not show the rugs below the histogram.
<ul>
<li>The default is <code>rug = TRUE</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb634-2"><a href="#cb634-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">rug =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-517-1.png" width="336" /></p>
<ul>
<li><code>borders</code> can summon the borders when set to <code>borders = TRUE</code>.</li>
<li>The default is <code>borders = FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb635-2"><a href="#cb635-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">borders =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-518-1.png" width="336" /></p>
<ul>
<li><code>hist.params</code> feeds arguments to <code>geom_histogram()</code> that dictates the aesthetics of the histogram, such as <code>color</code>, <code>fill</code>, <code>alpha</code> and <code>binwidth</code>.
<ul>
<li><code>binwidth</code> refers to the width of the bins. It has to be included if the user wishes to write <code>hist.params = list()</code> to finely control the aesthetics of the histogram.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb636-2"><a href="#cb636-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">hist.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb636-3"><a href="#cb636-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb636-4"><a href="#cb636-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb636-5"><a href="#cb636-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">binwidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-519-1.png" width="336" /></p>
<ul>
<li><code>density.params</code> feeds arguments to <code>geom_density()</code> that dictates the aesthetics of the histogram, such as <code>color</code>, <code>fill</code> and <code>alpha</code>.</li>
</ul>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb637-2"><a href="#cb637-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">hist.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb637-3"><a href="#cb637-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb637-4"><a href="#cb637-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb637-5"><a href="#cb637-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">binwidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb637-6"><a href="#cb637-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb637-7"><a href="#cb637-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb637-8"><a href="#cb637-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,</span>
<span id="cb637-9"><a href="#cb637-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> <span class="st">&#39;transparent&#39;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-520-1.png" width="336" /></p>
<ul>
<li><code>rug.params</code> feeds arguments to <code>geom_rug</code> to control the aesthetics of the rugs such as <code>color</code>, <code>alpha</code> and <code>size</code>.</li>
</ul>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day)) <span class="sc">+</span></span>
<span id="cb638-2"><a href="#cb638-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">hist.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb638-3"><a href="#cb638-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb638-4"><a href="#cb638-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb638-5"><a href="#cb638-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">binwidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb638-6"><a href="#cb638-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb638-7"><a href="#cb638-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb638-8"><a href="#cb638-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,</span>
<span id="cb638-9"><a href="#cb638-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> <span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb638-10"><a href="#cb638-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">rug.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb638-11"><a href="#cb638-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-521-1.png" width="336" /></p>
<p>You can also plot the histogram across multiple conditions/groups by setting <code>ggplot(aes(..., color = xx)</code>. We can demonstrate this using <code>df</code>, which has data across multiple groups.</p>
<ul>
<li><code>legends</code> argument can be used to show the legend if <code>legends = TRUE</code>.
<ul>
<li>The default is set to <code>legends = FALSE</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>day, <span class="at">color =</span> day)) <span class="sc">+</span></span>
<span id="cb639-2"><a href="#cb639-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hist</span>(<span class="at">hist.params =</span> <span class="fu">list</span>(<span class="at">binwidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb639-3"><a href="#cb639-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.params =</span> <span class="fu">list</span>(<span class="at">fill=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>),</span>
<span id="cb639-4"><a href="#cb639-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">rug.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>), <span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb639-5"><a href="#cb639-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb639-6"><a href="#cb639-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb639-7"><a href="#cb639-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Histograms + rugs + kernel estimations of two groups&#39;</span>) <span class="sc">+</span></span>
<span id="cb639-8"><a href="#cb639-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.85</span>))) <span class="sc">+</span></span>
<span id="cb639-9"><a href="#cb639-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.84</span>,<span class="fl">0.82</span>),</span>
<span id="cb639-10"><a href="#cb639-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb639-11"><a href="#cb639-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-522-1.png" width="576" /></p>
<!--chapter:end:smplot2b.Rmd-->
</div>
</div>
<div id="part-contrast-sensitivity-function" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Contrast Sensitivity Function<a href="#part-contrast-sensitivity-function" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="plotting-the-contrast-sensitivity-function" class="section level1 hasAnchor" number="13">
<h1 class="hasAnchor"><span class="header-section-number">13</span> Plotting the Contrast Sensitivity Function<a href="#plotting-the-contrast-sensitivity-function" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For the next three chapters, we will use <strong>smCSF</strong>. Make sure you have downloaded it.</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="#cb640-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb640-2"><a href="#cb640-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smCSF&#39;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Also, we will use the data of achromatic contrast sensitivity from 51 normal observers from this paper (a subset of the entire dataset):</p>
<p><strong>Kim, Y. J., Reynaud, A., Hess, R. F., &amp; Mullen, K. T. (2017). A normative data set for the clinical assessment of achromatic and chromatic contrast sensitivity using a qCSF approach. Investigative ophthalmology &amp; visual science, 58(9), 3628-3636.</strong></p>
<p>Luckily, the data are publicly available. I have reorganized the data so that we could easily use them in the form of a data frame. Let’s load the data from online.</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb641-2"><a href="#cb641-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb641-3"><a href="#cb641-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smCSF)</span></code></pre></div>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a>ACh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Repetition SpatialFreq Sensitivity
##   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1 S1               1        0.25       23.8 
## 2 S2               1        0.25       18.0 
## 3 S3               1        0.25       14.2 
## 4 S4               1        0.25        5.14
## 5 S5               1        0.25       16.0 
## 6 S6               1        0.25       10.9</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 51 participants total in the .csv file.</p></li>
<li><p>Next, <code>Repetition</code> refers to each repetition of the measurement The participants performed two repetitions of the contrast sensitivity measurement.</p></li>
<li><p><code>SpatialFreq</code> refers to spatial frequency of the stimuli that were shown to test the observers’ contrast sensitivity. There are a total of 12 spatial frequencies.</p></li>
<li><p>The <code>Sensitivity</code> column refers to the linear values of the contrast sensitivity.</p></li>
</ul>
<div id="brief-introduction" class="section level2 hasAnchor" number="13.1">
<h2 class="hasAnchor"><span class="header-section-number">13.1</span> Brief Introduction<a href="#brief-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The contrast sensitivity function (CSF) how the observer is sensitive to an image. This image could be large (low spatial frequency) or small (high spatal frequency). To obtain the CSF, the measurement test must measure the threshold. Threshold refers to the difference in stimulus magnitude between the states of presence and absence. If the observer can just barely discriminate between these two states of the visual stimulus, this can be described as the threshold for detection.</p>
</div>
<div id="data-visualization" class="section level2 hasAnchor" number="13.2">
<h2 class="hasAnchor"><span class="header-section-number">13.2</span> Data Visualization<a href="#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s compute the average, standard errors and standard deviation using the dataset. It is recommended that the reader has read Chapters 5 and 6 already. Understanding of <code>summarise()</code>, <code>filter()</code>, <code>mutate()</code> and <code>%&gt;%</code> is assumed.</p>
<p>The code below reorganizes the <code>ACh</code> dataset so that instead of containing the data of each subject, it now contains the averaged data across <code>Repetition</code> and <code>SpatialFreq</code> as well as their standard errors and standard deviations. We use <code>mean()</code> to compute the mean, <code>sm_stdErr()</code> the standard error, and <code>sd()</code> the standard deviation.</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="#cb645-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> </span>
<span id="cb645-2"><a href="#cb645-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Repetition, SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb645-3"><a href="#cb645-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb645-4"><a href="#cb645-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb645-5"><a href="#cb645-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb645-6"><a href="#cb645-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb645-7"><a href="#cb645-7" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1          1        0.25    12.6      0.743       5.31
##  2          1        0.35    14.7      0.777       5.55
##  3          1        0.49    18.6      0.993       7.09
##  4          1        0.68    23.7      1.22        8.71
##  5          1        0.94    28.7      1.36        9.68
##  6          1        1.31    32.0      1.40        9.99
##  7          1        1.83    32.4      1.43       10.2 
##  8          1        2.54    29.6      1.39        9.93
##  9          1        3.54    24.3      1.22        8.70
## 10          1        4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>Let’s create a variable that stores the data for each <code>Repetition</code>. Before we do that, however, it is important that we convert the data type of the <code>Repetition</code> column from <code>&lt;dbl&gt;</code> to <code>&lt;fct&gt;</code>, which refers from <strong>double</strong> to <strong>factor</strong>. <strong>Double</strong> refers to continuous data, whereas <strong>factor</strong> refers to categorical data.</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="#cb647-1" aria-hidden="true" tabindex="-1"></a>ACh_avg<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg<span class="sc">$</span>Repetition) <span class="co"># factor</span></span>
<span id="cb647-2"><a href="#cb647-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-3"><a href="#cb647-3" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># repetition 1</span></span>
<span id="cb647-4"><a href="#cb647-4" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">2</span>) <span class="co"># repetition 2</span></span></code></pre></div>
<p>Let’s now plot the data for each repetition using <strong>ggplot2</strong>. Understanding of Chapters 1-4 is assumed.</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb648-2"><a href="#cb648-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb648-3"><a href="#cb648-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb648-4"><a href="#cb648-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb648-5"><a href="#cb648-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb648-6"><a href="#cb648-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-530-1.png" width="336" /></p>
<p>So far, this graph does not show the contrast sensitivity function, which has a rotund shape. Instead, if we connect the points, we get this plot instead.</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb649-2"><a href="#cb649-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb649-3"><a href="#cb649-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb649-4"><a href="#cb649-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb649-5"><a href="#cb649-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb649-6"><a href="#cb649-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb649-7"><a href="#cb649-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-531-1.png" width="336" /></p>
<p>The function is still not a smooth, rotund shape. This is because it is standard to plot the contrast sensitivity function in log10 scales in both x and y axes. The code below shows the plot in the log scale.</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb650-2"><a href="#cb650-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb650-3"><a href="#cb650-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb650-4"><a href="#cb650-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb650-5"><a href="#cb650-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb650-6"><a href="#cb650-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb650-7"><a href="#cb650-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb650-8"><a href="#cb650-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb650-9"><a href="#cb650-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-532-1.png" width="336" /></p>
<p>This plot shows the averaged sensitivity for each spatial frequency during the first repetition. However, the contrast sensitivity function is still missing because this plot instead shows the plot that is connected between a pair of the points. To plot the contrast sensitivity function with the data, <code>sm_CSF()</code> is required.</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb651-2"><a href="#cb651-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-533-1.png" width="336" /></p>
<p>Notice that even if the data frame contains data in <strong>linear units</strong>, the plotted data from <code>sm_CSF()</code> are in log10 scales. It shows a nice, rotund shape that is typical of the contrast sensitivity function. The function can also plot the linear curve by setting <code>sm_CSF(logXY = FALSE)</code>. The default is <code>sm_CSF(logXY = TRUE)</code>.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb652-2"><a href="#cb652-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-534-1.png" width="336" /></p>
<p>Now let’s plot a prettier contrast sensitivity function.</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb653-2"><a href="#cb653-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>)) <span class="sc">+</span></span>
<span id="cb653-3"><a href="#cb653-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb653-4"><a href="#cb653-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb653-5"><a href="#cb653-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb653-6"><a href="#cb653-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb653-7"><a href="#cb653-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-535-1.png" width="336" /></p>
<p>We can also plot the data using <code>ACh_avg2</code>, which contains data from the second repetition rather than first.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb654-2"><a href="#cb654-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb654-3"><a href="#cb654-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb654-4"><a href="#cb654-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb654-5"><a href="#cb654-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb654-6"><a href="#cb654-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb654-7"><a href="#cb654-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-536-1.png" width="336" /></p>
<p>Notice that <code>sm_CSF()</code> is written first because the curve has to appear before the points (<code>geom_point()</code>); else, the points will be covered by the CSF curve. This example is shown below.</p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb655-2"><a href="#cb655-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb655-3"><a href="#cb655-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb655-4"><a href="#cb655-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb655-5"><a href="#cb655-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb655-6"><a href="#cb655-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb655-7"><a href="#cb655-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-537-1.png" width="336" /></p>
<p>The curve appears later in this plot, so it covers some overlapping points.</p>
<p><strong>smCSF</strong> also offers a function that fill the area of the CSF curve. This function is <code>sm_areaCSF()</code>. The default is set to plot the area in log10 scales, <code>sm_areaCSF(logXY = TRUE)</code>.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb656-2"><a href="#cb656-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>() <span class="sc">+</span></span>
<span id="cb656-3"><a href="#cb656-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-538-1.png" width="336" /></p>
<p>To plot the linear CSF and its area, <code>logXY = FALSE</code> has to be set <code>FALSE</code> in both <code>sm_areaCSF()</code> and <code>sm_CSF()</code>. The functions of <code>smCSF</code> have defaults <code>logXY = TRUE</code>, therefore, it is recommended that the user uploads a data frame that contains the linear data of spatial frequencies and contrast sensitivities. The functions then will convert them into log scale by default.</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="#cb657-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb657-2"><a href="#cb657-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb657-3"><a href="#cb657-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">logXY =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-539-1.png" width="336" /></p>
<p>We can make the area plot prettier.</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb658-2"><a href="#cb658-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb658-3"><a href="#cb658-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb658-4"><a href="#cb658-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb658-5"><a href="#cb658-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb658-6"><a href="#cb658-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb658-7"><a href="#cb658-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb658-8"><a href="#cb658-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb658-9"><a href="#cb658-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">0.9</span>, <span class="at">y =</span> <span class="fl">1.3</span>, <span class="at">label =</span> <span class="st">&#39;Area under Log CSF&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-540-1.png" width="336" /></p>
<p>You might get a warning that says <code>Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale</code>. You can ignore this warning and not be worried about it. This is because we used the function <code>scale_y_log10()</code> on top of <code>sm_CSF()</code>, which actually calls forth the function <code>scale_y_continuous()</code> to convert the plot into log scales. Hence, there are two functions that serve the same purpose here, so the warning message is printed.</p>
<p>The <strong>smCSF</strong> package also offers a function that draws a ribbon shade to denote standard error or standard deviation. This function works exactly the same as <code>geom_ribbon()</code>. It requires the uses to specify <code>ymin</code> and <code>ymax</code>. The example below plots standard deviation using <code>sm_ribbonCSF()</code>, where <code>ymin = avgSens - stdDevSens</code> and <code>ymax = avgSens + stdDevSens</code>. As before, its default is <code>logXY = TRUE</code>. Therefore, even if <code>ACh_avg2</code> contains data in linear units, the ribbon shade that is generated by <code>sm_ribbonCSF()</code> will be in log unit.</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="#cb659-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb659-2"><a href="#cb659-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb659-3"><a href="#cb659-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)) <span class="sc">+</span></span>
<span id="cb659-4"><a href="#cb659-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb659-5"><a href="#cb659-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-541-1.png" width="336" /></p>
<p>Let’s make the plot prettier using <strong>smplot</strong>.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb660-2"><a href="#cb660-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb660-3"><a href="#cb660-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens),</span>
<span id="cb660-4"><a href="#cb660-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb660-5"><a href="#cb660-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)) <span class="sc">+</span></span>
<span id="cb660-6"><a href="#cb660-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb660-7"><a href="#cb660-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb660-8"><a href="#cb660-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb660-9"><a href="#cb660-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb660-10"><a href="#cb660-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-542-1.png" width="336" /></p>
<p>You can also shade standard error instead, but the ribbon is barely visible.</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="#cb661-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb661-2"><a href="#cb661-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdErrSens,</span>
<span id="cb661-3"><a href="#cb661-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdErrSens)) <span class="sc">+</span></span>
<span id="cb661-4"><a href="#cb661-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb661-5"><a href="#cb661-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-543-1.png" width="336" /></p>
<p>As practice, let’s plot the averaged data across all repetitions.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_final <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb662-2"><a href="#cb662-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb662-3"><a href="#cb662-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb662-4"><a href="#cb662-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb662-5"><a href="#cb662-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-6"><a href="#cb662-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh_avg_final)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1        0.25    13.2      0.536       5.41
## 2        0.35    15.2      0.568       5.74
## 3        0.49    19.1      0.698       7.05
## 4        0.68    24.3      0.836       8.44
## 5        0.94    29.4      0.938       9.48
## 6        1.31    33.0      0.977       9.87</code></pre>
<p>Here is the new data frame <code>ACh_avg_final</code>.</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_final <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb664-2"><a href="#cb664-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb664-3"><a href="#cb664-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens),</span>
<span id="cb664-4"><a href="#cb664-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb664-5"><a href="#cb664-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb664-6"><a href="#cb664-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb664-7"><a href="#cb664-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb664-8"><a href="#cb664-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb664-9"><a href="#cb664-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Contrast Sensitivity (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb664-10"><a href="#cb664-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb664-11"><a href="#cb664-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb664-12"><a href="#cb664-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-545-1.png" width="336" /></p>
<p>The standard deviation seems to be still broad.</p>
</div>
<div id="facetting-the-contrast-sensitivity-functions" class="section level2 hasAnchor" number="13.3">
<h2 class="hasAnchor"><span class="header-section-number">13.3</span> Facetting the Contrast Sensitivity Functions<a href="#facetting-the-contrast-sensitivity-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To facet means to split the plot into multiple plots based on a categorical variable (i.e., <strong>factor</strong>). We will facet the contrast sensitivity function plot above (the blue curve) into two panels based on two repetitions (red and green below).</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-546-1.png" width="624" /></p>
<p>To facet the plot, you need to have a data frame that has data with a column that specifies the categorical variable. For instance, let’s look at the data frame <code>ACh_avg</code>.</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="#cb665-1" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##    &lt;fct&gt;            &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 1                 0.25    12.6      0.743       5.31
##  2 1                 0.35    14.7      0.777       5.55
##  3 1                 0.49    18.6      0.993       7.09
##  4 1                 0.68    23.7      1.22        8.71
##  5 1                 0.94    28.7      1.36        9.68
##  6 1                 1.31    32.0      1.40        9.99
##  7 1                 1.83    32.4      1.43       10.2 
##  8 1                 2.54    29.6      1.39        9.93
##  9 1                 3.54    24.3      1.22        8.70
## 10 1                 4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>We see that the first column of <code>Ach_avg</code> has a column named <code>Repetition</code> which stores whether the given data are from the first or second repetition. To see all the unique levels of <code>Repetition</code>, we can use the function <code>unique()</code>.</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="#cb667-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ACh_avg<span class="sc">$</span>Repetition)</span></code></pre></div>
<pre><code>## [1] 1 2
## Levels: 1 2</code></pre>
<p>To facet a plot using ggplot2, the function <code>facet_wrap()</code> has to be used.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="#cb669-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb669-2"><a href="#cb669-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb669-3"><a href="#cb669-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb669-4"><a href="#cb669-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-549-1.png" width="624" /></p>
<p>The argument inside <code>facet_wrap</code> has to include the tilde (<code>~</code>). The right side the tilde (<code>~</code>) should be the name of the categorical variable by which you wish to facet the plot. If the variable however happens to be continuous, <code>facet_wrap()</code> would not work properly.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="#cb670-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb670-2"><a href="#cb670-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb670-3"><a href="#cb670-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb670-4"><a href="#cb670-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> stdErrSens) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-550-1.png" width="624" /></p>
<p>However, I do not often use <code>facet_wrap()</code> because the plot often ends up not being pretty. Let’s try to make it prettier.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb671-2"><a href="#cb671-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb671-3"><a href="#cb671-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb671-4"><a href="#cb671-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb671-5"><a href="#cb671-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb671-6"><a href="#cb671-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb671-7"><a href="#cb671-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb671-8"><a href="#cb671-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb671-9"><a href="#cb671-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb671-10"><a href="#cb671-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb671-11"><a href="#cb671-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb671-12"><a href="#cb671-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb671-13"><a href="#cb671-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb671-14"><a href="#cb671-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) <span class="sc">+</span></span>
<span id="cb671-15"><a href="#cb671-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-551-1.png" width="624" /></p>
<p>Personally, I do not like the grey-filled header of each panel. Since I personally will find myself repeatedly bypassing the default grey color into a color of my choice, I have created the function myself <code>sm_facet_header()</code> as part of the <strong>smCSF</strong> package.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="#cb672-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb672-2"><a href="#cb672-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb672-3"><a href="#cb672-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb672-4"><a href="#cb672-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb672-5"><a href="#cb672-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb672-6"><a href="#cb672-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb672-7"><a href="#cb672-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb672-8"><a href="#cb672-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb672-9"><a href="#cb672-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb672-10"><a href="#cb672-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb672-11"><a href="#cb672-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb672-12"><a href="#cb672-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb672-13"><a href="#cb672-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb672-14"><a href="#cb672-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition) <span class="sc">+</span></span>
<span id="cb672-15"><a href="#cb672-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb672-16"><a href="#cb672-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-552-1.png" width="624" /></p>
<p>Now the title of each plot has been bolded and the filled color is white. I personally think that this plot is a lot cleaner than the default one.</p>
<p>Next, I wish to change the titles of each panel because <code>1</code> and <code>2</code> are not descriptive. To do so, we need to use the argument <code>labeller</code> within <code>facet_wrap()</code> to specify the title of each panel.</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb673-2"><a href="#cb673-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb673-3"><a href="#cb673-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb673-4"><a href="#cb673-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb673-5"><a href="#cb673-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb673-6"><a href="#cb673-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb673-7"><a href="#cb673-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb673-8"><a href="#cb673-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb673-9"><a href="#cb673-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb673-10"><a href="#cb673-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb673-11"><a href="#cb673-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb673-12"><a href="#cb673-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb673-13"><a href="#cb673-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb673-14"><a href="#cb673-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition,</span>
<span id="cb673-15"><a href="#cb673-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 1&#39;</span>,</span>
<span id="cb673-16"><a href="#cb673-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 2&#39;</span>))) <span class="sc">+</span></span>
<span id="cb673-17"><a href="#cb673-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb673-18"><a href="#cb673-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>(<span class="at">font_size=</span><span class="dv">11</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-553-1.png" width="624" /></p>
<p>We use the function <code>as_labeller()</code> as part of the argument <code>labeller()</code> inside <code>facet_wrap()</code> to specify that factor level <code>1</code> should be shown as <code>Repetition 1</code> and <code>2</code> as <code>Repetition 2</code>.</p>
<p>We can also change the number of rows and columns using <code>facet_wrap()</code>. Lets make a data frame that has 4 repetitions instead of 2.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="#cb674-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb674-2"><a href="#cb674-2" aria-hidden="true" tabindex="-1"></a>spatFreqNum <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(ACh_avg<span class="sc">$</span>SpatialFreq))</span>
<span id="cb674-3"><a href="#cb674-3" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ACh_avg,ACh_avg)</span>
<span id="cb674-4"><a href="#cb674-4" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">each=</span>spatFreqNum)</span>
<span id="cb674-5"><a href="#cb674-5" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep[<span class="dv">25</span><span class="sc">:</span><span class="fu">nrow</span>(ACh_avg_4rep), <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> ACh_avg_4rep[<span class="dv">25</span><span class="sc">:</span><span class="fu">nrow</span>(ACh_avg_4rep), <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">+</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">24</span>),<span class="dv">1</span>) </span>
<span id="cb674-6"><a href="#cb674-6" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg_4rep<span class="sc">$</span>Repetition)</span></code></pre></div>
<p>We can specify the number of columns (ex. <code>ncol = 2</code>) and rows (ex. <code>nrow = 2</code>) inside the function <code>facet_wrap()</code>, as shown in the example below.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true" tabindex="-1"></a>ACh_avg_4rep <span class="sc">%&gt;%</span></span>
<span id="cb675-2"><a href="#cb675-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb675-3"><a href="#cb675-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb675-4"><a href="#cb675-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition,</span>
<span id="cb675-5"><a href="#cb675-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb675-6"><a href="#cb675-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb675-7"><a href="#cb675-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)) <span class="sc">+</span></span>
<span id="cb675-8"><a href="#cb675-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb675-9"><a href="#cb675-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb675-10"><a href="#cb675-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb675-11"><a href="#cb675-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>,<span class="st">&#39;yelloworange&#39;</span>, <span class="st">&#39;crimson&#39;</span>)) <span class="sc">+</span></span>
<span id="cb675-12"><a href="#cb675-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>, <span class="st">&#39;orange&#39;</span>,<span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb675-13"><a href="#cb675-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb675-14"><a href="#cb675-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb675-15"><a href="#cb675-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb675-16"><a href="#cb675-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Repetition, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb675-17"><a href="#cb675-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 1&#39;</span>,</span>
<span id="cb675-18"><a href="#cb675-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 2&#39;</span>,</span>
<span id="cb675-19"><a href="#cb675-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;3&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 3&#39;</span>,</span>
<span id="cb675-20"><a href="#cb675-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;4&#39;</span> <span class="ot">=</span> <span class="st">&#39;Repetition 4&#39;</span>))) <span class="sc">+</span></span>
<span id="cb675-21"><a href="#cb675-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb675-22"><a href="#cb675-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_facet_header</span>(<span class="at">font_size=</span><span class="dv">11</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-555-1.png" width="624" /></p>
<p>Notice that when <code>facet_wrap()</code> is used, there is no need to create variable for each plot like we have done in Chapter 5 and use <code>sm_common_axis()</code>. The preference can vary depending on the user. Rather than using <code>facet_wrap()</code>, however, I still prefer to store each plot separately so that I can have freedom to decide where to place each panel wherever I want using <code>sm_common_axis()</code>.</p>
<p>Also, make sure that when you combine the plots using <code>facet_wrap()</code> you set the size of the figure properly within the <code>save_plot()</code> function or else the figure will appear to be too crowded. You can use <code>base_height</code> and <code>base_width</code> arguments within <code>facet_wrap()</code>.</p>
<p>Another issue with plotting each contrast sensitivity function per panel is that it is visually difficult to compare whether the functions between the panels are different. One way to overcome this problem is to plot all the plots together. In this case, legend is necessary, which can be generated using <code>sm_hgrid(legends = TRUE)</code>. Let’s use the data frame <code>ACh_avg</code> which has two levels in the <code>Repetition</code> column.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="#cb676-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="sc">%&gt;%</span></span>
<span id="cb676-2"><a href="#cb676-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens,</span>
<span id="cb676-3"><a href="#cb676-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Repetition, <span class="at">color =</span> Repetition,</span>
<span id="cb676-4"><a href="#cb676-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb676-5"><a href="#cb676-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb676-6"><a href="#cb676-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb676-7"><a href="#cb676-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_CSF</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb676-8"><a href="#cb676-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> T) <span class="sc">+</span></span>
<span id="cb676-9"><a href="#cb676-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>,<span class="st">&#39;lightgreen&#39;</span>)) <span class="sc">+</span></span>
<span id="cb676-10"><a href="#cb676-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>,<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb676-11"><a href="#cb676-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb676-12"><a href="#cb676-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb676-13"><a href="#cb676-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb676-14"><a href="#cb676-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb676-15"><a href="#cb676-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">&#39;Achromatic CSF (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-556-1.png" width="336" /></p>
<p>We see that these two curves are nearly identical, except that the green curve is uniformly higher than the red curve.</p>
<p>In the next chapter, we will discuss about some techniques on how to analyze contrast sensitivity data.</p>
<!--chapter:end:Csf1.Rmd-->
</div>
</div>
<div id="area-under-curve-aulcsf-and-r2-of-the-csf" class="section level1 hasAnchor" number="14">
<h1 class="hasAnchor"><span class="header-section-number">14</span> Area under Curve, AULCSF and R2 of the CSF<a href="#area-under-curve-aulcsf-and-r2-of-the-csf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As in the previous chapter, we will use data of achromatic contrast sensitivity from 51 normal observers from this paper (a subset of the entire dataset) and the <strong>smCSF</strong> package:</p>
<p><strong>Kim, Y. J., Reynaud, A., Hess, R. F., &amp; Mullen, K. T. (2017). A normative data set for the clinical assessment of achromatic and chromatic contrast sensitivity using a qCSF approach. Investigative ophthalmology &amp; visual science, 58(9), 3628-3636.</strong></p>
<p>Let’s load the necessary packages.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb677-2"><a href="#cb677-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb677-3"><a href="#cb677-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smCSF)</span></code></pre></div>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="#cb678-1" aria-hidden="true" tabindex="-1"></a>ACh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ACh)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Repetition SpatialFreq Sensitivity
##   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1 S1               1        0.25       23.8 
## 2 S2               1        0.25       18.0 
## 3 S3               1        0.25       14.2 
## 4 S4               1        0.25        5.14
## 5 S5               1        0.25       16.0 
## 6 S6               1        0.25       10.9</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 51 participants total in the .csv file.</p></li>
<li><p>Next, <code>Repetition</code> refers to each repetition of the measurement The participants performed two repetitions of the contrast sensitivity measurement.</p></li>
<li><p><code>SpatialFreq</code> refers to spatial frequency of the stimuli that were shown to test the observers’ contrast sensitivity. There are a total of 12 spatial frequencies.</p></li>
<li><p>The <code>Sensitivity</code> column refers to the linear values of the contrast sensitivity.</p></li>
</ul>
<div id="area-under-a-curve-1" class="section level2 hasAnchor" number="14.1">
<h2 class="hasAnchor"><span class="header-section-number">14.1</span> Area under a Curve<a href="#area-under-a-curve-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Area under a curve under the contrast sensitivity function (CSF) as an index of visual performance or sensitivity. The higher the areal measure, the better the visual performance. There are two ways to calculate the area: 1) trapezoidal integration of the contrast sensitivity data as a function of spatial frequency, and 2) area under the fitted log CSF (AULCSF).</p>
<p>Let’s create a data frame <code>ACh_avg</code> that contains the averaged contrast sensitivity data for each repetition and spatial frequency across 51 subjects.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true" tabindex="-1"></a>ACh_avg <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> </span>
<span id="cb681-2"><a href="#cb681-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Repetition, SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb681-3"><a href="#cb681-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb681-4"><a href="#cb681-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb681-5"><a href="#cb681-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb681-6"><a href="#cb681-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb681-7"><a href="#cb681-7" aria-hidden="true" tabindex="-1"></a>ACh_avg</span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1          1        0.25    12.6      0.743       5.31
##  2          1        0.35    14.7      0.777       5.55
##  3          1        0.49    18.6      0.993       7.09
##  4          1        0.68    23.7      1.22        8.71
##  5          1        0.94    28.7      1.36        9.68
##  6          1        1.31    32.0      1.40        9.99
##  7          1        1.83    32.4      1.43       10.2 
##  8          1        2.54    29.6      1.39        9.93
##  9          1        3.54    24.3      1.22        8.70
## 10          1        4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>As in the previous chapter, lets store the data into proper data frames for each repetition.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="#cb683-1" aria-hidden="true" tabindex="-1"></a>ACh_avg<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh_avg<span class="sc">$</span>Repetition) <span class="co"># factor</span></span>
<span id="cb683-2"><a href="#cb683-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-3"><a href="#cb683-3" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># repetition 1</span></span>
<span id="cb683-4"><a href="#cb683-4" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="ot">&lt;-</span> ACh_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Repetition <span class="sc">==</span> <span class="dv">2</span>) <span class="co"># repetition 2</span></span></code></pre></div>
<p>Here is an example of trapezoidal integration of the contrast sensitivity function (i.e., AUC). AUC is an abbreviation of <strong>a</strong>rea <strong>u</strong>nder a <strong>c</strong>urve from trapezoidal integration.</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb684-2"><a href="#cb684-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb684-3"><a href="#cb684-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb684-4"><a href="#cb684-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb684-5"><a href="#cb684-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb684-6"><a href="#cb684-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb684-7"><a href="#cb684-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb684-8"><a href="#cb684-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb684-9"><a href="#cb684-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb684-10"><a href="#cb684-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb684-11"><a href="#cb684-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb684-12"><a href="#cb684-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">1.3</span>, <span class="at">label =</span> <span class="st">&#39;Trapezoidal AUC&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-563-1.png" width="336" /></p>
<p>Here is an example of the AULCSF.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="#cb685-1" aria-hidden="true" tabindex="-1"></a>ACh_avg2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb685-2"><a href="#cb685-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_areaCSF</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightgreen&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb685-3"><a href="#cb685-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>), <span class="at">size =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb685-4"><a href="#cb685-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;viridian&#39;</span>)) <span class="sc">+</span></span>
<span id="cb685-5"><a href="#cb685-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb685-6"><a href="#cb685-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb685-7"><a href="#cb685-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb685-8"><a href="#cb685-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 2 (n=51)&#39;</span>) <span class="sc">+</span></span>
<span id="cb685-9"><a href="#cb685-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb685-10"><a href="#cb685-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">0.4</span>, <span class="at">y =</span> <span class="fl">1.3</span>, <span class="at">label =</span> <span class="st">&#39;AULCSF&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-564-1.png" width="336" /></p>
<p>Notice that these that AUC and AULCSF are slightly different. AUC denotes the area that is enclosed by the lines that connect each point. AULCSF refers to the area that is enclosed by the fitted contrast sensitivity function. The astute reader may realize that if the fit of the contrast sensitivity function is poor, then the AULCSF might not be accurate. Hence, it might be necessary to prove that the CSF fit is robust with the given data. To avoid these hassles, some researchers use AUC instead. Nevertheless, <strong>smCSF</strong> offers functions that compute both AUC and AULCSF.</p>
<p>The higher the AUC and AULCSF are, the higher the overall sensitivity of the observer. Therefore, when potential treatment is being studied, it is of interest to see an increase in AUC and AULCSF in the visually impaired after their treatment.</p>
</div>
<div id="sm_trapz-sm_aulcsf-and-sm_r2" class="section level2 hasAnchor" number="14.2">
<h2 class="hasAnchor"><span class="header-section-number">14.2</span> <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code><a href="#sm_trapz-sm_aulcsf-and-sm_r2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section is identical to what we have seen in Chapter 6. For those who have read Chapter 6, the only difference is that these AUCs should be in log scales (both x and y scales) in the context of contrast sensitivity.</p>
<p>Recall that <code>ACh_avg</code> contains averaged contrast sensitivity for each spatial frequency across 51 observers for the first repetition.</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="#cb686-1" aria-hidden="true" tabindex="-1"></a>ACh_avg </span></code></pre></div>
<pre><code>## # A tibble: 24 x 5
## # Groups:   Repetition [2]
##    Repetition SpatialFreq avgSens stdErrSens stdDevSens
##    &lt;fct&gt;            &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 1                 0.25    12.6      0.743       5.31
##  2 1                 0.35    14.7      0.777       5.55
##  3 1                 0.49    18.6      0.993       7.09
##  4 1                 0.68    23.7      1.22        8.71
##  5 1                 0.94    28.7      1.36        9.68
##  6 1                 1.31    32.0      1.40        9.99
##  7 1                 1.83    32.4      1.43       10.2 
##  8 1                 2.54    29.6      1.39        9.93
##  9 1                 3.54    24.3      1.22        8.70
## 10 1                 4.93    18.1      0.960       6.85
## # ... with 14 more rows</code></pre>
<p>To compute the trapezoidal AUC, we can use the function <code>sm_trapz()</code>.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_trapz</span>(ACh_avg1<span class="sc">$</span>SpatialFreq, ACh_avg1<span class="sc">$</span>avgSens)</span></code></pre></div>
<pre><code>## [1] 2.081833</code></pre>
<p>The difference between <code>sm_trapz()</code> and <code>sm_auc()</code> is that <code>sm_trapz()</code> automatically converts the <code>x</code> and <code>y</code> vectors into log10 scales. This default can be overcome when <code>logXY = FALSE</code>. When, <code>logXY = FALSE</code>, <code>sm_trapz()</code> becomes identical to <code>sm_auc()</code>. <code>sm_trapz()</code> has been created as a separate function to create a convenient and straightforward workflow for those who wish to analyze the contrast sensitivity data.</p>
<p>In addition, to compute the trapezoidal AUC, we can use the function <code>sm_AULCSF()</code>.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_AULCSF</span>(ACh_avg1<span class="sc">$</span>SpatialFreq, ACh_avg1<span class="sc">$</span>avgSens)</span></code></pre></div>
<pre><code>## [1] 2.089264</code></pre>
<p>Notice that the AULCSF is very similar to AUC. This suggests that the CSF fit (as generated by <code>sm_CSF()</code>) is very good. This can verified by computing R2 (R-squared), which ranges from 0 (worst model fit) to 1 (best model fit), using <code>sm_r2()</code>.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_r2</span>(ACh_avg1<span class="sc">$</span>SpatialFreq, ACh_avg1<span class="sc">$</span>avgSens)</span></code></pre></div>
<pre><code>## [1] 0.9672</code></pre>
<p>We see that R2 of the CSF fit is 0.9672, which is considered excellent. Note that <code>sm_r2()</code> is a function specific for CSF fit only, and the <code>x</code> and <code>y</code> arguments should contain data in linear units, not log units.</p>
<p>To visualize what R2 captures, we need to understand <strong>residuals</strong>, which is the difference or distance between the actual data and the predicted data from the given fit, such as the CSF.</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true" tabindex="-1"></a>ACh_avg1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb694-2"><a href="#cb694-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;wine&#39;</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb694-3"><a href="#cb694-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;darkred&#39;</span>)) <span class="sc">+</span></span>
<span id="cb694-4"><a href="#cb694-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb694-5"><a href="#cb694-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Spatial frequency (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb694-6"><a href="#cb694-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Averaged sensitivity&#39;</span>) <span class="sc">+</span></span>
<span id="cb694-7"><a href="#cb694-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Repetition 1 (n=51)&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-569-1.png" width="336" /></p>
<p>If the residual is very low, then the distance between the actual and predicted data should be close to 0. We see that the residual is low when the spatial frequency is between 3 and 10 c/deg. In this case, the general fit is very faithful to the original data, so the residual is low and R2 is high (close to 1). In sum, the lower the residuals, the higher the R2, which ranges from 0 to 1.</p>
</div>
<div id="calculating-area-and-r2-of-all-subjects-groups-and-conditions" class="section level2 hasAnchor" number="14.3">
<h2 class="hasAnchor"><span class="header-section-number">14.3</span> Calculating area and R2 of all subjects, groups and conditions<a href="#calculating-area-and-r2-of-all-subjects-groups-and-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we know how to calculate AUC, AULCSF and R2 for each subject, let’s calculate slopes of our entire dataset.</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="#cb695-1" aria-hidden="true" tabindex="-1"></a>ACh</span></code></pre></div>
<pre><code>## # A tibble: 1,224 x 4
##    Subject Repetition SpatialFreq Sensitivity
##    &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 S1               1        0.25       23.8 
##  2 S2               1        0.25       18.0 
##  3 S3               1        0.25       14.2 
##  4 S4               1        0.25        5.14
##  5 S5               1        0.25       16.0 
##  6 S6               1        0.25       10.9 
##  7 S7               1        0.25        8.41
##  8 S8               1        0.25       10.5 
##  9 S9               1        0.25        9.06
## 10 S10              1        0.25        3.57
## # ... with 1,214 more rows</code></pre>
<p>We see that there are 51 subjects total, each of which has completed two repetitions (i.e., conditions). So there are 102 slopes to calculate! Does that mean we need to use <code>sm_trapz()</code>, <code>sm_AULCSF()</code> and <code>sm_r2()</code> 102 times?</p>
<p>As the reader might expect from the previous chapters, the answer is <strong>no</strong>. <strong>smCSF</strong> has a functions <code>sm_trapz_list()</code>, <code>sm_AULCSF_list()</code> and <code>sm_r2_list()</code> that return a data frame of AUCs, AULCSFs and R2s, respectively. They works similarly to <code>sm_auc_list()</code> and <code>sm_slope_list()</code> from <strong>smplot</strong>.</p>
<ul>
<li><code>data</code> = this argument requires the variable that stores the data frame. In our case, it is <code>ACh</code>. It is recommended that the data are in linear units.</li>
<li><code>subjects</code> = this argument requires the name of the column of the data frame that contains subjects. It must strings, ex. <code>'Subject'</code>, not <code>Subject</code>.</li>
<li><code>groups</code> = this argument requires the name of the column of the data frame that contains each group. In this example, there is no group. An example would be <code>Group</code> column that contains two groups: <code>Normal</code> and <code>Amblyopia</code>.</li>
<li><code>conditions</code> = this argument requires name of the column of the data frame that contains each condition. In our example, the two conditions are <code>1</code> and <code>2</code> from the <code>Repetition</code> column.</li>
<li><code>x</code> = this argument requires the name of the column of the data frame that contains the x-axis points from which the AUC can be calculated. In our case, these are values from the <code>SpatialFreq</code> column of <code>ACh</code>. It must strings, ex. <code>'SpatialFreq'</code>, not <code>SpatialFreq</code>.</li>
<li><code>values</code> = this argument requires the name of the column of the data frame that contains the actual data, which are the y-axis points from which the AUC can be calculated. In our case, it is the change in contrast balance ratio. It must strings, ex. <code>'Sensitivity'</code>, not <code>Sensitivity</code>.</li>
<li><code>logXY</code> (for <code>sm_trapz_list()</code> and <code>sm_AULCSF_list()</code>) = thus argument’s default is <code>sm_trapz_list(logXY = TRUE)</code> and <code>sm_AULCSF_list(logXY = TRUE)</code>, so it computes the log10 units (<code>x</code> and <code>values</code> vector) of AUC and AULCSF. When <code>logXY = FALSE</code>, it computes the linear units (<code>x</code> and <code>values</code> vector) AUC and AULCSF.</li>
</ul>
<p>Let’s calculate the AUCs first. We can store the results from <code>sm_trapz_list()</code> into a new variable. I will call the new variable <code>trapz_df</code>.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true" tabindex="-1"></a>trapz_df <span class="ot">&lt;-</span> <span class="fu">sm_trapz_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb697-2"><a href="#cb697-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb697-3"><a href="#cb697-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb697-4"><a href="#cb697-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb697-5"><a href="#cb697-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh)</span></code></pre></div>
<pre><code>## [1] &quot;Trapezoid AUC = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="#cb699-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trapz_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject Repetition AUC_Sensitivity
## 1      S1          1        2.299290
## 2      S1          2        2.032390
## 3      S2          1        2.246943
## 4      S2          2        2.215784
## 5      S3          1        1.973220
## 6      S3          2        2.204566</code></pre>
<p>Likewise, we can store the results from <code>sm_AULCSF_list()</code> in a new variable. I will call the new variable <code>aulcsf_df</code>.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a>aulcsf_df <span class="ot">&lt;-</span> <span class="fu">sm_AULCSF_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb701-2"><a href="#cb701-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb701-3"><a href="#cb701-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb701-4"><a href="#cb701-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb701-5"><a href="#cb701-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh)</span></code></pre></div>
<pre><code>## [1] &quot;AULCSF = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="#cb703-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aulcsf_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject Repetition   AULCSF
## 1      S1          1 2.307217
## 2      S1          2 2.038921
## 3      S2          1 2.254705
## 4      S2          2 2.222592
## 5      S3          1 1.979206
## 6      S3          2 2.214169</code></pre>
<p>Finally, we can store the results from <code>sm_r2_list()</code> in a new variable. I will call the new variable <code>r2</code>_df`.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="#cb705-1" aria-hidden="true" tabindex="-1"></a>r2_df <span class="ot">&lt;-</span> <span class="fu">sm_r2_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb705-2"><a href="#cb705-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb705-3"><a href="#cb705-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb705-4"><a href="#cb705-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb705-5"><a href="#cb705-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh)</span></code></pre></div>
<pre><code>## [1] &quot;R2 (0-worst, 1-best) for each subject&quot;</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(r2_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject Repetition     R2
## 1      S1          1 0.8605
## 2      S1          2 1.0000
## 3      S2          1 0.9086
## 4      S2          2 0.8731
## 5      S3          1 0.7505
## 6      S3          2 0.9947</code></pre>
<p>We see that R2 is very good except for few observers in certain repetitions. Let’s see how many rows of the data frame contains R2 less than 0.75.</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="#cb709-1" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(r2_df<span class="sc">$</span>R2 <span class="sc">&lt;</span> <span class="fl">0.75</span>)</span>
<span id="cb709-2"><a href="#cb709-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ind)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true" tabindex="-1"></a>r2_df[ind,]</span></code></pre></div>
<pre><code>##    Subject Repetition     R2
## 11      S6          1 0.5294
## 18      S9          2 0.6518
## 29     S15          1 0.5664
## 61     S31          1 0.6935
## 66     S33          2 0.6041
## 78     S39          2 0.5018
## 88     S44          2 0.7240
## 92     S46          2 0.5190</code></pre>
<p>Out of 102 rows of the R2s, only 8 of them contain poor R2. I think the contrast sensitivity function fit is acceptable to model the dataset of achromatic sensitivity in 51 normal observers.</p>
</div>
<div id="case-study" class="section level2 hasAnchor" number="14.4">
<h2 class="hasAnchor"><span class="header-section-number">14.4</span> Case Study<a href="#case-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If one is interested in seeing whether a clinical treatment can improve the overall contrast sensitivity of the visually impaired, one can do so by comparing the area (AUC or AULCSF) before and after the treatment.</p>
<p>Let’s generate some fake data with <code>ACh</code>. We will create a new column using <code>mutate()</code> by creating a new column <code>BeforeAfter</code>, which replaces <code>1</code> with <code>Before</code> and <code>2</code> with <code>After</code> to denote before and after receiving clinical treatment. Since <code>BeforeAfter</code> is derived from the <code>Repetition</code> column, it is a <code>&lt;fct&gt;</code> column, as it is so with the <code>Repetition</code> column. This new data frame is stored in the variable named <code>ACh1</code>. We assume that the 51 subjects are visually impaired patients who received clinical treatment for visual improvement.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1" aria-hidden="true" tabindex="-1"></a>ACh<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh<span class="sc">$</span>Repetition)</span>
<span id="cb713-2"><a href="#cb713-2" aria-hidden="true" tabindex="-1"></a>ACh1 <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">BeforeAfter =</span> <span class="fu">fct_recode</span>(Repetition,</span>
<span id="cb713-3"><a href="#cb713-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;Before&#39;</span> <span class="ot">=</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb713-4"><a href="#cb713-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;After&#39;</span> <span class="ot">=</span> <span class="st">&#39;2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb713-5"><a href="#cb713-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Repetition)</span></code></pre></div>
<p>Now, lets increase the values from the <code>Sensitivity</code> column in rows that have <code>BeforeAfter == After</code> using positive random numbers from a normal distribution that has a mean of <code>31</code> and a standard deviation of <code>35</code> using <code>rnorm()</code>.</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="#cb714-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb714-2"><a href="#cb714-2" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(ACh1<span class="sc">$</span>BeforeAfter <span class="sc">==</span> <span class="st">&#39;After&#39;</span>)</span>
<span id="cb714-3"><a href="#cb714-3" aria-hidden="true" tabindex="-1"></a>ACh1[ind,]<span class="sc">$</span>Sensitivity <span class="ot">&lt;-</span> ACh1[ind,]<span class="sc">$</span>Sensitivity <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(ind), <span class="dv">31</span>, <span class="dv">35</span>))</span></code></pre></div>
<p>Now let’s calculate both the trapezoidal AUC and AULCSF and using <code>sm_trapz_list()</code> and <code>sm_AULCSF_list()</code>, both of which have defaults <code>logXY = TRUE</code>.</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true" tabindex="-1"></a>trapz_df <span class="ot">&lt;-</span> <span class="fu">sm_trapz_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb715-2"><a href="#cb715-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;BeforeAfter&#39;</span>,</span>
<span id="cb715-3"><a href="#cb715-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb715-4"><a href="#cb715-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb715-5"><a href="#cb715-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh1)</span></code></pre></div>
<pre><code>## [1] &quot;Trapezoid AUC = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trapz_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject BeforeAfter AUC_Sensitivity
## 1      S1      Before        2.299290
## 2      S1       After        2.867173
## 3      S2      Before        2.246943
## 4      S2       After        2.817482
## 5      S3      Before        1.973220
## 6      S3       After        2.856290</code></pre>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true" tabindex="-1"></a>aulcsf_df <span class="ot">&lt;-</span> <span class="fu">sm_AULCSF_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb719-2"><a href="#cb719-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;BeforeAfter&#39;</span>,</span>
<span id="cb719-3"><a href="#cb719-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb719-4"><a href="#cb719-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb719-5"><a href="#cb719-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh1)</span></code></pre></div>
<pre><code>## [1] &quot;AULCSF = Sensitivity * SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aulcsf_df) <span class="co"># first 6 rows</span></span></code></pre></div>
<pre><code>##   Subject BeforeAfter   AULCSF
## 1      S1      Before 2.307217
## 2      S1       After 2.874242
## 3      S2      Before 2.254705
## 4      S2       After 2.824033
## 5      S3      Before 1.979206
## 6      S3       After 2.849016</code></pre>
<p>Now let’s plot a bar graph using <code>sm_bar()</code> that compares both the trapezoidal AUCs and AULCSFs between before and after the visually impaired patients have received the clinical treatment.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true" tabindex="-1"></a>trapz_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BeforeAfter, <span class="at">y =</span> AUC_Sensitivity,</span>
<span id="cb723-2"><a href="#cb723-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> BeforeAfter)) <span class="sc">+</span></span>
<span id="cb723-3"><a href="#cb723-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">size=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb723-4"><a href="#cb723-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb723-5"><a href="#cb723-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-579-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="#cb724-1" aria-hidden="true" tabindex="-1"></a>aulcsf_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BeforeAfter, <span class="at">y =</span> AULCSF,</span>
<span id="cb724-2"><a href="#cb724-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> BeforeAfter)) <span class="sc">+</span></span>
<span id="cb724-3"><a href="#cb724-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">size=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb724-4"><a href="#cb724-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb724-5"><a href="#cb724-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-580-1.png" width="336" /></p>
<p>Both graphs suggest that the visual improvement has brought a large improvement of the overall contrast sensitivity in the patients who received the visual treatment. <strong>Chapter 8 Basic Statistics</strong> covers some methods to analyze data, and the reader can attempt to use the concepts in the previous chapter to analyze whether these differences from the simulated data are statistically significant.</p>
<p>Instead of focusing on the overall sensitivity of the observers, one can focus on observing whether the sensitivity of the high-spatial frequency range has improved after receiving the treatment. This, however, requires an understanding of the parameters that are used to fit the contrast sensitivity function. We will discuss these parameters in the next chapter.</p>
<!--chapter:end:Csf2.Rmd-->
</div>
</div>
<div id="understanding-the-contrast-sensitivity-function" class="section level1 hasAnchor" number="15">
<h1 class="hasAnchor"><span class="header-section-number">15</span> Understanding the Contrast Sensitivity Function<a href="#understanding-the-contrast-sensitivity-function" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section, the model that is used to fit the contrast sensitivity function (CSF) in <code>sm_CSF()</code> is discussed in detail. If readers decide to use <strong>smCSF</strong>, it is necessary to understand and report these details on their manuscripts.</p>
<div id="contrast-sensitivity-function-model" class="section level2 hasAnchor" number="15.1">
<h2 class="hasAnchor"><span class="header-section-number">15.1</span> Contrast Sensitivity Function Model<a href="#contrast-sensitivity-function-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The model that is used to fit CSF in <code>sm_CSF()</code> employs this formula below. It also referred to as the <strong>truncated log-parabola model</strong> of the contrast sensitivity function (Kim et al., 2017)</p>
<p><span class="math inline">\(S&#39;(f) = log_{10}(\gamma_{max}) - \kappa\left(\frac{log_{10}(f) - log_{10}(f_{max})}{\beta&#39;/2}\right)^{2}\)</span>, where <span class="math inline">\(\kappa = log_{10}(2)\)</span> and <span class="math inline">\(\beta&#39; = log_{10}(2\beta)\)</span></p>
<p><span class="math inline">\(S(f) = log_{10}(\gamma_{max}) - \delta\)</span>, if <span class="math inline">\(f &lt; f_{max}\)</span> and <span class="math inline">\(S&#39;(f) &lt; log_{10}(\gamma_{max}) - \delta\)</span></p>
<p><span class="math inline">\(S(f) = S&#39;(f)\)</span> when <span class="math inline">\(f &gt; f_{max}\)</span></p>
<p>There are <strong>four parameters</strong> in the model. First, the <strong>peak gain</strong> <span class="math inline">\(\gamma_{max}\)</span> denotes the peak sensitivity of the contrast sensitivity function. Second, the <strong>peak spatial frequency</strong> <span class="math inline">\(f &gt; f_{max}\)</span> essentially refers to the region of the x-axis of the CSF where the peak sensitivity <span class="math inline">\(\gamma_{max}\)</span> is located. It can also be thought of as the center of the (log) contrast sensitivity function. Third, the <strong>bandwidth</strong> <span class="math inline">\(\beta\)</span> describes the width of the contrast sensitivity function. This width is measured at the half of the maximum sensitivity <span class="math inline">\(\gamma_{max}\)</span>. Moreover, the <strong>truncation value</strong> <span class="math inline">\(\delta\)</span> is a factor that makes sure that the contrast sensitivity function is asymmetric. This factor does not have a huge importance.</p>
<p>Finally, there is another parameter, known as the cutoff spatial frequency <span class="math inline">\(f_{c}\)</span>. It is the spatial frequency where the log-sensitivity is 0 (linear sensitivity = 1) Here is the equation to calculate <span class="math inline">\(f_{c}\)</span>:</p>
<p><span class="math inline">\(f_{c} = f_{max}*10^{\frac{\beta&#39;}{2}\sqrt\frac{log_{10}(\gamma_{max})}{\kappa}}\)</span></p>
<p><code>sm_params</code> calculates all of these parameters automatically.</p>
<p>As I have already stated, if the reader decides to use <strong>smCSF</strong>, it is important to mention in their reports about the parameters and the equations, as well as to understand them.</p>
</div>
<div id="understanding-sm_csf" class="section level2 hasAnchor" number="15.2">
<h2 class="hasAnchor"><span class="header-section-number">15.2</span> Understanding <code>sm_CSF()</code><a href="#understanding-sm_csf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If the user provides linear data of spatial frequency and contrast sensitivity, <code>sm_CSF()</code> can appear to magically plot the contrast sensitivity function with a very good fit as demonstrated below.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb725-2"><a href="#cb725-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot2)</span>
<span id="cb725-3"><a href="#cb725-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smCSF)</span>
<span id="cb725-4"><a href="#cb725-4" aria-hidden="true" tabindex="-1"></a>ACh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data_ACh.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="#cb726-1" aria-hidden="true" tabindex="-1"></a>ACh1 <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> </span>
<span id="cb726-2"><a href="#cb726-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SpatialFreq) <span class="sc">%&gt;%</span></span>
<span id="cb726-3"><a href="#cb726-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgSens =</span> <span class="fu">mean</span>(Sensitivity),</span>
<span id="cb726-4"><a href="#cb726-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdErrSens =</span> <span class="fu">sm_stdErr</span>(Sensitivity),</span>
<span id="cb726-5"><a href="#cb726-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdDevSens =</span> <span class="fu">sd</span>(Sensitivity))</span>
<span id="cb726-6"><a href="#cb726-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb726-7"><a href="#cb726-7" aria-hidden="true" tabindex="-1"></a>ACh1</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    SpatialFreq avgSens stdErrSens stdDevSens
##          &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1        0.25   13.2       0.536       5.41
##  2        0.35   15.2       0.568       5.74
##  3        0.49   19.1       0.698       7.05
##  4        0.68   24.3       0.836       8.44
##  5        0.94   29.4       0.938       9.48
##  6        1.31   33.0       0.977       9.87
##  7        1.83   33.6       0.996      10.1 
##  8        2.54   30.8       0.970       9.80
##  9        3.54   25.4       0.856       8.64
## 10        4.93   18.9       0.681       6.88
## 11        6.87   12.7       0.513       5.19
## 12        9.57    7.81      0.381       3.85</code></pre>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="#cb728-1" aria-hidden="true" tabindex="-1"></a>ACh1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb728-2"><a href="#cb728-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-584-1.png" width="336" /></p>
<p>Notice that <code>ACh1</code> does not contain any predicted values from the <strong>truncated log-parabola model</strong> of the CSF. And yet, somehow, <code>sm_CSF()</code> manages to plot the <strong>predicted values</strong> from the model with the given data, rather than the points of the actual data themselves. Let’s walk through these steps to understand what is happening behind the scenes.</p>
<div id="sm_params" class="section level3 hasAnchor" number="15.2.1">
<h3 class="hasAnchor"><span class="header-section-number">15.2.1</span> <code>sm_params()</code><a href="#sm_params" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sm_params()</code> returns the four main parameters of the model that result in the lowest difference (i.e., residual sum of squares = RSS) between the fitted values <span class="math inline">\(\hat{y_{i}}\)</span> and the actual data (<span class="math inline">\(y_{i}\)</span>, linear data). The fitted values <span class="math inline">\(\hat{y_{i}}\)</span> are the ones that result from plugging in four parameters into the formulas of the model, which is specified in <code>sm_findQCSF()</code> and described in the earlier section of the chapter. The RSS is computed as:</p>
<p><span class="math inline">\(\sum_{i=1}^{n}(\hat{y_{i}} - y_{i})^{2}\)</span></p>
<p>In short, the smaller the RSS, the better the model is because it means that the model describes the actual data more faithfully.</p>
<p><code>sm_params()</code> repeatedly plugs in different combinations and permutations of the four parameters. This process is repeated many times until the four parameters yield the smallest RSS. This process is known as <strong>optimization</strong>. During the first iteration of optimization, it uses initial guess parameters, which are provided by the argument <code>param0</code>, to calculate the RSS. Then, it tries another four parameters. The ranges of the parameters are limited, however. When the parameters of the CSF model are estimated, it is standard to set the upper and lower bound of the parameters. These are set by the arguments <code>param_upLimit</code> and <code>param_lowLimit</code>, respectively. <code>sm_params()</code> specifically uses the <code>L-BFGS-B</code> algorithm to perform the optimization so that upper and lower bounds can be set to estimate the parameters that yield the minimum RSS. <strong>smCSF</strong> provides default values for <code>param0</code>, <code>param_upLimit</code> and <code>param_lowLimit</code> (see the values below) so that the user does not have to be stressed about these initial parameters, and can easily visualize and analyze the contrast sensitivity function.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true" tabindex="-1"></a>param0 <span class="ot">=</span> <span class="fu">log10</span>(<span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.5</span>))</span>
<span id="cb729-2"><a href="#cb729-2" aria-hidden="true" tabindex="-1"></a>param_upLimit <span class="ot">=</span> <span class="fu">log10</span>(<span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">20</span>, <span class="dv">9</span>, <span class="dv">2</span>)) </span>
<span id="cb729-3"><a href="#cb729-3" aria-hidden="true" tabindex="-1"></a>param_lowLimit<span class="ot">=</span> <span class="fu">log10</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="fl">0.02</span>)) </span></code></pre></div>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">sm_params</span>(ACh1<span class="sc">$</span>SpatialFreq, ACh1<span class="sc">$</span>avgSens, param0,</span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a>          param_upLimit, param_lowLimit)</span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-4"><a href="#cb730-4" aria-hidden="true" tabindex="-1"></a>params</span></code></pre></div>
<pre><code>##        logGain      logPeakSF logOctaveWidth       logTrunc    logCutOffSF 
##      1.5114544      0.1450387      0.6006582     -0.3010300      1.4909611</code></pre>
<p>The first four parameters (<code>logGain</code>, <code>logPeakSF</code>, <code>logOctaveWidth</code> and <code>logTrunc</code>) yield the lowest RSS possible between the actual data and the fitted values.</p>
</div>
<div id="sm_cutoff" class="section level3 hasAnchor" number="15.2.2">
<h3 class="hasAnchor"><span class="header-section-number">15.2.2</span> <code>sm_cutOff()</code><a href="#sm_cutoff" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the first three parameters (<code>logGain</code>, <code>logPeakSF</code> and <code>logOctaveWidth</code>), <code>sm_cutOff()</code> computes the cutoff spatial frequency, which is also printed as the 5th parameter from <code>sm_params()</code>. In other words, <code>sm_params()</code> also runs the function <code>sm_cutOff()</code> to obtain the cutoff spatial frequency.</p>
<p>The a fourth argument of <code>sm_cutOff()</code> is <code>sensCutOff</code>. The default is set to 1. This refers to the sensitivity level that the user wishes to measure the cut-off spatial frequency. This means that the cut-off SF is measured when the linear sensitivity equals to 1 for the default,.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="#cb732-1" aria-hidden="true" tabindex="-1"></a>params[[<span class="dv">5</span>]]</span></code></pre></div>
<pre><code>## [1] 1.490961</code></pre>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_cutOff</span>(params[[<span class="dv">1</span>]], params[[<span class="dv">2</span>]], params[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## [1] 1.490961</code></pre>
<p><code>sm_cutOff()</code> computes the cutoff spatial frequency and returns it in a log10 unit. In a linear spatial frequency, this can be about 30.97 c/deg.</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear conversion of the log units</span></span>
<span id="cb736-2"><a href="#cb736-2" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span><span class="sc">^</span>params</span></code></pre></div>
<pre><code>##        logGain      logPeakSF logOctaveWidth       logTrunc    logCutOffSF 
##      32.467917       1.396493       3.987110       0.500000      30.971422</code></pre>
<p>Let’s visually confirm whether the cut-off spatial frequency yields sensitivity that is equal to 0. First, we will need to create a sequence of x values (about 200) to plot a continuous function of the CSF model from the minimum tested SF (<code>min(ACh1$SpatialFreq)</code>) to 31 c/deg. This can be done using <code>seq()</code> function.</p>
<p>Then using the sequence of the x values, we plug them into the CSF formulas with the parameters that we have obtained using <code>sm_params()</code> to obtain the fitted values.</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fu">min</span>(ACh1<span class="sc">$</span>SpatialFreq),<span class="dv">31</span>, <span class="at">length =</span> <span class="dv">200</span>))</span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-3"><a href="#cb738-3" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">sm_findQCSF</span>(<span class="fu">log10</span>(grid<span class="sc">$</span>x), </span>
<span id="cb738-4"><a href="#cb738-4" aria-hidden="true" tabindex="-1"></a>                         params[[<span class="dv">1</span>]], params[[<span class="dv">2</span>]],</span>
<span id="cb738-5"><a href="#cb738-5" aria-hidden="true" tabindex="-1"></a>                         params[[<span class="dv">3</span>]], params[[<span class="dv">4</span>]])</span>
<span id="cb738-6"><a href="#cb738-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-7"><a href="#cb738-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(grid,<span class="dv">10</span>) <span class="co"># first 10 rows</span></span></code></pre></div>
<pre><code>##            x        y
## 1  0.2500000 11.08954
## 2  0.4045226 18.59659
## 3  0.5590452 23.95092
## 4  0.7135678 27.56634
## 5  0.8680905 29.91028
## 6  1.0226131 31.34346
## 7  1.1771357 32.12558
## 8  1.3316583 32.44129
## 9  1.4861809 32.42228
## 10 1.6407035 32.16323</code></pre>
<p><code>grid</code> variable contains all the fitted values as a function of the <code>x</code> values.</p>
<p>Now let’s plot the fitted values.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="#cb740-1" aria-hidden="true" tabindex="-1"></a>grid <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb740-2"><a href="#cb740-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb740-3"><a href="#cb740-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb740-4"><a href="#cb740-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb740-5"><a href="#cb740-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb740-6"><a href="#cb740-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">max</span>(ACh1<span class="sc">$</span>SpatialFreq),</span>
<span id="cb740-7"><a href="#cb740-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>), <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb740-8"><a href="#cb740-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb740-9"><a href="#cb740-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">1.5</span>, </span>
<span id="cb740-10"><a href="#cb740-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;maximum tested</span><span class="sc">\n</span><span class="st">SF&#39;</span>, <span class="at">color =</span> </span>
<span id="cb740-11"><a href="#cb740-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-591-1.png" width="336" /></p>
<p>If you use <code>sm_CSF()</code>, you will get the same plot, but this plot only has a x-range from the minimum and maximum values of the spatial frequency within the <code>SpatialFreq</code> column of <code>ACh1</code>. You might get some warning messages after the running the example code below but you can ignore them altogether.</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="#cb741-1" aria-hidden="true" tabindex="-1"></a>ACh1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb741-2"><a href="#cb741-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb741-3"><a href="#cb741-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb741-4"><a href="#cb741-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(grid<span class="sc">$</span>x),<span class="fu">max</span>(grid<span class="sc">$</span>x))) <span class="sc">+</span></span>
<span id="cb741-5"><a href="#cb741-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(grid<span class="sc">$</span>y), <span class="fu">max</span>(grid<span class="sc">$</span>y)), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">30</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-592-1.png" width="336" /></p>
<p>From the first plot, it is visually clear that at about 31 c/deg, the linear sensitivity approaches 1 (i.e., log-sensitivity = 0). We can also directly see the fitted values in the <code>grid</code> data frame and confirm our qualitative observation.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(grid)</span></code></pre></div>
<pre><code>##            x        y
## 195 30.22739 1.049434
## 196 30.38191 1.037546
## 197 30.53643 1.025833
## 198 30.69095 1.014292
## 199 30.84548 1.002919
## 200 31.00000 1.000000</code></pre>
</div>
</div>
<div id="understanding-sm_ribboncsf" class="section level2 hasAnchor" number="15.3">
<h2 class="hasAnchor"><span class="header-section-number">15.3</span> Understanding <code>sm_ribbonCSF()</code><a href="#understanding-sm_ribboncsf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another highlight of the <strong>smCSF</strong> package is the function <code>sm_ribbonCSF()</code>, which magically plots the ribbon shades around the fitted CSF from <code>sm_CSF()</code>.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="#cb744-1" aria-hidden="true" tabindex="-1"></a>ACh1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb744-2"><a href="#cb744-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_ribbonCSF</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb744-3"><a href="#cb744-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)) <span class="sc">+</span></span>
<span id="cb744-4"><a href="#cb744-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() <span class="sc">+</span> </span>
<span id="cb744-5"><a href="#cb744-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-594-1.png" width="336" /></p>
<p>How is that the plot above shows the standard deviation across the sequence of x-values even if the contrast sensitivity has been tested at across only 12 unique spatial frequencies?</p>
<p>This is because the plot shown above shows <strong>3 fits</strong> of the CSF rather than 1. The one that the reader can obviously recognize is the CSF fit using the raw data, shown as the black line. The other 2 fits are less apparent. These are basically the upper and lower bounds of the CSF ribbon.</p>
<p>The upper fit of the CSF is created using values from <code>ymax = avgSens + stdDevSens</code>. The lower fit of the CSF is done so using values from <code>ymin = avgSens - stdDevSens</code>. <code>ymax</code> and <code>ymin</code> values are used to estimate the 4 parameters of the CSF fit each. These are then used to fit the CSF curves.</p>
<p>Let’s recreate the plot above using only <code>sm_CSF()</code> and without <code>sm_ribbonCSF()</code>. To do so, we will need to create two more columns <code>ymin</code> and <code>ymax</code>.</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="#cb745-1" aria-hidden="true" tabindex="-1"></a>ACh2 <span class="ot">&lt;-</span> ACh1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ymin =</span> avgSens <span class="sc">-</span> stdDevSens,</span>
<span id="cb745-2"><a href="#cb745-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymax =</span> avgSens <span class="sc">+</span> stdDevSens)</span>
<span id="cb745-3"><a href="#cb745-3" aria-hidden="true" tabindex="-1"></a>ACh2</span></code></pre></div>
<pre><code>## # A tibble: 12 x 6
##    SpatialFreq avgSens stdErrSens stdDevSens  ymin  ymax
##          &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1        0.25   13.2       0.536       5.41  7.78  18.6
##  2        0.35   15.2       0.568       5.74  9.50  21.0
##  3        0.49   19.1       0.698       7.05 12.1   26.2
##  4        0.68   24.3       0.836       8.44 15.9   32.8
##  5        0.94   29.4       0.938       9.48 20.0   38.9
##  6        1.31   33.0       0.977       9.87 23.1   42.9
##  7        1.83   33.6       0.996      10.1  23.5   43.6
##  8        2.54   30.8       0.970       9.80 21.0   40.6
##  9        3.54   25.4       0.856       8.64 16.8   34.1
## 10        4.93   18.9       0.681       6.88 12.0   25.8
## 11        6.87   12.7       0.513       5.19  7.51  17.9
## 12        9.57    7.81      0.381       3.85  3.96  11.7</code></pre>
<p>The code below will generate warning messages but these are trivial, so you can ignore them.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="#cb747-1" aria-hidden="true" tabindex="-1"></a>ACh2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> avgSens)) <span class="sc">+</span></span>
<span id="cb747-2"><a href="#cb747-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>() <span class="sc">+</span></span>
<span id="cb747-3"><a href="#cb747-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> ymin), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb747-4"><a href="#cb747-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_CSF</span>(<span class="fu">aes</span>(<span class="at">x =</span> SpatialFreq, <span class="at">y =</span> ymax), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb747-5"><a href="#cb747-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-596-1.png" width="336" /></p>
<p>We now have recreated the same plot without using <code>sm_ribbonCSF()</code>.</p>
</div>
<div id="calculating-the-five-parameters-of-all-subjects-groups-and-conditions" class="section level2 hasAnchor" number="15.4">
<h2 class="hasAnchor"><span class="header-section-number">15.4</span> Calculating the five parameters of all subjects, groups and conditions<a href="#calculating-the-five-parameters-of-all-subjects-groups-and-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have discussed in detail what the parameters mean and how <code>sm_CSF()</code> and <code>sm_ribbonCSF()</code> plot the CSF curves. We have also discussed how to use <code>sm_params()</code> with the given data. Now, lets use <code>sm_params_list()</code> to compute the five parameters of all subjects across groups and conditions. To do so, we will need a data frame that contains the data of each observer that has been assigned to a group and condition. <code>ACh1</code> is an example of such a data frame.</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="#cb748-1" aria-hidden="true" tabindex="-1"></a>ACh</span></code></pre></div>
<pre><code>## # A tibble: 1,224 x 4
##    Subject Repetition SpatialFreq Sensitivity
##    &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 S1               1        0.25       23.8 
##  2 S2               1        0.25       18.0 
##  3 S3               1        0.25       14.2 
##  4 S4               1        0.25        5.14
##  5 S5               1        0.25       16.0 
##  6 S6               1        0.25       10.9 
##  7 S7               1        0.25        8.41
##  8 S8               1        0.25       10.5 
##  9 S9               1        0.25        9.06
## 10 S10              1        0.25        3.57
## # ... with 1,214 more rows</code></pre>
<p><code>sm_params_list()</code> work very similarly to <code>sm_trapz_list()</code>, <code>sm_AULCSF_list()</code> and <code>sm_r2_list()</code>. Here are the arguments:</p>
<ul>
<li><code>data</code> = this argument requires the variable that stores the data frame. In our case, it is <code>ACh</code>. Data <strong>should be </strong> in linear units.</li>
<li><code>subjects</code> = this argument requires the name of the column of the data frame that contains subjects. It must strings, ex. <code>'Subject'</code>, not <code>Subject</code>.</li>
<li><code>groups</code> = this argument requires the name of the column of the data frame that contains each group. In this example, there is no group. An example would be <code>Group</code> column that contains two groups: <code>Normal</code> and <code>Amblyopia</code>.</li>
<li><code>conditions</code> = this argument requires name of the column of the data frame that contains each condition. In our example, the two conditions are <code>1</code> and <code>2</code> from the <code>Repetition</code> column.</li>
<li><code>x</code> = this argument requires the name of the column of the data frame that contains the x-axis points from which the AUC can be calculated. In our case, these are values from the <code>SpatialFreq</code> column of <code>ACh</code>. It must be strings, ex. <code>'SpatialFreq'</code>, not <code>SpatialFreq</code>. Also, it must be <strong>numeric</strong>/<strong>double</strong>, NOT <strong>factor</strong>. Make sure you check that the column is numeric. If its not, convert the column of the dataframe into <strong>double</strong> beforehand. ex. <code>df$SpatialFreq &lt;- as.numeric(df$SpatialFreq)</code></li>
<li><code>values</code> = this argument requires the name of the column of the data frame that contains the actual data, which are the y-axis points from which the AUC can be calculated. In our case, it is the change in contrast balance ratio. It must strings, ex. <code>'Sensitivity'</code>, not <code>Sensitivity</code>.</li>
<li><code>param0</code> = This argument should a vector that contains the initial guess values for the four parameters (peak gain, peak spatial frequency, bandwidth and truncation value) of the log-truncated CSF model. This argument is not required because the default has been set to <code>log10(c(100, 1, 2, 0.5))</code>.</li>
<li><code>param_upLimit</code> = This argument should be a vector that contains the upper bounds of the four parameters (peak gain, peak spatial frequency, bandwidth and truncation value) of the log-truncated CSF model. This argument is not required because the default has been set to <code>log10(c(2000, 20, 9, 2))</code>.</li>
<li><code>param_lowLimit</code> = This argument should be a vector that contains the lower bounds of the four parameters (peak gain, peak spatial frequency, bandwidth and truncation value) of the log-truncated CSF model. This argument is not required because the default has been set to <code>log10(c(2, 0.2, 1, 0.02))</code>.</li>
</ul>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="#cb750-1" aria-hidden="true" tabindex="-1"></a>params_df <span class="ot">&lt;-</span> <span class="fu">sm_params_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb750-2"><a href="#cb750-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Repetition&#39;</span>,</span>
<span id="cb750-3"><a href="#cb750-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb750-4"><a href="#cb750-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb750-5"><a href="#cb750-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh)</span></code></pre></div>
<pre><code>## [1] &quot;CSF parameters = Sensitivity ~ SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="#cb752-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(params_df[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>##   Subject Repetition  logGain  logPeakSF logOctaveWidth logTrunc logCutOffSF
## 1      S1          1 1.629834 0.09807101      0.6119619 -0.30103    1.522009
## 2      S1          2 1.569498 0.01320197      0.5270044 -0.30103    1.216546
## 3      S2          1 1.562791 0.18084246      0.6510530 -0.30103    1.664255
## 4      S2          2 1.521231 0.22933453      0.6888543 -0.30103    1.777866
## 5      S3          1 1.394250 0.14405204      0.6446500 -0.30103    1.531413
## 6      S3          2 1.668939 0.17290997      0.5060525 -0.30103    1.364456</code></pre>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="#cb754-1" aria-hidden="true" tabindex="-1"></a>params_df[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>##  [1] 0.25 0.35 0.49 0.68 0.94 1.31 1.83 2.54 3.54 4.93 6.87 9.57</code></pre>
<p><code>sm_params_list()</code> returns a <code>list</code>, which as two elements. The first element has a data frame of all the parameters as well as the identifiers for <code>conditions</code> and <code>subjects</code>. The second element contains a vector that has <code>x</code>, which in this case is the linear units of spatial frequency.</p>
</div>
<div id="visualization-of-the-parameters" class="section level2 hasAnchor" number="15.5">
<h2 class="hasAnchor"><span class="header-section-number">15.5</span> Visualization of the parameters<a href="#visualization-of-the-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is a visual representation of the parameters. The contrast sensitivity function has been drawn with the four parameters that have been obtained from the <code>ACh</code> data set. The four parameters have been used to draw the contrast sensitivity function all the way to 30 c/deg. As an exercise, the reader can produce the example below. This plot has been entirely drawn with R, including the arrow and text annotations.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-600-1.png" width="336" /></p>
</div>
<div id="case-study-1" class="section level2 hasAnchor" number="15.6">
<h2 class="hasAnchor"><span class="header-section-number">15.6</span> Case Study<a href="#case-study-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous chapter, I foreshadow that there is a parameter that can inform us about whether the high-spatial frequency range has improved or not. There are two parameters: 1) bandwidth, and 2) cut-off spatial frequency. Kim et al does not use the bandwidth to analyze their results because the authors believe that analyzing both bandwidth and cut-off spatial frequency is redundant. Likewise, this case study only shows the analysis of cut-off spatial frequency but this can be applied to all other parameters as well.</p>
<p>As in the previous chapter, let’s make some fake data with <code>ACh</code>. This new data frame is stored in the variable named <code>ACh3</code>. We assume that the 51 subjects are visually impaired patients who received clinical treatment for visual improvement.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="#cb756-1" aria-hidden="true" tabindex="-1"></a>ACh<span class="sc">$</span>Repetition <span class="ot">&lt;-</span> <span class="fu">factor</span>(ACh<span class="sc">$</span>Repetition)</span>
<span id="cb756-2"><a href="#cb756-2" aria-hidden="true" tabindex="-1"></a>ACh3 <span class="ot">&lt;-</span> ACh <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">BeforeAfter =</span> <span class="fu">fct_recode</span>(Repetition,</span>
<span id="cb756-3"><a href="#cb756-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;Before&#39;</span> <span class="ot">=</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb756-4"><a href="#cb756-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;After&#39;</span> <span class="ot">=</span> <span class="st">&#39;2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb756-5"><a href="#cb756-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Repetition)</span>
<span id="cb756-6"><a href="#cb756-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb756-7"><a href="#cb756-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb756-8"><a href="#cb756-8" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(ACh3<span class="sc">$</span>BeforeAfter <span class="sc">==</span> <span class="st">&#39;After&#39;</span>)</span>
<span id="cb756-9"><a href="#cb756-9" aria-hidden="true" tabindex="-1"></a>ACh3[ind,]<span class="sc">$</span>Sensitivity <span class="ot">&lt;-</span> ACh3[ind,]<span class="sc">$</span>Sensitivity <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(ind), <span class="dv">31</span>, <span class="dv">35</span>))</span></code></pre></div>
<p>Now let’s calculate five parameters using <code>sm_params_list()</code>.</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="#cb757-1" aria-hidden="true" tabindex="-1"></a>params_df <span class="ot">&lt;-</span> <span class="fu">sm_params_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb757-2"><a href="#cb757-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;BeforeAfter&#39;</span>,</span>
<span id="cb757-3"><a href="#cb757-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;SpatialFreq&#39;</span>, </span>
<span id="cb757-4"><a href="#cb757-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values =</span> <span class="st">&#39;Sensitivity&#39;</span>, </span>
<span id="cb757-5"><a href="#cb757-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ACh3)</span></code></pre></div>
<pre><code>## [1] &quot;CSF parameters = Sensitivity ~ SpatialFreq&quot;</code></pre>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="#cb759-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(params_df[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>##   Subject BeforeAfter  logGain   logPeakSF logOctaveWidth logTrunc logCutOffSF
## 1      S1      Before 1.629834  0.09807101      0.6119619 -0.30103    1.522009
## 2      S1       After 1.902661  0.48036071      0.8259008 -0.30103    2.556726
## 3      S2      Before 1.562791  0.18084246      0.6510530 -0.30103    1.664255
## 4      S2       After 1.892264  0.20854797      0.7047611 -0.30103    1.975513
## 5      S3      Before 1.394250  0.14405204      0.6446500 -0.30103    1.531413
## 6      S3       After 2.005334 -0.02095422      0.6068997 -0.30103    1.545456</code></pre>
<p>Let’s store the results of cut-off spatial frequency in a new variable <code>cut_sf</code> along with <code>Subject</code> and <code>BeforeAfter</code> columns.</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="#cb761-1" aria-hidden="true" tabindex="-1"></a>cut_sf <span class="ot">&lt;-</span> params_df[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>)]</span>
<span id="cb761-2"><a href="#cb761-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cut_sf)</span></code></pre></div>
<pre><code>##   Subject BeforeAfter logCutOffSF
## 1      S1      Before    1.522009
## 2      S1       After    2.556726
## 3      S2      Before    1.664255
## 4      S2       After    1.975513
## 5      S3      Before    1.531413
## 6      S3       After    1.545456</code></pre>
<p>After we convert the cut-off SF into linear units, let’s plot a bar graph to show the results and see whether cut-off SF has increased. If it increases, it shows that the high spatial frequncy range’s overall sensitivity has improved. This also applies to the bandwidth.</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="#cb763-1" aria-hidden="true" tabindex="-1"></a>cut_sf<span class="sc">$</span>linCutOff <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>cut_sf<span class="sc">$</span>logCutOffSF</span>
<span id="cb763-2"><a href="#cb763-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cut_sf)</span></code></pre></div>
<pre><code>##   Subject BeforeAfter logCutOffSF linCutOff
## 1      S1      Before    1.522009  33.26667
## 2      S1       After    2.556726 360.35096
## 3      S2      Before    1.664255  46.15881
## 4      S2       After    1.975513  94.51766
## 5      S3      Before    1.531413  33.99482
## 6      S3       After    1.545456  35.11200</code></pre>
<p>Notice that we have created a new column entitled <code>linCutOff</code>. We will now plot the values from the column, as shown below.</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="#cb765-1" aria-hidden="true" tabindex="-1"></a>cut_sf <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BeforeAfter, <span class="at">y =</span> linCutOff,</span>
<span id="cb765-2"><a href="#cb765-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> BeforeAfter)) <span class="sc">+</span></span>
<span id="cb765-3"><a href="#cb765-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">point.params =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">size=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb765-4"><a href="#cb765-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb765-5"><a href="#cb765-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb765-6"><a href="#cb765-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Cut-off spatial frequency&#39;</span>) <span class="sc">+</span></span>
<span id="cb765-7"><a href="#cb765-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Cut-off SF (c/deg)&#39;</span>) <span class="sc">+</span></span>
<span id="cb765-8"><a href="#cb765-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Before/after treatment&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-606-1.png" width="336" /></p>
<!--chapter:end:Csf3.Rmd-->
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
