<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Data Analysis and Visualization in R Using smplot</title>
  <meta name="description" content="Data Analysis and Visualization in R Using smplot" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Data Analysis and Visualization in R Using smplot" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Analysis and Visualization in R Using smplot" />
  
  
  

<meta name="author" content="Seung Hyun Min" />


<meta name="date" content="2022-05-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Data Analysis and Visualization in R Using smplot</h1>
<p class="author"><em>Seung Hyun Min</em></p>
<p class="date"><em>2022-05-08</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#index">Welcome!</a>
<ul>
<li><a href="#major-updates-on-smplot">Major updates on smplot</a></li>
<li><a href="#please-cite-this-paper-when-smplot-is-used">Please cite this paper when smplot is used</a></li>
<li><a href="#for-r-and-ggplot2-experts">For R and ggplot2 experts</a></li>
<li><a href="#issues-and-contact">Issues and contact</a></li>
<li><a href="#license">License</a></li>
</ul></li>
<li><a href="#download-rstudio-basics-of-r"><span class="toc-section-number">1</span> Download RStudio &amp; Basics of R</a>
<ul>
<li><a href="#setting-up-rstudio"><span class="toc-section-number">1.1</span> Setting up RStudio</a>
<ul>
<li><a href="#why-use-r-for-data-visualization">Why use R for data visualization?</a></li>
<li><a href="#other-available-resources-for-r">Other available resources for R</a></li>
<li><a href="#download-requirements-for-rstudio">Download requirements for RStudio</a></li>
<li><a href="#open-rstudio">Open RStudio</a></li>
<li><a href="#lets-make-a-folder-and-set-it-as-working-directory">Let’s make a folder and set it as working directory</a></li>
<li><a href="#how-to-run-your-code"><span class="toc-section-number">1.1.1</span> How to run your code</a></li>
</ul></li>
<li><a href="#basics-of-r"><span class="toc-section-number">1.2</span> Basics of R</a>
<ul>
<li><a href="#lets-type-some-codes">Let’s type some codes</a></li>
<li><a href="#how-can-i-learn-most-effectively-with-the-notes">How can I learn most effectively with the notes?</a></li>
<li><a href="#more-installation">More installation</a></li>
</ul></li>
</ul></li>
<li><a href="#basics-of-ggplot2-and-correlation-plot"><span class="toc-section-number">2</span> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li><a href="#uploading-data"><span class="toc-section-number">2.1</span> Uploading data</a>
<ul>
<li><a href="#sample-data-mpg">Sample data: mpg</a></li>
</ul></li>
<li><a href="#basics-of-ggplot2"><span class="toc-section-number">2.2</span> Basics of ggplot2</a>
<ul>
<li><a href="#lets-make-some-graphs">Let’s make some graphs</a></li>
<li><a href="#how-ggplot-works">How ggplot works</a></li>
<li><a href="#different-color-of-points-for-each-unique-group">Different color of points for each unique group</a></li>
<li><a href="#different-color-shape-for-each-group">Different color &amp; shape for each group</a></li>
<li><a href="#same-shape-across-all-groups">Same shape across all groups</a></li>
<li><a href="#exercise-try-changing-the-shape-of-the-points-to-the-circle-with-the-border.">Exercise: try changing the shape of the points to the circle with the border.</a></li>
<li><a href="#how-do-we-draw-the-best-fit-line-of-the-graph">How do we draw the best-fit line of the graph?</a></li>
<li><a href="#geom_point-geom_smooth">geom_point() + geom_smooth()</a></li>
<li><a href="#writing-shorter-codes">Writing shorter codes</a></li>
</ul></li>
<li><a href="#improve-data-visualization-using-smplot"><span class="toc-section-number">2.3</span> Improve Data Visualization using smplot</a>
<ul>
<li><a href="#positive-relationship-between-x--and-y-axes">Positive relationship between x- and y-axes</a></li>
<li><a href="#reporting-statistics-from-a-paired-correlation">Reporting statistics from a paired correlation</a></li>
<li><a href="#fill-0f993d-vs-fill-green"><code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li><a href="#different-color-for-each-group-but-with-other-colors">Different color for each group but with other colors</a></li>
<li><a href="#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1.">Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li><a href="#summary"><span class="toc-section-number">2.4</span> Summary</a></li>
</ul></li>
<li><a href="#boxplot-and-violin-plot"><span class="toc-section-number">3</span> Boxplot and Violin Plot</a>
<ul>
<li><a href="#upload-sample-data-csv-file-in-rstudio"><span class="toc-section-number">3.1</span> Upload Sample Data (csv file) in RStudio</a>
<ul>
<li><a href="#download-requirements">Download requirements</a></li>
<li><a href="#before-we-get-started">Before we get started</a></li>
<li><a href="#data.csv">data.csv</a></li>
<li><a href="#read_csvdata.csv"><code>read_csv('data.csv')</code></a></li>
<li><a href="#best-way-to-plot-data">Best way to plot data</a></li>
</ul></li>
<li><a href="#boxplot"><span class="toc-section-number">3.2</span> Boxplot</a>
<ul>
<li><a href="#what-is-a-boxplot">What is a boxplot?</a></li>
<li><a href="#boxplot-vs-bar-graph">Boxplot vs bar graph</a></li>
<li><a href="#boxplot-using-ggplot2">Boxplot using ggplot2</a></li>
<li><a href="#problem-alphabetical-order">Problem: Alphabetical order</a></li>
<li><a href="#displaying-characters-in-a-non-alphabetical-order">Displaying characters in a non-alphabetical order</a></li>
<li><a href="#double-check-if-the-day-column-is-factor">Double-check if the ‘Day’ column is factor</a></li>
<li><a href="#back-to-boxplot-using-ggplot2">Back to boxplot using ggplot2</a></li>
<li><a href="#a-boxplot-with-individual-data">A boxplot with individual data</a></li>
<li><a href="#geom_boxplot-vs-sm_boxplot"><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li><a href="#save-boxplot">Save boxplot</a></li>
</ul></li>
<li><a href="#violin-plot"><span class="toc-section-number">3.3</span> Violin Plot</a>
<ul>
<li><a href="#structure-of-the-violin-plot">Structure of the violin plot</a></li>
<li><a href="#violin-plot-with-ggplot2">Violin plot with ggplot2</a></li>
<li><a href="#violin-plot-with-individual-points">Violin plot with individual points</a></li>
<li><a href="#geom_violin-vs-sm_violin">geom_violin() vs sm_violin()</a></li>
<li><a href="#save-your-violin-plot">Save your violin plot</a></li>
</ul></li>
<li><a href="#summary-1"><span class="toc-section-number">3.4</span> Summary</a></li>
</ul></li>
<li><a href="#manual-and-examples-of-smplot"><span class="toc-section-number">4</span> Manual and Examples of smplot</a>
<ul>
<li><a href="#installation-of-the-package"><span class="toc-section-number">4.1</span> Installation of the Package</a>
<ul>
<li><a href="#what-is-smplot">What is <code>smplot</code>?</a></li>
</ul></li>
<li><a href="#smplots-color-palette-and-graph-themes"><span class="toc-section-number">4.2</span> smplot’s Color Palette and Graph Themes</a>
<ul>
<li><a href="#smplots-color-palette">smplot’s color palette</a></li>
<li><a href="#smplots-graph-themes">smplot’s graph themes</a></li>
</ul></li>
<li><a href="#correlation-plot"><span class="toc-section-number">4.3</span> Correlation Plot</a>
<ul>
<li><a href="#data-frame-for-a-correlation-plot"><span class="toc-section-number">4.3.1</span> Data frame for a correlation plot</a></li>
<li><a href="#correlation-plot-with-both-regression-and-reference-lines"><span class="toc-section-number">4.3.2</span> Correlation plot with both regression and reference lines</a></li>
</ul></li>
<li><a href="#boxplot---sm_boxplot"><span class="toc-section-number">4.4</span> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors"><span class="toc-section-number">4.4.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#violin-plot---sm_violin"><span class="toc-section-number">4.5</span> Violin Plot - <code>sm_violin()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors-1"><span class="toc-section-number">4.5.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#bar-plot---sm_bar"><span class="toc-section-number">4.6</span> Bar Plot - <code>sm_bar()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors-2"><span class="toc-section-number">4.6.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#slope-chart---sm_slope"><span class="toc-section-number">4.7</span> Slope Chart - <code>sm_slope()</code></a></li>
<li><a href="#a-bland-altman-plot---sm_bland_altman"><span class="toc-section-number">4.8</span> A Bland Altman Plot - <code>sm_bland_altman()</code></a></li>
<li><a href="#raincloud-plot---sm_raincloud"><span class="toc-section-number">4.9</span> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li><a href="#overriding-defaults-of-smplots-themes"><span class="toc-section-number">4.10</span> Overriding Defaults of smplot’s Themes</a></li>
<li><a href="#overriding-defaults-of-smplot-colors"><span class="toc-section-number">4.11</span> Overriding Defaults of smplot Colors</a></li>
</ul></li>
<li><a href="#combining-plots-with-common-axes"><span class="toc-section-number">5</span> Combining Plots with Common Axes</a>
<ul>
<li><a href="#filter-select-and-summarise"><span class="toc-section-number">5.1</span> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></a>
<ul>
<li><a href="#filter-for-rows"><span class="toc-section-number">5.1.1</span> <code>filter()</code> for rows</a></li>
<li><a href="#select-for-columns"><span class="toc-section-number">5.1.2</span> <code>select()</code> for columns</a></li>
<li><a href="#summarise-for-grouped-summaries"><span class="toc-section-number">5.1.3</span> <code>summarise()</code> for grouped summaries</a></li>
</ul></li>
<li><a href="#plotting-average-data-with-error-bars"><span class="toc-section-number">5.2</span> Plotting average data with error bars</a></li>
<li><a href="#plotting-individual-data"><span class="toc-section-number">5.3</span> Plotting Individual Data</a></li>
</ul></li>
<li><a href="#calculating-area-under-a-curve"><span class="toc-section-number">6</span> Calculating Area under a Curve</a>
<ul>
<li><a href="#pipe"><span class="toc-section-number">6.1</span> Pipe <code>%&gt;%</code></a></li>
<li><a href="#area-under-a-curve"><span class="toc-section-number">6.2</span> Area under a curve</a></li>
<li><a href="#reproducing-figures-in-the-paper-min-et-al.-2019"><span class="toc-section-number">6.3</span> Reproducing figures in the paper (Min et al., 2019)</a>
<ul>
<li><a href="#figure-3b-a-best-fit-line-with-points-and-error-bars"><span class="toc-section-number">6.3.1</span> Figure 3B (a best-fit line with points and error bars)</a></li>
<li><a href="#figure-3d-a-bar-graph"><span class="toc-section-number">6.3.2</span> Figure 3D (a bar graph)</a></li>
<li><a href="#figure-3e-modeling-in-matlab-and-plotting-in-r"><span class="toc-section-number">6.3.3</span> Figure 3E (modeling in Matlab and plotting in R)</a></li>
</ul></li>
</ul></li>
<li><a href="#calculating-linear-slopes"><span class="toc-section-number">7</span> Calculating Linear Slopes</a>
<ul>
<li><a href="#linear-relationship-using-lm"><span class="toc-section-number">7.1</span> Linear relationship using <code>lm()</code></a></li>
<li><a href="#calculating-slopes-of-all-subjects-groups-and-conditions"><span class="toc-section-number">7.2</span> Calculating slopes of all subjects, groups and conditions</a></li>
</ul></li>
<li><a href="#basic-statistics"><span class="toc-section-number">8</span> Basic Statistics</a>
<ul>
<li><a href="#one-sample-t-test"><span class="toc-section-number">8.1</span> One-sample t-test</a></li>
<li><a href="#two-sample-t-test"><span class="toc-section-number">8.2</span> Two-sample t-test</a>
<ul>
<li><a href="#shapiro-wilk-test-to-test-for-normality-of-data"><span class="toc-section-number">8.2.1</span> Shapiro-Wilk Test to test for Normality of Data</a></li>
</ul></li>
<li><a href="#wilcoxon-signed-rank-test"><span class="toc-section-number">8.3</span> Wilcoxon Signed-rank Test</a></li>
<li><a href="#effect-size"><span class="toc-section-number">8.4</span> Effect Size</a></li>
<li><a href="#power-analysis"><span class="toc-section-number">8.5</span> Power Analysis</a></li>
<li><a href="#one-way-anova"><span class="toc-section-number">8.6</span> One-way ANOVA</a>
<ul>
<li><a href="#check-for-outliers"><span class="toc-section-number">8.6.1</span> Check for Outliers</a></li>
<li><a href="#checking-for-normality-of-data"><span class="toc-section-number">8.6.2</span> Checking for Normality of Data</a></li>
<li><a href="#checking-the-assumption-for-homogeneity-of-variance"><span class="toc-section-number">8.6.3</span> Checking the Assumption for Homogeneity of Variance</a></li>
<li><a href="#computing-one-way-anova"><span class="toc-section-number">8.6.4</span> Computing One-way ANOVA</a></li>
<li><a href="#post-hoc-tests"><span class="toc-section-number">8.6.5</span> Post-hoc Tests</a></li>
<li><a href="#one-way-repeated-measures-anova"><span class="toc-section-number">8.6.6</span> One-way Repeated Measures ANOVA</a></li>
</ul></li>
<li><a href="#two-way-anova"><span class="toc-section-number">8.7</span> Two-way ANOVA</a>
<ul>
<li><a href="#identifying-outliers"><span class="toc-section-number">8.7.1</span> Identifying Outliers</a></li>
<li><a href="#checking-for-normality-of-data-1"><span class="toc-section-number">8.7.2</span> Checking for Normality of Data</a></li>
<li><a href="#computing-two-way-anova"><span class="toc-section-number">8.7.3</span> Computing Two-way ANOVA</a></li>
<li><a href="#post-hoc-test"><span class="toc-section-number">8.7.4</span> Post-hoc Test</a></li>
</ul></li>
<li><a href="#extra-resources"><span class="toc-section-number">8.8</span> Extra Resources</a></li>
</ul></li>
<li><a href="#recreating-figures-from-front.-genetics-2021"><span class="toc-section-number">9</span> Recreating Figures from Front. Genetics (2021)</a>
<ul>
<li><a href="#figure-1---correlation-plot"><span class="toc-section-number">9.1</span> Figure 1 - Correlation Plot</a></li>
<li><a href="#figure-2---bar-plot"><span class="toc-section-number">9.2</span> Figure 2 - Bar Plot</a></li>
<li><a href="#figure-3---boxplot"><span class="toc-section-number">9.3</span> Figure 3 - Boxplot</a></li>
<li><a href="#figure-4---violin-plot"><span class="toc-section-number">9.4</span> Figure 4 - Violin Plot</a></li>
<li><a href="#figure-5---slope-chart"><span class="toc-section-number">9.5</span> Figure 5 - Slope Chart</a></li>
<li><a href="#figure-6---raincloud-plot"><span class="toc-section-number">9.6</span> Figure 6 - Raincloud Plot</a></li>
<li><a href="#figure-7---case-study"><span class="toc-section-number">9.7</span> Figure 7 - Case Study</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R Using smplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="index" class="section level1 unnumbered">
<h1 class="unnumbered">Welcome!</h1>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="710.4" /></p>
<p>This book (<a href="https://smin95.com/dataviz" class="uri">https://smin95.com/dataviz</a>) guides the reader to be familiar with R, a programming language, for data visualization. It also introduces the R package <strong>smplot</strong>, which aims to make the process of data visualization simple. This book was created entirely using RMarkdown for reproducibility.</p>
<div id="major-updates-on-smplot" class="section level2 unnumbered">
<h2 class="unnumbered">Major updates on smplot</h2>
<p>If you downloaded <strong>before May 8th, 2022</strong>, please <strong>re-download smplot</strong>. Some updates include：</p>
<ul>
<li><code>sm_auc_list()</code> has a new argument <code>groups</code>.</li>
<li><code>sm_slope_list()</code> has also been created.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot&#39;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="please-cite-this-paper-when-smplot-is-used" class="section level2 unnumbered">
<h2 class="unnumbered">Please cite this paper when smplot is used</h2>
<p><strong>Seung Hyun Min, Jiawei Zhou. smplot: An R Package for Easy and Elegant Data Visualization (2021). Frontiers in Genetics, 12:802894.</strong></p>
</div>
<div id="for-r-and-ggplot2-experts" class="section level2 unnumbered">
<h2 class="unnumbered">For R and ggplot2 experts</h2>
<p>Please read Chapter 4, which is a manual for <strong>smplot</strong>.</p>
</div>
<div id="issues-and-contact" class="section level2 unnumbered">
<h2 class="unnumbered">Issues and contact</h2>
<p>If you spot any mistakes in this online book, please pull-request on <a href="https://github.com/smin95/dataviz">Github</a> or email me <a href="mailto:seung.min@mail.mcgill.ca" class="email">seung.min@mail.mcgill.ca</a>. If you find issues with the ‘smplot’ package, please pull-request on <a href="https://github.com/smin95/smplot">Github</a>.</p>
</div>
<div id="license" class="section level2 unnumbered">
<h2 class="unnumbered">License</h2>
<p>smplot is under the MIT license. This tutorial is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. Seung Hyun Min is the sole creator of <strong>smplot</strong>.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="download-rstudio-basics-of-r" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Download RStudio &amp; Basics of R</h1>
<div id="setting-up-rstudio" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Setting up RStudio</h2>
<div id="why-use-r-for-data-visualization" class="section level3 unnumbered">
<h3 class="unnumbered">Why use R for data visualization?</h3>
<ul>
<li>R is free.</li>
<li>Often, less codes are needed in R to plot an elegant graph.</li>
<li>for/while loops (basic concepts in programming) are not necessary in R to make a production-quality graph.</li>
<li>R is the best software for statistical analysis.</li>
</ul>
</div>
<div id="other-available-resources-for-r" class="section level3 unnumbered">
<h3 class="unnumbered">Other available resources for R</h3>
<ul>
<li>Stack Overflow: <a href="https://www.stackoverflow.com" class="uri">https://www.stackoverflow.com</a></li>
<li>R for Data Science (a bible for learning R): <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></li>
<li>R documentation: <a href="https://www.rdocumentation.org" class="uri">https://www.rdocumentation.org</a></li>
<li>Learn Statistics with R: <a href="https://learningstatisticswithr.com/" class="uri">https://learningstatisticswithr.com/</a></li>
<li>ggplot2 (a reference for plotting data in R): <a href="https://ggplot2-book.org/" class="uri">https://ggplot2-book.org/</a></li>
</ul>
</div>
<div id="download-requirements-for-rstudio" class="section level3 unnumbered">
<h3 class="unnumbered">Download requirements for RStudio</h3>
<ul>
<li>Download R: <a href="http://cran.r-project.org/" class="uri">http://cran.r-project.org/</a></li>
<li>For Mac users: Mac: XQuartz <a href="https://www.xquartz.org/" class="uri">https://www.xquartz.org/</a></li>
<li>RStudio: <a href="http://www.rstudio.org/" class="uri">http://www.rstudio.org/</a></li>
</ul>
</div>
<div id="open-rstudio" class="section level3 unnumbered">
<h3 class="unnumbered">Open RStudio</h3>
<div class="figure" style="text-align: center">
<img src="img/rstudio.png" alt="Rstudio layout, image from http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" width="65%" />
<p class="caption">
(#fig:pressure)Rstudio layout, image from <a href="http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" class="uri">http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming</a>
</p>
</div>
<ul>
<li><strong>Rstudio</strong> is where people do R programming.</li>
<li>You can type codes (<strong>commands</strong>) into the <strong>console</strong> (bottom-left panel).
<ul>
<li><code>&gt;</code> means that the console is ready to receive more code.</li>
<li><code>+</code> means your code is not complete.</li>
</ul></li>
<li>You can also write (longer) codes in the <strong>script</strong> within the code editor (top-left panel).
<ul>
<li>The code editor will run the script into the console.</li>
<li>A <strong>new script</strong> can be opened by clicking: <strong>File -&gt; New -&gt; R Script</strong>.</li>
</ul></li>
<li>You can run a script by clicking <strong>’Run”</strong> with the green arrow or by typing <strong>ctrl + enter</strong>. It is labeled with the red circle.
<ul>
<li>Or you can just type your codes directly into the console.</li>
</ul></li>
</ul>
</div>
<div id="lets-make-a-folder-and-set-it-as-working-directory" class="section level3 unnumbered">
<h3 class="unnumbered">Let’s make a folder and set it as working directory</h3>
<div class="figure" style="text-align: center">
<img src="img/setwd.png" alt="Setting your working directory, image from https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html" width="80%" />
<p class="caption">
(#fig:unnamed-chunk-4)Setting your working directory, image from <a href="https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html" class="uri">https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html</a>
</p>
</div>
<ul>
<li>Create a folder named <strong>LearnR</strong> in Desktop.</li>
<li>Set the folder as your working directory by clicking: <strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>. Then find your <strong>LearnR</strong> folder.</li>
<li>More information about setting up a directory is here:
<a href="http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" class="uri">http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming</a></li>
<li>You will need set the directory <strong>every time</strong> you start RStudio.</li>
</ul>
</div>
<div id="how-to-run-your-code" class="section level3" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> How to run your code</h3>
<ul>
<li><p>You can run code in 2 ways.</p></li>
<li><p>First, you can type it in the script and run it after highlighting the codes you would like to run.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/run_code.PNG" alt="How to run your code - script" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-5)How to run your code - script
</p>
</div>
<ul>
<li>Second, you can type your code directly in the console.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/run_code_console.PNG" alt="How to run your code - console" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-6)How to run your code - console
</p>
</div>
</div>
</div>
<div id="basics-of-r" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Basics of R</h2>
<div id="lets-type-some-codes" class="section level3 unnumbered">
<h3 class="unnumbered">Let’s type some codes</h3>
<ul>
<li>Capitalization, punctuations and brackets are all important.</li>
<li><code>' '</code> and <code>" "</code> mean the same.</li>
<li>However, <code>' "</code> are not paired. So they will not work.</li>
<li><code>=</code> and <code>&lt;-</code> mean equivalent.
<ul>
<li>I often use <code>&lt;-</code>.</li>
</ul></li>
<li>Type <code>?</code> when you are not sure about the code (ex. <code>?t.test</code>)</li>
<li>A code becomes comment when it is preceded by <code>#</code>.
<ul>
<li>Try typing <code># g = 3</code> and see if the number gets stored in g by typing <strong>g</strong> in the console.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">3</span> <span class="co"># x equals to 3</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># a equals to 4 </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="st">&#39;Group&#39;</span> <span class="co"># gr is equal to a character &#39;Group&#39;, which is not a number.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="st">&quot;Group&quot;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>d <span class="sc">==</span> e <span class="co"># &#39;Group&#39; and &quot;Group&quot; are equal</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># g = 3 # its a comment</span></span></code></pre></div>
<ul>
<li>Notice that I used <code>==</code> to test if <strong>d</strong> and <strong>e</strong> are equal. Therefore, <code>==</code> and <code>=</code> mean different. <code>==</code> <strong>tests</strong> if two things are equal. <code>=</code> <strong>sets</strong> two things to be equal.
<ul>
<li><code>d == e</code> returns <code>TRUE</code> because they are both <code>'Group'</code>. <code>TRUE</code> is equivalent to 1 numerically.</li>
</ul></li>
<li>Now let’s check if <strong>x</strong> and <strong>a</strong> are equal.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> a</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<ul>
<li><p>It returns <code>FALSE</code> because <strong>x</strong> and <strong>a</strong> are not equal. This is correct because 3 and 4 are not equal. <code>FALSE</code> equals to 0 numerically.</p></li>
<li><p>Below are more examples showing that <code>TRUE</code> = 1 and <code>FALSE</code> = 0.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="cn">FALSE</span> <span class="co"># 1 + 0</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="cn">TRUE</span> <span class="co"># 1 + 1</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">+</span> <span class="cn">FALSE</span> <span class="co"># 0 + 0</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span><span class="sc">*</span><span class="dv">2</span> <span class="co"># 1 * 2</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span><span class="sc">*</span><span class="cn">FALSE</span> <span class="co"># 1 * 0</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="how-can-i-learn-most-effectively-with-the-notes" class="section level3 unnumbered">
<h3 class="unnumbered">How can I learn most effectively with the notes?</h3>
<ul>
<li>Don’t just read it.</li>
<li>Don’t just copy and paste the codes and run them in RStudio (ctrl + c &amp; ctrl + p). <strong>Make sure you type each code.</strong></li>
<li>You can also change your code and see if it still works.</li>
<li>If you are not sure of your code, you can type <code>?</code> before the function.</li>
<li>If you are still not sure after reading the notes, check out Chapter 3 of <strong>R for Data Science</strong>: <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></li>
</ul>
</div>
<div id="more-installation" class="section level3 unnumbered">
<h3 class="unnumbered">More installation</h3>
<ul>
<li>R is an old programming language.</li>
<li>So, people, such as statisticians and programmers, have created more functions in R in the form of the package to update the language. They are free but they have to be downloaded separately.
<ul>
<li>A <strong>package</strong> can contain several <strong>functions</strong>.</li>
<li>In this tutorial, you will mainly be using <strong>ggplot2</strong> package, which is elegant and flexible for visualizing data.</li>
<li>Also, you will be using <strong>smplot</strong> package. It improves ggplot2 graphs visually.</li>
</ul></li>
<li>So, you will need to install some packages, such as ggplot2 and smplot. Please type the codes below.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot&#39;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>) <span class="co"># requires VPN if you are in China</span></span></code></pre></div>
<ul>
<li>You only need to install them once, but you will need to reload them whenever you start a new session in RStudio using the function <code>library()</code>.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<ul>
<li>Now let’s make some graphs in the subsequent chapters.</li>
</ul>
<!--chapter:end:01-basics.Rmd-->
</div>
</div>
</div>
<div id="basics-of-ggplot2-and-correlation-plot" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Basics of ggplot2 and Correlation Plot</h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="uploading-data" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Uploading data</h2>
<div id="sample-data-mpg" class="section level3 unnumbered">
<h3 class="unnumbered">Sample data: mpg</h3>
<ul>
<li>I will be using an example from the book <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/data-visualisation.html" class="uri">https://r4ds.had.co.nz/data-visualisation.html</a>).</li>
<li><strong>Question: Do cars with large engines use up more fuel than the those with small ones?</strong></li>
<li>Let’s open <strong>mpg</strong>, which is a <strong>data frame</strong> stored in the <strong>ggplot2</strong> package.</li>
<li><strong>mpg</strong> contains data about cars in the US. You can type <code>?mpg</code> for more information.
<ul>
<li><strong>displ</strong>: the size of the car’s engine in liters</li>
<li><strong>hwy</strong>: fuel efficiency. If it’s high, then the car uses less fuel per distance.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mpg</span></code></pre></div>
<pre><code>## # A tibble: 234 x 11
##    manufacturer model      displ  year   cyl trans drv     cty   hwy fl   
##    &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
##  1 audi         a4           1.8  1999     4 auto~ f        18    29 p    
##  2 audi         a4           1.8  1999     4 manu~ f        21    29 p    
##  3 audi         a4           2    2008     4 manu~ f        20    31 p    
##  4 audi         a4           2    2008     4 auto~ f        21    30 p    
##  5 audi         a4           2.8  1999     6 auto~ f        16    26 p    
##  6 audi         a4           2.8  1999     6 manu~ f        18    26 p    
##  7 audi         a4           3.1  2008     6 auto~ f        18    27 p    
##  8 audi         a4 quattro   1.8  1999     4 manu~ 4        18    26 p    
##  9 audi         a4 quattro   1.8  1999     4 auto~ 4        16    25 p    
## 10 audi         a4 quattro   2    2008     4 manu~ 4        20    28 p    
## # ... with 224 more rows, and 1 more variable: class &lt;chr&gt;</code></pre>
<ul>
<li>Notice that some columns and rows are not shown. You can type <code>View(mpg)</code> to see the entire <strong>data frame</strong>.</li>
<li>Each row is an unique observation.</li>
<li>Each column is an unique variable/condition.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mpg)</span></code></pre></div>
</div>
</div>
<div id="basics-of-ggplot2" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Basics of ggplot2</h2>
<div id="lets-make-some-graphs" class="section level3 unnumbered">
<h3 class="unnumbered">Let’s make some graphs</h3>
<ul>
<li>Question: Do cars with large engines use up more fuel than the those with small ones?</li>
<li>To answer our question, we need to plot <strong>mpg</strong> data. The x-axis should be <strong>displ</strong>, the y-axis should be <strong>hwy</strong>.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-15-1.png" width="355.2" /></p>
<ul>
<li>We find that a smaller car has a higher efficiency and that a larger car has a lower efficiency. In other words, we see a negative relationship.</li>
</ul>
</div>
<div id="how-ggplot-works" class="section level3 unnumbered">
<h3 class="unnumbered">How ggplot works</h3>
<ul>
<li>When you are making a graph with <strong>ggplot2</strong>, always begin by typing the function <code>ggplot()</code>.
<ul>
<li>The <strong>data</strong> you want to plot is the <strong>first argument</strong> here. Ex. <code>ggplot(data = mpg)</code>.</li>
</ul></li>
<li>However, <code>ggplot(data = mpg)</code> alone does not create a graph. You will need <strong>add</strong> (by typing <strong>+</strong>) more layers, such as <code>geom_point()</code>.
<ul>
<li><code>geom_point()</code> adds points to your graphs. You will need to specify (or map) x- and y-axes in the <code>aes()</code> function, which means aesthetics. This process is called <strong>mapping</strong>.</li>
<li>As you might expect, there are other <strong>geom</strong> functions, such as <code>geom_bar()</code>, <code>geom_boxplot()</code>, <code>geom_errorbar()</code>. They plot bar graphs, boxplots and error bars, respectively.</li>
</ul></li>
<li>Here is the <strong>template</strong> for using <strong>ggplot2</strong> (copied from <em>R for Data Science</em>).</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="er">&lt;</span>GEOM_FUNCTION<span class="sc">&gt;</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="sc">&lt;</span>MAPPINGS<span class="sc">&gt;</span>))</span></code></pre></div>
</div>
<div id="different-color-of-points-for-each-unique-group" class="section level3 unnumbered">
<h3 class="unnumbered">Different color of points for each unique group</h3>
<ul>
<li>You can apply different colors by the <strong>class</strong> of each car (each car = each row of the <strong>mpg</strong> data frame).
<ul>
<li>Include <code>class</code> variable in the <code>aes()</code> function.</li>
<li>This maps the third variable <code>class</code> into your graph.</li>
<li><code>aes()</code> means aesthetic (ex. color, shape, etc).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-17-1.png" width="508.8" /></p>
<ul>
<li>You can also set different shapes for each group of the data.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-18-1.png" width="508.8" /></p>
<ul>
<li>Or size or transparency (not recommended). But you get the idea. Using <code>aes()</code> in a geom function (ex. <code>geom_point()</code>), you can label different group of points.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different levels of transparency (alpha) for each group</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-19-1.png" width="508.8" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different sizes of the points for each group</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-20-1.png" width="508.8" /></p>
</div>
<div id="different-color-shape-for-each-group" class="section level3 unnumbered">
<h3 class="unnumbered">Different color &amp; shape for each group</h3>
<ul>
<li>You can also apply different color &amp; shape for each group of the data.
<ul>
<li><strong>Exercise</strong>: Try it on your own before you look at the code below.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-21-1.png" width="508.8" /></p>
</div>
<div id="same-shape-across-all-groups" class="section level3 unnumbered">
<h3 class="unnumbered">Same shape across all groups</h3>
<ul>
<li>So far, you have put variables such as <code>shape</code> and <code>color</code> inside the function <code>aes()</code>.
<ul>
<li>This has enabled you to apply different shape and color for each group.</li>
</ul></li>
<li>If you put the variable for <code>shape</code>, <code>color</code>, <code>size</code> outside of <code>aes()</code> in the geom function, then all data points will have the specified <code>shape</code>, <code>color</code>, etc even if they are in different groups.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">17</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-22-1.png" width="508.8" /></p>
<ul>
<li>Notice that the <code>color</code> is different for each group because it is inside the function <code>aes()</code>. However, all the points are triangle because we have typed <code>shape = 17</code> outside the function <code>aes()</code>.</li>
<li><strong>Exercise:</strong> try changing the shape of the points to the circle with the border.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/shape.JPG" alt="image from http://www.sthda.com/english/wiki/ggplot2-point-shapes" width="25%" />
<p class="caption">
(#fig:unnamed-chunk-23)image from <a href="http://www.sthda.com/english/wiki/ggplot2-point-shapes" class="uri">http://www.sthda.com/english/wiki/ggplot2-point-shapes</a>
</p>
</div>
</div>
<div id="exercise-try-changing-the-shape-of-the-points-to-the-circle-with-the-border." class="section level3 unnumbered">
<h3 class="unnumbered">Exercise: try changing the shape of the points to the circle with the border.</h3>
<ul>
<li>When <code>shape = 19</code>, the shape is the circle without the border.</li>
<li>When <code>shape = 20</code>, the shape is the small circle without the border.</li>
<li>When <code>shape = 21</code>, the shape is the circle with the border.</li>
<li>So let’s set <code>shape</code> to 21.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-24-1.png" width="508.8" /></p>
<ul>
<li>Notice that the border color is different for each group, but not the color that fills the circle.</li>
<li>Shapes without their borders (15-20) are filled with <code>color</code>.</li>
<li>Shapes with the border (21-24) are filled with <code>fill</code> and its border colored with <code>color</code>.</li>
<li>So let’s change <code>color = Class</code> to <code>fill = Class</code>.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">fill =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-25-1.png" width="508.8" /></p>
</div>
<div id="how-do-we-draw-the-best-fit-line-of-the-graph" class="section level3 unnumbered">
<h3 class="unnumbered">How do we draw the best-fit line of the graph?</h3>
<ul>
<li>Here is our graph.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" width="355.2" /></p>
<ul>
<li>There seems to be a negative relationship.</li>
<li>How do we draw the best-fit line of the graph’s negative relationship?</li>
<li>Use another geom function <code>geom_smooth()</code>.</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-27-1.png" width="355.2" /></p>
</div>
<div id="geom_point-geom_smooth" class="section level3 unnumbered">
<h3 class="unnumbered">geom_point() + geom_smooth()</h3>
<ul>
<li>Now let’s combine geom_point() + geom_smooth() into one graph.</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-29-1.png" width="355.2" /></p>
<ul>
<li><code>ggplot()</code> acts as a system where you can add multiple <code>geom</code> objects, such as <code>geom_point()</code> and <code>geom_smooth()</code>.</li>
<li>You can add multiple layers of geom in a single plot, like shown here.</li>
<li><code>ggplot()</code> and <strong>at least one geom</strong> function are necessary to draw a graph.</li>
<li><code>ggplot()</code> alone does not draw a graph. Try it on your own.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-30-1.png" width="355.2" /></p>
</div>
<div id="writing-shorter-codes" class="section level3 unnumbered">
<h3 class="unnumbered">Writing shorter codes</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<ul>
<li>Notice that we have typed <code>mapping = aes(x = displ, y = hwy)</code> twice. This is <strong>repetitive</strong>.</li>
<li>If you type the <code>mapping</code> argument in <code>ggplot()</code>, you won’t need to type them anymore in the subsequent <code>geom</code> functions.</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-32-1.png" width="355.2" /></p>
<ul>
<li><p>This is exactly the same as the previous graph. In both cases, the mapping has been set so that the x-axis is <code>displ</code> and the y-axis is <code>hwy</code> in both <code>geom_point()</code> and <code>geom_smooth()</code>.</p></li>
<li><p>Now let’s apply different color of points and the fit the line for each group.</p></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-33-1.png" width="508.8" /></p>
<ul>
<li>Okay, this is extremely messy and probably a bad idea.
<ul>
<li>You might have gotten <code>warnings</code> but you can usually ignore them.</li>
</ul></li>
<li>Let’s plot the best-fit line across all groups (i.e., one best-fit line) but apply different color for each class (i.e., many colors).</li>
<li>To do so, type <code>color = class</code> in geom_point, not <code>ggplot()</code>. This enables you to specify that you will apply different color for each class <strong>only</strong> in <code>geom_point()</code> but not in <code>geom_smooth()</code>.</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-34-1.png" width="508.8" /></p>
</div>
</div>
<div id="improve-data-visualization-using-smplot" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Improve Data Visualization using smplot</h2>
<ul>
<li>Although the default theme of ggplot2 graphs is clean, there are some things that I do not like:
<ul>
<li>The fonts are too small.</li>
<li>The grey background is distracting.</li>
<li>There are too many grids.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-35-1.png" width="499.2" /></p>
<ul>
<li>Let’s make this graph prettier by using functions from <strong>smplot</strong>.
<ul>
<li>In this example, let’s use <code>sm_corr_theme()</code>. I’ve made this function as a theme suitable for correlation plots.</li>
<li>Disclaimer: <strong>smplot</strong> package has been built based on my preference.</li>
<li><strong>smplot</strong> is not necessary to make a <strong>ggplot</strong> graph or change its style. It is possible to change every aspect of the graph with <strong>ggplot2</strong> but this requires about 8-20 lines of codes (based on my experience). Instead, <strong>smplot</strong> function does so in one line of code.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-36-1.png" width="499.2" /></p>
<ul>
<li>Now let’s remove the border within <code>sm_corr_theme()</code> by setting <code>borders = FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-37-1.png" width="499.2" /></p>
<ul>
<li><strong>Exercise:</strong> You can also set <code>borders = TRUE</code> and see what happens.</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ul>
<li><p>You might notice that borders come back. This is exactly what happens when you do not include <code>borders</code> argument in <code>sm_corr_theme()</code>. This is because <code>sm_corr_theme()</code> is set to <code>borders = TRUE</code> as default.</p></li>
<li><p>I think the one with the border looks better.</p></li>
<li><p>You can also remove the legend by setting <code>legends = FALSE</code> in <code>sm_corr_theme()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-39-1.png" width="355.2" /></p>
<ul>
<li><strong>Exercise</strong> Set <code>legends = TRUE</code> and see what happens. Type <code>?sm_corr_theme</code> to see why legends appear without directly writing <code>legends = TRUE</code>.</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ul>
<li>However, in this case, I think we need a legend because there are many <strong>classes</strong>.</li>
</ul>
<div id="positive-relationship-between-x--and-y-axes" class="section level3 unnumbered">
<h3 class="unnumbered">Positive relationship between x- and y-axes</h3>
<ul>
<li>Let’s plot another scatterplot using <strong>mtcars</strong> data.</li>
<li>Set the x-axis with <strong>drat</strong> and y-axis with <strong>mpg</strong>.</li>
<li>Since you are making a scatterplot, you will need to use <code>geom_point()</code>.</li>
<li>Set the <strong>size</strong> of all points to <strong>3</strong> by typing <code>size = 3</code>.</li>
<li>Set the <strong>shape</strong> of all points to the circle with a border by typing <code>shape = 21</code>.</li>
<li>Set the <strong>filled color</strong> of all points to <strong>green</strong> by typing <code>fill = '#0f993d'</code>.</li>
<li>Set the <strong>border color</strong> to <strong>white</strong> by typing <code>color = 'white'</code>.
<ul>
<li>Since <code>shape = 21</code> refers to the circle with a border, <code>fill</code> is the color that fills the points and <code>color</code> is the border color.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-41-1.png" width="355.2" /></p>
<ul>
<li><p><strong>drat</strong> and <strong>mpg</strong> have a positive relationship.</p></li>
<li><p>Now let’s make it pretty by adding <code>sm_corr_theme()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-42-1.png" width="355.2" /></p>
<ul>
<li>You can remove borders too by setting <code>borders = FALSE</code> in <code>sm_corr_theme()</code>.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-43-1.png" width="355.2" /></p>
</div>
<div id="reporting-statistics-from-a-paired-correlation" class="section level3 unnumbered">
<h3 class="unnumbered">Reporting statistics from a paired correlation</h3>
<ul>
<li><strong>smplot</strong> also offers a function that plots the best-fit line of a scatterplot (i.e., correlation plot) and prints statistical values, such as p- and R-values.
<ul>
<li>p-value is used to check for statistical significance. If it’s less than 0.05, its regarded as <strong>statistically significant</strong>. However, it gets smaller with a larger sample size.</li>
<li>R-value (correlation coefficient) measures the strength and the direction of the correlation. It ranges from -1 to 1. It does not depend on the sample size.</li>
</ul></li>
<li>Let’s add a function <code>sm_statCorr()</code>. The statistical results are from Pearson’s correlation test.</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-1.png" width="355.2" /></p>
<ul>
<li>I don’t really like how the line color is different from that of the points. Let’s change the color to green.</li>
<li>Also let’s get results from Spearman’s correlation test rather than from Pearson’s.
<ul>
<li>To do so, type <code>corr_method = 'spearman'</code> in the function <code>sm_statCorr()</code>. You will get a different <strong>R</strong> value from 0.68, which is from Pearson’s correlation test.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-45-1.png" width="355.2" /></p>
<ul>
<li><strong>Exercise</strong>: Set <code>corr_method = 'pearson'</code>and see what happens.</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>)</span></code></pre></div>
<ul>
<li><p>You will see that this is exactly the same as when <code>corr_method</code> argument is not included in <code>sm_statCorr()</code>. In short, the <strong>default</strong> correlation method for <code>sm_statCorr()</code> is <code>'pearson'</code>. So, if you don’t write anything for <code>corr_method</code>, it will give results from Pearson’s correlation test. Type <code>?sm_statCorr</code> to see the default of <code>line_type</code>.</p></li>
<li><p><code>#0f993d</code> is a specific green that I like.</p></li>
<li><p>Now, let’s change the color. Replace <code>'#0f993d'</code> with <code>'green'</code> in <code>geom_point()</code> and <code>sm_statCorr</code>.</p>
<ul>
<li>This <code>'green'</code> is the default green color of <strong>R</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;green&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-47-1.png" width="355.2" /></p>
<ul>
<li>Which one do you prefer?</li>
</ul>
</div>
<div id="fill-0f993d-vs-fill-green" class="section level3 unnumbered">
<h3 class="unnumbered"><code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></h3>
<ul>
<li>I personally like <code>#0f993d</code> more. However, <strong>R</strong> does not recognize this color as <code>green</code>.</li>
<li>So how are you supposed to remember the color code?</li>
<li>You do not have to. You can type <code>sm_color('green')</code> instead. This is a function from the <strong>smplot</strong> package.</li>
<li><code>sm_color()</code> accepts the name of the color. If you want to get the hex codes (color codes) for red and green, type <code>sm_color('red','green')</code>.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<ul>
<li>Again, <code>sm_color()</code> has been built based on my preference. So it returns the hex codes of colors that I use most often.</li>
<li>There are many more color themes that are available in R. For more information, please check out Chapter 28 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/graphics-for-communication.html" class="uri">https://r4ds.had.co.nz/graphics-for-communication.html</a>).</li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-49-1.png" width="355.2" /></p>
<ul>
<li><strong>Exercise</strong> Change the color of the points and the best-fit line to <code>blue</code> using <code>sm_color()</code>. If you want to see all the color options for <code>sm_color()</code>, type <code>?sm_color</code>. There are 16 colors total.</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
</div>
<div id="different-color-for-each-group-but-with-other-colors" class="section level3 unnumbered">
<h3 class="unnumbered">Different color for each group but with other colors</h3>
<ul>
<li>Let’s go back to the <strong>mpg</strong> data. Set the x-axis with <strong>displ</strong> and y-axis with <strong>hwy</strong>. Then make a scatterplot using <code>geom_point()</code>.
<ul>
<li>Set the size of the points to 2 across all groups. So type <code>size = 2</code> outside of <code>aes()</code> in <code>geom_point()</code>.</li>
</ul></li>
<li>Let’s apply different color for each <code>class</code> of the cars by writing <code>color = class</code> in <code>aes()</code> from <code>ggplot()</code>.
<ul>
<li><code>fill = class</code> is needed when the shape of the point is set to 21-25.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-51-1.png" width="499.2" /></p>
<ul>
<li>To use other colors, we could use a function from <strong>ggplot2</strong> called <code>scale_color_manual()</code>.
<ul>
<li><code>scale_fill_manual()</code> is used when the shape of the point has borders (shape = 21-25).</li>
</ul></li>
<li>To find how many colors we need total, we need to find how many groups exist.</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>unique_classes <span class="ot">&lt;-</span> <span class="fu">unique</span>(mpg<span class="sc">$</span>class)</span></code></pre></div>
<ul>
<li>In R, you can extract data from one column by using <code>$</code>. You can try it with different variables too.</li>
<li><code>unique()</code> returns unique values in the selected data.</li>
<li>Then compute the number of unique values using <code>length()</code> function.</li>
</ul>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>number_of_classes <span class="ot">&lt;-</span> <span class="fu">length</span>(unique_classes)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>number_of_classes</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<ul>
<li><code>sm_palette</code> accepts the number of colors as input. It returns colors that I use most often.</li>
<li>Now that we know we need 7 colors total, we can type <code>sm_palette(7)</code> or <code>sm_palette(number_of_classes)</code> for <code>values</code> in <code>scale_color_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-54-1.png" width="499.2" /></p>
<ul>
<li>Let’s store this graph using a <strong>variable</strong> called <code>figure1</code>.</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<ul>
<li><strong>Notice that when you store a figure into a variable, the figure is not displayed</strong> when you run the code that makes the figure, ex. <code>figure1 &lt;- ggplot(data = mpg, mapping = ...</code>. To display the figure, please type the variable name in the console.</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="co"># it will appear again by calling this variable </span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-56-1.png" width="499.2" /></p>
</div>
<div id="lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1." class="section level3 unnumbered">
<h3 class="unnumbered">Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</h3>
<ul>
<li>To save the figure as an image, we will use a function from the <strong>cowplot</strong> package.</li>
<li>The function is <code>save_plot()</code>.</li>
<li>There is one important argument: <code>base_asp</code>.
<ul>
<li>This is the ratio of your image (width/height). I usually set it to 1.4. So let’s type <code>base_asp = 1.4</code> in <code>save_plot()</code>.</li>
<li>If <code>base_asp</code> is larger than 1, it gets wider than its height. This is recommended when you have a legend.</li>
<li>If there is no legend, then <code>base_asp = 1</code> is recommended.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1.png&#39;</span>, figure1, <span class="at">base_asp =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<ul>
<li><strong>Exercise</strong>: try to save it again with a name <strong>figure1b.png</strong> by typing:</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1b.png&#39;</span>, figure1)</span></code></pre></div>
<ul>
<li><p>How’s the picture? Why does it look different? Type <code>?save_plot</code> to see what the default <code>base_asp</code> is.</p></li>
<li><p>Done! The graph (in png file) should be in your <strong>LearnR</strong> folder.</p></li>
<li><p><strong>Exercise:</strong> Try to open Microsoft Word or PowerPoint and upload <strong>figure1</strong>. The figure should look the same as it appears in the slides.</p></li>
<li><p><strong>Exercise:</strong> Remove the legend and save the scatterplot with <code>base_asp = 1</code>.</p></li>
<li><p>Congratulations! You can now make <strong>correlation plots</strong> with R.</p></li>
</ul>
</div>
</div>
<div id="summary" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Summary</h2>
<ul>
<li>You have learned the basics of <strong>ggplot</strong>.
<ul>
<li>You begin by writing a <code>ggplot()</code> function.</li>
<li>If aesthetics (color, shape, etc) are specified outside of <code>aes()</code> function, then there is no group difference.</li>
<li>If aesthetics are specified in <code>aes()</code>, different groups of data will have different looks.</li>
<li>You have learned to add geom layers such as <code>geom_point()</code>, which shows points, and <code>geom_smooth()</code>, which plots the best-fit function.</li>
<li>You have learned to plot <code>geom_point()</code> and <code>geom_smooth()</code> in the same graph.</li>
</ul></li>
<li><strong>smplot</strong> functions can be used to improve <strong>ggplot2</strong> visually.
<ul>
<li>For correlation plots, add <code>sm_corr_theme()</code>.</li>
<li>You can report statistical results and plot linear regression from correlation by <code>sm_statCorr()</code>.</li>
<li>You can also select colors using <code>sm_color()</code>.</li>
</ul></li>
<li>Save the graph as an image file in your working directory.
<ul>
<li>Working directory has to be set in RStudio (<strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>)</li>
<li>Then use <code>save_plot()</code> from <strong>cowplot</strong> to save the image in your directory (folder <strong>LearnR</strong>).</li>
</ul></li>
</ul>
<!--chapter:end:02-corr.Rmd-->
</div>
</div>
<div id="boxplot-and-violin-plot" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Boxplot and Violin Plot</h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="upload-sample-data-csv-file-in-rstudio" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Upload Sample Data (csv file) in RStudio</h2>
<div id="download-requirements" class="section level3 unnumbered">
<h3 class="unnumbered">Download requirements</h3>
<ul>
<li>Download <strong>data.csv</strong> from
<a href="https://www.smin95.com/data.csv" class="uri">https://www.smin95.com/data.csv</a></li>
<li>Put the file <strong>data.csv</strong> in your <strong>LearnR</strong> folder</li>
</ul>
</div>
<div id="before-we-get-started" class="section level3 unnumbered">
<h3 class="unnumbered">Before we get started</h3>
<ul>
<li>Set <strong>LearnR</strong> folder as your working directory by by clicking: <strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>. Then find your <strong>LearnR</strong> folder.</li>
<li>Load these three packages with the <code>library()</code> function: <strong>ggplot2</strong>, <strong>cowplot</strong> and <strong>smplot</strong>.
<ul>
<li>Since the <strong>tidyverse</strong> package includes the <strong>ggplot2</strong> package, you can load <strong>tidyverse</strong> instead. <strong>tidyverse</strong> has other packages beside <strong>ggplot2</strong>, so it is more useful.</li>
</ul></li>
<li>Remember from the last tutorial that:
<ul>
<li>Functions from the <strong>ggplot2</strong> package include <code>ggplot()</code> and other <strong>geom</strong> functions such as <code>geom_point()</code>, <code>geom_smooth()</code>, etc.</li>
<li>Functions from the <strong>smplot</strong> package improve the <strong>ggplot2</strong> graphs visually. However, they are not required to make a graph using <strong>ggplot2</strong>.</li>
<li>The <strong>cowplot</strong> package has a function called <code>save_plot</code>, which is very useful for saving a graph as an image.</li>
</ul></li>
</ul>
</div>
<div id="data.csv" class="section level3 unnumbered">
<h3 class="unnumbered">data.csv</h3>
<ul>
<li>Let’s load <strong>data.csv</strong> in R from your <strong>LearnR</strong> folder.</li>
<li>Then store the loaded data into a variable called <code>df</code>.</li>
<li>We will use a function from the <strong>tidyverse</strong> package called <strong>read_csv()</strong>.
<ul>
<li>For more information, type <code>?read_csv()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data.csv&#39;</span>)</span></code></pre></div>
<pre><code>## Rows: 90 Columns: 3
## -- Column specification --------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (2): Subject, Day
## dbl (1): Value
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<ul>
<li><p>If you get an <strong>error</strong> such as <code>object 'data.csv' not found</code>, make sure you set your working directory in the <strong>LearnR</strong> folder. Also make sure you have downloaded your data and saved it in the <strong>LearnR</strong> folder.</p></li>
<li><p>You can view the entire data frame by typing <code>View(df)</code>.</p></li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df)</span></code></pre></div>
<ul>
<li>There are <strong>three columns</strong> in <strong>df</strong>.
<ul>
<li>The first column (<strong>Subject</strong>) is the subject number. S1 means the first subject, and S2 second.</li>
<li>The second column (<strong>Value</strong>) is the data. It contains numbers.</li>
<li>The third column (<strong>Day</strong>) is the day of testing. There are three days of measurement: <strong>One</strong>, <strong>Two</strong> and <strong>Three</strong>.</li>
</ul></li>
<li><strong>What is the data about?</strong>
<ul>
<li>30 patients were tested across three days to see if there was an improvement in their visual function (<strong>Value</strong>). The higher value, the better the vision.</li>
<li>Day <strong>One</strong>: first day of the study. This is the baseline value. After this measurement, patients received treatment (ex. drug, surgery, etc).</li>
<li>Day <strong>Two</strong>: second day of the study. This is the one day after receiving the treatment.</li>
<li>Day <strong>Three</strong>: third day of the study. This is two days after receiving the treatment.</li>
</ul></li>
<li>The data are all fake.</li>
</ul>
</div>
<div id="read_csvdata.csv" class="section level3 unnumbered">
<h3 class="unnumbered"><code>read_csv('data.csv')</code></h3>
<ul>
<li><p>Let’s use the variable <strong>df</strong> to store the output from <strong>data.csv</strong>.</p></li>
<li><p><strong>df</strong> is shortened from <strong>data frame</strong>, which refers to a structure of the data that is commonly used for data analysis.</p></li>
<li><p>In fact, ‘data.csv’ has the structure of a typical <strong>data frame</strong>.</p>
<ul>
<li>Each <strong>column</strong> is a <strong>variable</strong>.</li>
<li>Each <strong>row</strong> represents an <strong>observation</strong></li>
</ul></li>
<li><p>In future, I suggest you save data that has a similar structure to that of <strong>df</strong>.</p>
<ul>
<li>Put your own data in Microsoft Excel and save it as a <strong>csv file</strong> to load it on R.</li>
</ul></li>
<li><p><strong>Exercise</strong>: Open <strong>data.csv</strong> using Microsoft Excel. Change the name of third column into <strong>Group</strong>. Then, save it as <strong>data2.csv</strong>. What does this data frame indicate now?</p>
<ul>
<li>It indicates there are 30 individuals for each group. Also, there are 3 groups, so there are 90 individuals total. So, it might be better to change the subject number so each person has a unique label, such as <strong>S1</strong> to <strong>S90</strong>.</li>
</ul></li>
</ul>
</div>
<div id="best-way-to-plot-data" class="section level3 unnumbered">
<h3 class="unnumbered">Best way to plot data</h3>
<ul>
<li>A popular way to visualize data is plotting a bar graph.</li>
<li>However, a bar graph does not show the distribution of the data well.</li>
<li>For this reason, boxplot and violin plots have become more popular in scientific writing.</li>
</ul>
</div>
</div>
<div id="boxplot" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Boxplot</h2>
<div id="what-is-a-boxplot" class="section level3 unnumbered">
<h3 class="unnumbered">What is a boxplot?</h3>
<ul>
<li>This is the basic structure of the boxplot.</li>
</ul>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-62-1.png" width="685.714285714286" /></p>
<ul>
<li>The line in the middle is the <strong>median</strong> of the data.</li>
<li>The <strong>first quartile</strong> is the lower 25% of the data.</li>
<li>The <strong>third quartile</strong> is the 75% percentile of the data.</li>
<li>The <strong>interquartile range</strong> is the distance between the first and third quartiles.</li>
<li>The <strong>lower whisker</strong> is the lowest data point without outliers.</li>
<li>The <strong>upper whisker</strong> is the highest data point without outliers.</li>
<li>The point that lies outside the whisker is the <strong>outlier</strong>.</li>
</ul>
</div>
<div id="boxplot-vs-bar-graph" class="section level3 unnumbered">
<h3 class="unnumbered">Boxplot vs bar graph</h3>
<ul>
<li>Here is the basic structure of the bar graph.</li>
</ul>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-63-1.png" width="685.714285714286" /></p>
<ul>
<li>The boxplot is more informative than bar graph.</li>
<li>The bar graph only shows the mean (average) of the data and the standard error.</li>
<li>The bar graph does not represent the distribution very well. The narrow errorbar is quite misleading here.</li>
<li>For this reason, let’s focus on drawing a boxplot.</li>
</ul>
</div>
<div id="boxplot-using-ggplot2" class="section level3 unnumbered">
<h3 class="unnumbered">Boxplot using ggplot2</h3>
<ul>
<li>We want to plot <strong>Value</strong> (y-axis) from each <strong>Day</strong> (x-axis).</li>
<li>As always in <strong>ggplot</strong>, let’s start by writing <code>ggplot()</code>.
<ul>
<li>Make sure you specify the data to plot by writing <code>data = df</code> in <code>ggplot()</code>.</li>
</ul></li>
<li>Also, you will need to specify the x- and y-axes in the <code>mapping</code> argument within <code>ggplot()</code>.
<ul>
<li><code>x = Day</code> and <code>y = Value</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-64-1.png" width="355.2" /></p>
<ul>
<li>However, as we learned in the last lesson, <strong>ggplot</strong> requires <strong>geom</strong> objects to plot something. Last time we used <strong>geom_point()</strong>, which plots points.</li>
<li>Now, let’s use <strong>geom_boxplot()</strong> to plot a boxplot.</li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-65-1.png" width="355.2" /></p>
<ul>
<li>Here’s the boxplot! But I think there is a problem here.</li>
<li>Day <strong>Three</strong> precedes Day <strong>Two</strong> in the x-axis.</li>
<li><strong>Exercise</strong>: Why do you think <strong>Three</strong> appeared first?</li>
</ul>
</div>
<div id="problem-alphabetical-order" class="section level3 unnumbered">
<h3 class="unnumbered">Problem: Alphabetical order</h3>
<ul>
<li>The issue with the boxplot is that the x-axis followed an alphabetical order.</li>
<li><strong>Th</strong> precedes <strong>Tw</strong>. In short, R does not seem to know that we want the order to be <strong>One -&gt; Two -&gt; Three</strong>.</li>
<li>R decided to follow the alphabetical order is because the column <strong>Day</strong> is shown as <code>&lt;chr&gt;</code>, which means <strong>character</strong>.</li>
</ul>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<ul>
<li>Note that the <strong>Subject</strong> column is also considered as <code>&lt;chr&gt;</code> (<strong>characters</strong>) because it contains texts/alphabets.</li>
<li>The <strong>Value</strong> column is categorized as <code>&lt;dbl&gt;</code>, which means <strong>double</strong>.
<ul>
<li><strong>Double</strong> basically means numbers.</li>
</ul></li>
<li>In R, <strong>character</strong> is also referred to as <strong>string</strong>. They mean the same thing.</li>
<li>Here are more examples of <strong>characters/strings</strong>.</li>
</ul>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">&#39;R is very useful!&#39;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="st">&#39;Dogs are so cute.&#39;</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="st">&#39;Clarinet is the best.&#39;</span></span></code></pre></div>
<ul>
<li>In these examples, you have stored the <strong>characters/strings</strong> in the variables <strong>a</strong>, <strong>b</strong> and <strong>c</strong>.</li>
</ul>
</div>
<div id="displaying-characters-in-a-non-alphabetical-order" class="section level3 unnumbered">
<h3 class="unnumbered">Displaying characters in a non-alphabetical order</h3>
<ul>
<li><p><strong>Factors</strong> are important when you want to display characters in non-alphabetical order.</p></li>
<li><p><strong>Factors</strong> are variables that have a limited number of different values.</p></li>
<li><p>For example, if a dataset has two groups (<strong>controls</strong> and <strong>patients</strong>), these can be referred to as <strong>factors</strong>.</p></li>
<li><p>However, when you are using <code>read_csv()</code> to load data into RStudio, <code>read_csv()</code> will interpret texts/alphabets as <strong>characters</strong>, not <strong>factors</strong>.</p>
<ul>
<li>This is a problem when you need a non-alphabetical order, such as <strong>one -&gt; two -&gt; three</strong> and <strong>Jan -&gt; Feb -&gt; Mar -&gt; Apr</strong>.</li>
</ul></li>
<li><p>To resolve this problem, you will need to change the <strong>characters</strong> into <strong>factors</strong> using <code>factor()</code> function.</p></li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span></code></pre></div>
<ul>
<li>Remember that <code>&lt;-</code> means equivalent.</li>
<li>Also, <code>$</code> of a data frame can extract a specific column
<ul>
<li>You can also type <code>df$Value</code> and run it to see what happens. You will get all values of the second column <strong>Value</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Value</span></code></pre></div>
<ul>
<li>By using <code>factor()</code>, you are making the <strong>Day</strong> column of <strong>df</strong> into factor from character.</li>
<li>However, you will need to store the <strong>factored</strong> version of <code>df$Day</code> by using <code>&lt;-</code>. If not, <code>df$Day</code> will stay as <strong>character</strong>.</li>
<li><code>levels</code> argument in <code>factor()</code> allows you to specify the order of the factors.</li>
<li>For more information about <strong>factors</strong>, please check Chapter 15 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/factors.html" class="uri">https://r4ds.had.co.nz/factors.html</a>).</li>
<li><strong>Note:</strong> you do not have to understand this part 100%. However, if you do encounter similar issues, I suggest you resolve it with the solution above.</li>
</ul>
</div>
<div id="double-check-if-the-day-column-is-factor" class="section level3 unnumbered">
<h3 class="unnumbered">Double-check if the ‘Day’ column is factor</h3>
<ul>
<li>Let’s open the data frame <strong>df</strong> again.</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;fct&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<ul>
<li>Now we see <code>&lt;fct&gt;</code> in the <strong>Day</strong> column. This means that the column is now <strong>factor</strong>, not <strong>character</strong>.</li>
</ul>
</div>
<div id="back-to-boxplot-using-ggplot2" class="section level3 unnumbered">
<h3 class="unnumbered">Back to boxplot using ggplot2</h3>
<ul>
<li>Now let’s draw the boxplot again.</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-71-1.png" width="355.2" /></p>
<ul>
<li>Since we have converted the <strong>Day</strong> column of <strong>df</strong> into factor, the boxplot successfully plots each day in the correct order.</li>
</ul>
</div>
<div id="a-boxplot-with-individual-data" class="section level3 unnumbered">
<h3 class="unnumbered">A boxplot with individual data</h3>
<ul>
<li><p>Sometimes, it is preferable to plot individual data on top of the boxplot.</p></li>
<li><p>There are many ways to do this. Here is a simple solution by using <code>geom_jitter()</code>. For more information, type <code>?geom_jitter</code>.</p></li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-72-1.png" width="355.2" /></p>
<ul>
<li>I think the points are too spread. So let’s set the <code>width</code> of the spread in <code>geom_jitter()</code> to 0.15.</li>
<li>Also, let’s apply a different color of points for each <strong>Day</strong>.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-73-1.png" width="489.6" /></p>
<ul>
<li>Now we can make the boxplot prettier with <code>sm_minimal()</code>, which removes all grids in the graph. We can also set <code>legends = FALSE</code> to remove the legends.</li>
<li>Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>, which is a function from the <strong>ggplot2</strong> package.</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-74-1.png" width="355.2" /></p>
<ul>
<li>Now let’s set the colors using <code>sm_palette()</code>. Remember from the last lesson that we set the colors in <strong>ggplot</strong> by using <code>scale_color_manual()</code> for points without borders.</li>
<li>Let’s write <code>3</code> in <code>sm_palette()</code> because we need 3 colors (for each <strong>Day</strong>).</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-75-1.png" width="355.2" /></p>
<ul>
<li>If you need horizontal grids, you can simply replace <code>sm_minimal()</code> with <code>sm_hgrid()</code>. There is also <code>sm_vgrid()</code> but I will not try it here because it is not so useful in our context.</li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-76-1.png" width="355.2" /></p>
</div>
<div id="geom_boxplot-vs-sm_boxplot" class="section level3 unnumbered">
<h3 class="unnumbered"><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></h3>
<ul>
<li><code>geom_boxplot()</code> does not show individual data. You need to add <code>geom_jitter()</code>.</li>
<li><code>sm_boxplot()</code> shows both a boxplot and individual data.
<ul>
<li>It automatically uses <code>sm_hgrid()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-77-1.png" width="355.2" /></p>
<ul>
<li>Let’s keep the color of the boxplot the same across <strong>Day</strong>. So we should remove <code>color = Day</code> in <code>aes()</code>.
<ul>
<li>However, since the shape is 16 (circle without borders), this will cause the points across <strong>Day</strong> to have the same color too.</li>
</ul></li>
<li>So let’s change the shape of the points to 21, which is a circle with borders.
<ul>
<li>So <code>fill</code> decides the filling color now. Let’s set <code>fill = Day</code> in <code>aes()</code>.</li>
<li>Also, <code>color</code> here only affects the border color. Let’s set it to <code>white</code>.</li>
</ul></li>
<li>Make sure you change <code>scale_color_manual()</code> to <code>scale_fill_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-78-1.png" width="355.2" /></p>
<ul>
<li>Now, pick your favorite boxplot and store it in a variable called <strong>my_boxplot</strong> using <code>&lt;-</code>.</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="save-boxplot" class="section level3 unnumbered">
<h3 class="unnumbered">Save boxplot</h3>
<ul>
<li>We can save the boxplot by using <code>save_plot()</code> from the <strong>cowplot</strong> package.</li>
<li>Let’s set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;boxplot.jpg&#39;</span>, my_boxplot, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>This image file should now be in your <strong>LearnR</strong> folder.</li>
</ul>
</div>
</div>
<div id="violin-plot" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Violin Plot</h2>
<ul>
<li>The boxplot represents the distribution quite well but it can still be misleading.
<ul>
<li>Also, it can be visually overwhelming (i.e., too crowded) to some readers.</li>
</ul></li>
<li>So, researchers have begun favoring the violin plot more.</li>
</ul>
<div id="structure-of-the-violin-plot" class="section level3 unnumbered">
<h3 class="unnumbered">Structure of the violin plot</h3>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-81-1.png" width="685.714285714286" /></p>
<ul>
<li>The part in the middle is the widest because it has most points. This part has the highest <strong>point density</strong>.</li>
<li>The lower and upper ends of the violin plot are thinner because there are less points.</li>
<li>Let’s draw a violin plot in R.</li>
</ul>
</div>
<div id="violin-plot-with-ggplot2" class="section level3 unnumbered">
<h3 class="unnumbered">Violin plot with ggplot2</h3>
<ul>
<li>Let’s draw the violin plot. Specify the x-axis to <strong>Day</strong> and the y-axis to <strong>Value</strong> using data frame <strong>df</strong>.</li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-82-1.png" width="355.2" /></p>
<ul>
<li>Notice that since we have already converted the <strong>Day</strong> column of df into <strong>factor</strong>, the violin plot’s x-axis is in the correct order.</li>
<li>Also, notice that we can just replace <code>geom_boxplot()</code> with <code>geom_violin()</code>.</li>
</ul>
</div>
<div id="violin-plot-with-individual-points" class="section level3 unnumbered">
<h3 class="unnumbered">Violin plot with individual points</h3>
<ul>
<li>Let’s add individual points to the violin plot by using <code>geom_jitter()</code>.
<ul>
<li>Set <code>width</code> of the spread to <code>0.15</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-83-1.png" width="355.2" /></p>
<ul>
<li>Now let’s apply different color to each <strong>Day</strong> like we did in boxplot by using <code>scale_color_manual()</code>.
<ul>
<li>Let’s use <code>sm_palette(3)</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-84-1.png" width="460.8" /></p>
<ul>
<li>Finally, let’s make it pretty and remove the <strong>legend</strong> by applying <code>sm_hgrid()</code> theme, which only has horizontal grids.</li>
<li>Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>.</li>
</ul>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-85-1.png" width="355.2" /></p>
</div>
<div id="geom_violin-vs-sm_violin" class="section level3 unnumbered">
<h3 class="unnumbered">geom_violin() vs sm_violin()</h3>
<ul>
<li><code>geom_violin()</code> does not show individual data. You need to add geom_jitter().</li>
<li><code>sm_violin()</code> shows both a boxplot and individual data.
<ul>
<li>It automatically uses <code>sm_hgrid()</code>.</li>
<li>It also display lines that represent the mean and +/- standard deviation.</li>
</ul></li>
<li>In <code>sm_violin()</code>, the default shape (<code>'point_shape'</code>) is 16, which is the circle without borders.</li>
<li><strong>Let’s try using <code>sm_violin()</code>.</strong></li>
<li><code>color</code> here filling color of the jittered points. Also, <code>color</code> affects the color of the lines that show the mean and +/- standard deviation.</li>
<li>Let’s set <code>color = Day</code> in <code>aes()</code> so that we can apply different colors of the lines and the points for each group.</li>
<li>Make sure you have <code>scale_color_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-86-1.png" width="355.2" /></p>
</div>
<div id="save-your-violin-plot" class="section level3 unnumbered">
<h3 class="unnumbered">Save your violin plot</h3>
<ul>
<li>Pick your violin plot and store it in a variable called <code>my_violin</code> using <code>&lt;-</code>.</li>
</ul>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>my_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<ul>
<li>We can save the violin plot by using <code>save_plot()</code> from the <strong>cowplot</strong> package.</li>
<li>Let’s set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;violin.jpg&#39;</span>, my_violin, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>This image file should now be in your <strong>LearnR</strong> folder.</li>
</ul>
</div>
</div>
<div id="summary-1" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Summary</h2>
<ul>
<li>You have learned how to convert <strong>characters</strong> to <strong>factors</strong>.</li>
<li><strong>Factor</strong> is important to order words/letters in a non-alphabetical order.</li>
<li>You can now make a <strong>boxplot</strong> and a <strong>violin plot</strong> with R.
<ul>
<li>They are more informative than a bar graph.</li>
</ul></li>
<li>You have learned to use <strong>geom</strong> functions, such <code>geom_boxplot()</code>, <code>geom_violin()</code>, and <code>geom_jitter()</code>.
<ul>
<li>These are functions from the <strong>ggplot2</strong> package.</li>
</ul></li>
<li>You can also plot individual data at the same time with functions from the <strong>smplot</strong> package.
<ul>
<li>These functions are <code>sm_boxplot()</code> and <code>sm_violin()</code>.</li>
</ul></li>
</ul>
<!--chapter:end:03-violinBox.Rmd-->
</div>
</div>
<div id="manual-and-examples-of-smplot" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Manual and Examples of smplot</h1>
<p>This chapter is a manual for <strong>smplot</strong>; it includes numerous examples. It also includes tutorials about <code>sm_bar()</code>, <code>sm_bland_altman()</code> and <code>sm_raincloud()</code>, all of which are not mentioned in the preceding chapters. However, this chapter does not describe <code>sm_effsize()</code>, <code>sm_power()</code> and <code>sm_common_axis()</code>; these functions are described in Chapters 5-7.</p>
<ul>
<li>If you are not sure about any of the functions, please type <code>?</code> before the function names, ex. <code>?sm_bar</code>.</li>
</ul>
<div id="installation-of-the-package" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Installation of the Package</h2>
<ul>
<li>The <strong>smplot</strong> package is NOT available on CRAN yet. So, you will need to download it directly from my github for now.</li>
<li>To install it, please type in the R console:</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot&#39;</span>)</span></code></pre></div>
<ul>
<li>To use the package, load it:</li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="what-is-smplot" class="section level3 unnumbered">
<h3 class="unnumbered">What is <code>smplot</code>?</h3>
<ul>
<li><strong>smplot</strong> is a package that provides functions that visually improve graphs produced from <strong>ggplot2</strong>.
<ul>
<li>So it does not work with plots made from base R.</li>
</ul></li>
<li>It was first developed in May 2021.</li>
<li>It is <strong>free</strong> and <strong>open source</strong> (<a href="https://github.com/smin95/smplot" class="uri">https://github.com/smin95/smplot</a>).</li>
</ul>
</div>
</div>
<div id="smplots-color-palette-and-graph-themes" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> smplot’s Color Palette and Graph Themes</h2>
<div id="smplots-color-palette" class="section level3 unnumbered">
<h3 class="unnumbered">smplot’s color palette</h3>
<ul>
<li>Its color palette can be accessed via two functions: <code>sm_color()</code> and <code>sm_palette()</code>.</li>
<li><code>sm_color()</code> accepts the <strong>character string</strong> of the color name.</li>
<li><code>sm_palette()</code> accepts the <strong>number of colors</strong> (up to <strong>20</strong>) and returns the hex codes accordingly.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/color.png" alt="smplot's color palette" width="85%" />
<p class="caption">
(#fig:unnamed-chunk-91)smplot’s color palette
</p>
</div>
<ul>
<li>For example, if you want <code>blue</code> and <code>red</code>, just type the input like this:</li>
</ul>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#1262b3&quot; &quot;#cc3d3d&quot;</code></pre>
<ul>
<li>But, do not form a single vector that contains two characters. If so, <code>sm_color()</code> will only return the first color.</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="fu">c</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>))</span></code></pre></div>
<pre><code>## Warning in if (color == &quot;blue&quot;) return(&quot;#1262b3&quot;): the condition has
## length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## [1] &quot;#1262b3&quot;</code></pre>
<ul>
<li>If you need 5 colors, you can use <code>sm_palette()</code>.</li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_palette</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#cc1489&quot; &quot;#1262b3&quot; &quot;#5b4080&quot; &quot;#e57717&quot; &quot;#0f993d&quot;</code></pre>
</div>
<div id="smplots-graph-themes" class="section level3 unnumbered">
<h3 class="unnumbered">smplot’s graph themes</h3>
<ul>
<li>There are several its graph themes. The text positions and the font are all similar.</li>
<li><code>sm_corr_theme()</code> and <code>sm_hvgrid()</code> are <strong>equivalent</strong>. They have major horizontal and vertical grids.
<ul>
<li>This theme is useful for correlation, so I created a duplicate function <code>sm_corr_theme()</code>.</li>
</ul></li>
<li><code>sm_bar_theme()</code> and <code>sm_hgrid()</code> are <strong>equivalent</strong>. They have major horizontal grids.
<ul>
<li>This theme is useful for a bar graph, so I created a duplicate function <code>sm_bar_theme()</code>.</li>
</ul></li>
<li><code>sm_minimal</code> has no major grid. This is useful when a graph has a lot of annotation, such as texts and arrows.</li>
<li><code>sm_slope_theme()</code> is a theme for a slope chart. It removes everything except the y-axis.</li>
<li>All of these functions, except for <code>sm_slope_theme()</code>, have two arguments: <code>borders</code> and <code>legends</code>.
<ul>
<li>For some of these functions, the defaults are set to <code>borders = TRUE</code> and <code>legends = TRUE</code>.</li>
<li>You can check the defaults by typing <code>?</code> in front of the function. Ex: <code>?sm_corr_theme</code></li>
<li>There is no option for <code>borders</code> in <code>sm_slope_theme()</code>.</li>
</ul></li>
<li><code>p1</code> has the default theme of <strong>ggplot2</strong>.</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-95-1.png" width="508.8" /></p>
<ul>
<li>Now we can change the theme using <code>sm_corr_theme()</code>.</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-96-1.png" width="508.8" /></p>
<ul>
<li>We can also remove <code>borders</code> and <code>legends</code> by setting them as <code>FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>, <span class="at">legends =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-97-1.png" width="355.2" /></p>
<ul>
<li>You can also apply smplot’s colors by using <code>scale_color_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">7</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-98-1.png" width="355.2" /></p>
</div>
</div>
<div id="correlation-plot" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Correlation Plot</h2>
<ul>
<li><p><code>sm_corr_theme()</code> and <code>sm_statCorr()</code> can be used as a pair when plotting a correlation.</p></li>
<li><p>This is the plot using the default theme of <strong>ggplot2</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-99-1.png" width="355.2" /></p>
<ul>
<li>The next plot uses <code>sm_corr_theme()</code> to apply the smplot’s theme and <code>sm_statCorr()</code> to print linear regression slope and statistical results from a paired correlation test (Pearson’s).</li>
<li><strong>Important:</strong> <code>sm_statCorr()</code> recognizes the data for the y- and x-axes from the <code>mapping = aes()</code> in <code>ggplot()</code> function.
<ul>
<li>There is no <code>mapping</code> argument in <code>sm_statCorr()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-100-1.png" width="355.2" /></p>
<ul>
<li>You can also change the <code>line_type</code> to <code>'solid'</code> in <code>sm_statCorr()</code>, and change the location of the printed texts by using <code>label_x</code> and <code>label_y</code> arguments.</li>
<li>You can also change the font size of the printed texts by setting <code>text_size</code> to a larger numerical value.</li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>),</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">line_type =</span> <span class="st">&#39;solid&#39;</span>,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">label_x =</span> <span class="fl">3.5</span>,</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">label_y =</span> <span class="dv">30</span>,</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">text_size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-101-1.png" width="355.2" /></p>
<div id="data-frame-for-a-correlation-plot" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Data frame for a correlation plot</h3>
<ul>
<li><p>Column 1 has to be the data for x-axis.</p></li>
<li><p>Column 2 has to be the data for y-axis.</p></li>
<li><p>This structure of the data frame is slightly different from that is typically used in ggplot2 and smplot functions (ex. <code>sm_boxplot()</code>, <code>sm_bar()</code>, <code>sm_violin()</code> and <code>sm_raincloud()</code>).</p></li>
<li><p>Correlation plot and a bar plot requires a different data frame structure.</p></li>
</ul>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>) <span class="co"># generate random data</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>method1 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(method1,method2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>Method <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Method 1&#39;</span>, <span class="st">&#39;Method 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(method1))</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>df_general <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Method) <span class="co"># used for sm_bar(), sm_boxplot(), sm_violin(), etc</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>df_corr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first =</span> method1, <span class="at">second =</span> method2) <span class="co"># used for correlation</span></span></code></pre></div>
<ul>
<li>We have created two data frames: <code>df_general</code> and <code>df_corr</code>. Let’s take a look at their structures.</li>
</ul>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_general)</span></code></pre></div>
<pre><code>##   Subject       Value   Method
## 1      S1 -0.59103110 Method 1
## 2      S2  0.02659437 Method 1
## 3      S3 -1.51655310 Method 1
## 4      S4 -1.36265335 Method 1
## 5      S5  1.17848916 Method 1
## 6      S6 -0.93415132 Method 1</code></pre>
<ul>
<li>Notice that <code>df_general</code> has three columns. The first column is subject, second column is data (i.e., <code>Value</code>) and third column is measurement group.</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_corr)</span></code></pre></div>
<pre><code>##         first      second
## 1 -0.59103110 -0.65571812
## 2  0.02659437 -0.68251762
## 3 -1.51655310 -0.01585819
## 4 -1.36265335 -0.44260479
## 5  1.17848916  0.35255750
## 6 -0.93415132  0.07317058</code></pre>
<ul>
<li>Notice that <code>df_corr</code> has two columns, each of which represents a measurement group.</li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot using data frame &#39;df_corr&#39; </span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_corr, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> first, <span class="at">y =</span> second)) <span class="sc">+</span> </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>,</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">label_y =</span> <span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Method 1&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Method 2&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-105-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bar graph using data frame &#39;df_general&#39;</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_general, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Value, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>,<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-106-1.png" width="355.2" /></p>
</div>
<div id="correlation-plot-with-both-regression-and-reference-lines" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Correlation plot with both regression and reference lines</h3>
<ul>
<li>You can also add a reference line (slope = 1) in a correlation plot.</li>
<li>This can be done with <code>geom_abline()</code>. In this example, the reference line’s slope is set to 1 and it has a dashed line style.</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot using data frame &#39;df_corr&#39; </span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_corr, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> first, <span class="at">y =</span> second)) <span class="sc">+</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="fl">2.8</span>),  <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="fl">2.8</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;crimson&#39;</span>), <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>,</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">label_y =</span> <span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Method 1&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Method 2&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-107-1.png" width="355.2" /></p>
</div>
</div>
<div id="boxplot---sm_boxplot" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Boxplot - <code>sm_boxplot()</code></h2>
<ul>
<li><code>sm_boxplot()</code> generates a boxplot and individual points at the same time.</li>
<li>It automatically uses <code>sm_hgrid()</code> as its default theme.</li>
<li>First, let’s generate some random data.</li>
</ul>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)), <span class="dv">2</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<ul>
<li>Now, let’s make a boxplot using <code>sm_boxplot()</code>.</li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a boxplot with the random data, all black points</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-109-1.png" width="355.2" /></p>
<ul>
<li>Now let’s apply different color for each Day.</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a boxplot with different colored points</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-110-1.png" width="355.2" /></p>
<ul>
<li>You can change the shape of the boxplot by setting <code>notch = TRUE</code>. You can also change the size of the individual points using <code>point_size</code> argument.</li>
<li>A notched boxplot shows the confidence interval around the median (+/- 1.58 * interquartile range / sqrt(n)).
<ul>
<li>The notches are used for group comparison.</li>
<li>If the notch of each box does not overlap, there is a strong likelihood that the medians are significantly different between groups.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">4</span>, <span class="at">notch =</span> <span class="st">&#39;TRUE&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-111-1.png" width="355.2" /></p>
<div id="plotting-individual-points-with-unique-colors" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Plotting individual points with unique colors</h3>
<ul>
<li>One can also use <code>sm_boxplot()</code> to plot individual points with unique colors.</li>
<li>But <code>sm_boxplot()</code> cannot print distinct box colors across distinct x levels (i.e., in this example, all boxes are grey). This is because the author thinks it is not a good practice to print different colors of boxes as they tend to distract the reader.</li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Subject)) <span class="sc">+</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-112-1.png" width="355.2" /></p>
</div>
</div>
<div id="violin-plot---sm_violin" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Violin Plot - <code>sm_violin()</code></h2>
<ul>
<li><code>sm_violin()</code> plots a violin plot, individual points and lines that indicate means and +/- 1 standard deviation at the same time.</li>
<li>It is very similar to <code>sm_boxplot()</code> except there is no option for <code>notch = TRUE</code> in <code>sm_violin()</code>.</li>
<li>Also <code>sm_violin()</code> uses both <code>color</code> (for the lines of mean and SD) and <code>fill</code> (for the colors of the points) arguments.</li>
<li>The default border color of the points is <code>white</code>.</li>
<li><code>sm_violin()</code> automatically uses <code>sm_hgrid()</code> as its default theme.</li>
</ul>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a violin plot with the random data, all black points and lines</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-113-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a violin plot with different colored points and lines</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-114-1.png" width="355.2" /></p>
<div id="plotting-individual-points-with-unique-colors-1" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Plotting individual points with unique colors</h3>
<ul>
<li>One can also use <code>sm_violin()</code> to plot individual points with unique colors.</li>
<li>The x-level has to be grouped in the aesthetics (ex. <code>group = Day</code>).</li>
<li>But <code>sm_violin()</code> cannot print distinct violin colors across distinct x levels (i.e., in this example, all boxes are grey). This is because the author thinks it is not a good practice to print different colors of boxes as they tend to distract the reader.</li>
</ul>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Subject,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Day)) <span class="sc">+</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">point_alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-115-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Subject,</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">point_alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-116-1.png" width="355.2" /></p>
</div>
</div>
<div id="bar-plot---sm_bar" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Bar Plot - <code>sm_bar()</code></h2>
<ul>
<li>It automatically uses <code>sm_bar_theme()</code> / <code>sm_hgrid()</code>.</li>
<li>Let’s use data (<code>df</code>) we generated before.</li>
</ul>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-117-1.png" width="355.2" /></p>
<ul>
<li>In this case, the error bar represents <strong>standard error</strong>. If you prefer to show <strong>standard deviation</strong>, then you should set <code>errorbar_type  = 'sd'</code> in <code>sm_bar()</code>.</li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>, <span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-118-1.png" width="355.2" /></p>
<ul>
<li>95% confidence interval also be displayed with <code>errorbar_type  = 'ci'</code>.</li>
</ul>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>, <span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>) <span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-119-1.png" width="355.2" /></p>
<div id="plotting-individual-points-with-unique-colors-2" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Plotting individual points with unique colors</h3>
<ul>
<li>One can also use <code>sm_bar()</code> to plot individual points with unique colors.</li>
</ul>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-120-1.png" width="355.2" /></p>
<ul>
<li><code>sm_bar()</code> can also print distinct box colors across distinct x levels.</li>
</ul>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject,</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>,<span class="st">&#39;skyblue&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-121-1.png" width="355.2" /></p>
</div>
</div>
<div id="slope-chart---sm_slope" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Slope Chart - <code>sm_slope()</code></h2>
<ul>
<li>This function plots a slope chart.</li>
<li>A slope chart is useful to describe changes between two different timepoints for each measurement (ex. a participant).</li>
<li>It automatically uses <code>sm_slope_theme()</code>.</li>
<li>Let’s use <code>df</code> that we generated before.</li>
<li><strong>Important:</strong> To make this function work, the <code>mapping</code> within <code>ggplot()</code> has to have a certain structure.
<ul>
<li>x- and y-axes have to be defined.</li>
<li>A slope chart groups each observation (ex. <code>Subject</code>) across x-axis. This has to be specified in <code>mapping</code> as <code>group =</code>.</li>
</ul></li>
<li>The x-axis cannot be <strong>continuous</strong>. It has to be <strong>discrete</strong>. So, it should take the form of <code>character</code> or <code>factor</code> (ex. ‘One’, ‘Two’, ‘Three’). If x-axis only has number (i.e., <code>double</code> form, such as 1.02, 1.05, 1.5), then <code>sm_slope()</code> will produce an error.</li>
<li><code>labels</code> argument is required to use <code>sm_slope()</code>. This refers to the labels of the ticks in the x-axis. Ex. <code>labels = c('Day 1', 'Day 2')</code>.</li>
</ul>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-122-1.png" width="355.2" /></p>
<ul>
<li>Let’s set the shape to 21.</li>
<li>Let’s make the border color to <code>white</code>.</li>
<li>Let’s apply the same color to each <strong>Day</strong>.</li>
</ul>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject)) <span class="sc">+</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-123-1.png" width="355.2" /></p>
<ul>
<li>You could also apply different color for each <code>Day</code> using <code>scale_fill_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-124-1.png" width="355.2" /></p>
<ul>
<li>You can also change the line color and other aesthetics. For more information, please type <code>?sm_slope</code>.</li>
</ul>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">line_color =</span> <span class="st">&#39;#ADD8E6&#39;</span>,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line_size =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-125-1.png" width="355.2" /></p>
</div>
<div id="a-bland-altman-plot---sm_bland_altman" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> A Bland Altman Plot - <code>sm_bland_altman()</code></h2>
<ul>
<li><code>sm_bland_altman()</code> and <code>sm_statBlandAlt()</code> functions can be used to create a Bland-Altman plot.</li>
<li>The plot is used to measure agreement between two different measurements.</li>
<li>It is also used to measure test-retest variability of a method.</li>
<li>Let’s generate random data.</li>
</ul>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>second <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(first,second)) <span class="co"># requires library(tidyverse)</span></span></code></pre></div>
<ul>
<li>Now let’s draw a Bland Altman plot using <code>sm_bland_altman()</code>, which requires two arguments: first dataset, second dataset. They have to be numerical vectors of equal length.
<ul>
<li>This function automatically uses <code>sm_classic()</code> theme.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-127-1.png" width="355.2" /></p>
<ul>
<li>The upper dashed line represents the upper limit of the difference between two measurements (mean difference + 1.96 * standard deviation of the difference).</li>
<li>The upper dashed line represents the upper limit of the difference between two measurements (mean difference - 1.96 * standard deviation of the difference).</li>
<li>The middle dashed line represents the mean difference.</li>
<li>The shaded region is the 95% confidence interval of the difference between the two measuremnts from one-sample t-test (difference vs 0).
<ul>
<li>If the shaded region includes 0 in the y-axis, then there is no significant difference (p &gt; 0.05) between 0 and the difference.</li>
<li>If it does not include 0, then there is a significant difference. This indicates that the two measurement results are considerably different.</li>
</ul></li>
<li>I usually label them with <code>annotate()</code>, which is a function
from <strong>ggplot2</strong>. This process can be tedious.</li>
<li>Also, <code>sm_statBlandAlt()</code> calculates the statistical values that are
necessary to draw a Bland-Altman plot, such as the mean difference, upper and lower limits. This function is used to annotate the values in the plot.
<ul>
<li>The arguments for this function are first and second datasets, just like in <code>sm_bland_altman()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">sm_statBlandAlt</span>(df3<span class="sc">$</span>first,df3<span class="sc">$</span>second) <span class="co"># store the results in res variable </span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit<span class="fl">-0.4</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-128-1.png" width="355.2" /></p>
<ul>
<li>Let’s change the border color of the circles to white. To do so, we will have to change their shape to 21.</li>
</ul>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit<span class="fl">-0.4</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-129-1.png" width="355.2" /></p>
</div>
<div id="raincloud-plot---sm_raincloud" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Raincloud plot - <code>sm_raincloud()</code></h2>
<ul>
<li>A raincloud plot is a combination of jittered points, a boxplot and a violin plot.</li>
<li>However, this plot can be visually crowded. Some people like to use raincloud plots, some do not. So, the choice to use it is entirely yours.</li>
<li>Let’s generate some random data.</li>
</ul>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<ul>
<li>The x-axis variable column has to have the right level. If not, you
should convert the column as factor and establish the levels correctly.</li>
<li>Now let’s draw a raincloud plot using <code>sm_raincloud()</code>.</li>
</ul>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-131-1.png" width="547.2" /></p>
<ul>
<li>Let’s change the x-axis labels.</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value) <span class="sc">+</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-132-1.png" width="547.2" /></p>
<ul>
<li>The filling colors of the violin plots and boxplots can be modified by using <code>scale_fill_manual()</code>.</li>
<li>The border color of the violin plot can be changed by using <code>scale_color_manual()</code>.
<ul>
<li>I will set it <code>transparent</code> to remove the border of the violin plots.</li>
</ul></li>
<li>The color of the points can be used by either of the 2 functions depending on the shape, which can be set within <code>sm_raincloud()</code>.</li>
</ul>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-133-1.png" width="547.2" /></p>
<ul>
<li><code>sep_level</code> is an argument to specify the degree of separation among points, boxplots and violin plots. When <code>sep_level = 0</code>, they will all be crowded. When <code>sep_level = 4</code>, they will all be separated from each other.
<ul>
<li>I personally prefer when the boxplot and violin plots are together, but not the points. So I set the default to <code>sep_level = 2</code>.</li>
<li>Shown below is an example when <code>sep_level = 4</code> with a horizontal grid theme <code>sm_hgrid()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-134-1.png" width="547.2" /></p>
<ul>
<li>You can also flip the raincloud plot by setting <code>which_side</code> to <code>left</code>.</li>
</ul>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>) <span class="sc">+</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-135-1.png" width="547.2" /></p>
<ul>
<li>So far the distribution plots (violin plots) have been vertical. We can change their configuration by setting <code>vertical = FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>, <span class="at">vertical =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-136-1.png" width="355.2" /></p>
<ul>
<li>The orientation is not correct, so let’s change it by setting <code>which_side = 'right'</code>.</li>
</ul>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">which_side =</span> <span class="st">&#39;right&#39;</span>, <span class="at">vertical =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-137-1.png" width="355.2" /></p>
</div>
<div id="overriding-defaults-of-smplots-themes" class="section level2" number="4.10">
<h2><span class="header-section-number">4.10</span> Overriding Defaults of smplot’s Themes</h2>
<ul>
<li><p>You can override all the defaults by adding <code>theme()</code> object to your <strong>ggplot2</strong> graph.</p></li>
<li><p>Here is a bar graph.</p></li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-138-1.png" width="355.2" /></p>
<ul>
<li>Now let’s remove the x-axis title <strong>Day</strong>.</li>
</ul>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-139-1.png" width="355.2" /></p>
<ul>
<li>Let’s customise the graph more by changing the y-axis title and adding a main title.</li>
</ul>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Value&#39;</span>) <span class="sc">+</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-140-1.png" width="355.2" /></p>
</div>
<div id="overriding-defaults-of-smplot-colors" class="section level2" number="4.11">
<h2><span class="header-section-number">4.11</span> Overriding Defaults of smplot Colors</h2>
<ul>
<li><p><code>sm_color('blue)</code> prints a hex code for the corresponding. Likewise, <code>sm_color('blue','orange')</code> prints out two hex codes.</p></li>
<li><p>Therefore, instead of using <code>sm_color()</code> function to call forth the colors, you can directly write the hex codes.</p></li>
</ul>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#ff1493&#39;</span>, <span class="st">&#39;#483d8B&#39;</span>) <span class="co"># pink and lavender</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_colors)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-141-1.png" width="355.2" /></p>
<!--chapter:end:04-smplot.Rmd-->
</div>
</div>
<div id="combining-plots-with-common-axes" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Combining Plots with Common Axes</h1>
<p>First, you need to load data (.csv file). When you are loading your own .csv file for your data analysis, make sure you place the .csv file of your interest in the folder that has been set to the <strong>working directory</strong>.</p>
<p>In this example, we will be using data from this paper:</p>
<p><strong>Seung Hyun Min, Alex S. Baldwin and Robert F. Hess. Ocular dominance plasticity: A binocular combination task finds no cumulative effect with repeated patching (2019). Vision Research, 161, 36-42.</strong></p>
<p>We will be creating similar figures to those in the paper (ex. <strong>Figure 3A</strong> and <strong>Figure A2</strong>) using <strong>smplot</strong>. For the PDF copy, please visit <a href="https://www.smin95.com/pubs/min2019.pdf">this link</a>.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019.csv&#39;</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S2      1         0   2.82 
## 3 S3      1         0   1.69 
## 4 S4      1         0   2.55 
## 5 S5      1         0  -0.217
## 6 S6      1         0   0.626</code></pre>
<p>There are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 10 participants total.</p></li>
<li><p>Next, <code>Day</code> refers to the day of testing. The participants were tested on Day 1, 2, 3, 4 and 5. We will only use Day from 1 and 5.</p></li>
<li><p><code>Time</code> refers to the number of minutes after an experimental manipulation (ex. monocular deprivation). These are 0, 3, 6, 12, 24 and 48 minutes, but in the data frame, it says 0, 1, 2, 3, 4 and 5; we will change the labels manually.</p></li>
<li><p>The <code>Cbratio</code> column refers to the actual data that will be plotted here.</p></li>
</ul>
<p>In the example below, the plots will have different colors based on Day (1 or 5). Therefore, the values in <code>Day</code> column have to be discrete, not continuous. To make them discrete, one needs to convert the <code>Day</code> column from <strong>double</strong> (continuous variable) to <strong>factor</strong> (discrete variable).</p>
<div id="filter-select-and-summarise" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> <code>filter()</code>, <code>select()</code> and <code>summarise()</code></h2>
<div id="filter-for-rows" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> <code>filter()</code> for rows</h3>
<p>To plot data of each subject separately, we need the data frame to show data only from one subject. This can be achieved as using <code>filter()</code>:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S1      1         1   0.802
##  3 S1      1         2   1.01 
##  4 S1      1         3   0.634
##  5 S1      1         4  -0.245
##  6 S1      1         5  -0.834
##  7 S1      5         0   2.42 
##  8 S1      5         1   1.76 
##  9 S1      5         2   1.91 
## 10 S1      5         3   0.609
## 11 S1      5         4   0.811
## 12 S1      5         5   0.363</code></pre>
<ul>
<li>The first argument of <code>filter()</code>, <code>select()</code>, <code>summarise()</code> and <code>mutate()</code> is a data frame.</li>
<li>The subsequent argument specifies how the data frame should be treated.</li>
<li>The new printed result is a new data frame.</li>
</ul>
<p><code>filter()</code> is used to filter for rows that meet the requirement of your interest.</p>
<p>Here is another example.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ... with 50 more rows</code></pre>
<p>The above code can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column.</p>
<p>Notice that S1 is a <strong>character</strong> because it has an alphabet. Therefore, it needs to be written as <code>'S1'</code>. However, <code>1</code> of <code>Day</code> is <strong>double</strong>, which is essentially just a number digit. Therefore, it can be written as <code>1</code> with no quotation mark.</p>
<p>Let’s try another example.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># save the new data frame into a new variable</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(day1, Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>) <span class="co"># this new data frame contains Day 1 and Subject 1 data only.</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S1      1         1   0.802
## 3 S1      1         2   1.01 
## 4 S1      1         3   0.634
## 5 S1      1         4  -0.245
## 6 S1      1         5  -0.834</code></pre>
<p>The above code can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column. Save this new data frame as <code>day1</code>. Then, <strong>filter</strong> for all rows of the data frame <code>day1</code> that have <code>S1</code> in the <code>Subject</code> column.</p>
<p>The above can also be written like the one below:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S1      1         1   0.802
## 3 S1      1         2   1.01 
## 4 S1      1         3   0.634
## 5 S1      1         4  -0.245
## 6 S1      1         5  -0.834</code></pre>
<p>The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>AND</strong> have <code>S1</code> in the <code>Subject</code> column.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 S1      1         0  -0.421
## 2 S1      1         1   0.802
## 3 S1      1         2   1.01 
## 4 S1      1         3   0.634
## 5 S1      1         4  -0.245
## 6 S1      1         5  -0.834</code></pre>
<p>The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>OR</strong> have <code>S1</code> in the <code>Subject</code> column.</p>
</div>
<div id="select-for-columns" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> <code>select()</code> for columns</h3>
<p>If you wish to see the <code>Cbratio</code> column only (i.e., data only) for rows of <strong>df</strong> that have <code>Day ==  1</code> and <code>Time == 0</code>, you can write it like this:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>day1_time0 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Time <span class="sc">==</span> <span class="dv">0</span>) <span class="co"># save the new data frame in the day1_time0 variable </span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(day1_time0, Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 1
##    Cbratio
##      &lt;dbl&gt;
##  1  -0.421
##  2   2.82 
##  3   1.69 
##  4   2.55 
##  5  -0.217
##  6   0.626
##  7   2.62 
##  8   1.42 
##  9   1.54 
## 10   3.05</code></pre>
<p>There are 10 rows (i.e., 10 subjects) in this filtered data frame and 1 column, which is <code>Cbratio</code>. The above can be read as: <strong>filter</strong> for all rows of the data frame <strong>df</strong> that have <code>1</code> in the <code>Day</code> column <strong>AND</strong> have <code>0</code> in the <code>Time</code> column. Then, store the new data frame in <code>day1_time0</code>. Then, select for <code>Cbratio</code> column from <code>day1_time0</code>.</p>
<p><code>select()</code> is used to filter for columns that meet the requirement of your interest.</p>
</div>
<div id="summarise-for-grouped-summaries" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> <code>summarise()</code> for grouped summaries</h3>
<p><strong>df</strong> contains individual data for all subjects on Days 1 and 5 across all time points. However, it does not contain average data either for each <strong>Day</strong> or <strong>Time</strong>.</p>
<p><code>summarise()</code> can help us enable us to collapse multiple rows of observations into values such as the mean.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(df, <span class="at">average =</span> <span class="fu">mean</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   average
##     &lt;dbl&gt;
## 1    1.35</code></pre>
<p>However, in this case, we got an example of <code>Cbratio</code> across <code>Subject</code>, <code>Day</code> and <code>Time</code>. This average value itself is not so meaningful. If we wish to obtain the average for each <code>Day</code> and <code>Time</code>, we can use the function <code>group_by()</code> to group data for each day and time.</p>
<ul>
<li><p>As it was the case before, the first argument of <code>group_by()</code> is a data frame.</p></li>
<li><p>The second argument of <code>group_by()</code> is the name of the column through which you would like to group the data.</p></li>
</ul>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>by_day_time <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df, Day, Time)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_day_time)</span></code></pre></div>
<pre><code>## # A tibble: 120 x 4
## # Groups:   Day, Time [12]
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 S1      1         0  -0.421
##  2 S2      1         0   2.82 
##  3 S3      1         0   1.69 
##  4 S4      1         0   2.55 
##  5 S5      1         0  -0.217
##  6 S6      1         0   0.626
##  7 S7      1         0   2.62 
##  8 S8      1         0   1.42 
##  9 S9      1         0   1.54 
## 10 S10     1         0   3.05 
## # ... with 110 more rows</code></pre>
<p>The output of <code>group_by()</code> is a new data frame (it might appear exactly the same as before, ex. <strong>df</strong>). However, it will respond differently to <code>summarise()</code> because the rows of the data frame are now grouped based on day and time, as we have specified.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_day_time, <span class="at">Average_Cbratio =</span> <span class="fu">mean</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
## # Groups:   Day [2]
##    Day    Time Average_Cbratio
##    &lt;fct&gt; &lt;dbl&gt;           &lt;dbl&gt;
##  1 1         0           1.57 
##  2 1         1           2.21 
##  3 1         2           2.32 
##  4 1         3           0.979
##  5 1         4           1.25 
##  6 1         5           1.14 
##  7 5         0           1.85 
##  8 5         1           1.49 
##  9 5         2           1.02 
## 10 5         3           1.15 
## 11 5         4           0.759
## 12 5         5           0.452</code></pre>
<p>This new data frame yields average for each Day and Time. We have now created a new column <code>Average_Cbratio</code> which stores all the average data of <code>Cbratio</code>.</p>
<p>Therefore, <code>group_by()</code> and <code>summarise()</code> are very useful together. They provide grouped summaries, such as the average. However, <code>summarise()</code> alone may not be so useful.</p>
<p>Besides the <strong>average</strong>, one might also be interested in obtaining either <strong>standard deviation</strong> or <strong>standard error</strong>.</p>
<p>However, our <strong>df</strong> does not contain any data about the <strong>standard deviation</strong> or <strong>standard error</strong> per Day or Time, etc. Standard error can be computed with <code>sm_stdErr()</code>.</p>
<p>We could obtain standard error with the help of the <code>summarise()</code> function for each <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(df, <span class="at">standard_error =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   standard_error
##            &lt;dbl&gt;
## 1          0.115</code></pre>
<p>As we have seen before, we see that <code>standard_error</code> has been calculated across all subjects, day and time. This is not so useful. We should use <code>summarise()</code> with <code>group_by()</code> so that each standard error could be for each <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>by_day_time <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df, Day, Time)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_day_time, <span class="at">standard_error =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
## # Groups:   Day [2]
##    Day    Time standard_error
##    &lt;fct&gt; &lt;dbl&gt;          &lt;dbl&gt;
##  1 1         0          0.393
##  2 1         1          0.363
##  3 1         2          0.400
##  4 1         3          0.352
##  5 1         4          0.266
##  6 1         5          0.438
##  7 5         0          0.563
##  8 5         1          0.422
##  9 5         2          0.462
## 10 5         3          0.224
## 11 5         4          0.292
## 12 5         5          0.193</code></pre>
<p>This standard error is for each <code>Day</code> and <code>Time</code> across all subjects.</p>
<p>Now let’s obtain the <strong>mean</strong> and <strong>standard error</strong> of <code>Cbratio</code> for each <code>Day</code> and <code>Time</code> across all subjects using the data frame that has been grouped by <code>Day</code> and <code>Time</code> via <code>group_by()</code>.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>by_day_time1 <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_day_time, <span class="at">Average =</span> <span class="fu">mean</span>(Cbratio),</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">StdError =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_day_time1)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
## # Groups:   Day [2]
##    Day    Time Average StdError
##    &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 1         0   1.57     0.393
##  2 1         1   2.21     0.363
##  3 1         2   2.32     0.400
##  4 1         3   0.979    0.352
##  5 1         4   1.25     0.266
##  6 1         5   1.14     0.438
##  7 5         0   1.85     0.563
##  8 5         1   1.49     0.422
##  9 5         2   1.02     0.462
## 10 5         3   1.15     0.224
## 11 5         4   0.759    0.292
## 12 5         5   0.452    0.193</code></pre>
<p>Now you see that the original <strong>df</strong>, which contains data for each subject, has now been transformed to a new data frame that contains grouped summaries, such as group averages and standard errors.</p>
<p>If you are interested in learning more about this topic (data transformation), please check out Chapter 5 of R for Data Science by Hadley Wickham (<a href="https://r4ds.had.co.nz/transform.html" class="uri">https://r4ds.had.co.nz/transform.html</a>).</p>
</div>
</div>
<div id="plotting-average-data-with-error-bars" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Plotting average data with error bars</h2>
<p>We will plot a similar graph to <strong>Figure 3A</strong> in the Vision Research paper (Min et al., 2019) in this section.</p>
<ul>
<li>Usually, a data frame that has grouped summary information, such as average and standard error across subject, is required to plot a graph that depicts average values.</li>
<li><code>geom_errorbar()</code> is required to plot the error bar.</li>
<li>Legend title has been removed with the <code>theme()</code> function.</li>
<li>Greek letter <strong>Delta</strong> is printed with <code>\u0394</code>.</li>
<li>X-tick labels are originally 0, 1, 2, 3, 4, 5 (as specified in the <strong>df</strong> data frame). However, they can be manually changed using <code>labels =</code> argument in the <code>scale_x_continuous()</code> function.</li>
<li>Legend label can also be changed in <code>labels =</code> from the <code>scale_color_manual()</code> function because each <code>Day</code> has been defined by each <code>color</code>; this is the case because <code>color = Day</code> in <code>aes(..., ..., color = Day)</code>.</li>
</ul>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> by_day_time1, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Average, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Average <span class="sc">-</span> StdError, <span class="at">ymax =</span> Average <span class="sc">+</span> StdError), <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">width =</span> .<span class="dv">05</span>) <span class="sc">+</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>),</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Day 1&quot;</span>, <span class="st">&quot;Day 5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Recovery of the patching effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time after monocular deprivation (min)&quot;</span>) <span class="sc">+</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.67</span>), </span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-156-1.png" width="350.4" /></p>
</div>
<div id="plotting-individual-data" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Plotting Individual Data</h2>
<p>In this section, we will plot a similar graph to <strong>Figure A2</strong> in the Vision Research paper (Min et al., 2019).</p>
<p>First, you will need several packages for this section.</p>
<ul>
<li>If you do not have the <strong>gridExtra</strong> and <strong>grid</strong> packages in your RStudio, please install them using the codes below. It might take less than a minute.</li>
</ul>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;gridExtra&#39;</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;grid&#39;</span>)</span></code></pre></div>
<ul>
<li>Then load all these packages below.</li>
</ul>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span></code></pre></div>
<p>Now let’s plot data for each subject (S1-S9) except S10. Each panel shows the data of each subject for both Days 1 and 5.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>df_s1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S1&#39;</span>) </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rows of df that only contain S1 in the Subject column</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use df_s1 to plot the data of S1</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>plot_s1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s1, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s1)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-159-1.png" width="350.4" /></p>
<p>Then make each one for the other subjects (S2-S9).</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>df_s2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S2&#39;</span>) </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>plot_s2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s2, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s2)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-160-1.png" width="350.4" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>df_s3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S3&#39;</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>plot_s3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s3, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s3)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-161-1.png" width="350.4" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>df_s4 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S4&#39;</span>)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>plot_s4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s4, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s4)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-162-1.png" width="350.4" /></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subject 5</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>df_s5 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S5&#39;</span>) </span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rows of df that only contain S5 in the Subject column</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>plot_s5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s5, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># show legends for the color</span></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> <span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.65</span>)) </span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a><span class="co"># location of legend (color label)</span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s5)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-163-1.png" width="350.4" /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subject 6</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>df_s6 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S6&#39;</span>) </span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rows of df that only contain S6 in the Subject column</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>plot_s6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s5, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>))  <span class="sc">+</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s6)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-164-1.png" width="350.4" /></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>df_s7 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S7&#39;</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>plot_s7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s7, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s7)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-165-1.png" width="350.4" /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>df_s8 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S8&#39;</span>)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>plot_s8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s8, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s8)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-166-1.png" width="350.4" /></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subject 9</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>df_s9 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Subject <span class="sc">==</span> <span class="st">&#39;S9&#39;</span>) </span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>plot_s9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_s9, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co"># axis text size is 1.5x the original font size. </span></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-17"><a href="#cb201-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_s9)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-167-1.png" width="350.4" /></p>
<p>Now let’s put them together in a 3x3 figure (3 rows, 3 columns) using the function <code>plot_grid</code> from the <strong>cowplot</strong> package. Here is the illustration of what we are going to do.</p>
<div class="figure" style="text-align: center">
<img src="img/rc33.png" alt="3x3 figure. It has 3 columns and 3 rows" width="75%" />
<p class="caption">
(#fig:unnamed-chunk-168)3x3 figure. It has 3 columns and 3 rows
</p>
</div>
<p>When you are saving the graph as an image file, <code>nrow</code> and <code>ncol</code> in <code>save_plot()</code> have to match the values in <code>plot_grid()</code> as shown below.</p>
<p><code>plot_grid()</code> is a function that puts different graphs together (ex. 3x3 structure).</p>
<p><code>save_plot()</code> is a function that saves a selected graph into an image or PDF file (or eps, etc).</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>together1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(plot_s1, plot_s2, plot_s3,</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>                       plot_s4, plot_s5, plot_s6, </span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>                       plot_s7, plot_s8, plot_s9, </span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="co"># 3 columns in the final figure</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">3</span>, <span class="co"># 3 rows in the final figure </span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">align =</span> <span class="st">&#39;hv&#39;</span>,<span class="co"># set to the same horizontal and vertical                             # lengths of each panel. </span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;S1&#39;</span>,<span class="st">&#39;S2&#39;</span>, <span class="st">&#39;S3&#39;</span>, <span class="st">&#39;S4&#39;</span>,<span class="st">&#39;S5&#39;</span>,<span class="st">&#39;S6&#39;</span>,</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;S7&#39;</span>,<span class="st">&#39;S8&#39;</span>,<span class="st">&#39;S9&#39;</span>), <span class="co"># each panel label</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_x =</span> <span class="fl">0.14</span>,<span class="co"># horizontal position of the panel&#39;s </span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>          <span class="co"># label relative to each panel. 0 is the very </span></span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>          <span class="co"># left of the plot.</span></span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_y =</span> <span class="fl">0.97</span>)  <span class="co"># vertical position of the panel&#39;s </span></span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>          <span class="co"># label relative to each panel. 1 is the very </span></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a>          <span class="co"># top of the plot. </span></span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(together1)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-169-1.png" width="1094.4" /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;together1.png&#39;</span>,together1,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">base_asp=</span><span class="fl">0.95</span>) </span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="co"># save as an image. ncol and nrow in save_plot() </span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow and ncol in save_plot() have to match the values in plot_grid() as shown above. </span></span></code></pre></div>
<p>Open <code>together1.png</code> in your directory folder. Notice that the <strong>png</strong> file may look different from the one printed in your RStudio screen or on the browser as shown in this guide. As long as your <strong>png</strong> file looks good, it should be okay.</p>
<p>Note that are some repeating x and y-axes labels. We can remove them. For instance, the top left panel’s x-axis labels can be removed because the bottom left panel also has the x-axis labels.</p>
<p>Another instance is that the y-axis labels of the top right panel can be removed because the top left panel has the same label.</p>
<p>Also, it seems that there are some empty space between amongst panel. Let’s remove them by reducing the margin of each panel. For more information about the function <code>plot_grid</code>, please type <code>?plot_grid</code> in the console.</p>
<ul>
<li><p>We will use the function <code>sm_common_axis()</code> to resolve these issues.</p></li>
<li><p><code>sm_common_axis()</code> has an argument called <code>location</code>. This refers to the location of each panel in the combined figure that you will make.</p></li>
<li><p>The picture here illustrates what you will need to write for <code>location</code> in the function <code>sm_common_axis()</code>.</p></li>
<li><p>Example: <code>sm_common_axis(location = 'topleft')</code> for the very top left panel of the 3x3 combined figure.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/rc_arg.png" alt="Arguments for location in sm_common_axis for 3x3 figure." width="75%" />
<p class="caption">
(#fig:unnamed-chunk-170)Arguments for location in sm_common_axis for 3x3 figure.
</p>
</div>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>plot_s1_b <span class="ot">&lt;-</span> plot_s1 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topleft&#39;</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>plot_s2_b <span class="ot">&lt;-</span> plot_s2 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topcenter&#39;</span>)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>plot_s3_b <span class="ot">&lt;-</span> plot_s1 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topright&#39;</span>)</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>plot_s4_b <span class="ot">&lt;-</span> plot_s4 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topleft&#39;</span>)</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>plot_s5_b <span class="ot">&lt;-</span> plot_s5 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topcenter&#39;</span>)</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>plot_s6_b <span class="ot">&lt;-</span> plot_s6 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;topright&#39;</span>)</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>plot_s7_b <span class="ot">&lt;-</span> plot_s7 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;bottomleft&#39;</span>)</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>plot_s8_b <span class="ot">&lt;-</span> plot_s1 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;bottomcenter&#39;</span>)</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>plot_s9_b <span class="ot">&lt;-</span> plot_s9 <span class="sc">+</span> <span class="fu">sm_common_axis</span>(<span class="at">location =</span> <span class="st">&#39;bottomright&#39;</span>)</span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>together2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(plot_s1_b, plot_s2_b, plot_s3_b,</span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>                       plot_s4_b, plot_s5_b, plot_s6_b, </span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>                       plot_s7_b, plot_s8_b, plot_s9_b, </span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="co"># 3 columns in the final figure</span></span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">3</span>, <span class="co"># 3 rows in the final figure </span></span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">align =</span> <span class="st">&#39;hv&#39;</span>,<span class="co"># set to the same horizontal and vertical </span></span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>          <span class="co"># lengths of each panel. </span></span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;S1&#39;</span>,<span class="st">&#39;S2&#39;</span>, <span class="st">&#39;S3&#39;</span>, <span class="st">&#39;S4&#39;</span>,<span class="st">&#39;S5&#39;</span>,<span class="st">&#39;S6&#39;</span>,</span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;S7&#39;</span>,<span class="st">&#39;S8&#39;</span>,<span class="st">&#39;S9&#39;</span>), <span class="co"># each panel label</span></span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_x =</span> <span class="fl">0.07</span>) <span class="co"># horizontal position of the panel&#39;s </span></span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># label relative to each panel. </span></span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># 0 is the very left of the plot. </span></span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-32"><a href="#cb204-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(together2)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-171-1.png" width="1065.6" /></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;together2.png&#39;</span>,together2,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">base_asp=</span><span class="fl">0.95</span>)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="co"># save as an image. ncol and nrow in save_plot() </span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow and ncol in save_plot() have to match the </span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># values in plot_grid() as shown above. </span></span></code></pre></div>
<p>Open <code>together2.png</code> in your directory folder. I think it looks a lot cleaner!</p>
<p>If you are planning to make a 1x3 figure (1 row, 3 columns), here is the illustration.</p>
<div class="figure" style="text-align: center">
<img src="img/rc13.png" alt="Arguments for location in sm_common_axis for 1x3 figure." width="75%" />
<p class="caption">
(#fig:unnamed-chunk-172)Arguments for location in sm_common_axis for 1x3 figure.
</p>
</div>
<p>If you are planning to make a 2x2 figure (2 rows, 2 columns), here is the illustration.</p>
<div class="figure" style="text-align: center">
<img src="img/rc22.png" alt="Arguments for location in sm_common_axis for 2x2 figure." width="55%" />
<p class="caption">
(#fig:unnamed-chunk-173)Arguments for location in sm_common_axis for 2x2 figure.
</p>
</div>
<p>We are almost done now. You need to add the y-axis label (<code>'Contrast balance ratio'</code>), x-axis label (<code>'Minutes after monocular deprivation'</code>) and the title (<code>'Recovery of the patching effect'</code>) as shown in the original paper (Vision Research 2019).</p>
<p>You can do this in <strong>Adobe Illustrator</strong> or directly in <strong>R</strong>. Here, I present a solution with <strong>R</strong>.</p>
<p>You don’t have to understand the codes below to use the codes.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span> </span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">&#39;Recovery of the patching effect&#39;</span>,</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="dv">17</span>, <span class="at">hjust =</span> <span class="fl">0.45</span>, <span class="at">vjust =</span> <span class="fl">1.2</span>,</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>) <span class="co"># title of the 3x3 figure. </span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="co"># vjust controls the vertical position of the title. </span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="co"># hjust controls the horizontal position of the title.</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>plot_with_title <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(title, together2, <span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span> ,<span class="dv">1</span>)) </span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add the title and the 3x3 figure together </span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">add_sub</span>(plot_with_title, </span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Minutes after monocular deprivation&quot;</span>, </span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">17</span>) </span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a><span class="co"># add x-axis title to the 3x3 figure</span></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add y-axis title to the 3x3 figure</span></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(combined_plot, </span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;\u0394 Contrast Balance Ratio (dB)&quot;</span>,</span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">17</span>), </span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rot =</span> <span class="dv">90</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-174-1.png" width="1104" /></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;combined_plot.png&quot;</span>, combined_plot, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">base_aspect_ratio =</span> .<span class="dv">9</span>, <span class="at">limitsize =</span> F)</span></code></pre></div>
<p>Open <code>combined_plot.png</code> file in your directory folder. Does it look similar to the one in the web browser? On my computer, they look very different, and I much prefer the <strong>png</strong> file.</p>
<p>Here is the actual <strong>png</strong> file:</p>
<div class="figure" style="text-align: center">
<img src="img/combined_plot.png" alt="Combined plot" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-175)Combined plot
</p>
</div>
<p>To be honest, for adding the titles of the axes and the graph, using <strong>Adobe Illustrator</strong> might be much easier. I just included the codes here to demonstrate that everything, however, can be done in R.</p>
<p>If you do not understand some of these functions, you can type in your console <code>?add_sub</code>, <code>?grid.arrange</code> to learn about these functions.</p>
<p>An astute reader will realize that the codes are quite repetitive. Could the codes be shortened? The answer is yes! However, this method is quite complex and beyond the scope of this book.</p>
<!--chapter:end:05-Data.Rmd-->
</div>
</div>
<div id="calculating-area-under-a-curve" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Calculating Area under a Curve</h1>
<p>In this chapter, we will continue to use data from this paper (<a href="https://www.smin95.com/pubs/min2019.pdf">PDF</a>):</p>
<p><strong>Seung Hyun Min, Alex S. Baldwin and Robert F. Hess. Ocular dominance plasticity: A binocular combination task finds no cumulative effect with repeated patching (2019). Vision Research, 161, 36-42.</strong></p>
<p>In Chapter 5, we only dealt with data from Days 1 and 5. In this chapter, we will use data from Days 1, 2, 3, 4 and 5.</p>
<p>Let’s begin by loading the <code>tidyverse</code> and other libraries, and uploading the csv file <code>min2019b.csv</code> using <code>read_csv()</code> from the <code>tidyverse</code> package.</p>
<p><code>head()</code> returns the first 6 rows of the data frame. <code>tail()</code> returns the last 6 rows of the data frame.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject   Day  Time Cbratio
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 a           1     0  -0.421
## 2 b           1     0   2.82 
## 3 c           1     0   1.69 
## 4 d           1     0   2.55 
## 5 e           1     0  -0.217
## 6 f           1     0   0.626</code></pre>
<p><code>unique()</code> returns unique values in the data set. Let’s see how many unique values there are in the <code>Day</code> column of the data set. A column can be extracted by using <code>$</code>.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Day)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5
## Levels: 1 2 3 4 5</code></pre>
<p>Notice that there are now five different days in the data set.</p>
<p>As previously mentioned, there are four columns in this data frame:</p>
<ul>
<li><p>First, <code>Subject</code> refers to each participant. There are 10 participants total.</p></li>
<li><p>Next, <code>Day</code> refers to the day of testing. The participants were tested on Days 1, 2, 3, 4 and 5, ad we will using all data.</p></li>
<li><p><code>Time</code> refers to the number of minutes after an experimental manipulation (ex. monocular deprivation). These are 0, 3, 6, 12, 24 and 48 minutes, but in the data frame, it says 0, 1, 2, 3, 4 and 5; we will change the labels manually.</p></li>
<li><p>The <code>Cbratio</code> column refers to the actual data that will be used for
data analysis.</p></li>
</ul>
<div id="pipe" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Pipe <code>%&gt;%</code></h2>
<p>Let’s plot data from Day 1 only.</p>
<p>To do so, we will need to first filter for data from Day 1 using <code>filter()</code>, compute the average and standard error across subjects using <code>summarise()</code> and <code>sm_stdErr()</code>, and save the changed
format of the dataframe into a new variable using <code>&lt;-</code> or <code>-&gt;</code>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>df_day1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>by_time_day1 <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df, Time)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>avg_day1 <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_time_day1, <span class="at">Average =</span> <span class="fu">mean</span>(Cbratio),</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">StdError =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<p>The steps above (<code>filter()</code>, <code>group_by()</code> and <code>summarise()</code>) are coded separately. Each line has one of these steps. However, these can be combined in one line by using pipe <code>%&gt;%</code> as shown below.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>avg_day1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average =</span> <span class="fu">mean</span>(Cbratio),</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">StdError =</span> <span class="fu">sm_stdErr</span>(Cbratio))</span></code></pre></div>
<p>Now the steps (<code>filter()</code>, <code>group_by()</code> and <code>summarise()</code>) are written from left-to-right in a continuous fashion, rather than a separate step.</p>
<p>Pipe <code>%&gt;%</code> is part of the <code>tidyverse</code> package, and it is deemed a necessary tool for data analysis using R. It is extremely useful because it allows you to write codes that are easier to understand. Notice that if you use <code>%&gt;%</code>, the input does not have to written because the input is actually the code that is written just before. For example:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 a       1         0  -0.421
##  2 b       1         0   2.82 
##  3 c       1         0   1.69 
##  4 d       1         0   2.55 
##  5 e       1         0  -0.217
##  6 f       1         0   0.626
##  7 g       1         0   2.62 
##  8 h       1         0   1.42 
##  9 u       1         0   1.54 
## 10 j       1         0   3.05 
## # ... with 50 more rows</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, Day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 x 4
##    Subject Day    Time Cbratio
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 a       1         0  -0.421
##  2 b       1         0   2.82 
##  3 c       1         0   1.69 
##  4 d       1         0   2.55 
##  5 e       1         0  -0.217
##  6 f       1         0   0.626
##  7 g       1         0   2.62 
##  8 h       1         0   1.42 
##  9 u       1         0   1.54 
## 10 j       1         0   3.05 
## # ... with 50 more rows</code></pre>
<p>These two are identical. But notice that if you do not use pipe,
you might have to save the intermediate variables (such as <code>df_day1</code> and <code>by_time_day1</code>) multiple times, which can be tedious. Notice that when pipe <code>%&gt;%</code> is used, the need to save these variables disappears.</p>
<p>I will use <code>%&gt;%</code> from now on due to my personal preference.</p>
</div>
<div id="area-under-a-curve" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Area under a curve</h2>
<p>Let’s use the data set <code>avg_day1</code> to plot data only from Day 1.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>avg_day1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Average)) <span class="sc">+</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Average <span class="sc">-</span> StdError, <span class="at">ymax =</span> Average <span class="sc">+</span> StdError), <span class="at">size =</span> .<span class="dv">75</span>, <span class="at">width =</span> .<span class="dv">05</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">16</span>, <span class="at">y =</span> <span class="fl">0.3</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-182-1.png" width="350.4" /></p>
<p>One way to show data is to calculate the area under a curve (as shown by the colored area) in the figure above. Area under a curve is useful because it reduces a number of data points (6 in this case due to 6 time points) into one. In our context, a large area under a curve represents a large change in contrast balance ratio over time. In short, it captures both the magnitude and longevity of the effect.</p>
<p>Let’s calculate area under a curve for each subject and day across 0 to 48 minutes in the x-axis (minutes after monocular deprivation) using <code>sm_auc()</code>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">24</span>,<span class="dv">48</span>)</span></code></pre></div>
<p>On the x-axis of the graph, there are six time points. You will need to store these values in a new variable, which I will call <code>x</code> here because it represents the x-axis. Instead of manually writing them down, you could extract the unique number of <code>Time</code> from the data frame.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time) <span class="co"># this is my preferred way</span></span></code></pre></div>
<p>Now let’s filter for one subject’s data (subject <code>b</code>) on Day 1 using <code>filter()</code> and pipe <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>subj_b_day1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>subj_b_day1</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject Day    Time Cbratio
##   &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 b       1         0   2.82 
## 2 b       1         3   0.881
## 3 b       1         6   1.83 
## 4 b       1        12   0.877
## 5 b       1        24   0.693
## 6 b       1        48   2.09</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>subj_b_day1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 1, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">16</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = ?&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-186-1.png" width="350.4" /></p>
<p>The variable <code>subj_b_day1</code> now stores the data of subject <code>b</code> on Day 1. Now let’s calculate the area under a curve (AUC) from <code>subj_b_day1</code> using <code>sm_auc()</code>.</p>
<p><code>sm_auc()</code> calculates the AUC using the method of trapezoid integration; this is equivalent to <code>trapz</code> function in Matlab and <code>numpy.trapz</code> in Python. It has two arguments:
- The first argument is the x point. In this case, it is the minutes after monocular deprivation (0, 3, 6, 12, 24 and 48). If this argument is left empty, it will use 0, 1, 2, 3 etc as default. For more information, please type <code>?sm_auc</code> in the command console.
- The second argument is the data, which is shown by the y-axis in the blue graph. In this case, it is the change of contrast balance ratio (dB). These values can be extracted from <code>subj_b_day1</code> using <code>$</code>.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_auc</span>(x, subj_b_day1<span class="sc">$</span>Cbratio)</span></code></pre></div>
<pre><code>## [1] 60.5286</code></pre>
<p>The AUC equals 60.53. This shows that for subject <code>b</code>, the effect is large and long-lasting.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>subj_b_day1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;skyblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 1, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">17.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = 60.5&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-188-1.png" width="350.4" /></p>
<p>Now let’s visualize the data of subject <code>b</code> from Day 2.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 2, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">16</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = ?&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-189-1.png" width="350.4" /></p>
<p>Now, let’s calculate the AUC for subject <code>b</code> from Day 2.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_auc</span>(x, subj_b_day2<span class="sc">$</span>Cbratio)</span></code></pre></div>
<pre><code>## [1] 80.38215</code></pre>
<p>The AUC equals 80.38. In the case of subject <code>b</code>, the effect seems to have increased on Day 2 relative to Day 1.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> Subject <span class="sc">==</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>subj_b_day2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Cbratio)) <span class="sc">+</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;yelloworange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Day 2, Subject b&quot;</span>) <span class="sc">+</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Minutes after monocular deprivation&quot;</span>) <span class="sc">+</span></span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">17.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&#39;Area under curve = 80.4&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-191-1.png" width="350.4" /></p>
<p>So far,we have 9 more subjects across five days and subject <code>b</code> from three other days. This will require us to compute 48 more AUCs total. This process is rater repetitive. Should we manually compute AUC for each one? Luckily, the answer is no. Let’s use <code>sm_auc_list()</code>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_auc_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<pre><code>##    Subject Day AUC_Cbratio
## 1        a   1    -2.36910
## 2        a   2     0.68265
## 3        a   3    -9.54795
## 4        a   4    27.12165
## 5        a   5    41.95680
## 6        b   1    60.52860
## 7        b   2    80.38215
## 8        b   3    94.68870
## 9        b   4    34.05225
## 10       b   5    86.51805
## 11       c   1    94.84035
## 12       c   2     1.78695
## 13       c   3    44.94750
## 14       c   4    24.83535
## 15       c   5    67.99770
## 16       d   1   100.62510
## 17       d   2   -19.60125
## 18       d   3    85.39140
## 19       d   4     9.37800
## 20       d   5   -16.12920
## 21       e   1    55.32240
## 22       e   2   132.99825
## 23       e   3    67.24410
## 24       e   4    -0.93135
## 25       e   5    27.36150
## 26       f   1   108.13770
## 27       f   2    31.14285
## 28       f   3    21.66375
## 29       f   4   116.81430
## 30       f   5    48.95040
## 31       g   1    63.27840
## 32       g   2    80.24685
## 33       g   3    33.71850
## 34       g   4   131.84340
## 35       g   5    32.61525
## 36       h   1    48.71625
## 37       h   2    75.98130
## 38       h   3    73.61250
## 39       h   4    21.84735
## 40       h   5    71.04780
## 41       u   1    39.11865
## 42       u   2    64.56690
## 43       u   3    15.80355
## 44       u   4    28.84035
## 45       u   5    15.56220
## 46       j   1    74.90610
## 47       j   2   101.06550
## 48       j   3    52.90590
## 49       j   4    40.73910
## 50       j   5    36.71595</code></pre>
<p><code>sm_auc_list()</code> creates a new data frame with AUC for each subject and condition (in this case, Day). It has five arguments:</p>
<ul>
<li><code>data</code> = this argument requires the variable that stores the data frame. In our case, it is <code>df</code>.</li>
<li><code>subjects</code> = this argument requires the name of the column of the data frame that contains subjects. It must strings, ex. <code>'Subject'</code>, not <code>Subject</code>.</li>
<li><code>groups</code> = this argument requires the name of the column of the data frame that contains each group. In this example, there is no group. An example would be <code>Group</code> column that contains two groups: <code>Normal</code> and <code>Amblyopia</code> (see next chapter on Slope Analysis).</li>
<li><code>conditions</code> = this argument requires name of the column of the data frame that contains each condition. In our example, the condition is the day. It must strings, ex. <code>'Day'</code>, not <code>Day</code>.</li>
<li><code>x</code> = this argument requires the name of the column of the data frame that contains the x-axis points from which the AUC can be calculated. In our case, these are 0, 3, 6, 12, 24 minutes. It must strings, ex. <code>'Time'</code>, not <code>Time</code>.</li>
<li><code>values</code> = this argument requires the name of the column of the data frame that contains the actual data, which are the y-axis points from which the AUC can be calculated. In our case, it is the change in contrast balance ratio. It must strings, ex. <code>'Cbratio'</code>, not <code>Cbratio</code>.</li>
</ul>
<p>We can store the results from <code>sm_auc_list()</code> into a new variable. I will call the new variable <code>auc_df</code>.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="ot">&lt;-</span> <span class="fu">sm_auc_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<p>Now we can plot the AUCs using <code>sm_bar()</code>, <code>sm_boxplot</code> etc. Let’s have a try.</p>
<p>Here is a bar graph showing <code>auc_df</code>’s data. This figure is similar to Figure 3E in the original paper (Min, Baldwin and Hess, 2019).</p>
<ul>
<li>re: means relative to X. The data are the differences compared to the baseline (re: Baseline).</li>
</ul>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>,</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">point_alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;\u0394 AUC re: Each day</span><span class="sc">\&#39;</span><span class="st">s baseline&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-194-1.png" width="350.4" /></p>
<p>Here is a box plot showing <code>auc_df</code>’s data.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;\u0394 AUC re: Each day</span><span class="sc">\&#39;</span><span class="st">s baseline&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-195-1.png" width="350.4" /></p>
</div>
<div id="reproducing-figures-in-the-paper-min-et-al.-2019" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Reproducing figures in the paper (Min et al., 2019)</h2>
<p>Let’s redraw some of the figures in the paper. In 2019, where the paper was published, there was no smplot. However, the themes I developed during then have become part of smplot.</p>
<div id="figure-3b-a-best-fit-line-with-points-and-error-bars" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Figure 3B (a best-fit line with points and error bars)</h3>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="co"># filter data from Days 2-4. | means OR.</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="dv">3</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(Cbratio), <span class="at">se =</span> <span class="fu">sm_stdErr</span>(Cbratio)) </span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and standard error computed for each day and time, both of which have been grouped.</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df1<span class="sc">$</span>Time)</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df1<span class="sc">$</span>Day) <span class="co"># Day has to be factored here because they will be labelled as different colors. Factor means categorical variables. </span></span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#55A868&quot;</span>, <span class="st">&quot;#C44E52&quot;</span>, <span class="st">&quot;#8172B2&quot;</span>)</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> avg, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avg <span class="sc">-</span> se, <span class="at">ymax =</span> avg <span class="sc">+</span> se), <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm = linear regression method </span></span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df<span class="sc">$</span>Time), </span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;48&quot;</span>)) <span class="sc">+</span></span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors,</span>
<span id="cb238-21"><a href="#cb238-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Day 2&quot;</span>, <span class="st">&quot;Day 3&quot;</span>, <span class="st">&quot;Day 4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb238-22"><a href="#cb238-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Recovery of the patching effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-23"><a href="#cb238-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time after monocular deprivation (min)&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-24"><a href="#cb238-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;\u0394 Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-25"><a href="#cb238-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb238-26"><a href="#cb238-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.67</span>), </span>
<span id="cb238-27"><a href="#cb238-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-196-1.png" width="350.4" /></p>
</div>
<div id="figure-3d-a-bar-graph" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Figure 3D (a bar graph)</h3>
<p>This a bar graph that has been plotted with <code>sm_bar()</code>. The y-axis has been set with the function <code>coord_cartesian()</code>.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/baseline.csv&#39;</span>) </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#4C72B0&quot;</span>, <span class="st">&quot;#55A868&quot;</span>, <span class="st">&quot;#C44E52&quot;</span>,</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;#8172B2&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>)</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>baseline<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(baseline<span class="sc">$</span>Day)</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>baseline <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y=</span> Baseline, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">points =</span> <span class="cn">FALSE</span>, <span class="at">bar_width =</span> <span class="fl">0.9</span>, <span class="at">errSize =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span> </span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Baseline across days&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))  <span class="sc">+</span></span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Contrast balance ratio (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Patching day&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-197-1.png" width="350.4" /></p>
</div>
<div id="figure-3e-modeling-in-matlab-and-plotting-in-r" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Figure 3E (modeling in Matlab and plotting in R)</h3>
<p>The grey shades have actually been approximated using Matlab. The results have been saved in the .csv file <code>fit_error_shade.csv</code>. They are then imported into R, where the final figure is plotted.</p>
<p>Notice that two data frames are used to create this plot, <code>df_shade1</code> and <code>auc_df1</code>. The former contains the values from the modeling in Matlab, the latter contains AUC values.</p>
<p>So do not worry if your field does not use R for data analysis. One can still perform data visualization using R.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>df_shade <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/fit_error_shade.csv&#39;</span>)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>df_shade1 <span class="ot">&lt;-</span> df_shade <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">yUpp =</span> y_mean <span class="sc">+</span> y_se, <span class="at">yLow =</span> y_mean <span class="sc">-</span> y_se)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>auc_df <span class="ot">&lt;-</span> <span class="fu">sm_auc_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>auc_df1 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span> </span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y_mean =</span> <span class="fu">mean</span>(AUC_Cbratio), <span class="at">std_err =</span> <span class="fu">sm_stdErr</span>(AUC_Cbratio))</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>auc_df1<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(auc_df1<span class="sc">$</span>Day)</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#4C72B0&quot;</span>, <span class="st">&quot;#55A868&quot;</span>, <span class="st">&quot;#C44E52&quot;</span>,</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;#8172B2&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>)</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>df_shade1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y_mean)) <span class="sc">+</span> </span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> yLow, <span class="at">ymax =</span> yUpp), <span class="at">alpha =</span> .<span class="dv">08</span>) <span class="sc">+</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="at">data =</span> auc_df1, <span class="fu">aes</span>(Day, <span class="at">ymin =</span> y_mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> y_mean <span class="sc">+</span> std_err), <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> auc_df1, <span class="fu">aes</span>(Day, y_mean, <span class="at">color =</span> <span class="fu">as.factor</span>(Day), <span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Area Under Curve (dB min)&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Patching Day&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;\u0394 AUC re: Each Day&#39;s Baseline&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;y = -5.8(Day) + 67.8&quot;</span>, <span class="at">x =</span> <span class="fl">2.0</span>, <span class="at">y=</span>  <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb242-21"><a href="#cb242-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">82</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-22"><a href="#cb242-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-23"><a href="#cb242-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">68</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-24"><a href="#cb242-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">65</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-25"><a href="#cb242-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">60</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-198-1.png" width="350.4" /></p>
<!--chapter:end:06-Data2.Rmd-->
</div>
</div>
</div>
<div id="calculating-linear-slopes" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Calculating Linear Slopes</h1>
<p>In this chapter, we will use a fake data set that I have generated by eyeballing Figure 3 from this paper (<a href="https://www.smin95.com/pubs/mao2020.pdf">PDF</a>):</p>
<p><strong>Yu Mao, Seung Hyun Min, Shijia Chen, Ling Gong, Hao Chen, Robert F. Hess, Jiawei Zhou. Binocular imbalance in amblyopia depends on spatial frequency in binocular combination. IOVS. 2020;61(8):7.</strong></p>
<p>In Chapters 5 and 6, we only dealt with data from Days 1 and 5 (i.e., experimental conditions). In this chapter, we will use a dataset that contains both subject groups (<code>Normal</code> and <code>Amblyopia</code>) and conditions (<code>SF</code> = spatial frequency).</p>
<p>Let’s begin by loading the <code>tidyverse</code> and other libraries, and uploading the csv file <code>amblyopia_random.csv</code> using <code>read_csv()</code> from the <code>tidyverse</code> package.</p>
<p>It is always a good habit to make sure that the data set you intended to load uploads properly by using <code>head()</code>, which returns the first 6 rows of the data frame.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/amblyopia_random.csv&#39;</span>) </span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   Subject  absBP    SF Group     Condition
##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    
## 1 A1      0.0747   0.5 Amblyopia One      
## 2 A1      0.678    1   Amblyopia One      
## 3 A1      0.868    2   Amblyopia One      
## 4 A1      1.45     4   Amblyopia One      
## 5 A1      0.868    8   Amblyopia One      
## 6 A10     0.139    0.5 Amblyopia One</code></pre>
<p>In this dataset, there are five columns.</p>
<ul>
<li>First, <code>Subject</code> column has all the subjects. People with amblyopia (a visual disorder) are labelled with <code>A</code>. First subject with amblyopia is written as <code>A1</code>. Normal subject is written with <code>N</code>; first normal subject is <code>N1</code>. We see that there are 10 subjects per group, so there are 20 subjects total.</li>
</ul>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Subject)</span></code></pre></div>
<pre><code>##  [1] &quot;A1&quot;  &quot;A10&quot; &quot;A2&quot;  &quot;A3&quot;  &quot;A4&quot;  &quot;A5&quot;  &quot;A6&quot;  &quot;A7&quot;  &quot;A8&quot;  &quot;A9&quot;  &quot;N1&quot; 
## [12] &quot;N10&quot; &quot;N2&quot;  &quot;N3&quot;  &quot;N4&quot;  &quot;N5&quot;  &quot;N6&quot;  &quot;N7&quot;  &quot;N8&quot;  &quot;N9&quot;</code></pre>
<ul>
<li><p>Second, <code>absBP</code> is the data of our interest.</p></li>
<li><p>Third, <code>SF</code> refers to spatial frequency. We will be calculating slopes of <code>absBP</code> as a function of <code>SF</code>. So these are our x-coordinates for slope calculations (see sections below). Each unit increases by a factor of 2, so it is also helpful to convert the values into log2 units.</p></li>
</ul>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>SF))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">logSF =</span> <span class="fu">log2</span>(SF))</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   Subject  absBP    SF Group     Condition logSF
##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
## 1 A1      0.0747   0.5 Amblyopia One          -1
## 2 A1      0.678    1   Amblyopia One           0
## 3 A1      0.868    2   Amblyopia One           1
## 4 A1      1.45     4   Amblyopia One           2
## 5 A1      0.868    8   Amblyopia One           3
## 6 A10     0.139    0.5 Amblyopia One          -1</code></pre>
<ul>
<li>Fourth, <code>Group</code> refers to as the subject gruop. There are two groups: <code>Amblyopia</code> and <code>Normal</code>.</li>
</ul>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Group)</span></code></pre></div>
<pre><code>## [1] &quot;Amblyopia&quot; &quot;Normal&quot;</code></pre>
<ul>
<li>Lastly, <code>Condition</code> refers to the testing condition. In this dataset, there are two conditions.</li>
</ul>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>Condition)</span></code></pre></div>
<pre><code>## [1] &quot;One&quot; &quot;Two&quot;</code></pre>
<p>The columns <code>Group</code> and <code>Condition</code> are categorical variable and must therefore be factors. <code>head(df)</code> shows that <code>Group</code> and <code>Condition</code> are <code>&lt;chr&gt;</code>, which mean characters. Lets change them to factors <code>&lt;fct&gt;</code>.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Group)</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Condition)</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   Subject  absBP    SF Group     Condition logSF
##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;
## 1 A1      0.0747   0.5 Amblyopia One          -1
## 2 A1      0.678    1   Amblyopia One           0
## 3 A1      0.868    2   Amblyopia One           1
## 4 A1      1.45     4   Amblyopia One           2
## 5 A1      0.868    8   Amblyopia One           3
## 6 A10     0.139    0.5 Amblyopia One          -1</code></pre>
<p>We see that <code>Group</code> and <code>Condition</code> columns are now factor <code>&lt;fct&gt;</code>.</p>
<div id="linear-relationship-using-lm" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Linear relationship using <code>lm()</code></h2>
<p>Linear relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> can be described as <span class="math inline">\(y = mx + b\)</span>, where y is the dependent variable, x is the independent variable, m is the slope, and b is the y-intercept.</p>
<p>Let’s try calculate <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> using the data of <code>A3</code>, which is the 3rd amblyopic observer.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">==</span> <span class="st">&#39;A3&#39;</span>)</span></code></pre></div>
<p>There are two conditions here. Let’s filter for data from the second condition only (<code>Condition == Two</code>).</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>A3_second <span class="ot">&lt;-</span> A3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;Two&#39;</span>)</span></code></pre></div>
<p>Now, we will use the function <code>lm()</code> to compute <span class="math inline">\(m\)</span> (slope) and <span class="math inline">\(b\)</span> (y-intercept).</p>
<p>In R, the relationship between <span class="math inline">\(y\)</span> (dependent variable) and <span class="math inline">\(x\)</span> (independent variable) is written as <code>y~x</code> using tilde (<code>~</code>). In other words, instead of directly writing <span class="math inline">\(y = mx + b\)</span> in R, we use <code>~</code> to describe the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>. Let’s write the relationship between <code>absBP</code> (dependent variable) and <code>logSF</code> (independent variable) within the function <code>lm()</code>.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(df<span class="sc">$</span>absBP <span class="sc">~</span> df<span class="sc">$</span>logSF)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = df$absBP ~ df$logSF)
## 
## Coefficients:
## (Intercept)     df$logSF  
##      0.3205       0.1249</code></pre>
<p>This yields two main outputs. Let’s store this result using a new variable <code>res</code>, which is short for <strong>results</strong>.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(A3_second<span class="sc">$</span>absBP <span class="sc">~</span> A3_second<span class="sc">$</span>logSF)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = A3_second$absBP ~ A3_second$logSF)
## 
## Residuals:
##       1       2       3       4       5 
##  0.1930 -0.1310 -0.1270 -0.1251  0.1900 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)      0.30461    0.11058   2.755  0.07046 . 
## A3_second$logSF  0.45815    0.06384   7.176  0.00557 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2019 on 3 degrees of freedom
## Multiple R-squared:  0.945,  Adjusted R-squared:  0.9266 
## F-statistic:  51.5 on 1 and 3 DF,  p-value: 0.005574</code></pre>
<p><code>summary()</code> is a function that prints all the outputs from a given model object. Here, the model object is <code>res</code>, which has been created using the <code>lm()</code> function. When using <code>lm()</code>, it is advisable to always store the results and print the results using <code>summary()</code>. For more information about <code>summary()</code>, please check out <code>?summary</code>.</p>
<p>We see that the y-intercept <span class="math inline">\(b\)</span> is 0.4582 under the column <code>Estimate</code>. We also see that the slope <span class="math inline">\(m\)</span> is 0.3046 under the column <code>Estimate</code>. You can ignore all the other values for now.</p>
<p>Let’s visualize the data of A3 and fit a linear slope.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>A3_second <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> logSF, <span class="at">y =</span> absBP)) <span class="sc">+</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fl">0.4582</span>, <span class="at">intercept =</span> <span class="fl">0.3046</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-209-1.png" width="350.4" /></p>
<p>Instead of writing the slope and intercept manually, we can subset these values using <code>$</code>.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##     (Intercept) A3_second$logSF 
##       0.3046126       0.4581507</code></pre>
<p>The first value is the intercept. Therefore use <code>[[1]]</code> to subset the intercept.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 0.3046126</code></pre>
<p>You can also subset the slope using <code>[[2]]</code>.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## [1] 0.4581507</code></pre>
<p>Now let’s plot the graph again and label the y-intercept as well.
A separate data frame <code>y_int</code> containing the y-intercept is created below. The code below is a bit challenging, so please use <code>?</code> to figure out each function if you are not sure.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>y_int <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">logSF =</span> <span class="dv">0</span>, <span class="at">absBP =</span> res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>A3_second <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> logSF, <span class="at">y =</span> absBP)) <span class="sc">+</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]], </span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]]) <span class="sc">+</span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> y_int, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&#39;Slope =&#39;</span>,<span class="fu">round</span>(res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]],<span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&#39;Intercept =&#39;</span>, <span class="fu">round</span>(res<span class="sc">$</span>coefficients[[<span class="dv">1</span>]],<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-213-1.png" width="350.4" /></p>
<p>In summary, you can compute the slope of a linear function between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> and using <code>lm()</code>, where you use <code>~</code> to describe the relationship. You also need to use <code>$</code> to subset the slopes directly.</p>
</div>
<div id="calculating-slopes-of-all-subjects-groups-and-conditions" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Calculating slopes of all subjects, groups and conditions</h2>
<p>Now that we know how to compute slope for each subject, let’s calculate slopes of our entire dataset.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 200 x 6
##    Subject  absBP    SF Group     Condition logSF
##    &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;
##  1 A1      0.0747   0.5 Amblyopia One          -1
##  2 A1      0.678    1   Amblyopia One           0
##  3 A1      0.868    2   Amblyopia One           1
##  4 A1      1.45     4   Amblyopia One           2
##  5 A1      0.868    8   Amblyopia One           3
##  6 A10     0.139    0.5 Amblyopia One          -1
##  7 A10     0.448    1   Amblyopia One           0
##  8 A10     0.667    2   Amblyopia One           1
##  9 A10     1.12     4   Amblyopia One           2
## 10 A10     1.70     8   Amblyopia One           3
## # ... with 190 more rows</code></pre>
<p>We see that there are 20 subjects total, each of which has completed two conditions. So there are 40 slopes to calculate! Does that mean we need to use <code>lm()</code> 40 times?</p>
<p>The answer is <strong>no</strong>. smplot has a function <code>sm_slope_list()</code> that returns a dataframe of slopes from <strong>linear regression</strong>. It works similarly to <code>sm_auc_list()</code>.</p>
<ul>
<li><code>data</code> = this argument requires the variable that stores the data frame. In our case, it is <code>df</code>.</li>
<li><code>subjects</code> = this argument requires the name of the column of the data frame that contains subjects. It must strings, ex. <code>'Subject'</code>, not <code>Subject</code>.</li>
<li><code>groups</code> = this argument requires the name of the column of the data frame that contains each group. In this example, there is no group. An example would be <code>Group</code> column that contains two groups: <code>Normal</code> and <code>Amblyopia</code>.</li>
<li><code>conditions</code> = this argument requires name of the column of the data frame that contains each condition. In our example, the two conditions are <code>One</code> and <code>Two</code>.</li>
<li><code>x</code> = this argument requires the name of the column of the data frame that contains the x-axis points from which the AUC can be calculated. In our case, these are values from the <code>logSF</code> column of <code>df</code>. It must strings, ex. <code>'logSF'</code>, not <code>logSF</code>.</li>
<li><code>values</code> = this argument requires the name of the column of the data frame that contains the actual data, which are the y-axis points from which the AUC can be calculated. In our case, it is the change in contrast balance ratio. It must strings, ex. <code>'absBP'</code>, not <code>absBP</code>.</li>
</ul>
<p>We can store the results from <code>sm_slope_list()</code> into a new variable. I will call the new variable <code>slope_df</code>.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>slope_df <span class="ot">&lt;-</span> <span class="fu">sm_slope_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, </span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">conditions =</span> <span class="st">&#39;Condition&#39;</span>,</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">groups =</span> <span class="st">&#39;Group&#39;</span>,</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&#39;logSF&#39;</span>, <span class="at">values =</span> <span class="st">&#39;absBP&#39;</span>, </span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;Slope =  absBP  ~  logSF&quot;</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>slope_df</span></code></pre></div>
<pre><code>##    Subject Condition     Group        Slope
## 2       A1       One Amblyopia  0.235667223
## 3       A1       Two Amblyopia  0.282800668
## 6      A10       One Amblyopia  0.380319905
## 7      A10       Two Amblyopia  0.456383886
## 10      A2       One Amblyopia  0.136716992
## 11      A2       Two Amblyopia  0.164060391
## 14      A3       One Amblyopia  0.381792237
## 15      A3       Two Amblyopia  0.458150685
## 18      A4       One Amblyopia  0.226928105
## 19      A4       Two Amblyopia  0.272313727
## 22      A5       One Amblyopia -0.015766219
## 23      A5       Two Amblyopia -0.018919463
## 26      A6       One Amblyopia  0.097918149
## 27      A6       Two Amblyopia  0.117501779
## 30      A7       One Amblyopia  0.217554761
## 31      A7       Two Amblyopia  0.261065713
## 34      A8       One Amblyopia  0.266574138
## 35      A8       Two Amblyopia  0.319888965
## 38      A9       One Amblyopia  0.198964218
## 39      A9       Two Amblyopia  0.238757061
## 43      N1       One    Normal  0.080372285
## 44      N1       Two    Normal  0.096446741
## 47     N10       One    Normal -0.038881222
## 48     N10       Two    Normal -0.046657466
## 51      N2       One    Normal  0.071885539
## 52      N2       Two    Normal  0.086262647
## 55      N3       One    Normal  0.018219466
## 56      N3       Two    Normal  0.021863359
## 59      N4       One    Normal  0.004361030
## 60      N4       Two    Normal  0.005233235
## 63      N5       One    Normal  0.043098286
## 64      N5       Two    Normal  0.051717943
## 67      N6       One    Normal -0.066678839
## 68      N6       Two    Normal -0.080014607
## 71      N7       One    Normal  0.082798046
## 72      N7       Two    Normal  0.099357656
## 75      N8       One    Normal -0.049344920
## 76      N8       Two    Normal -0.059213905
## 79      N9       One    Normal -0.001135896
## 80      N9       Two    Normal -0.001363075</code></pre>
<p>We see that the slope of A3 in <code>Two</code> condition is identical to the one we have obtained from the <code>lm()</code> function.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>coefficients[[<span class="dv">2</span>]] </span></code></pre></div>
<pre><code>## [1] 0.4581507</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>slope_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">==</span> <span class="st">&#39;A3&#39;</span> <span class="sc">&amp;</span> Condition <span class="sc">==</span> <span class="st">&#39;Two&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Slope)</span></code></pre></div>
<pre><code>##       Slope
## 1 0.4581507</code></pre>
<p>Now we can plot all the slopes from <code>One</code> condition using <code>sm_bar()</code>, <code>sm_boxplot</code> etc. Let’s have a try.</p>
<p>The factor level of <code>slope_df_one$Group</code> is changed below so that bar plot of normal observer is plotted first, then amblyopia (rather than amblyopia -&gt; normals as per alphabetical order).</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>slope_df_one <span class="ot">&lt;-</span> slope_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;One&#39;</span>)</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>slope_df_one<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(slope_df_one<span class="sc">$</span>Group, </span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Amblyopia&#39;</span>))</span></code></pre></div>
<p>Here is a box plot showing <code>slope_df_one</code>’s data.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>slope_df_one <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Slope, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;\u0394 AUC re: Each day</span><span class="sc">\&#39;</span><span class="st">s baseline&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-219-1.png" width="350.4" /></p>
<p>Here is a bar graph showing <code>slope_df</code>’s data for <code>One</code> condition only. This figure is similar to Figure 3B in the paper (Mao et al., 2020).</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>slope_df_one <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> Slope, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>,</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">point_alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Binocular imbalance&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-220-1.png" width="350.4" /></p>
<!--chapter:end:07-Data3.Rmd-->
</div>
</div>
<div id="basic-statistics" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Basic Statistics</h1>
<p>As in the previous two chapters, we will continue to use data from this paper (<a href="https://www.smin95.com/pubs/min2019.pdf">PDF</a>):</p>
<p><strong>Seung Hyun Min, Alex S. Baldwin and Robert F. Hess. Ocular dominance plasticity: A binocular combination task finds no cumulative effect with repeated patching (2019). Vision Research, 161, 36-42.</strong></p>
<p>Load the <code>tidyverse</code> and other libraries, and the csv file <code>min2019b.csv</code> using <code>read_csv()</code> from the <code>tidyverse</code> package.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject   Day  Time Cbratio
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 a           1     0  -0.421
## 2 b           1     0   2.82 
## 3 c           1     0   1.69 
## 4 d           1     0   2.55 
## 5 e           1     0  -0.217
## 6 f           1     0   0.626</code></pre>
<div id="one-sample-t-test" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> One-sample t-test</h2>
<p>One sample t-test compares the mean of a sample to a hypothesized mean (often 0).</p>
<p>For example, here is Figure 3E from the paper. What do the *** mean? How about ** and *? Let’s take a look.</p>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-222-1.png" width="350.4" /></p>
<p>For instance, to determine if the area under curve (changes in contrast balance ratio over time) after patching is significant, so much so that one can confidently say that it is different from 0, we can perform a one-sample t-test using <code>t.test()</code>.</p>
<p>Let’s use data from the sampe paper. We import the data from online using <code>read_csv()</code> and store them into a variable (in this case, <code>df</code>). Then, we compute the area under a curve using <code>sm_auc_list()</code> and store the values in the variable <code>auc_df</code>.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>auc_df <span class="ot">&lt;-</span> <span class="fu">sm_auc_list</span>(<span class="at">subjects =</span> <span class="st">&#39;Subject&#39;</span>, <span class="at">conditions =</span> <span class="st">&#39;Day&#39;</span>, </span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">values =</span> <span class="st">&#39;Cbratio&#39;</span>,</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## [1] &quot;AUC = Cbratio * Time&quot;</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(auc_df)</span></code></pre></div>
<pre><code>##   Subject Day AUC_Cbratio
## 1       a   1    -2.36910
## 2       a   2     0.68265
## 3       a   3    -9.54795
## 4       a   4    27.12165
## 5       a   5    41.95680
## 6       b   1    60.52860</code></pre>
<p>The <code>Day</code> column of <code>df</code> has to be factored using <code>as.factor()</code> because <code>Day</code> here is a categorical, rather than, continuous variable.</p>
<p>To determine if the area under curve data on Day 1 were significantly different from 0, we could use one-sample t-test. First, let’s filter for data from only Day 1.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>auc_df_day1 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>auc_df_day1</span></code></pre></div>
<pre><code>##    Subject Day AUC_Cbratio
## 1        a   1    -2.36910
## 2        b   1    60.52860
## 3        c   1    94.84035
## 4        d   1   100.62510
## 5        e   1    55.32240
## 6        f   1   108.13770
## 7        g   1    63.27840
## 8        h   1    48.71625
## 9        u   1    39.11865
## 10       j   1    74.90610</code></pre>
<p>Then, lets extract the values from the <code>AUC_Cbratio</code> column and perform one-sample t-test using <code>t.test()</code>.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  auc_df_day1$AUC_Cbratio
## t = 6.1934, df = 9, p-value = 0.0001601
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  40.82072 87.80017
## sample estimates:
## mean of x 
##  64.31045</code></pre>
<p>The p-value must be less than <strong>0.05</strong> to be considered statistically significant. It is labelled with one asterisk *. 0.001 &lt; p &lt; 0.01 is denoted with two asterisks **, and p &lt; 0.001 is denoted with three asterisks ***. Since the p-value reported here is less than 0.001, Figure 3E has *** for Day 1’s area under a curve.</p>
<p>We can repeat this for Days 2-5. For brevity, we repeat the example with Days 2 and 4 only.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>auc_df_day2 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day2<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  auc_df_day2$AUC_Cbratio
## t = 3.5182, df = 9, p-value = 0.006534
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  19.60882 90.24161
## sample estimates:
## mean of x 
##  54.92521</code></pre>
<p>The p value is 0.0065, which is less than 0.01 but larger than 0.001. In this case, the statistical significane is denoted as **. Likewise, Figure 3E shows the AUC of Day 2 with **.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>auc_df_day4 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day4<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  auc_df_day4$AUC_Cbratio
## t = 3.0973, df = 9, p-value = 0.01278
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  11.71639 75.19169
## sample estimates:
## mean of x 
##  43.45404</code></pre>
<p>The p-value is 0.013, which is less than 0.05 but larger than 0.01. Therefore one asterisk * is used to label the statistical significance.</p>
</div>
<div id="two-sample-t-test" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Two-sample t-test</h2>
<p>A two-sample t-test is used to compare the mean of one sample to that of another sample.</p>
<p>For example, let’s compare changes in sensory eye dominance after short-term monocular deprivation in Day 1 vs Day 5. These values are shown in the <code>Cbratio</code> column.</p>
<p>Let’s filter only for AUC data from Days 1 and 5.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>auc_df_day1 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>auc_df_day5 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>auc_df_day15 <span class="ot">&lt;-</span> auc_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="dv">5</span>)</span></code></pre></div>
<p>Now, let’s plot a bar graph to display the AUC from Days 1 and 5 using <code>sm_bar()</code>.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> auc_df_day15, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;AUC in Days 1 and 5&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-229-1.png" width="355.2" /></p>
<p>There seems to be a difference in the AUC <code>AUC_Cbratio</code> between Days 1 and 5. The error bars (in this case, standard error) are barely overlapping. If the error bars are clearly overlapping, there is often no significant difference (p &lt; 0.05) between the two data sets. If there is no overlap, it is highly likely that a statistical test will show a significant difference (p &lt; 0.05). Let’s take a look using <strong>t-test</strong> using the function <code>t.test()</code>.</p>
<p><code>t.test()</code> allows us to compare whether data between two different groups are significantly different. Here, <code>$</code> is used to <strong>extract</strong> data from a specific column within a data frame. You could type <code>df_0min$</code>, press the <strong>Tab</strong> button from the keyboard, and see what happens. Since we will only compare values in the <code>AUC_Cbratio</code> column, let’s select for the <code>AUC_Cbratio</code> column and use these values in our <code>t.test()</code>.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day5<span class="sc">$</span>AUC_Cbratio, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  auc_df_day1$AUC_Cbratio and auc_df_day5$AUC_Cbratio
## t = 1.5694, df = 9, p-value = 0.151
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -10.17563  56.27723
## sample estimates:
## mean of the differences 
##                 23.0508</code></pre>
<p>In this case, the subjects are <strong>paired</strong> because the 10 subjects performed on both Days 1 and 5. If your data are not paired (ex. patients vs controls) and you want to perform a t-test, you can set <code>paired = FALSE</code>.</p>
<p>If we are reporting the results, we should report it as such, t(9) = 1.60, p = 0.15. The difference between Days 1 and 5 is not statistically significant.</p>
<div id="shapiro-wilk-test-to-test-for-normality-of-data" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Shapiro-Wilk Test to test for Normality of Data</h3>
<p>T-test can only be used when the data assume normality. In other word, the data that are to be analyzed using <code>t.test()</code> must have a normal distribution (shown below).</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-231-1.png" width="355.2" /></p>
<p>Whether the data have a normal distribution can be checked using a Shaprio-Wilk test (<code>shapiro.test()</code>). If p &gt; 0.05, then the data have a normal distribution, and therefore, t-test can be used to analyze the data. If p &lt; 0.05, the data are not normally distributed, and t-test cannot be used.</p>
<p>For example, let’s check whether the AUC data from Day 1 have a normal distribution.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  auc_df_day1$AUC_Cbratio
## W = 0.95039, p-value = 0.6732</code></pre>
<p>P value is 0.67, which is larger than 0.05. Therefore, the AUCs from Day 1 have a normal distribution.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(auc_df_day5<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  auc_df_day5$AUC_Cbratio
## W = 0.97531, p-value = 0.9353</code></pre>
<p>P value is 0.935, which is larger than 0.05. Therefore, the AUCs from Day 5 have a normal distribution. More information about <code>shapiro.test()</code> can be found in this link: <a href="http://www.sthda.com/english/wiki/normality-test-in-r" class="uri">http://www.sthda.com/english/wiki/normality-test-in-r</a>.</p>
<p>T-test is a type of <strong>parametric</strong> statistical test, which is used to analyze data that are normally distributed. If the data are not normally distributed, <strong>non-parametric</strong> statistical test can be used.</p>
</div>
</div>
<div id="wilcoxon-signed-rank-test" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Wilcoxon Signed-rank Test</h2>
<p>Wilcoxon Signed-rank Test is a <strong>non-parametric</strong> statistical test that is used instead of a t-test when the data are <strong>not normally distributed</strong>.</p>
<p>If eShaprio-Wilk test yields p &lt; 0.05 for the following datasets, a Wilcoxon Signed Rank Test must be used for both one-sample and two-sample tests.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sample Wilcoxon Signed-rank Test</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  auc_df_day1$AUC_Cbratio
## V = 54, p-value = 0.003906
## alternative hypothesis: true location is not equal to 0</code></pre>
<p>The p-value is 0.0039, which is less than 0.05. Therefore, according to the Wilcoxon test, the AUCs from Day 1 are significantly different from 0.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two-sample Wilcoxon test</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day5<span class="sc">$</span>AUC_Cbratio, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  auc_df_day1$AUC_Cbratio and auc_df_day5$AUC_Cbratio
## V = 43, p-value = 0.1309
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>The p-value is 0.13, which is larger than 0.05. Therefore, according to the Wilcoxon test, the AUCs from Days 1 and 2 are not significantly different.</p>
</div>
<div id="effect-size" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Effect Size</h2>
<p>However, even if p-value is larger than 0.05, this does not mean that there is no significant difference between the two groups/conditions. In fact, even a strong drug effect in a study that compares placebo vs. drug can result in p &gt; 0.05 if the sample size is too small.</p>
<p>On the other hand, if a study is conducted a very large sample size (1000 patients per group) to examine the effect of a very weak drug, the data between weak drug and control can give us a p &lt; 0.05, which indicates a statistically significant difference.</p>
<p>In short, <strong>p-value is not everything because it depends on the sample size.</strong></p>
<p>If the sample size is small, p-value can be larger than 0.05. But as the sample gets larger, p-value will decrease even if the mean difference between the two groups remains the same.</p>
<p>In this example, the sample size is not large (n=10). Therefore, one might ask whether our conclusion that there is no significant difference between Days 1 and 5 is truly valid. One might also believe that if our sample size was larger (ex. n=50), we would have found a significant difference between Days 1 and 5.</p>
<p>To respond to this concern, we might need to calculate the <strong>effect size</strong>. If the effect size is large, there is a large difference between the sample groups. <strong>Unlike the p-value, the effect size does not depend on the sample size.</strong></p>
<p>One measure to capture the effect size is <strong>Cohen’s d</strong>. We can use <code>sm_effsize()</code> to calculate Cohen’s d as a measure for the effect size.</p>
<ul>
<li><strong>Small</strong> effect size: Cohen’s d around <strong>0.2</strong></li>
<li><strong>Medium</strong> effect size: Cohen’s d around <strong>0.5</strong></li>
<li><strong>Large</strong> effect size: Cohen’s d &gt; <strong>0.8</strong>.</li>
</ul>
<p>The inputs for <code>sm_effsize()</code> are the data of two sample groups, just as they were in <code>t.test()</code>.</p>
<p>Let’s compute the effect size (Cohen’s d) using AUC data from Days 1 and 2.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_effsize</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day2<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## [1] 0.2238542</code></pre>
<p>Cohen’s d equals <strong>0.224</strong>, which is a very small effect size. This indicates that there is a very small difference in AUC between Days 1 and 2.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1<span class="sc">$</span>AUC_Cbratio, auc_df_day2<span class="sc">$</span>AUC_Cbratio,</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  auc_df_day1$AUC_Cbratio and auc_df_day2$AUC_Cbratio
## t = 0.46312, df = 9, p-value = 0.6543
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -36.45777  55.22823
## sample estimates:
## mean of the differences 
##                 9.38523</code></pre>
<p>Also, it is recommended that <strong>both p-value and effect size are reported</strong> at all times. In this example, I would report the results as: <strong>t(9) = 0.46, p = 0.65, Cohen’s d = 0.22</strong>.</p>
<p>Let’s see what happens in the effect size and p-value from t-test if there are 1000 subjects.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>auc_df_day1b <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&#39;rbind&#39;</span>, <span class="fu">replicate</span>(<span class="dv">100</span>, auc_df_day1, <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>auc_df_day1b<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(auc_df_day1b, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##    Subject Day AUC_Cbratio
## 1       S1   1    -2.36910
## 2       S2   1    60.52860
## 3       S3   1    94.84035
## 4       S4   1   100.62510
## 5       S5   1    55.32240
## 6       S6   1   108.13770
## 7       S7   1    63.27840
## 8       S8   1    48.71625
## 9       S9   1    39.11865
## 10     S10   1    74.90610
## 11     S11   1    -2.36910
## 12     S12   1    60.52860
## 13     S13   1    94.84035
## 14     S14   1   100.62510
## 15     S15   1    55.32240
## 16     S16   1   108.13770
## 17     S17   1    63.27840
## 18     S18   1    48.71625
## 19     S19   1    39.11865
## 20     S20   1    74.90610
## 21     S21   1    -2.36910
## 22     S22   1    60.52860
## 23     S23   1    94.84035
## 24     S24   1   100.62510
## 25     S25   1    55.32240
## 26     S26   1   108.13770
## 27     S27   1    63.27840
## 28     S28   1    48.71625
## 29     S29   1    39.11865
## 30     S30   1    74.90610</code></pre>
<p>We have replicated all the rows of the data frame <code>auc_df_day1</code> by 100 times to create 1000 rows total (i.e., 1000 subjects).</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>auc_df_day2b <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&#39;rbind&#39;</span>, <span class="fu">replicate</span>(<span class="dv">100</span>, auc_df_day2, <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>auc_df_day2b<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(auc_df_day2b, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##    Subject Day AUC_Cbratio
## 1       S1   2     0.68265
## 2       S2   2    80.38215
## 3       S3   2     1.78695
## 4       S4   2   -19.60125
## 5       S5   2   132.99825
## 6       S6   2    31.14285
## 7       S7   2    80.24685
## 8       S8   2    75.98130
## 9       S9   2    64.56690
## 10     S10   2   101.06550
## 11     S11   2     0.68265
## 12     S12   2    80.38215
## 13     S13   2     1.78695
## 14     S14   2   -19.60125
## 15     S15   2   132.99825
## 16     S16   2    31.14285
## 17     S17   2    80.24685
## 18     S18   2    75.98130
## 19     S19   2    64.56690
## 20     S20   2   101.06550
## 21     S21   2     0.68265
## 22     S22   2    80.38215
## 23     S23   2     1.78695
## 24     S24   2   -19.60125
## 25     S25   2   132.99825
## 26     S26   2    31.14285
## 27     S27   2    80.24685
## 28     S28   2    75.98130
## 29     S29   2    64.56690
## 30     S30   2   101.06550</code></pre>
<p>We have replicated all the rows of the data frame <code>auc_df_day2</code> by 100 times to create 1000 rows total (i.e., 1000 subjects).</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_effsize</span>(auc_df_day1b<span class="sc">$</span>AUC_Cbratio, auc_df_day2b<span class="sc">$</span>AUC_Cbratio)</span></code></pre></div>
<pre><code>## [1] 0.2358451</code></pre>
<p>The effect size is 0.24. It has barely changed. Theoretically, it should <strong>not</strong> change (i.e., stay at 0.224), but for some reason here, it has changed very slightly.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(auc_df_day1b<span class="sc">$</span>AUC_Cbratio, auc_df_day2b<span class="sc">$</span>AUC_Cbratio,</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> T)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  auc_df_day1b$AUC_Cbratio and auc_df_day2b$AUC_Cbratio
## t = 4.8793, df = 999, p-value = 1.239e-06
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   5.610696 13.159764
## sample estimates:
## mean of the differences 
##                 9.38523</code></pre>
<p>Now, the p-value is <strong>much less than 0.001</strong>, rather than staying at 0.65. Therefore, we can now observe that p-value is heavily affected by the sample size, whereas the effect size (Cohen’s d) does not. In short, as the sample size increases, the p-value decreases even if the effect size stays the same.</p>
</div>
<div id="power-analysis" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Power Analysis</h2>
<p>We got p &gt; 0.05 with our small sample size (n = 10). As we previously mentioned, we know that p-value gets smaller with an increasing sample size. <strong>Therefore, given the mean difference between two sample groups (i.e., same effect size), the p-value can change depending on the sample size</strong>. So, it is important to report both the p-value and the effect size.</p>
<p>So, one might be concerned with what would be the minimal sample size to detect a statistically significant difference between the two groups (Days 1 and 5). This can be achieved using <strong>power analysis</strong>. Note that p can always be less than 0.05 as long as the sample size meets the requirement (i.e., very large).</p>
<p>If the effect size was large but the data yielded p &gt; 0.05, then we could predict that the minimal sample size from power analysis would be not large. If the effect size was small and the data yielded p &gt; 0.05, as it was for my data, the minimal sample size to yield p &lt; 0.05 would need to be very large.</p>
<p>If the minimal sample size from power analysis was not large (hence, large effect size), then one could conclude that I did not collect enough data and incorrectly concluded that there was no significant difference between the two groups. This would be so because if the sample size was larger, I would have gotten p &lt; 0.05.</p>
<p><strong>Power analysis</strong> can be performed using <code>sm_power()</code>. The inputs for <code>sm_power()</code> are data of two sample groups, just as they were in <code>t.test()</code>.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_power</span>(auc_df_day1b<span class="sc">$</span>AUC_Cbratio, auc_df_day2b<span class="sc">$</span>AUC_Cbratio,</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 143.0411
##               d = 0.2358451
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<p>According to our power analysis (significant level = 0.05, power = 80%), we would need about <strong>143 subjects</strong> per group (<code>n = 143.0411</code>) for the p-value to reach below 0.05 and, therefore, for us to detect a statistically significant difference in AUCs between Days 1 and 2. In other words, the difference between Days 1 and 2 is very small. Also, the conclusion that there was no difference between the days seems to be valid even though the sample size is small.</p>
</div>
<div id="one-way-anova" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> One-way ANOVA</h2>
<p>One-way analysis of variance (ANOVA) is used to compare the mean of multiple groups (2 groups or more). It can also be referred to as one-factor ANOVA. The data are separated into multiple groups based on one categorical variable (such as patching days, conditions or subject groups).</p>
<p>When one is comparing two groups, one-way ANOVA and two-sample t-test can yield the same results because both of these tests would compare two groups.</p>
<p>To do ANOVA, we will use <code>rstatix</code> package. Install the package if you have not done so.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;rstatix&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code></pre></div>
<p><strong>Note:</strong> We will use <code>rstatix</code> to perform some statistical tests. However, both <code>tidyverse</code> and <code>rstatix</code> packages have the function called <code>filter()</code>. To use <code>filter()</code> from the <code>tidyverse</code> (or <code>dplyr</code>) package, as we have done so before, you will need to type <code>dplyr::filter</code> rather than <code>filter</code> instead to specify <code>filter()</code> from the <code>dplyr</code> package.</p>
<p>To perform ANOVA, we have to make some assumptions about the data:</p>
<ul>
<li><p>Data should be normally distributed. This can be confirmed by using a Shapiro-Wilk test.</p></li>
<li><p>No outliers.</p></li>
<li><p>Homogeneity of variance. The variance of the data should be consistent as a function of the predictor (x-axis). This can be examined with the Levene’s test.</p></li>
<li><p>Observations should be independent: The data from one group should have no relationship with other data within the same group. In short, each observation should be unique and come from an unique individual.</p></li>
</ul>
<p>Let’s investigate whether AUC data differ significantly across days (Days 1 to 5). To do so, we will need to perform one-way ANOVA where the factor is <code>Day</code>.</p>
<div id="check-for-outliers" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Check for Outliers</h3>
<p>We will check for outliers in the <code>auc_df</code> data frame, which stores the results of AUCs. Since we will compare the AUCs across different days (factor: <code>Day</code>), we will group each observation (each row) of the data frame by <code>Day</code>. Next, we will use the function <code>identify_outliers()</code> from the <code>rstatix</code> package to see if there are any outliers in the data set.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify_outliers</span>(AUC_Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   Day   Subject AUC_Cbratio is.outlier is.extreme
##   &lt;fct&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
## 1 4     f              117. TRUE       TRUE      
## 2 4     g              132. TRUE       TRUE</code></pre>
<p>In this case, we have <strong>2 outliers</strong> of AUC data on Day 4. Since Figure 3E indicates that Day 4 is not outrageously different than the averaged AUCs of other days, I will infer that these 2 outliers do not significantly affect the data. Therefore, I will include these 2 outliers in my data analysis.</p>
<p>However, if your data set has too many outliers, then it might be inappropriate to proceed to one-way ANOVA.</p>
<p>Let’s visually confirm whether there are 2 outliers in the AUC data from Day 4 by plotting a boxplot using <code>sm_boxplot()</code>.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> AUC_Cbratio, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;\u0394 AUC re: Each day</span><span class="sc">\&#39;</span><span class="st">s baseline&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-246-1.png" width="350.4" /></p>
<p>We see that there are two orange points that reside outside the whiskers of the boxplot. Points that are outside the whiskers represent outliers. Therefore, we confirm visually that there are two outliers on Day 4, and no outliers on any other days.</p>
</div>
<div id="checking-for-normality-of-data" class="section level3" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Checking for Normality of Data</h3>
<p>Rather than using <code>shapiro.test()</code>, we will be using <code>shapiro_test()</code> from the <code>rstatix</code> package because we will be sorting data (<code>group_by()</code> by <code>Day</code>) using the pipe <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(AUC_Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   Day   variable    statistic       p
##   &lt;fct&gt; &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;
## 1 1     AUC_Cbratio     0.950 0.673  
## 2 2     AUC_Cbratio     0.944 0.599  
## 3 3     AUC_Cbratio     0.977 0.947  
## 4 4     AUC_Cbratio     0.770 0.00620
## 5 5     AUC_Cbratio     0.975 0.935</code></pre>
<p>In this data set, Days 1, 2, 3 and 5 have normally distributed data sets. However, the data from Day 4 do not seem to be normally distributed. This could because there are 2 outliers on Day 4. Since bulk of the data are normally distributed, I will use <strong>parametric</strong> method to analyze the data, i.e., one-way ANOVA. If most of your data are not normally distributed, then one-way ANOVA should not be used.</p>
</div>
<div id="checking-the-assumption-for-homogeneity-of-variance" class="section level3" number="8.6.3">
<h3><span class="header-section-number">8.6.3</span> Checking the Assumption for Homogeneity of Variance</h3>
<p>We can examine whether the variance of the response values (y values) is homogeneous using <code>levene_test()</code>.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span><span class="fu">levene_test</span>(AUC_Cbratio <span class="sc">~</span> Day)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##     df1   df2 statistic     p
##   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1     4    45     0.638 0.638</code></pre>
<p>The Levene’s test shows that the p-value is 0.64, which is larger than 0.05. Therefore, we can assume that the variance is homogeneous across different days. Therefore, we can proceed to using ANOVA.</p>
</div>
<div id="computing-one-way-anova" class="section level3" number="8.6.4">
<h3><span class="header-section-number">8.6.4</span> Computing One-way ANOVA</h3>
<p>We perform one-way ANOVA by comparing whether <code>AUC_Cbratio</code> values significantly differ across <code>Day</code>. <code>~</code> (tilde) defines the relationship between dependent and independent variables. <code>y = m*x + b</code> can be described with <code>~</code> as <code>y~x</code>, where the value of x can affect the value of y. In the example below, it is written as <code>AUC_Cbratio ~ Day</code> because <code>AUC_Cbratio</code> (dependent variable) is affected by <code>Day</code> (independent variable).</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> AUC_Cbratio <span class="sc">~</span> Day, <span class="at">data =</span> auc_df)</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## Day          4   3513   878.3   0.588  0.673
## Residuals   45  67191  1493.1</code></pre>
<p><code>aov()</code> is used to perform <strong>a</strong>nalysis <strong>o</strong>f <strong>v</strong>ariance. In this example, the result from <code>aov()</code> is stored in the variable <code>res</code>. The summary of the results can be displayed using the function <code>summary()</code>.</p>
<p>The p-value is 0.67, which is larger than 0.05. This indicates that there is no significant difference across days in AUCs.</p>
<p>If your data show a p value less than 0.05, then you should proceed to the next step of performing post-hoc pairwise comparison tests.</p>
</div>
<div id="post-hoc-tests" class="section level3" number="8.6.5">
<h3><span class="header-section-number">8.6.5</span> Post-hoc Tests</h3>
<p>If one-way ANOVA shows a significant difference (p &lt; 0.05), then the reader should perform <strong>Tukey HSD</strong> post-hoc pairwise comparison (<strong>H</strong>onestly <strong>S</strong>ignificant <strong>D</strong>ifference) tests to see which two specific groups vary significantly. In the example, I have saved the results in the variable <code>res</code> (short for results).</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = AUC_Cbratio ~ Day, data = auc_df)
## 
## $Day
##           diff       lwr      upr     p adj
## 2-1  -9.385230 -58.48783 39.71737 0.9822382
## 3-1 -16.267650 -65.37025 32.83495 0.8791429
## 4-1 -20.856405 -69.95900 28.24619 0.7473960
## 5-1 -23.050800 -72.15340 26.05180 0.6718799
## 3-2  -6.882420 -55.98502 42.22018 0.9945038
## 4-2 -11.471175 -60.57377 37.63142 0.9630859
## 5-2 -13.665570 -62.76817 35.43703 0.9319698
## 4-3  -4.588755 -53.69135 44.51384 0.9988648
## 5-3  -6.783150 -55.88575 42.31945 0.9948024
## 5-4  -2.194395 -51.29699 46.90820 0.9999390</code></pre>
<p>As expected from one-way ANOVA, which shows no significant difference across days, the post-hoc pairwise tests (Tukey HSD test) yield p-values higher than 0.05 between any combinations of two different days.</p>
<p>If one-way ANOVA yielded p &lt; 0.05, then we could expect to see a p-value lower than 0.05 in the Tukey HSD post-hoc test. Therefore, when one-way ANOVA yields p &gt; 0.05, it is not necessary to perform a pairwise post-hoc comparison (Tukey HSD) using the data set.</p>
</div>
<div id="one-way-repeated-measures-anova" class="section level3" number="8.6.6">
<h3><span class="header-section-number">8.6.6</span> One-way Repeated Measures ANOVA</h3>
<p>If the subjects are identical across the factor (ex. <code>Day</code>), then <code>anova_test()</code> (from the <code>rstatix</code> package) can be used to perform repeated measures ANOVA.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>auc_df <span class="sc">%&gt;%</span> <span class="fu">anova_test</span>(AUC_Cbratio <span class="sc">~</span> Day, <span class="at">wid =</span> Subject,</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">within =</span> Day)</span></code></pre></div>
<pre><code>## ANOVA Table (type II tests)
## 
##   Effect DFn DFd     F     p p&lt;.05  ges
## 1    Day   4  45 0.588 0.673       0.05</code></pre>
<p><code>wid</code> is the column name containing individuals/subjects identifiers. It should be unique to each individual. <code>within</code> is an <strong>optional</strong> argument that contains within subject variable, which in this case is <code>Day</code> as the same subjects were tested across days.</p>
<p>If different subjects were tested on each day, then <code>wid</code> should be empty. In both occasions, the p-value is the same because the subject identifiers (ex. <code>S1</code>, <code>S2</code>) are unique to each subject. Therefore, <code>R</code> just recognizes that it should perform repeated measures ANOVA.</p>
</div>
</div>
<div id="two-way-anova" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Two-way ANOVA</h2>
<p>In a two-way ANOVA, the effects of two factors are examined. In our example, we will use the data set from the paper, and examine the effects of <code>Day</code> and <code>Time</code>, which is the time point after short-term monocular deprivation (minutes).</p>
<p>Since we will be investigating whether the effects of <code>Day</code> and <code>Time</code> as variables significantly affect the values of <code>Cbratio</code>, we need to convert the columns <code>Day</code> and <code>Time</code> of <code>df</code> as factor using <code>as.factor()</code>.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/min2019b.csv&#39;</span>) </span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Day)</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Time)</span></code></pre></div>
<p>As before, let’s check for some of the assumptions that are required to perform ANOVA.</p>
<div id="identifying-outliers" class="section level3" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> Identifying Outliers</h3>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify_outliers</span>(Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 13 x 6
##    Day   Time  Subject Cbratio is.outlier is.extreme
##    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
##  1 1     12    f         3.43  TRUE       FALSE     
##  2 2     24    d        -0.916 TRUE       FALSE     
##  3 2     24    e         5.20  TRUE       TRUE      
##  4 2     48    j         2.75  TRUE       FALSE     
##  5 3     24    b         2.79  TRUE       FALSE     
##  6 3     24    u        -0.389 TRUE       FALSE     
##  7 4     0     f         7.47  TRUE       FALSE     
##  8 4     3     e         8.70  TRUE       TRUE      
##  9 4     6     f         2.38  TRUE       FALSE     
## 10 4     24    g         3.45  TRUE       FALSE     
## 11 4     48    e        -2.37  TRUE       FALSE     
## 12 4     48    g         3.21  TRUE       FALSE     
## 13 5     6     d        -2.88  TRUE       TRUE</code></pre>
<p>We observe that there are 13 outliers, 2 of which are considered to be extreme points. <code>identify_outliers()</code> pinpoint outliers based on the definition of boxplots. Outliers in boxplots can be ignored. However, extreme points can be considered to be slightly troublesome. In this example, 2 out of 230 (<code>nrow(df)</code>) observations seem to be extreme points. Therefore, the data set meets the requirement to be analyzed using two-way ANOVA.</p>
</div>
<div id="checking-for-normality-of-data-1" class="section level3" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> Checking for Normality of Data</h3>
<p>Let’s check for the normality of the data using <code>shapiro_test()</code> from the <code>rstatix</code> package for each <code>Day</code> and <code>Time</code>. To do so, we will have to group our data using <code>group_by()</code> for <code>Day</code> and <code>Time</code>.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Cbratio)</span></code></pre></div>
<pre><code>## # A tibble: 30 x 5
##    Day   Time  variable statistic     p
##    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
##  1 1     0     Cbratio      0.913 0.306
##  2 1     3     Cbratio      0.947 0.630
##  3 1     6     Cbratio      0.899 0.213
##  4 1     12    Cbratio      0.897 0.201
##  5 1     24    Cbratio      0.918 0.341
##  6 1     48    Cbratio      0.964 0.831
##  7 2     0     Cbratio      0.925 0.398
##  8 2     3     Cbratio      0.912 0.292
##  9 2     6     Cbratio      0.900 0.221
## 10 2     12    Cbratio      0.934 0.493
## # ... with 20 more rows</code></pre>
<p>Only the first 10 rows are shown. To view the entire results, store the results into a variable and use <code>View()</code>.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day, Time) <span class="sc">%&gt;%</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Cbratio)</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res)</span></code></pre></div>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(res<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>We see that there are 3 p-values (out of 30 combinations of <code>Day</code> and <code>Time</code>) that are smaller than 0.05. Ideally, we would want all of them to have a p-value higher than 0.05 for the data to be considered as normally distributed. However, since most data seem to be normally distributed in our example, it is okay to proceed to use a two-way ANOVA, which is a parametric procedure.</p>
</div>
<div id="computing-two-way-anova" class="section level3" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> Computing Two-way ANOVA</h3>
<p>As before, let’s use <code>aov()</code> function to compute ANOVA.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> Cbratio <span class="sc">~</span> Day <span class="sc">+</span> Time <span class="sc">+</span> Day<span class="sc">:</span>Time,</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df)</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Day           4    7.2   1.796   0.948    0.437    
## Time          5   74.2  14.832   7.825 6.77e-07 ***
## Day:Time     20   18.4   0.921   0.486    0.971    
## Residuals   270  511.8   1.896                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>As before, we specify the <code>formula</code> using tilde (<code>~</code>); its left side is the dependent variable (<code>Cbratio</code>), and the right side includes the independent variables (or predictors, ex. <code>Day</code> and <code>Time</code>). <code>+</code> is used to add more independent variables in the model formula. Interaction between the effects of <code>Day</code> and <code>Time</code> should also be included by <code>:</code>.</p>
<p>Another way of writing the model formula is shown below. It uses <code>*</code> as a shortcut to include the effects of <code>Day</code>, <code>Time</code> and their interactions. Notice that the results of both ANOVAs are identical because the model formulas are the same.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> Cbratio <span class="sc">~</span> Day<span class="sc">*</span>Time, <span class="at">data =</span> df)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res2)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Day           4    7.2   1.796   0.948    0.437    
## Time          5   74.2  14.832   7.825 6.77e-07 ***
## Day:Time     20   18.4   0.921   0.486    0.971    
## Residuals   270  511.8   1.896                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>It appears that there is a statistically significant effect of <code>Time</code>, F(5, 270) = 7.83, p &lt; 0.001. But the effect of <code>Day</code> seems to be not significant, F(4,270) = 0.49, p = 0.44. Also the effect of interaction between <code>Day</code> and <code>Time</code> is not significant, F(20,270) = 0.97, p &gt; 0.05.</p>
<p>An interaction effect between A and B exists when the effect of factor A (ex. <code>Day</code>) is different at different levels of factor B (ex. <code>Time</code>). Let’s understand how the effect of interaction could affect the data.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-259-1.png" width="350.4" /></p>
<p>We see that best-fit regression slopes of the green, red and purple lines are almost identical. This is because the factor <code>Time</code> affects <code>Cbratio</code> at different levels of the factor <code>Day</code> (i.e., different days). This suggests that the slope of decay (decrease in changes in Contrast balance ratio) over time is similar across days. In other words, the interaction effect between <code>Time</code> and <code>Day</code> is not significant (p &lt; 0.05).</p>
<p>Conversely, if <code>Time</code> affects <code>Cbratio</code> differently across different days, we would see that the best-fit regression slopes would be different among days.</p>
</div>
<div id="post-hoc-test" class="section level3" number="8.7.4">
<h3><span class="header-section-number">8.7.4</span> Post-hoc Test</h3>
<p>The procedure for post-hoc analysis differs depending on whether the interaction effect is statistically significant (p &lt; 0.05) or not (p &gt; 0.05).</p>
<p>Post-hoc test should be performed when there is a significant main effect from one of the factors (ex. <code>Time</code> or <code>Day</code>) in the two-way ANOVA. If not, it should not be performed.</p>
<p>If there is a significant main effect but the interaction effect is not significant, only interpret the results of post-hoc analysis that are related to the main effects. For example, if <code>Time</code> was a significant main effect, we could analyze the data as following.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res, <span class="at">which =</span> <span class="st">&#39;Time&#39;</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Cbratio ~ Day + Time + Day:Time, data = df)
## 
## $Time
##            diff        lwr         upr     p adj
## 3-0    0.106096 -0.6842609  0.89645292 0.9988910
## 6-0   -0.378016 -1.1683729  0.41234092 0.7432954
## 12-0  -0.887696 -1.6780529 -0.09733908 0.0176431
## 24-0  -0.876150 -1.6665069 -0.08579308 0.0201057
## 48-0  -1.257262 -2.0476189 -0.46690508 0.0001098
## 6-3   -0.484112 -1.2744689  0.30624492 0.4946934
## 12-3  -0.993792 -1.7841489 -0.20343508 0.0048793
## 24-3  -0.982246 -1.7726029 -0.19188908 0.0056524
## 48-3  -1.363358 -2.1537149 -0.57300108 0.0000191
## 12-6  -0.509680 -1.3000369  0.28067692 0.4349141
## 24-6  -0.498134 -1.2884909  0.29222292 0.4616410
## 48-6  -0.879246 -1.6696029 -0.08888908 0.0194170
## 24-12  0.011546 -0.7788109  0.80190292 1.0000000
## 48-12 -0.369566 -1.1599229  0.42079092 0.7611911
## 48-24 -0.381112 -1.1714689  0.40924492 0.7366165</code></pre>
<p>If there is a significant interaction effect between <code>Day</code> and <code>Time</code>, we can examine how the effect of <code>Time</code> varies across different days.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cbratio <span class="sc">~</span> Time, <span class="at">wid =</span> Subject, <span class="at">within =</span> Day) <span class="sc">%&gt;%</span></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_anova_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 9
##     Day Effect   DFn   DFd     F        p `p&lt;.05`   ges   p.adj
##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1     1 Time       1    58  3.73 0.058    &quot;&quot;      0.06  0.29   
## 2     2 Time       1    58  5    0.029    &quot;*&quot;     0.079 0.145  
## 3     3 Time       1    58 17.4  0.000104 &quot;*&quot;     0.23  0.00052
## 4     4 Time       1    58  3.96 0.051    &quot;&quot;      0.064 0.255  
## 5     5 Time       1    58  6.9  0.011    &quot;*&quot;     0.106 0.055</code></pre>
<p><code>within</code> refers to the within-subject factor, which in this case <code>Day</code>. If there are different subjects associated with each <code>Day</code>, then <code>between</code> argument can be filled instead of <code>within</code> in the <code>anova_test()</code> function.</p>
<p>It seems that the effect of <code>Time</code> is not statistically significant at different levels of the factor <code>Day</code>, except for Day 3. This means that the decrease of <code>Cbratio</code> over time does not differ significantly across most days. This (sort of) agrees with our results that the interaction effect is not statistically significant.</p>
<p>Let’s pretend that the interaction effect is still significant. If so, we can examine whether the second independent variable (<code>Day</code> in our case) differs across different levels of the first independent variable (<code>Time</code> in our example).</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cbratio <span class="sc">~</span> Day, <span class="at">wid =</span> Subject, <span class="at">within =</span> Time) <span class="sc">%&gt;%</span></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_anova_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##    Time Effect   DFn   DFd     F     p `p&lt;.05`   ges p.adj
##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1     0 Day        1    48 0.36  0.551 &quot;&quot;      0.007 1    
## 2     3 Day        1    48 1.10  0.3   &quot;&quot;      0.022 1    
## 3     6 Day        1    48 7.88  0.007 &quot;*&quot;     0.141 0.042
## 4    12 Day        1    48 0.058 0.811 &quot;&quot;      0.001 1    
## 5    24 Day        1    48 1.54  0.221 &quot;&quot;      0.031 1    
## 6    48 Day        1    48 1.25  0.268 &quot;&quot;      0.025 1</code></pre>
<p>It seems that the effect of <code>Day</code> remains insignificant across all time points.</p>
<p>You may realize that this result from the above is strange. Indeed, it is inappropriate to report these two results because the interaction effect is not statistically significant. Therefore, it is more appropriate to just report the post-hoc analysis that is only concerned with the effect of <code>Time</code>.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res, <span class="at">which =</span> <span class="st">&#39;Time&#39;</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Cbratio ~ Day + Time + Day:Time, data = df)
## 
## $Time
##            diff        lwr         upr     p adj
## 3-0    0.106096 -0.6842609  0.89645292 0.9988910
## 6-0   -0.378016 -1.1683729  0.41234092 0.7432954
## 12-0  -0.887696 -1.6780529 -0.09733908 0.0176431
## 24-0  -0.876150 -1.6665069 -0.08579308 0.0201057
## 48-0  -1.257262 -2.0476189 -0.46690508 0.0001098
## 6-3   -0.484112 -1.2744689  0.30624492 0.4946934
## 12-3  -0.993792 -1.7841489 -0.20343508 0.0048793
## 24-3  -0.982246 -1.7726029 -0.19188908 0.0056524
## 48-3  -1.363358 -2.1537149 -0.57300108 0.0000191
## 12-6  -0.509680 -1.3000369  0.28067692 0.4349141
## 24-6  -0.498134 -1.2884909  0.29222292 0.4616410
## 48-6  -0.879246 -1.6696029 -0.08888908 0.0194170
## 24-12  0.011546 -0.7788109  0.80190292 1.0000000
## 48-12 -0.369566 -1.1599229  0.42079092 0.7611911
## 48-24 -0.381112 -1.1714689  0.40924492 0.7366165</code></pre>
</div>
</div>
<div id="extra-resources" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Extra Resources</h2>
<p>For detailed information about ANOVA in R, please check out this link: <a href="https://www.datanovia.com/en/lessons/anova-in-r/" class="uri">https://www.datanovia.com/en/lessons/anova-in-r/</a>.</p>
<p>To learn more about performing statistical tests in R, please check out the book entitled <strong>YaRrr! The Pirate’s Guide to R</strong> by Nathaniel Phillips (<a href="https://bookdown.org/ndphillips/YaRrr/" class="uri">https://bookdown.org/ndphillips/YaRrr/</a>).</p>
<!--chapter:end:08-statistics.Rmd-->
</div>
</div>
<div id="recreating-figures-from-front.-genetics-2021" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Recreating Figures from Front. Genetics (2021)</h1>
<p>This chapter refers to this paper: <strong>Seung Hyun Min, Jiawei Zhou. smplot: An R Package for Easy and Elegant Data Visualization (2021). Frontiers in Genetics, 12:802894.</strong></p>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="figure-1---correlation-plot" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Figure 1 - Correlation Plot</h2>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>corr1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># ggplot2 default</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot without smplot&#39;</span>)</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, </span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;Base plot only using </span><span class="sc">\n</span><span class="st">the defaults of ggplot2&#39;</span>,</span>
<span id="cb361-10"><a href="#cb361-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">25</span>)</span>
<span id="cb361-11"><a href="#cb361-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-12"><a href="#cb361-12" aria-hidden="true" tabindex="-1"></a>corr2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb361-13"><a href="#cb361-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb361-14"><a href="#cb361-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb361-15"><a href="#cb361-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> <span class="co"># smplot correlation theme </span></span>
<span id="cb361-16"><a href="#cb361-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot with smplot&#39;</span>) </span>
<span id="cb361-17"><a href="#cb361-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-18"><a href="#cb361-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-19"><a href="#cb361-19" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb361-20"><a href="#cb361-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb361-21"><a href="#cb361-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Base plot + sm_corr_theme()&#39;</span>,</span>
<span id="cb361-22"><a href="#cb361-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">29</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb361-23"><a href="#cb361-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">23</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb361-24"><a href="#cb361-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;bold(sm_corr_theme())~</span><span class="sc">\n</span><span class="st">provides~</span><span class="sc">\n</span><span class="st">a~theme~with&#39;</span>) <span class="sc">+</span></span>
<span id="cb361-25"><a href="#cb361-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">20</span>,</span>
<span id="cb361-26"><a href="#cb361-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;minimalistic background</span><span class="sc">\n</span><span class="st">larger font</span><span class="sc">\n</span><span class="st">centered title&#39;</span>)</span>
<span id="cb361-27"><a href="#cb361-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-28"><a href="#cb361-28" aria-hidden="true" tabindex="-1"></a>corr3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb361-29"><a href="#cb361-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb361-30"><a href="#cb361-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb361-31"><a href="#cb361-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> <span class="co"># smplot corr theme + p and r values</span></span>
<span id="cb361-32"><a href="#cb361-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>) <span class="sc">+</span></span>
<span id="cb361-33"><a href="#cb361-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Statistics computed with smplot&#39;</span>) </span>
<span id="cb361-34"><a href="#cb361-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-35"><a href="#cb361-35" aria-hidden="true" tabindex="-1"></a>text3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb361-36"><a href="#cb361-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb361-37"><a href="#cb361-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Base plot + sm_corr_theme() +</span><span class="sc">\n</span><span class="st">sm_statCorr()&#39;</span>,</span>
<span id="cb361-38"><a href="#cb361-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">30</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb361-39"><a href="#cb361-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">24</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb361-40"><a href="#cb361-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;bold(sm_statCorr())~from~smplot~computes&#39;</span>) <span class="sc">+</span></span>
<span id="cb361-41"><a href="#cb361-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="fl">22.6</span>, </span>
<span id="cb361-42"><a href="#cb361-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;R and p values from a correlation test.&#39;</span>) <span class="sc">+</span></span>
<span id="cb361-43"><a href="#cb361-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">18</span>,</span>
<span id="cb361-44"><a href="#cb361-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">It also prints the best-fit </span><span class="sc">\n</span><span class="st">linear regression line </span><span class="sc">\n</span><span class="st">based on the R value.&#39;</span>)</span>
<span id="cb361-45"><a href="#cb361-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-46"><a href="#cb361-46" aria-hidden="true" tabindex="-1"></a>corr_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(corr1, text1, corr2, text2, </span>
<span id="cb361-47"><a href="#cb361-47" aria-hidden="true" tabindex="-1"></a>                      corr3, text3,</span>
<span id="cb361-48"><a href="#cb361-48" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb361-49"><a href="#cb361-49" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb361-50"><a href="#cb361-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb361-51"><a href="#cb361-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb361-52"><a href="#cb361-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-53"><a href="#cb361-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(corr_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-265-1.png" width="696" /></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;corr_plots.png&quot;</span>, </span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>          corr_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-2---bar-plot" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Figure 2 - Bar Plot</h2>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>bar1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&#39;bar&#39;</span>) <span class="sc">+</span> </span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Bar plot without smplot&#39;</span>)</span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb363-15"><a href="#cb363-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb363-16"><a href="#cb363-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Bar~plot~using~bold(stat_summary())~from~ggplot2&#39;</span>,</span>
<span id="cb363-17"><a href="#cb363-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">3</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) </span>
<span id="cb363-18"><a href="#cb363-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-19"><a href="#cb363-19" aria-hidden="true" tabindex="-1"></a>bar2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb363-20"><a href="#cb363-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb363-21"><a href="#cb363-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb363-22"><a href="#cb363-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Bar plot using smplot&#39;</span>)</span>
<span id="cb363-23"><a href="#cb363-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-24"><a href="#cb363-24" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb363-25"><a href="#cb363-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb363-26"><a href="#cb363-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Bar~plot~using~bold(sm_bar())&#39;</span>,</span>
<span id="cb363-27"><a href="#cb363-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb363-28"><a href="#cb363-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Individual points,</span><span class="sc">\n</span><span class="st">larger font,</span><span class="sc">\n</span><span class="st">minimalistic theme</span><span class="sc">\n</span><span class="st">centered title</span><span class="sc">\n</span><span class="st">narrower bar width</span><span class="sc">\n</span><span class="st">error bar&#39;</span>,</span>
<span id="cb363-29"><a href="#cb363-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.5</span>)</span>
<span id="cb363-30"><a href="#cb363-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-31"><a href="#cb363-31" aria-hidden="true" tabindex="-1"></a>bar_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(bar1, text1, bar2, text2, </span>
<span id="cb363-32"><a href="#cb363-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb363-33"><a href="#cb363-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb363-34"><a href="#cb363-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb363-35"><a href="#cb363-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb363-36"><a href="#cb363-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-37"><a href="#cb363-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bar_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-266-1.png" width="696" /></p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;bars.png&quot;</span>, </span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>          bar_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-3---boxplot" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Figure 3 - Boxplot</h2>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://www.smin95.com/data.csv&#39;</span>) </span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>boxplot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Boxplot without smplot&#39;</span>)</span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Boxplot~using~bold(geom_boxplot())</span><span class="sc">\n</span><span class="st">~from~ggplot2&#39;</span>,</span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">8</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb365-14"><a href="#cb365-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-15"><a href="#cb365-15" aria-hidden="true" tabindex="-1"></a>boxplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb365-16"><a href="#cb365-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb365-17"><a href="#cb365-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb365-18"><a href="#cb365-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Boxplot with smplot&#39;</span>) <span class="co"># smplot&#39;s default</span></span>
<span id="cb365-19"><a href="#cb365-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-20"><a href="#cb365-20" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb365-21"><a href="#cb365-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb365-22"><a href="#cb365-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Boxplot~using~bold(sm_boxplot())&#39;</span>,</span>
<span id="cb365-23"><a href="#cb365-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">11</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb365-24"><a href="#cb365-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Individual points,</span><span class="sc">\n</span><span class="st">larger font,</span><span class="sc">\n</span><span class="st">minimalistic theme</span><span class="sc">\n</span><span class="st">centered title&#39;</span>,</span>
<span id="cb365-25"><a href="#cb365-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">5</span>)</span>
<span id="cb365-26"><a href="#cb365-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-27"><a href="#cb365-27" aria-hidden="true" tabindex="-1"></a>boxplot_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(boxplot1, text1, boxplot2, text2, </span>
<span id="cb365-28"><a href="#cb365-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb365-29"><a href="#cb365-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb365-30"><a href="#cb365-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb365-31"><a href="#cb365-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb365-32"><a href="#cb365-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-33"><a href="#cb365-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boxplot_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-267-1.png" width="696" /></p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;boxplots.png&quot;</span>, </span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>          boxplot_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-4---violin-plot" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Figure 4 - Violin Plot</h2>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>violin1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Violin plot without smplot&#39;</span>) <span class="do">## ggplot2 default</span></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Violin~plot~using~bold(geom_violin())</span><span class="sc">\n</span><span class="st">~from~ggplot2&#39;</span>,</span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">8</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a>violin2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Violin plot with smplot&#39;</span>) <span class="co"># smplot default</span></span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-16"><a href="#cb367-16" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb367-17"><a href="#cb367-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb367-18"><a href="#cb367-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Violin~plot~using~bold(sm_violin())</span><span class="sc">\n</span><span class="st">from~smplot&#39;</span>,</span>
<span id="cb367-19"><a href="#cb367-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">12</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb367-20"><a href="#cb367-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Individual points,</span><span class="sc">\n</span><span class="st">larger font,</span><span class="sc">\n</span><span class="st">minimalistic theme</span><span class="sc">\n</span><span class="st">centered title</span><span class="sc">\n</span><span class="st">error bars&#39;</span>,</span>
<span id="cb367-21"><a href="#cb367-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">4</span>)</span>
<span id="cb367-22"><a href="#cb367-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-23"><a href="#cb367-23" aria-hidden="true" tabindex="-1"></a>violin_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(violin1, text1, violin2, text2, </span>
<span id="cb367-24"><a href="#cb367-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb367-25"><a href="#cb367-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb367-26"><a href="#cb367-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb367-27"><a href="#cb367-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb367-28"><a href="#cb367-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-29"><a href="#cb367-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(violin_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-268-1.png" width="696" /></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;violins.png&quot;</span>, </span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>          violin_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-5---slope-chart" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Figure 5 - Slope Chart</h2>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>),</span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A slope chart with 2 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> slope_n2</span>
<span id="cb369-16"><a href="#cb369-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-17"><a href="#cb369-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb369-18"><a href="#cb369-18" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb369-19"><a href="#cb369-19" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb369-20"><a href="#cb369-20" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb369-21"><a href="#cb369-21" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb369-22"><a href="#cb369-22" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb369-23"><a href="#cb369-23" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb369-24"><a href="#cb369-24" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb369-25"><a href="#cb369-25" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb369-26"><a href="#cb369-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-27"><a href="#cb369-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb369-28"><a href="#cb369-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb369-29"><a href="#cb369-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>),</span>
<span id="cb369-30"><a href="#cb369-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb369-31"><a href="#cb369-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb369-32"><a href="#cb369-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_slope() with 4 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb369-33"><a href="#cb369-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> slope_n4</span>
<span id="cb369-34"><a href="#cb369-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-35"><a href="#cb369-35" aria-hidden="true" tabindex="-1"></a>slopes <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(slope_n2, slope_n4, </span>
<span id="cb369-36"><a href="#cb369-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb369-37"><a href="#cb369-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb369-38"><a href="#cb369-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb369-39"><a href="#cb369-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb369-40"><a href="#cb369-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-41"><a href="#cb369-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(slopes)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-269-1.png" width="768" /></p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;slopes.png&quot;</span>, </span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>          slopes, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-6---raincloud-plot" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Figure 6 - Raincloud Plot</h2>
<p>Due to the recent update of smplot (Feb. 21st, 2022), paired lines are no longer shown in this figure.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>raincloud1 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df1, <span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">2.85</span>), </span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>),</span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A raincloud plot with 2 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb371-15"><a href="#cb371-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;sep_level = 0</span><span class="sc">\n</span><span class="st">which_side = &quot;right&quot;&#39;</span>,</span>
<span id="cb371-16"><a href="#cb371-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb371-17"><a href="#cb371-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">2.5</span>, </span>
<span id="cb371-18"><a href="#cb371-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;Separation is minimum amongst</span><span class="sc">\n</span><span class="st">points, violin plot and boxplot.</span><span class="sc">\n</span><span class="st">This can be adjusted with&#39;</span>) <span class="sc">+</span></span>
<span id="cb371-19"><a href="#cb371-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.6</span>, <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">  sep_level (0-4).&#39;</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb371-20"><a href="#cb371-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb371-21"><a href="#cb371-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;The violin plots face to the right.</span><span class="sc">\n</span><span class="st">This can be be changed with&#39;</span>) <span class="sc">+</span></span>
<span id="cb371-22"><a href="#cb371-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">1.1</span>, <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">   which_side (&quot;right&quot;, &quot;left&quot;, &quot;mixed&quot;).&#39;</span>, <span class="at">fontface =</span> <span class="dv">2</span>)</span>
<span id="cb371-23"><a href="#cb371-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb371-24"><a href="#cb371-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-25"><a href="#cb371-25" aria-hidden="true" tabindex="-1"></a>raincloud2 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df1, <span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb371-26"><a href="#cb371-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb371-27"><a href="#cb371-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">which_side =</span> <span class="st">&#39;mixed&#39;</span>) <span class="sc">+</span></span>
<span id="cb371-28"><a href="#cb371-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">2.85</span>), </span>
<span id="cb371-29"><a href="#cb371-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>),</span>
<span id="cb371-30"><a href="#cb371-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb371-31"><a href="#cb371-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb371-32"><a href="#cb371-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb371-33"><a href="#cb371-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_raincloud() with 2 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-34"><a href="#cb371-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-35"><a href="#cb371-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb371-36"><a href="#cb371-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-37"><a href="#cb371-37" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb371-38"><a href="#cb371-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb371-39"><a href="#cb371-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;sep_level = 2</span><span class="sc">\n</span><span class="st">which_side = &quot;mixed&quot;&#39;</span>,</span>
<span id="cb371-40"><a href="#cb371-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">4.7</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb371-41"><a href="#cb371-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">2.8</span>, </span>
<span id="cb371-42"><a href="#cb371-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;Default sep_level is set at 2</span><span class="sc">\n</span><span class="st"> but this can be changed (0-4).&#39;</span>) <span class="sc">+</span></span>
<span id="cb371-43"><a href="#cb371-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb371-44"><a href="#cb371-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;The violin plots face both to the</span><span class="sc">\n</span><span class="st">left (x=1) and right (x=2).&#39;</span>) <span class="sc">+</span></span>
<span id="cb371-45"><a href="#cb371-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">which_side = &quot;mixed&quot; only works when</span><span class="sc">\n</span><span class="st">there are 2 x discrete levels.&#39;</span>, <span class="at">fontface =</span> <span class="dv">2</span>)</span>
<span id="cb371-46"><a href="#cb371-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-47"><a href="#cb371-47" aria-hidden="true" tabindex="-1"></a>raincloud3 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df1, <span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb371-48"><a href="#cb371-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb371-49"><a href="#cb371-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">4</span>, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>) <span class="sc">+</span></span>
<span id="cb371-50"><a href="#cb371-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">2.85</span>), </span>
<span id="cb371-51"><a href="#cb371-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>),</span>
<span id="cb371-52"><a href="#cb371-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb371-53"><a href="#cb371-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb371-54"><a href="#cb371-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb371-55"><a href="#cb371-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A raincloud with no overlap&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-56"><a href="#cb371-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-57"><a href="#cb371-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb371-58"><a href="#cb371-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-59"><a href="#cb371-59" aria-hidden="true" tabindex="-1"></a>text3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb371-60"><a href="#cb371-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb371-61"><a href="#cb371-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;sep_level = 4</span><span class="sc">\n</span><span class="st">which_side = &quot;left&quot;&#39;</span>,</span>
<span id="cb371-62"><a href="#cb371-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb371-63"><a href="#cb371-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.5</span>,</span>
<span id="cb371-64"><a href="#cb371-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="st">&#39;The violin plots face to the left.&#39;</span>)</span>
<span id="cb371-65"><a href="#cb371-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-66"><a href="#cb371-66" aria-hidden="true" tabindex="-1"></a>raincloud_2x_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(raincloud1, text1, </span>
<span id="cb371-67"><a href="#cb371-67" aria-hidden="true" tabindex="-1"></a>                           raincloud2, text2, </span>
<span id="cb371-68"><a href="#cb371-68" aria-hidden="true" tabindex="-1"></a>                           raincloud3, text3,  </span>
<span id="cb371-69"><a href="#cb371-69" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb371-70"><a href="#cb371-70" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb371-71"><a href="#cb371-71" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb371-72"><a href="#cb371-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb371-73"><a href="#cb371-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-74"><a href="#cb371-74" aria-hidden="true" tabindex="-1"></a>raincloud4 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb371-75"><a href="#cb371-75" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb371-76"><a href="#cb371-76" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb371-77"><a href="#cb371-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), </span>
<span id="cb371-78"><a href="#cb371-78" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>),</span>
<span id="cb371-79"><a href="#cb371-79" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb371-80"><a href="#cb371-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb371-81"><a href="#cb371-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb371-82"><a href="#cb371-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Four discrete levels of x, sep_level = 2, which_side = &quot;right&quot;&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-83"><a href="#cb371-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-84"><a href="#cb371-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb371-85"><a href="#cb371-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-86"><a href="#cb371-86" aria-hidden="true" tabindex="-1"></a>raincloud_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(raincloud_2x_all, </span>
<span id="cb371-87"><a href="#cb371-87" aria-hidden="true" tabindex="-1"></a>                           raincloud4,  </span>
<span id="cb371-88"><a href="#cb371-88" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;D&quot;</span>),</span>
<span id="cb371-89"><a href="#cb371-89" aria-hidden="true" tabindex="-1"></a>                           <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb371-90"><a href="#cb371-90" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb371-91"><a href="#cb371-91" aria-hidden="true" tabindex="-1"></a>                           <span class="at">scale =</span> <span class="fl">0.95</span>,</span>
<span id="cb371-92"><a href="#cb371-92" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">7.5</span>,<span class="fl">2.5</span>))</span>
<span id="cb371-93"><a href="#cb371-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-94"><a href="#cb371-94" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(raincloud_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-270-1.png" width="696" /></p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;rainclouds.png&quot;</span>, </span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>          raincloud_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-7---case-study" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Figure 7 - Case Study</h2>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>) <span class="co"># generate random data</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>method1 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(method1,method2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>Method <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Method 1&#39;</span>, <span class="st">&#39;Method 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(method1))</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Method)</span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a><span class="co"># slope chart</span></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Value, </span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> Subject, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Method 1&#39;</span>, <span class="st">&#39;Method 2&#39;</span>),</span>
<span id="cb373-13"><a href="#cb373-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb373-14"><a href="#cb373-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb373-15"><a href="#cb373-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Slope chart&#39;</span>) <span class="sc">+</span> </span>
<span id="cb373-16"><a href="#cb373-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="sc">+</span></span>
<span id="cb373-17"><a href="#cb373-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Gene expression level&#39;</span>) <span class="sc">+</span> </span>
<span id="cb373-18"><a href="#cb373-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">label =</span> <span class="st">&#39;sm_slope()&#39;</span>) <span class="ot">-&gt;</span> slope</span>
<span id="cb373-19"><a href="#cb373-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-20"><a href="#cb373-20" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot</span></span>
<span id="cb373-21"><a href="#cb373-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-22"><a href="#cb373-22" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first =</span> method1, <span class="at">second =</span> method2)</span>
<span id="cb373-23"><a href="#cb373-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-24"><a href="#cb373-24" aria-hidden="true" tabindex="-1"></a>corr_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> first, <span class="at">y =</span> second)) <span class="sc">+</span> </span>
<span id="cb373-25"><a href="#cb373-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb373-26"><a href="#cb373-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb373-27"><a href="#cb373-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb373-28"><a href="#cb373-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb373-29"><a href="#cb373-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>,</span>
<span id="cb373-30"><a href="#cb373-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">label_y =</span> <span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb373-31"><a href="#cb373-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb373-32"><a href="#cb373-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Method 1&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Method 2&#39;</span>) <span class="sc">+</span></span>
<span id="cb373-33"><a href="#cb373-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">2.3</span>, <span class="at">label =</span> <span class="st">&#39;sm_corr_theme() + sm_statCorr()&#39;</span>)</span>
<span id="cb373-34"><a href="#cb373-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-35"><a href="#cb373-35" aria-hidden="true" tabindex="-1"></a><span class="co"># BA plot</span></span>
<span id="cb373-36"><a href="#cb373-36" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">sm_statBlandAlt</span>(df3<span class="sc">$</span>first,df3<span class="sc">$</span>second)</span>
<span id="cb373-37"><a href="#cb373-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-38"><a href="#cb373-38" aria-hidden="true" tabindex="-1"></a>ba_plot <span class="ot">&lt;-</span> <span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb373-39"><a href="#cb373-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb373-40"><a href="#cb373-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb373-41"><a href="#cb373-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb373-42"><a href="#cb373-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb373-43"><a href="#cb373-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb373-44"><a href="#cb373-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb373-45"><a href="#cb373-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb373-46"><a href="#cb373-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb373-47"><a href="#cb373-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb373-48"><a href="#cb373-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb373-49"><a href="#cb373-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Bland-Altman plot&#39;</span>) <span class="sc">+</span></span>
<span id="cb373-50"><a href="#cb373-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">label =</span> <span class="st">&#39;sm_statBlandAlt() + </span><span class="sc">\n</span><span class="st">sm_bland_altman()&#39;</span>)</span>
<span id="cb373-51"><a href="#cb373-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-52"><a href="#cb373-52" aria-hidden="true" tabindex="-1"></a>case_study <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(slope, corr_plot, ba_plot, </span>
<span id="cb373-53"><a href="#cb373-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb373-54"><a href="#cb373-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="co"># horizontal position of ABC labels</span></span>
<span id="cb373-55"><a href="#cb373-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb373-56"><a href="#cb373-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb373-57"><a href="#cb373-57" aria-hidden="true" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb373-58"><a href="#cb373-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-59"><a href="#cb373-59" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(case_study)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-271-1.png" width="1051.2" /></p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;case_study.png&quot;</span>, </span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>          case_study, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<!--chapter:end:09-manuscriptFig.Rmd-->
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
