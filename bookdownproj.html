<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Data Visualization in R Using smplot</title>
  <meta name="description" content="Data Visualization in R Using smplot" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Data Visualization in R Using smplot" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Visualization in R Using smplot" />
  
  
  

<meta name="author" content="Seung Hyun Min" />


<meta name="date" content="2022-01-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Data Visualization in R Using smplot</h1>
<p class="author"><em>Seung Hyun Min</em></p>
<p class="date" style="margin-top: 1.5em;"><em>2022-01-13</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#index">Welcome!</a>
<ul>
<li><a href="#please-cite-this-paper-when-smplot-is-used">Please cite this paper when smplot is used</a></li>
<li><a href="#for-r-and-ggplot2-experts">For R and ggplot2 experts</a></li>
<li><a href="#issues-and-contact">Issues and Contact</a></li>
<li><a href="#license">License</a></li>
</ul></li>
<li><a href="#download-rstudio-basics-of-r"><span class="toc-section-number">1</span> Download RStudio &amp; Basics of R</a>
<ul>
<li><a href="#setting-up-rstudio"><span class="toc-section-number">1.1</span> Setting up RStudio</a>
<ul>
<li><a href="#why-use-r-for-data-visualization">Why use R for data visualization?</a></li>
<li><a href="#other-available-resources-for-r">Other available resources for R</a></li>
<li><a href="#download-requirements-for-rstudio">Download requirements for RStudio</a></li>
<li><a href="#open-rstudio">Open RStudio</a></li>
<li><a href="#lets-make-a-folder-and-set-it-as-working-directory">Let’s make a folder and set it as working directory</a></li>
</ul></li>
<li><a href="#basics-of-r"><span class="toc-section-number">1.2</span> Basics of R</a>
<ul>
<li><a href="#lets-type-some-codes">Let’s type some codes</a></li>
<li><a href="#how-can-i-learn-most-effectively-with-the-notes">How can I learn most effectively with the notes?</a></li>
<li><a href="#more-installation">More installation</a></li>
</ul></li>
</ul></li>
<li><a href="#basics-of-ggplot2-and-correlation-plot"><span class="toc-section-number">2</span> Basics of ggplot2 and Correlation Plot</a>
<ul>
<li><a href="#upload-sample-data"><span class="toc-section-number">2.1</span> Upload sample data</a>
<ul>
<li><a href="#sample-data-mpg">Sample data: mpg</a></li>
</ul></li>
<li><a href="#basics-of-ggplot2"><span class="toc-section-number">2.2</span> Basics of ggplot2</a>
<ul>
<li><a href="#lets-make-some-graphs">Let’s make some graphs</a></li>
<li><a href="#how-ggplot-works">How ggplot works</a></li>
<li><a href="#different-color-of-points-for-each-unique-group">Different color of points for each unique group</a></li>
<li><a href="#different-color-shape-for-each-group">Different color &amp; shape for each group</a></li>
<li><a href="#same-shape-across-all-groups">Same shape across all groups</a></li>
<li><a href="#exercise-try-changing-the-shape-of-the-points-to-the-circle-with-the-border.">Exercise: try changing the shape of the points to the circle with the border.</a></li>
<li><a href="#how-do-we-draw-the-best-fit-line-of-the-graph">How do we draw the best-fit line of the graph?</a></li>
<li><a href="#geom_point-geom_smooth">geom_point() + geom_smooth()</a></li>
<li><a href="#writing-shorter-codes">Writing shorter codes</a></li>
</ul></li>
<li><a href="#improve-dataviz-using-smplot"><span class="toc-section-number">2.3</span> Improve dataviz using smplot</a>
<ul>
<li><a href="#positive-relationship-between-x--and-y-axes">Positive relationship between x- and y-axes</a></li>
<li><a href="#reporting-statistics-from-a-paired-correlation">Reporting statistics from a paired correlation</a></li>
<li><a href="#fill-0f993d-vs-fill-green"><code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></a></li>
<li><a href="#different-color-for-each-group-but-with-other-colors">Different color for each group but with other colors</a></li>
<li><a href="#lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1.">Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</a></li>
</ul></li>
<li><a href="#summary"><span class="toc-section-number">2.4</span> Summary</a></li>
</ul></li>
<li><a href="#boxplot-and-violin-plot"><span class="toc-section-number">3</span> Boxplot and Violin Plot</a>
<ul>
<li><a href="#upload-sample-data-csv-file-in-rstudio"><span class="toc-section-number">3.1</span> Upload sample data (csv file) in RStudio</a>
<ul>
<li><a href="#download-requirements">Download requirements</a></li>
<li><a href="#before-we-get-started">Before we get started</a></li>
<li><a href="#data.csv">data.csv</a></li>
<li><a href="#read_csvdata.csv"><code>read_csv('data.csv')</code></a></li>
<li><a href="#best-way-to-plot-data">Best way to plot data</a></li>
</ul></li>
<li><a href="#boxplot"><span class="toc-section-number">3.2</span> Boxplot</a>
<ul>
<li><a href="#what-is-a-boxplot">What is a boxplot?</a></li>
<li><a href="#boxplot-vs-bar-graph">Boxplot vs bar graph</a></li>
<li><a href="#boxplot-using-ggplot2">Boxplot using ggplot2</a></li>
<li><a href="#problem-alphabetical-order">Problem: Alphabetical order</a></li>
<li><a href="#displaying-characters-in-a-non-alphabetical-order">Displaying characters in a non-alphabetical order</a></li>
<li><a href="#double-check-if-the-day-column-is-factor">Double-check if the ‘Day’ column is factor</a></li>
<li><a href="#back-to-boxplot-using-ggplot2">Back to boxplot using ggplot2</a></li>
<li><a href="#a-boxplot-with-individual-data">A boxplot with individual data</a></li>
<li><a href="#geom_boxplot-vs-sm_boxplot"><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></a></li>
<li><a href="#save-boxplot">Save boxplot</a></li>
</ul></li>
<li><a href="#violin-plot"><span class="toc-section-number">3.3</span> Violin plot</a>
<ul>
<li><a href="#structure-of-the-violin-plot">Structure of the violin plot</a></li>
<li><a href="#violin-plot-with-ggplot2">Violin plot with ggplot2</a></li>
<li><a href="#violin-plot-with-individual-points">Violin plot with individual points</a></li>
<li><a href="#geom_violin-vs-sm_violin">geom_violin() vs sm_violin()</a></li>
<li><a href="#save-your-violin-plot">Save your violin plot</a></li>
</ul></li>
<li><a href="#summary-1"><span class="toc-section-number">3.4</span> Summary</a></li>
</ul></li>
<li><a href="#full-guide-on-smplot"><span class="toc-section-number">4</span> Full Guide on smplot</a>
<ul>
<li><a href="#installation-of-the-package"><span class="toc-section-number">4.1</span> Installation of the package</a>
<ul>
<li><a href="#what-is-smplot">What is <code>smplot</code>?</a></li>
</ul></li>
<li><a href="#smplots-color-palette-and-graph-themes"><span class="toc-section-number">4.2</span> smplot’s color palette and graph themes</a>
<ul>
<li><a href="#smplots-color-palette">smplot’s color palette</a></li>
<li><a href="#smplots-graph-themes">smplot’s graph themes</a></li>
</ul></li>
<li><a href="#correlation-plot"><span class="toc-section-number">4.3</span> Correlation plot</a>
<ul>
<li><a href="#data-frame-for-a-correlation-plot"><span class="toc-section-number">4.3.1</span> Data frame for a correlation plot</a></li>
</ul></li>
<li><a href="#boxplot---sm_boxplot"><span class="toc-section-number">4.4</span> Boxplot - <code>sm_boxplot()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors"><span class="toc-section-number">4.4.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#violin-plot---sm_violin"><span class="toc-section-number">4.5</span> Violin plot - <code>sm_violin()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors-1"><span class="toc-section-number">4.5.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#bar-plot---sm_bar"><span class="toc-section-number">4.6</span> Bar plot - <code>sm_bar()</code></a>
<ul>
<li><a href="#plotting-individual-points-with-unique-colors-2"><span class="toc-section-number">4.6.1</span> Plotting individual points with unique colors</a></li>
</ul></li>
<li><a href="#slope-chart---sm_slope"><span class="toc-section-number">4.7</span> Slope chart - <code>sm_slope()</code></a></li>
<li><a href="#a-bland-altman-plot---sm_bland_altman"><span class="toc-section-number">4.8</span> A Bland Altman plot - <code>sm_bland_altman()</code></a></li>
<li><a href="#raincloud-plot---sm_raincloud"><span class="toc-section-number">4.9</span> Raincloud plot - <code>sm_raincloud()</code></a></li>
<li><a href="#overriding-defaults-of-smplots-themes"><span class="toc-section-number">4.10</span> Overriding defaults of smplot’s themes</a></li>
<li><a href="#overriding-defaults-of-smplot-colors"><span class="toc-section-number">4.11</span> Overriding defaults of smplot colors</a></li>
</ul></li>
<li><a href="#data-analysis-in-development"><span class="toc-section-number">5</span> Data Analysis (in development)</a>
<ul>
<li><a href="#figure-1---correlation-plot"><span class="toc-section-number">5.1</span> Figure 1 - Correlation plot</a></li>
<li><a href="#figure-2---bar-plot"><span class="toc-section-number">5.2</span> Figure 2 - Bar plot</a></li>
<li><a href="#figure-3---boxplot"><span class="toc-section-number">5.3</span> Figure 3 - Boxplot</a></li>
<li><a href="#figure-4---violin-plot"><span class="toc-section-number">5.4</span> Figure 4 - Violin plot</a></li>
<li><a href="#figure-5---slope-chart"><span class="toc-section-number">5.5</span> Figure 5 - Slope chart</a></li>
<li><a href="#figure-6---raincloud-plot"><span class="toc-section-number">5.6</span> Figure 6 - Raincloud plot</a></li>
<li><a href="#figure-7---case-study"><span class="toc-section-number">5.7</span> Figure 7 - Case study</a></li>
<li><a href="#recreating-the-cover-figure"><span class="toc-section-number">5.8</span> Recreating the Cover Figure</a></li>
<li><a href="#boxplot-and-violin-plot-1"><span class="toc-section-number">5.9</span> Boxplot and violin plot</a>
<ul>
<li><a href="#upload-pre-existing-data">Upload pre-existing data</a></li>
</ul></li>
<li><a href="#bar-plot-and-slope-chart"><span class="toc-section-number">5.10</span> Bar plot and slope chart</a></li>
<li><a href="#raincloud-plot"><span class="toc-section-number">5.11</span> Raincloud plot</a></li>
<li><a href="#put-all-figures-together"><span class="toc-section-number">5.12</span> Put all figures together</a>
<ul>
<li><a href="#the-codes-only-with-no-discussion">The codes only with no discussion</a></li>
</ul></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Visualization in R Using smplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="index" class="section level1 unnumbered">
<h1 class="unnumbered">Welcome!</h1>
<p><img src="img/sample.png" width="750" alt="Cover image" align="right" style="margin: 0 1em 0 1em"/></p>
<p>This book guides the reader to be familiar with R, a programming language, for data visualization. It also introduces the R package <strong>smplot</strong>, which aims to make the process of data visualization simple. This book was created entirely using RMarkdown for reproducibility.</p>
<p><strong>Note:</strong> If you are interested in recreating this figure, please read Chapter 5.</p>
<div id="please-cite-this-paper-when-smplot-is-used" class="section level2 unnumbered">
<h2 class="unnumbered">Please cite this paper when smplot is used</h2>
<p><strong>Seung Hyun Min, Jiawei Zhou. smplot: An R Package for Easy and Elegant Data Visualization (2021). Frontiers in Genetics, 12:802894.</strong></p>
</div>
<div id="for-r-and-ggplot2-experts" class="section level2 unnumbered">
<h2 class="unnumbered">For R and ggplot2 experts</h2>
<p>Please skip Chapters 1-3.</p>
</div>
<div id="issues-and-contact" class="section level2 unnumbered">
<h2 class="unnumbered">Issues and Contact</h2>
<p>If you spot any mistakes in this online book, please pull-request on <a href="https://github.com/smin95/dataviz">Github</a> or email me <a href="mailto:seung.min@mail.mcgill.ca" class="email">seung.min@mail.mcgill.ca</a>. If you find issues with the ‘smplot’ package, please pull-request on <a href="https://github.com/smin95/smplot">Github</a>.</p>
</div>
<div id="license" class="section level2 unnumbered">
<h2 class="unnumbered">License</h2>
<p>smplot is under the MIT license. This tutorial is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="download-rstudio-basics-of-r" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Download RStudio &amp; Basics of R</h1>
<div id="setting-up-rstudio" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Setting up RStudio</h2>
<div id="why-use-r-for-data-visualization" class="section level3 unnumbered">
<h3 class="unnumbered">Why use R for data visualization?</h3>
<ul>
<li>R is free.</li>
<li>Often, less codes are needed in R to plot an elegant graph.</li>
<li>for/while loops (basic concepts in programming) are not necessary in R to make a production-quality graph.</li>
<li>R is the best software for statistical analysis.</li>
</ul>
</div>
<div id="other-available-resources-for-r" class="section level3 unnumbered">
<h3 class="unnumbered">Other available resources for R</h3>
<ul>
<li>Stack Overflow: <a href="https://www.stackoverflow.com" class="uri">https://www.stackoverflow.com</a></li>
<li>R for Data Science (a bible for learning R): <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></li>
<li>R documentation: <a href="https://www.rdocumentation.org" class="uri">https://www.rdocumentation.org</a></li>
<li>Learn Statistics with R: <a href="https://learningstatisticswithr.com/" class="uri">https://learningstatisticswithr.com/</a></li>
<li>ggplot2 (a reference for plotting data in R): <a href="https://ggplot2-book.org/" class="uri">https://ggplot2-book.org/</a></li>
</ul>
</div>
<div id="download-requirements-for-rstudio" class="section level3 unnumbered">
<h3 class="unnumbered">Download requirements for RStudio</h3>
<ul>
<li>Download R: <a href="http://cran.r-project.org/" class="uri">http://cran.r-project.org/</a></li>
<li>For Mac users: Mac: XQuartz <a href="https://www.xquartz.org/" class="uri">https://www.xquartz.org/</a></li>
<li>RStudio: <a href="http://www.rstudio.org/" class="uri">http://www.rstudio.org/</a></li>
</ul>
</div>
<div id="open-rstudio" class="section level3 unnumbered">
<h3 class="unnumbered">Open RStudio</h3>
<div class="figure" style="text-align: center">
<img src="img/rstudio.png" alt="Rstudio layout, image from http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" width="65%" />
<p class="caption">
(#fig:pressure)Rstudio layout, image from <a href="http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" class="uri">http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming</a>
</p>
</div>
<ul>
<li><strong>Rstudio</strong> is where people do R programming.</li>
<li>You can type codes (<strong>commands</strong>) into the <strong>console</strong> (bottom-left panel).
<ul>
<li><code>&gt;</code> means that the console is ready to receive more code.</li>
<li><code>+</code> means your code is not complete.</li>
</ul></li>
<li>You can also write (longer) codes in the <strong>script</strong> within the code editor (top-left panel).
<ul>
<li>The code editor will run the script into the console.</li>
<li>A <strong>new script</strong> can be opened by clicking: <strong>File -&gt; New -&gt; R Script</strong>.</li>
</ul></li>
<li>You can run a script by clicking <strong>’Run"</strong> with the green arrow or by typing <strong>ctrl + enter</strong>. It is labeled with the red circle.
<ul>
<li>Or you can just type your codes directly into the console.</li>
</ul></li>
</ul>
</div>
<div id="lets-make-a-folder-and-set-it-as-working-directory" class="section level3 unnumbered">
<h3 class="unnumbered">Let’s make a folder and set it as working directory</h3>
<div class="figure" style="text-align: center">
<img src="img/setwd.png" alt="Setting your working directory, image from https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html" width="80%" />
<p class="caption">
(#fig:unnamed-chunk-2)Setting your working directory, image from <a href="https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html" class="uri">https://www.ucl.ac.uk/~uctqiax/PUBLG100/2015/faq/setwd.html</a>
</p>
</div>
<ul>
<li>Create a folder named <strong>LearnR</strong> in Desktop.</li>
<li>Set the folder as your working directory by clicking: <strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>. Then find your <strong>LearnR</strong> folder.</li>
<li>More information about setting up a directory is here:
<a href="http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming" class="uri">http://www.sthda.com/english/wiki/running-rstudio-and-setting-up-your-working-directory-easy-r-programming</a></li>
<li>You will need set the directory <strong>every time</strong> you start RStudio.</li>
</ul>
</div>
</div>
<div id="basics-of-r" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Basics of R</h2>
<div id="lets-type-some-codes" class="section level3 unnumbered">
<h3 class="unnumbered">Let’s type some codes</h3>
<ul>
<li>Capitalization, punctuations and brackets are all important.</li>
<li><code>' '</code> and <code>" "</code> mean the same.</li>
<li>However, <code>' "</code> are not paired. So they will not work.</li>
<li><code>=</code> and <code>&lt;-</code> mean equivalent.
<ul>
<li>I often use <code>&lt;-</code>.</li>
</ul></li>
<li>Type <code>?</code> when you are not sure about the code (ex. <code>?t.test</code>)</li>
<li>A code becomes comment when it is preceded by <code>#</code>.
<ul>
<li>Try typing <code># g = 3</code> and see if the number gets stored in g by typing <strong>g</strong> in the console.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">3</span> <span class="co"># x equals to 3</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># a equals to 4 </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="st">&#39;Group&#39;</span> <span class="co"># gr is equal to a character &#39;Group&#39;, which is not a number.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="st">&quot;Group&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>d <span class="sc">==</span> e <span class="co"># &#39;Group&#39; and &quot;Group&quot; are equal</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># g = 3 # its a comment</span></span></code></pre></div>
<ul>
<li>Notice that I used <code>==</code> to test if <strong>d</strong> and <strong>e</strong> are equal. Therefore, <code>==</code> and <code>=</code> mean different. <code>==</code> <strong>tests</strong> if two things are equal. <code>=</code> <strong>sets</strong> two things to be equal.
<ul>
<li><code>d == e</code> returns <code>TRUE</code> because they are both <code>'Group'</code>. <code>TRUE</code> is equivalent to 1 numerically.</li>
</ul></li>
<li>Now let’s check if <strong>x</strong> and <strong>a</strong> are equal.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> a</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<ul>
<li><p>It returns <code>FALSE</code> because <strong>x</strong> and <strong>a</strong> are not equal. This is correct because 3 and 4 are not equal. <code>FALSE</code> equals to 0 numerically.</p></li>
<li><p>Below are more examples showing that <code>TRUE</code> = 1 and <code>FALSE</code> = 0.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="cn">FALSE</span> <span class="co"># 1 + 0</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="cn">TRUE</span> <span class="co"># 1 + 1</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">+</span> <span class="cn">FALSE</span> <span class="co"># 0 + 0</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span><span class="sc">*</span><span class="dv">2</span> <span class="co"># 1 * 2</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span><span class="sc">*</span><span class="cn">FALSE</span> <span class="co"># 1 * 0</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="how-can-i-learn-most-effectively-with-the-notes" class="section level3 unnumbered">
<h3 class="unnumbered">How can I learn most effectively with the notes?</h3>
<ul>
<li>Don’t just read it.</li>
<li>Don’t just copy and paste the codes and run them in RStudio (ctrl + c &amp; ctrl + p). <strong>Make sure you type each code.</strong></li>
<li>You can also change your code and see if it still works.</li>
<li>If you are not sure of your code, you can type <code>?</code> before the function.</li>
<li>If you are still not sure after reading the notes, check out Chapter 3 of <strong>R for Data Science</strong>: <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></li>
</ul>
</div>
<div id="more-installation" class="section level3 unnumbered">
<h3 class="unnumbered">More installation</h3>
<ul>
<li>R is an old programming language.</li>
<li>So, people, such as statisticians and programmers, have created more functions in R in the form of the package to update the language. They are free but they have to be downloaded separately.
<ul>
<li>A <strong>package</strong> can contain several <strong>functions</strong>.</li>
<li>In this tutorial, you will mainly be using <strong>ggplot2</strong> package, which is elegant and flexible for visualizing data.</li>
<li>Also, you will be using <strong>smplot</strong> package. It improves ggplot2 graphs visually.</li>
</ul></li>
<li>So, you will need to install some packages, such as ggplot2 and smplot. Please type the codes below.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;tidyverse&#39;</span>) <span class="co"># tidyverse was created by Hadley Wickham at RStudio, tidyverse includes ggplot2</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot&#39;</span>) </span></code></pre></div>
<ul>
<li>You only need to install them once, but you will need to reload them whenever you start a new session in RStudio using the function <code>library()</code>.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<ul>
<li>Now let’s make some graphs in the subsequent chapters.</li>
</ul>
<!--chapter:end:01-basics.Rmd-->
</div>
</div>
</div>
<div id="basics-of-ggplot2-and-correlation-plot" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Basics of ggplot2 and Correlation Plot</h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="upload-sample-data" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Upload sample data</h2>
<div id="sample-data-mpg" class="section level3 unnumbered">
<h3 class="unnumbered">Sample data: mpg</h3>
<ul>
<li>I will be using an example from the book <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/data-visualisation.html" class="uri">https://r4ds.had.co.nz/data-visualisation.html</a>).</li>
<li><strong>Question: Do cars with large engines use up more fuel than the those with small ones?</strong></li>
<li>Let’s open <strong>mpg</strong>, which is a <strong>data frame</strong> stored in the <strong>ggplot2</strong> package.</li>
<li><strong>mpg</strong> contains data about cars in the US. You can type <code>?mpg</code> for more information.
<ul>
<li><strong>displ</strong>: the size of the car’s engine in liters</li>
<li><strong>hwy</strong>: fuel efficiency. If it’s high, then the car uses less fuel per distance.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mpg</span></code></pre></div>
<pre><code>## # A tibble: 234 x 11
##    manufacturer model    displ  year   cyl trans   drv     cty   hwy fl   
##    &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
##  1 audi         a4         1.8  1999     4 auto(l~ f        18    29 p    
##  2 audi         a4         1.8  1999     4 manual~ f        21    29 p    
##  3 audi         a4         2    2008     4 manual~ f        20    31 p    
##  4 audi         a4         2    2008     4 auto(a~ f        21    30 p    
##  5 audi         a4         2.8  1999     6 auto(l~ f        16    26 p    
##  6 audi         a4         2.8  1999     6 manual~ f        18    26 p    
##  7 audi         a4         3.1  2008     6 auto(a~ f        18    27 p    
##  8 audi         a4 quat~   1.8  1999     4 manual~ 4        18    26 p    
##  9 audi         a4 quat~   1.8  1999     4 auto(l~ 4        16    25 p    
## 10 audi         a4 quat~   2    2008     4 manual~ 4        20    28 p    
## # ... with 224 more rows, and 1 more variable: class &lt;chr&gt;</code></pre>
<ul>
<li>Notice that some columns and rows are not shown. You can type <code>View(mpg)</code> to see the entire <strong>data frame</strong>.</li>
<li>Each row is an unique observation.</li>
<li>Each column is an unique variable/condition.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mpg)</span></code></pre></div>
</div>
</div>
<div id="basics-of-ggplot2" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Basics of ggplot2</h2>
<div id="lets-make-some-graphs" class="section level3 unnumbered">
<h3 class="unnumbered">Let’s make some graphs</h3>
<ul>
<li>Question: Do cars with large engines use up more fuel than the those with small ones?</li>
<li>To answer our question, we need to plot <strong>mpg</strong> data. The x-axis should be <strong>displ</strong>, the y-axis should be <strong>hwy</strong>.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-11-1.png" width="355.2" /></p>
<ul>
<li>We find that a smaller car has a higher efficiency and that a larger car has a lower efficiency. In other words, we see a negative relationship.</li>
</ul>
</div>
<div id="how-ggplot-works" class="section level3 unnumbered">
<h3 class="unnumbered">How ggplot works</h3>
<ul>
<li>When you are making a graph with <strong>ggplot2</strong>, always begin by typing the function <code>ggplot()</code>.
<ul>
<li>The <strong>data</strong> you want to plot is the <strong>first argument</strong> here. Ex. <code>ggplot(data = mpg)</code>.</li>
</ul></li>
<li>However, <code>ggplot(data = mpg)</code> alone does not create a graph. You will need <strong>add</strong> (by typing <strong>+</strong>) more layers, such as <code>geom_point()</code>.
<ul>
<li><code>geom_point()</code> adds points to your graphs. You will need to specify (or map) x- and y-axes in the <code>aes()</code> function, which means aesthetics. This process is called <strong>mapping</strong>.</li>
<li>As you might expect, there are other <strong>geom</strong> functions, such as <code>geom_bar()</code>, <code>geom_boxplot()</code>, <code>geom_errorbar()</code>. They plot bar graphs, boxplots and error bars, respectively.</li>
</ul></li>
<li>Here is the <strong>template</strong> for using <strong>ggplot2</strong> (copied from <em>R for Data Science</em>).</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="er">&lt;</span>GEOM_FUNCTION<span class="sc">&gt;</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="sc">&lt;</span>MAPPINGS<span class="sc">&gt;</span>))</span></code></pre></div>
</div>
<div id="different-color-of-points-for-each-unique-group" class="section level3 unnumbered">
<h3 class="unnumbered">Different color of points for each unique group</h3>
<ul>
<li>You can apply different colors by the <strong>class</strong> of each car (each car = each row of the <strong>mpg</strong> data frame).
<ul>
<li>Include <code>class</code> variable in the <code>aes()</code> function.</li>
<li>This maps the third variable <code>class</code> into your graph.</li>
<li><code>aes()</code> means aesthetic (ex. color, shape, etc).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-13-1.png" width="508.8" /></p>
<ul>
<li>You can also set different shapes for each group of the data.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-14-1.png" width="508.8" /></p>
<ul>
<li>Or size or transparency (not recommended). But you get the idea. Using <code>aes()</code> in a geom function (ex. <code>geom_point()</code>), you can label different group of points.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different levels of transparency (alpha) for each group</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-15-1.png" width="508.8" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different sizes of the points for each group</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-16-1.png" width="508.8" /></p>
</div>
<div id="different-color-shape-for-each-group" class="section level3 unnumbered">
<h3 class="unnumbered">Different color &amp; shape for each group</h3>
<ul>
<li>You can also apply different color &amp; shape for each group of the data.
<ul>
<li><strong>Exercise</strong>: Try it on your own before you look at the code below.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-17-1.png" width="508.8" /></p>
</div>
<div id="same-shape-across-all-groups" class="section level3 unnumbered">
<h3 class="unnumbered">Same shape across all groups</h3>
<ul>
<li>So far, you have put variables such as <code>shape</code> and <code>color</code> inside the function <code>aes()</code>.
<ul>
<li>This has enabled you to apply different shape and color for each group.</li>
</ul></li>
<li>If you put the variable for <code>shape</code>, <code>color</code>, <code>size</code> outside of <code>aes()</code> in the geom function, then all data points will have the specified <code>shape</code>, <code>color</code>, etc even if they are in different groups.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">17</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-18-1.png" width="508.8" /></p>
<ul>
<li>Notice that the <code>color</code> is different for each group because it is inside the function <code>aes()</code>. However, all the points are triangle because we have typed <code>shape = 17</code> outside the function <code>aes()</code>.</li>
<li><strong>Exercise:</strong> try changing the shape of the points to the circle with the border.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/shape.JPG" alt="image from http://www.sthda.com/english/wiki/ggplot2-point-shapes" width="25%" />
<p class="caption">
(#fig:unnamed-chunk-19)image from <a href="http://www.sthda.com/english/wiki/ggplot2-point-shapes" class="uri">http://www.sthda.com/english/wiki/ggplot2-point-shapes</a>
</p>
</div>
</div>
<div id="exercise-try-changing-the-shape-of-the-points-to-the-circle-with-the-border." class="section level3 unnumbered">
<h3 class="unnumbered">Exercise: try changing the shape of the points to the circle with the border.</h3>
<ul>
<li>When <code>shape = 19</code>, the shape is the circle without the border.</li>
<li>When <code>shape = 20</code>, the shape is the small circle without the border.</li>
<li>When <code>shape = 21</code>, the shape is the circle with the border.</li>
<li>So let’s set <code>shape</code> to 21.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-20-1.png" width="508.8" /></p>
<ul>
<li>Notice that the border color is different for each group, but not the color that fills the circle.</li>
<li>Shapes without their borders (15-20) are filled with <code>color</code>.</li>
<li>Shapes with the border (21-24) are filled with <code>fill</code> and its border colored with <code>color</code>.</li>
<li>So let’s change <code>color = Class</code> to <code>fill = Class</code>.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">fill =</span> class), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-21-1.png" width="508.8" /></p>
</div>
<div id="how-do-we-draw-the-best-fit-line-of-the-graph" class="section level3 unnumbered">
<h3 class="unnumbered">How do we draw the best-fit line of the graph?</h3>
<ul>
<li>Here is our graph.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-22-1.png" width="355.2" /></p>
<ul>
<li>There seems to be a negative relationship.</li>
<li>How do we draw the best-fit line of the graph’s negative relationship?</li>
<li>Use another geom function <code>geom_smooth()</code>.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-23-1.png" width="355.2" /></p>
</div>
<div id="geom_point-geom_smooth" class="section level3 unnumbered">
<h3 class="unnumbered">geom_point() + geom_smooth()</h3>
<ul>
<li>Now let’s combine geom_point() + geom_smooth() into one graph.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-25-1.png" width="355.2" /></p>
<ul>
<li><code>ggplot()</code> acts as a system where you can add multiple <code>geom</code> objects, such as <code>geom_point()</code> and <code>geom_smooth()</code>.</li>
<li>You can add multiple layers of geom in a single plot, like shown here.</li>
<li><code>ggplot()</code> and <strong>at least one geom</strong> function are necessary to draw a graph.</li>
<li><code>ggplot()</code> alone does not draw a graph. Try it on your own.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" width="355.2" /></p>
</div>
<div id="writing-shorter-codes" class="section level3 unnumbered">
<h3 class="unnumbered">Writing shorter codes</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<ul>
<li>Notice that we have typed <code>mapping = aes(x = displ, y = hwy)</code> twice. This is <strong>repetitive</strong>.</li>
<li>If you type the <code>mapping</code> argument in <code>ggplot()</code>, you won’t need to type them anymore in the subsequent <code>geom</code> functions.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-28-1.png" width="355.2" /></p>
<ul>
<li><p>This is exactly the same as the previous graph. In both cases, the mapping has been set so that the x-axis is <code>displ</code> and the y-axis is <code>hwy</code> in both <code>geom_point()</code> and <code>geom_smooth()</code>.</p></li>
<li><p>Now let’s apply different color of points and the fit the line for each group.</p></li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-29-1.png" width="508.8" /></p>
<ul>
<li>Okay, this is extremely messy and probably a bad idea.
<ul>
<li>You might have gotten <code>warnings</code> but you can usually ignore them.</li>
</ul></li>
<li>Let’s plot the best-fit line across all groups (i.e., one best-fit line) but apply different color for each class (i.e., many colors).</li>
<li>To do so, type <code>color = class</code> in geom_point, not <code>ggplot()</code>. This enables you to specify that you will apply different color for each class <strong>only</strong> in <code>geom_point()</code> but not in <code>geom_smooth()</code>.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-30-1.png" width="508.8" /></p>
</div>
</div>
<div id="improve-dataviz-using-smplot" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Improve dataviz using smplot</h2>
<ul>
<li>Although the default theme of ggplot2 graphs is clean, there are some things that I do not like:
<ul>
<li>The fonts are too small.</li>
<li>The grey background is distracting.</li>
<li>There are too many grids.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-31-1.png" width="499.2" /></p>
<ul>
<li>Let’s make this graph prettier by using functions from <strong>smplot</strong>.
<ul>
<li>In this example, let’s use <code>sm_corr_theme()</code>. I’ve made this function as a theme suitable for correlation plots.</li>
<li>Disclaimer: <strong>smplot</strong> package has been built based on my preference.</li>
<li><strong>smplot</strong> is not necessary to make a <strong>ggplot</strong> graph or change its style. It is possible to change every aspect of the graph with <strong>ggplot2</strong> but this requires about 8-20 lines of codes (based on my experience). Instead, <strong>smplot</strong> function does so in one line of code.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-32-1.png" width="499.2" /></p>
<ul>
<li>Now let’s remove the border within <code>sm_corr_theme()</code> by setting <code>borders = FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-33-1.png" width="499.2" /></p>
<ul>
<li><strong>Exercise:</strong> You can also set <code>borders = TRUE</code> and see what happens.</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ul>
<li><p>You might notice that borders come back. This is exactly what happens when you do not include <code>borders</code> argument in <code>sm_corr_theme()</code>. This is because <code>sm_corr_theme()</code> is set to <code>borders = TRUE</code> as default.</p></li>
<li><p>I think the one with the border looks better.</p></li>
<li><p>You can also remove the legend by setting <code>legends = FALSE</code> in <code>sm_corr_theme()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-35-1.png" width="355.2" /></p>
<ul>
<li><strong>Exercise</strong> Set <code>legends = TRUE</code> and see what happens. Type <code>?sm_corr_theme</code> to see why legends appear without directly writing <code>legends = TRUE</code>.</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">legends =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ul>
<li>However, in this case, I think we need a legend because there are many <strong>classes</strong>.</li>
</ul>
<div id="positive-relationship-between-x--and-y-axes" class="section level3 unnumbered">
<h3 class="unnumbered">Positive relationship between x- and y-axes</h3>
<ul>
<li>Let’s plot another scatterplot using <strong>mtcars</strong> data.</li>
<li>Set the x-axis with <strong>drat</strong> and y-axis with <strong>mpg</strong>.</li>
<li>Since you are making a scatterplot, you will need to use <code>geom_point()</code>.</li>
<li>Set the <strong>size</strong> of all points to <strong>3</strong> by typing <code>size = 3</code>.</li>
<li>Set the <strong>shape</strong> of all points to the circle with a border by typing <code>shape = 21</code>.</li>
<li>Set the <strong>filled color</strong> of all points to <strong>green</strong> by typing <code>fill = '#0f993d'</code>.</li>
<li>Set the <strong>border color</strong> to <strong>white</strong> by typing <code>color = 'white'</code>.
<ul>
<li>Since <code>shape = 21</code> refers to the circle with a border, <code>fill</code> is the color that fills the points and <code>color</code> is the border color.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-37-1.png" width="355.2" /></p>
<ul>
<li><p><strong>drat</strong> and <strong>mpg</strong> have a positive relationship.</p></li>
<li><p>Now let’s make it pretty by adding <code>sm_corr_theme()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-38-1.png" width="355.2" /></p>
<ul>
<li>You can remove borders too by setting <code>borders = FALSE</code> in <code>sm_corr_theme()</code>.</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-39-1.png" width="355.2" /></p>
</div>
<div id="reporting-statistics-from-a-paired-correlation" class="section level3 unnumbered">
<h3 class="unnumbered">Reporting statistics from a paired correlation</h3>
<ul>
<li><strong>smplot</strong> also offers a function that plots the best-fit line of a scatterplot (i.e., correlation plot) and prints statistical values, such as p- and R-values.
<ul>
<li>p-value is used to check for statistical significance. If it’s less than 0.05, its regarded as <strong>statistically significant</strong>. However, it gets smaller with a larger sample size.</li>
<li>R-value (correlation coefficient) measures the strength and the direction of the correlation. It ranges from -1 to 1. It does not depend on the sample size.</li>
</ul></li>
<li>Let’s add a function <code>sm_statCorr()</code>. The statistical results are from Pearson’s correlation test.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-40-1.png" width="355.2" /></p>
<ul>
<li>I don’t really like how the line color is different from that of the points. Let’s change the color to green.</li>
<li>Also let’s get results from Spearman’s correlation test rather than from Pearson’s.
<ul>
<li>To do so, type <code>corr_method = 'spearman'</code> in the function <code>sm_statCorr()</code>. You will get a different <strong>R</strong> value from 0.68, which is from Pearson’s correlation test.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-41-1.png" width="355.2" /></p>
<ul>
<li><strong>Exercise</strong>: Set <code>corr_method = 'pearson'</code>and see what happens.</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;#0f993d&#39;</span>, <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>)</span></code></pre></div>
<ul>
<li><p>You will see that this is exactly the same as when <code>corr_method</code> argument is not included in <code>sm_statCorr()</code>. In short, the <strong>default</strong> correlation method for <code>sm_statCorr()</code> is <code>'pearson'</code>. So, if you don’t write anything for <code>corr_method</code>, it will give results from Pearson’s correlation test. Type <code>?sm_statCorr</code> to see the default of <code>line_type</code>.</p></li>
<li><p><code>#0f993d</code> is a specific green that I like.</p></li>
<li><p>Now, let’s change the color. Replace <code>'#0f993d'</code> with <code>'green'</code> in <code>geom_point()</code> and <code>sm_statCorr</code>.</p>
<ul>
<li>This <code>'green'</code> is the default green color of <strong>R</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&#39;green&#39;</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-43-1.png" width="355.2" /></p>
<ul>
<li>Which one do you prefer?</li>
</ul>
</div>
<div id="fill-0f993d-vs-fill-green" class="section level3 unnumbered">
<h3 class="unnumbered"><code>fill = '#0f993d'</code> vs <code>fill = 'green'</code></h3>
<ul>
<li>I personally like <code>#0f993d</code> more. However, <strong>R</strong> does not recognize this color as <code>green</code>.</li>
<li>So how are you supposed to remember the color code?</li>
<li>You do not have to. You can type <code>sm_color('green')</code> instead. This is a function from the <strong>smplot</strong> package.</li>
<li><code>sm_color()</code> accepts the name of the color. If you want to get the hex codes (color codes) for red and green, type <code>sm_color('red','green')</code>.</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<ul>
<li>Again, <code>sm_color()</code> has been built based on my preference. So it returns the hex codes of colors that I use most often.</li>
<li>There are many more color themes that are available in R. For more information, please check out Chapter 28 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/graphics-for-communication.html" class="uri">https://r4ds.had.co.nz/graphics-for-communication.html</a>).</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-45-1.png" width="355.2" /></p>
<ul>
<li><strong>Exercise</strong> Change the color of the points and the best-fit line to <code>blue</code> using <code>sm_color()</code>. If you want to see all the color options for <code>sm_color()</code>, type <code>?sm_color</code>. There are 16 colors total.</li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
</div>
<div id="different-color-for-each-group-but-with-other-colors" class="section level3 unnumbered">
<h3 class="unnumbered">Different color for each group but with other colors</h3>
<ul>
<li>Let’s go back to the <strong>mpg</strong> data. Set the x-axis with <strong>displ</strong> and y-axis with <strong>hwy</strong>. Then make a scatterplot using <code>geom_point()</code>.
<ul>
<li>Set the size of the points to 2 across all groups. So type <code>size = 2</code> outside of <code>aes()</code> in <code>geom_point()</code>.</li>
</ul></li>
<li>Let’s apply different color for each <code>class</code> of the cars by writing <code>color = class</code> in <code>aes()</code> from <code>ggplot()</code>.
<ul>
<li><code>fill = class</code> is needed when the shape of the point is set to 21-25.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-47-1.png" width="499.2" /></p>
<ul>
<li>To use other colors, we could use a function from <strong>ggplot2</strong> called <code>scale_color_manual()</code>.
<ul>
<li><code>scale_fill_manual()</code> is used when the shape of the point has borders (shape = 21-25).</li>
</ul></li>
<li>To find how many colors we need total, we need to find how many groups exist.</li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>unique_classes <span class="ot">&lt;-</span> <span class="fu">unique</span>(mpg<span class="sc">$</span>class)</span></code></pre></div>
<ul>
<li>In R, you can extract data from one column by using <code>$</code>. You can try it with different variables too.</li>
<li><code>unique()</code> returns unique values in the selected data.</li>
<li>Then compute the number of unique values using <code>length()</code> function.</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>number_of_classes <span class="ot">&lt;-</span> <span class="fu">length</span>(unique_classes)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>number_of_classes</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<ul>
<li><code>sm_palette</code> accepts the number of colors as input. It returns colors that I use most often.</li>
<li>Now that we know we need 7 colors total, we can type <code>sm_palette(7)</code> or <code>sm_palette(number_of_classes)</code> for <code>values</code> in <code>scale_color_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-50-1.png" width="499.2" /></p>
<ul>
<li>Let’s store this graph using a <strong>variable</strong> called <code>figure1</code>.</li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(number_of_classes)) <span class="sc">+</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>()</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="co"># make your graph disappear</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>figure1 <span class="co"># it will appear again by calling this variable </span></span></code></pre></div>
<ul>
<li>Now you will able to call forth the graph just by calling the <strong>figure1</strong> variable in the console.</li>
</ul>
</div>
<div id="lets-save-the-plot-as-an-image-in-your-folder-learnr-by-using-the-variable-figure1." class="section level3 unnumbered">
<h3 class="unnumbered">Let’s save the plot as an image in your folder <strong>LearnR</strong> by using the variable <strong>figure1</strong>.</h3>
<ul>
<li>To save the figure as an image, we will use a function from the <strong>cowplot</strong> package.</li>
<li>The function is <code>save_plot()</code>.</li>
<li>There is one important argument: <code>base_asp</code>.
<ul>
<li>This is the ratio of your image (width/height). I usually set it to 1.4. So let’s type <code>base_asp = 1.4</code> in <code>save_plot()</code>.</li>
<li>If <code>base_asp</code> is larger than 1, it gets wider than its height. This is recommended when you have a legend.</li>
<li>If there is no legend, then <code>base_asp = 1</code> is recommended.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1.png&#39;</span>, figure1, <span class="at">base_asp =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<ul>
<li><strong>Exercise</strong>: try to save it again with a name <strong>figure1b.png</strong> by typing:</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;figure1b.png&#39;</span>, figure1)</span></code></pre></div>
<ul>
<li><p>How’s the picture? Why does it look different? Type <code>?save_plot</code> to see what the default <code>base_asp</code> is.</p></li>
<li><p>Done! The graph (in png file) should be in your <strong>LearnR</strong> folder.</p></li>
<li><p><strong>Exercise:</strong> Try to open Microsoft Word or PowerPoint and upload <strong>figure1</strong>. The figure should look the same as it appears in the slides.</p></li>
<li><p><strong>Exercise:</strong> Remove the legend and save the scatterplot with <code>base_asp = 1</code>.</p></li>
<li><p>Congratulations! You can now make <strong>correlation plots</strong> with R.</p></li>
</ul>
</div>
</div>
<div id="summary" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> Summary</h2>
<ul>
<li>You have learned the basics of <strong>ggplot</strong>.
<ul>
<li>You begin by writing a <code>ggplot()</code> function.</li>
<li>If aesthetics (color, shape, etc) are specified outside of <code>aes()</code> function, then there is no group difference.</li>
<li>If aesthetics are specified in <code>aes()</code>, different groups of data will have different looks.</li>
<li>You have learned to add geom layers such as <code>geom_point()</code>, which shows points, and <code>geom_smooth()</code>, which plots the best-fit function.</li>
<li>You have learned to plot <code>geom_point()</code> and <code>geom_smooth()</code> in the same graph.</li>
</ul></li>
<li><strong>smplot</strong> functions can be used to improve <strong>ggplot2</strong> visually.
<ul>
<li>For correlation plots, add <code>sm_corr_theme()</code>.</li>
<li>You can report statistical results and plot linear regression from correlation by <code>sm_statCorr()</code>.</li>
<li>You can also select colors using <code>sm_color()</code>.</li>
</ul></li>
<li>Save the graph as an image file in your working directory.
<ul>
<li>Working directory has to be set in RStudio (<strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>)</li>
<li>Then use <code>save_plot()</code> from <strong>cowplot</strong> to save the image in your directory (folder <strong>LearnR</strong>).</li>
</ul></li>
</ul>
<!--chapter:end:02-corr.Rmd-->
</div>
</div>
<div id="boxplot-and-violin-plot" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Boxplot and Violin Plot</h1>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="upload-sample-data-csv-file-in-rstudio" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Upload sample data (csv file) in RStudio</h2>
<div id="download-requirements" class="section level3 unnumbered">
<h3 class="unnumbered">Download requirements</h3>
<ul>
<li>Download <strong>data.csv</strong> from <a href="https://raw.githubusercontent.com/smin95/dataviz/master/data.csv" class="uri">https://raw.githubusercontent.com/smin95/dataviz/master/data.csv</a></li>
<li>Put the file <strong>data.csv</strong> in your <strong>LearnR</strong> folder</li>
</ul>
</div>
<div id="before-we-get-started" class="section level3 unnumbered">
<h3 class="unnumbered">Before we get started</h3>
<ul>
<li>Set <strong>LearnR</strong> folder as your working directory by by clicking: <strong>Session -&gt; Set Working Directory -&gt; Choose Directory</strong>. Then find your <strong>LearnR</strong> folder.</li>
<li>Load these three packages with the <code>library()</code> function: <strong>ggplot2</strong>, <strong>cowplot</strong> and <strong>smplot</strong>.
<ul>
<li>Since the <strong>tidyverse</strong> package includes the <strong>ggplot2</strong> package, you can load <strong>tidyverse</strong> instead. <strong>tidyverse</strong> has other packages beside <strong>ggplot2</strong>, so it is more useful.</li>
</ul></li>
<li>Remember from the last tutorial that:
<ul>
<li>Functions from the <strong>ggplot2</strong> package include <code>ggplot()</code> and other <strong>geom</strong> functions such as <code>geom_point()</code>, <code>geom_smooth()</code>, etc.</li>
<li>Functions from the <strong>smplot</strong> package improve the <strong>ggplot2</strong> graphs visually. However, they are not required to make a graph using <strong>ggplot2</strong>.</li>
<li>The <strong>cowplot</strong> package has a function called <code>save_plot</code>, which is very useful for saving a graph as an image.</li>
</ul></li>
</ul>
</div>
<div id="data.csv" class="section level3 unnumbered">
<h3 class="unnumbered">data.csv</h3>
<ul>
<li>Let’s load <strong>data.csv</strong> in R from your <strong>LearnR</strong> folder.</li>
<li>Then store the loaded data into a variable called <code>df</code>.</li>
<li>We will use a function from the <strong>tidyverse</strong> package called <strong>read_csv()</strong>.
<ul>
<li>For more information, type <code>?read_csv()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data.csv&#39;</span>)</span></code></pre></div>
<pre><code>## 
## -- Column specification --------------------------------------------------
## cols(
##   Subject = col_character(),
##   Value = col_double(),
##   Day = col_character()
## )</code></pre>
<ul>
<li><p>If you get an <strong>error</strong> such as <code>object 'data.csv' not found</code>, make sure you set your working directory in the <strong>LearnR</strong> folder. Also make sure you have downloaded your data and saved it in the <strong>LearnR</strong> folder.</p></li>
<li><p>You can view the entire data frame by typing <code>View(df)</code>.</p></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df)</span></code></pre></div>
<ul>
<li>There are <strong>three columns</strong> in <strong>df</strong>.
<ul>
<li>The first column (<strong>Subject</strong>) is the subject number. S1 means the first subject, and S2 second.</li>
<li>The second column (<strong>Value</strong>) is the data. It contains numbers.</li>
<li>The third column (<strong>Day</strong>) is the day of testing. There are three days of measurement: <strong>One</strong>, <strong>Two</strong> and <strong>Three</strong>.</li>
</ul></li>
<li><strong>What is the data about?</strong>
<ul>
<li>30 patients were tested across three days to see if there was an improvement in their visual function (<strong>Value</strong>). The higher value, the better the vision.</li>
<li>Day <strong>One</strong>: first day of the study. This is the baseline value. After this measurement, patients received treatment (ex. drug, surgery, etc).</li>
<li>Day <strong>Two</strong>: second day of the study. This is the one day after receiving the treatment.</li>
<li>Day <strong>Three</strong>: third day of the study. This is two days after receiving the treatment.</li>
</ul></li>
<li>The data are all fake.</li>
</ul>
</div>
<div id="read_csvdata.csv" class="section level3 unnumbered">
<h3 class="unnumbered"><code>read_csv('data.csv')</code></h3>
<ul>
<li><p>Let’s use the variable <strong>df</strong> to store the output from <strong>data.csv</strong>.</p></li>
<li><p><strong>df</strong> is shortened from <strong>data frame</strong>, which refers to a structure of the data that is commonly used for data analysis.</p></li>
<li><p>In fact, ‘data.csv’ has the structure of a typical <strong>data frame</strong>.</p>
<ul>
<li>Each <strong>column</strong> is a <strong>variable</strong>.</li>
<li>Each <strong>row</strong> represents an <strong>observation</strong></li>
</ul></li>
<li><p>In future, I suggest you save data that has a similar structure to that of <strong>df</strong>.</p>
<ul>
<li>Put your own data in Microsoft Excel and save it as a <strong>csv file</strong> to load it on R.</li>
</ul></li>
<li><p><strong>Exercise</strong>: Open <strong>data.csv</strong> using Microsoft Excel. Change the name of third column into <strong>Group</strong>. Then, save it as <strong>data2.csv</strong>. What does this data frame indicate now?</p>
<ul>
<li>It indicates there are 30 individuals for each group. Also, there are 3 groups, so there are 90 individuals total. So, it might be better to change the subject number so each person has a unique label, such as <strong>S1</strong> to <strong>S90</strong>.</li>
</ul></li>
</ul>
</div>
<div id="best-way-to-plot-data" class="section level3 unnumbered">
<h3 class="unnumbered">Best way to plot data</h3>
<ul>
<li>A popular way to visualize data is plotting a bar graph.</li>
<li>However, a bar graph does not show the distribution of the data well.</li>
<li>For this reason, boxplot and violin plots have become more popular in scientific writing.</li>
</ul>
</div>
</div>
<div id="boxplot" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Boxplot</h2>
<div id="what-is-a-boxplot" class="section level3 unnumbered">
<h3 class="unnumbered">What is a boxplot?</h3>
<ul>
<li>This is the basic structure of the boxplot.</li>
</ul>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-57-1.png" width="685.714285714286" /></p>
<ul>
<li>The line in the middle is the <strong>median</strong> of the data.</li>
<li>The <strong>first quartile</strong> is the lower 25% of the data.</li>
<li>The <strong>third quartile</strong> is the 75% percentile of the data.</li>
<li>The <strong>interquartile range</strong> is the distance between the first and third quartiles.</li>
<li>The <strong>lower whisker</strong> is the lowest data point without outliers.</li>
<li>The <strong>upper whisker</strong> is the highest data point without outliers.</li>
<li>The point that lies outside the whisker is the <strong>outlier</strong>.</li>
</ul>
</div>
<div id="boxplot-vs-bar-graph" class="section level3 unnumbered">
<h3 class="unnumbered">Boxplot vs bar graph</h3>
<ul>
<li>Here is the basic structure of the bar graph.</li>
</ul>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-58-1.png" width="685.714285714286" /></p>
<ul>
<li>The boxplot is more informative than bar graph.</li>
<li>The bar graph only shows the mean (average) of the data and the standard error.</li>
<li>The bar graph does not represent the distribution very well. The narrow errorbar is quite misleading here.</li>
<li>For this reason, let’s focus on drawing a boxplot.</li>
</ul>
</div>
<div id="boxplot-using-ggplot2" class="section level3 unnumbered">
<h3 class="unnumbered">Boxplot using ggplot2</h3>
<ul>
<li>We want to plot <strong>Value</strong> (y-axis) from each <strong>Day</strong> (x-axis).</li>
<li>As always in <strong>ggplot</strong>, let’s start by writing <code>ggplot()</code>.
<ul>
<li>Make sure you specify the data to plot by writing <code>data = df</code> in <code>ggplot()</code>.</li>
</ul></li>
<li>Also, you will need to specify the x- and y-axes in the <code>mapping</code> argument within <code>ggplot()</code>.
<ul>
<li><code>x = Day</code> and <code>y = Value</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-59-1.png" width="355.2" /></p>
<ul>
<li>However, as we learned in the last lesson, <strong>ggplot</strong> requires <strong>geom</strong> objects to plot something. Last time we used <strong>geom_point()</strong>, which plots points.</li>
<li>Now, let’s use <strong>geom_boxplot()</strong> to plot a boxplot.</li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-60-1.png" width="355.2" /></p>
<ul>
<li>Here’s the boxplot! But I think there is a problem here.</li>
<li>Day <strong>Three</strong> precedes Day <strong>Two</strong> in the x-axis.</li>
<li><strong>Exercise</strong>: Why do you think <strong>Three</strong> appeared first?</li>
</ul>
</div>
<div id="problem-alphabetical-order" class="section level3 unnumbered">
<h3 class="unnumbered">Problem: Alphabetical order</h3>
<ul>
<li>The issue with the boxplot is that the x-axis followed an alphabetical order.</li>
<li><strong>Th</strong> precedes <strong>Tw</strong>. In short, R does not seem to know that we want the order to be <strong>One -&gt; Two -&gt; Three</strong>.</li>
<li>R decided to follow the alphabetical order is because the column <strong>Day</strong> is shown as <code>&lt;chr&gt;</code>, which means <strong>character</strong>.</li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<ul>
<li>Note that the <strong>Subject</strong> column is also considered as <code>&lt;chr&gt;</code> (<strong>characters</strong>) because it contains texts/alphabets.</li>
<li>The <strong>Value</strong> column is categorized as <code>&lt;dbl&gt;</code>, which means <strong>double</strong>.
<ul>
<li><strong>Double</strong> basically means numbers.</li>
</ul></li>
<li>In R, <strong>character</strong> is also referred to as <strong>string</strong>. They mean the same thing.</li>
<li>Here are more examples of <strong>characters/strings</strong>.</li>
</ul>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">&#39;R is very useful!&#39;</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="st">&#39;Dogs are so cute.&#39;</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="st">&#39;Clarinet is the best.&#39;</span></span></code></pre></div>
<ul>
<li>In these examples, you have stored the <strong>characters/strings</strong> in the variables <strong>a</strong>, <strong>b</strong> and <strong>c</strong>.</li>
</ul>
</div>
<div id="displaying-characters-in-a-non-alphabetical-order" class="section level3 unnumbered">
<h3 class="unnumbered">Displaying characters in a non-alphabetical order</h3>
<ul>
<li><p><strong>Factors</strong> are important when you want to display characters in non-alphabetical order.</p></li>
<li><p><strong>Factors</strong> are variables that have a limited number of different values.</p></li>
<li><p>For example, if a dataset has two groups (<strong>controls</strong> and <strong>patients</strong>), these can be referred to as <strong>factors</strong>.</p></li>
<li><p>However, when you are using <code>read_csv()</code> to load data into RStudio, <code>read_csv()</code> will interpret texts/alphabets as <strong>characters</strong>, not <strong>factors</strong>.</p>
<ul>
<li>This is a problem when you need a non-alphabetical order, such as <strong>one -&gt; two -&gt; three</strong> and <strong>Jan -&gt; Feb -&gt; Mar -&gt; Apr</strong>.</li>
</ul></li>
<li><p>To resolve this problem, you will need to change the <strong>characters</strong> into <strong>factors</strong> using <code>factor()</code> function.</p></li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span></code></pre></div>
<ul>
<li>Remember that <code>&lt;-</code> means equivalent.</li>
<li>Also, <code>$</code> of a data frame can extract a specific column
<ul>
<li>You can also type <code>df$Value</code> and run it to see what happens. You will get all values of the second column <strong>Value</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Value</span></code></pre></div>
<ul>
<li>By using <code>factor()</code>, you are making the <strong>Day</strong> column of <strong>df</strong> into factor from character.</li>
<li>However, you will need to store the <strong>factored</strong> version of <code>df$Day</code> by using <code>&lt;-</code>. If not, <code>df$Day</code> will stay as <strong>character</strong>.</li>
<li><code>levels</code> argument in <code>factor()</code> allows you to specify the order of the factors.</li>
<li>For more information about <strong>factors</strong>, please check Chapter 15 of <em>R for Data Science</em> (<a href="https://r4ds.had.co.nz/factors.html" class="uri">https://r4ds.had.co.nz/factors.html</a>).</li>
<li><strong>Note:</strong> you do not have to understand this part 100%. However, if you do encounter similar issues, I suggest you resolve it with the solution above.</li>
</ul>
</div>
<div id="double-check-if-the-day-column-is-factor" class="section level3 unnumbered">
<h3 class="unnumbered">Double-check if the ‘Day’ column is factor</h3>
<ul>
<li>Let’s open the data frame <strong>df</strong> again.</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    Subject  Value Day  
##    &lt;chr&gt;    &lt;dbl&gt; &lt;fct&gt;
##  1 S1      -0.752 One  
##  2 S2       0.220 One  
##  3 S3      -1.00  One  
##  4 S4       1.91  One  
##  5 S5       0.395 One  
##  6 S6      -0.985 One  
##  7 S7       0.585 One  
##  8 S8       0.886 One  
##  9 S9       0.691 One  
## 10 S10     -0.366 One  
## # ... with 80 more rows</code></pre>
<ul>
<li>Now we see <code>&lt;fct&gt;</code> in the <strong>Day</strong> column. This means that the column is now <strong>factor</strong>, not <strong>character</strong>.</li>
</ul>
</div>
<div id="back-to-boxplot-using-ggplot2" class="section level3 unnumbered">
<h3 class="unnumbered">Back to boxplot using ggplot2</h3>
<ul>
<li>Now let’s draw the boxplot again.</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-66-1.png" width="355.2" /></p>
<ul>
<li>Since we have converted the <strong>Day</strong> column of <strong>df</strong> into factor, the boxplot successfully plots each day in the correct order.</li>
</ul>
</div>
<div id="a-boxplot-with-individual-data" class="section level3 unnumbered">
<h3 class="unnumbered">A boxplot with individual data</h3>
<ul>
<li><p>Sometimes, it is preferable to plot individual data on top of the boxplot.</p></li>
<li><p>There are many ways to do this. Here is a simple solution by using <code>geom_jitter()</code>. For more information, type <code>?geom_jitter</code>.</p></li>
</ul>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-67-1.png" width="355.2" /></p>
<ul>
<li>I think the points are too spread. So let’s set the <code>width</code> of the spread in <code>geom_jitter()</code> to 0.15.</li>
<li>Also, let’s apply a different color of points for each <strong>Day</strong>.</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-68-1.png" width="489.6" /></p>
<ul>
<li>Now we can make the boxplot prettier with <code>sm_minimal()</code>, which removes all grids in the graph. We can also set <code>legends = FALSE</code> to remove the legends.</li>
<li>Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>, which is a function from the <strong>ggplot2</strong> package.</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-69-1.png" width="355.2" /></p>
<ul>
<li>Now let’s set the colors using <code>sm_palette()</code>. Remember from the last lesson that we set the colors in <strong>ggplot</strong> by using <code>scale_color_manual()</code> for points without borders.</li>
<li>Let’s write <code>3</code> in <code>sm_palette()</code> because we need 3 colors (for each <strong>Day</strong>).</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_minimal</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-70-1.png" width="355.2" /></p>
<ul>
<li>If you need horizontal grids, you can simply replace <code>sm_minimal()</code> with <code>sm_hgrid()</code>. There is also <code>sm_vgrid()</code> but I will not try it here because it is not so useful in our context.</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>(<span class="at">legends =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-71-1.png" width="355.2" /></p>
</div>
<div id="geom_boxplot-vs-sm_boxplot" class="section level3 unnumbered">
<h3 class="unnumbered"><code>geom_boxplot()</code> vs <code>sm_boxplot()</code></h3>
<ul>
<li><code>geom_boxplot()</code> does not show individual data. You need to add <code>geom_jitter()</code>.</li>
<li><code>sm_boxplot()</code> shows both a boxplot and individual data.
<ul>
<li>It automatically uses <code>sm_hgrid()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-72-1.png" width="355.2" /></p>
<ul>
<li>Let’s keep the color of the boxplot the same across <strong>Day</strong>. So we should remove <code>color = Day</code> in <code>aes()</code>.
<ul>
<li>However, since the shape is 16 (circle without borders), this will cause the points across <strong>Day</strong> to have the same color too.</li>
</ul></li>
<li>So let’s change the shape of the points to 21, which is a circle with borders.
<ul>
<li>So <code>fill</code> decides the filling color now. Let’s set <code>fill = Day</code> in <code>aes()</code>.</li>
<li>Also, <code>color</code> here only affects the border color. Let’s set it to <code>white</code>.</li>
</ul></li>
<li>Make sure you change <code>scale_color_manual()</code> to <code>scale_fill_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-73-1.png" width="355.2" /></p>
<ul>
<li>Now, pick your favorite boxplot and store it in a variable called <strong>my_boxplot</strong> using <code>&lt;-</code>.</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="save-boxplot" class="section level3 unnumbered">
<h3 class="unnumbered">Save boxplot</h3>
<ul>
<li>We can save the boxplot by using <code>save_plot()</code> from the <strong>cowplot</strong> package.</li>
<li>Let’s set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;boxplot.jpg&#39;</span>, my_boxplot, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>This image file should now be in your <strong>LearnR</strong> folder.</li>
</ul>
</div>
</div>
<div id="violin-plot" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> Violin plot</h2>
<ul>
<li>The boxplot represents the distribution quite well but it can still be misleading.
<ul>
<li>Also, it can be visually overwhelming (i.e., too crowded) to some readers.</li>
</ul></li>
<li>So, researchers have begun favoring the violin plot more.</li>
</ul>
<div id="structure-of-the-violin-plot" class="section level3 unnumbered">
<h3 class="unnumbered">Structure of the violin plot</h3>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-76-1.png" width="685.714285714286" /></p>
<ul>
<li>The part in the middle is the widest because it has most points. This part has the highest <strong>point density</strong>.</li>
<li>The lower and upper ends of the violin plot are thinner because there are less points.</li>
<li>Let’s draw a violin plot in R.</li>
</ul>
</div>
<div id="violin-plot-with-ggplot2" class="section level3 unnumbered">
<h3 class="unnumbered">Violin plot with ggplot2</h3>
<ul>
<li>Let’s draw the violin plot. Specify the x-axis to <strong>Day</strong> and the y-axis to <strong>Value</strong> using data frame <strong>df</strong>.</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-77-1.png" width="355.2" /></p>
<ul>
<li>Notice that since we have already converted the <strong>Day</strong> column of df into <strong>factor</strong>, the violin plot’s x-axis is in the correct order.</li>
<li>Also, notice that we can just replace <code>geom_boxplot()</code> with <code>geom_violin()</code>.</li>
</ul>
</div>
<div id="violin-plot-with-individual-points" class="section level3 unnumbered">
<h3 class="unnumbered">Violin plot with individual points</h3>
<ul>
<li>Let’s add individual points to the violin plot by using <code>geom_jitter()</code>.
<ul>
<li>Set <code>width</code> of the spread to <code>0.15</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-78-1.png" width="355.2" /></p>
<ul>
<li>Now let’s apply different color to each <strong>Day</strong> like we did in boxplot by using <code>scale_color_manual()</code>.
<ul>
<li>Let’s use <code>sm_palette(3)</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-79-1.png" width="460.8" /></p>
<ul>
<li>Finally, let’s make it pretty and remove the <strong>legend</strong> by applying <code>sm_hgrid()</code> theme, which only has horizontal grids.</li>
<li>Let’s also add a title <strong>Visual improvement after treatment</strong> using <code>ggtitle()</code>.</li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_hgrid</span>() <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-80-1.png" width="355.2" /></p>
</div>
<div id="geom_violin-vs-sm_violin" class="section level3 unnumbered">
<h3 class="unnumbered">geom_violin() vs sm_violin()</h3>
<ul>
<li><code>geom_violin()</code> does not show individual data. You need to add geom_jitter().</li>
<li><code>sm_violin()</code> shows both a boxplot and individual data.
<ul>
<li>It automatically uses <code>sm_hgrid()</code>.</li>
<li>It also display lines that represent the mean and +/- standard deviation.</li>
</ul></li>
<li>In <code>sm_violin()</code>, the default shape (<code>'point_shape'</code>) is 16, which is the circle without borders.</li>
<li><strong>Let’s try using <code>sm_violin()</code>.</strong></li>
<li><code>color</code> here filling color of the jittered points. Also, <code>color</code> affects the color of the lines that show the mean and +/- standard deviation.</li>
<li>Let’s set <code>color = Day</code> in <code>aes()</code> so that we can apply different colors of the lines and the points for each group.</li>
<li>Make sure you have <code>scale_color_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-81-1.png" width="355.2" /></p>
</div>
<div id="save-your-violin-plot" class="section level3 unnumbered">
<h3 class="unnumbered">Save your violin plot</h3>
<ul>
<li>Pick your violin plot and store it in a variable called <code>my_violin</code> using <code>&lt;-</code>.</li>
</ul>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>my_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<ul>
<li>We can save the violin plot by using <code>save_plot()</code> from the <strong>cowplot</strong> package.</li>
<li>Let’s set the aspect ratio (width/height) to 1. So, type <code>base_asp = 1</code>.</li>
</ul>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&#39;violin.jpg&#39;</span>, my_violin, <span class="at">base_asp =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>This image file should now be in your <strong>LearnR</strong> folder.</li>
</ul>
</div>
</div>
<div id="summary-1" class="section level2" number="3.4">
<h2 number="3.4"><span class="header-section-number">3.4</span> Summary</h2>
<ul>
<li>You have learned how to convert <strong>characters</strong> to <strong>factors</strong>.</li>
<li><strong>Factor</strong> is important to order words/letters in a non-alphabetical order.</li>
<li>You can now make a <strong>boxplot</strong> and a <strong>violin plot</strong> with R.
<ul>
<li>They are more informative than a bar graph.</li>
</ul></li>
<li>You have learned to use <strong>geom</strong> functions, such <code>geom_boxplot()</code>, <code>geom_violin()</code>, and <code>geom_jitter()</code>.
<ul>
<li>These are functions from the <strong>ggplot2</strong> package.</li>
</ul></li>
<li>You can also plot individual data at the same time with functions from the <strong>smplot</strong> package.
<ul>
<li>These functions are <code>sm_boxplot()</code> and <code>sm_violin()</code>.</li>
</ul></li>
</ul>
<!--chapter:end:03-violinBox.Rmd-->
</div>
</div>
<div id="full-guide-on-smplot" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Full Guide on smplot</h1>
<p>This chapter is for those who know how to use ggplot2 already and skipped Chapters 1-3 from the online tutorial. It also includes tutorials about <code>sm_bar()</code>, <code>sm_bland_altman()</code> and <code>sm_raincloud()</code>, all of which are not mentioned in the preceding chapters.</p>
<ul>
<li>If you are not sure about any of the functions, please type <code>?</code> before the function names, ex. <code>?sm_bar</code>.</li>
</ul>
<div id="installation-of-the-package" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Installation of the package</h2>
<ul>
<li>The <strong>smplot</strong> package is NOT available on CRAN yet. So, you will need to download it directly from my github for now.</li>
<li>To install it, please type in the R console:</li>
</ul>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;smin95/smplot&#39;</span>)</span></code></pre></div>
<ul>
<li>To use the package, load it:</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
<div id="what-is-smplot" class="section level3 unnumbered">
<h3 class="unnumbered">What is <code>smplot</code>?</h3>
<ul>
<li><strong>smplot</strong> is a package that provides functions that visually improve graphs produced from <strong>ggplot2</strong>.
<ul>
<li>So it does not work with plots made from base R.</li>
</ul></li>
<li>It was first developed in May 2021.</li>
<li>It is <strong>free</strong> and <strong>open source</strong> (<a href="https://github.com/smin95/smplot" class="uri">https://github.com/smin95/smplot</a>).</li>
</ul>
</div>
</div>
<div id="smplots-color-palette-and-graph-themes" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> smplot’s color palette and graph themes</h2>
<div id="smplots-color-palette" class="section level3 unnumbered">
<h3 class="unnumbered">smplot’s color palette</h3>
<ul>
<li>Its color palette can be accessed via two functions: <code>sm_color()</code> and <code>sm_palette()</code>.</li>
<li><code>sm_color()</code> accepts the <strong>character string</strong> of the color name.</li>
<li><code>sm_palette()</code> accepts the <strong>number of colors</strong> (up to <strong>16</strong>) and returns the hex codes accordingly.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/color.png" alt="smplot's color palette" width="55%" />
<p class="caption">
(#fig:unnamed-chunk-86)smplot’s color palette
</p>
</div>
<ul>
<li>For example, if you want <code>blue</code> and <code>red</code>, just type the input like this:</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#1262b3&quot; &quot;#cc3d3d&quot;</code></pre>
<ul>
<li>But, do not form a single vector that contains two characters. If so, <code>sm_color()</code> will only return the first color.</li>
</ul>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_color</span>(<span class="fu">c</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>))</span></code></pre></div>
<pre><code>## Warning in if (color == &quot;blue&quot;) return(&quot;#1262b3&quot;): the condition has
## length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## [1] &quot;#1262b3&quot;</code></pre>
<ul>
<li>If you need 5 colors, you can use <code>sm_palette()</code>.</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_palette</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#cc1489&quot; &quot;#1262b3&quot; &quot;#5b4080&quot; &quot;#e57717&quot; &quot;#0f993d&quot;</code></pre>
</div>
<div id="smplots-graph-themes" class="section level3 unnumbered">
<h3 class="unnumbered">smplot’s graph themes</h3>
<ul>
<li>There are several its graph themes. The text positions and the font are all similar.</li>
<li><code>sm_corr_theme()</code> and <code>sm_hvgrid()</code> are <strong>equivalent</strong>. They have major horizontal and vertical grids.
<ul>
<li>This theme is useful for correlation, so I created a duplicate function <code>sm_corr_theme()</code>.</li>
</ul></li>
<li><code>sm_bar_theme()</code> and <code>sm_hgrid()</code> are <strong>equivalent</strong>. They have major horizontal grids.
<ul>
<li>This theme is useful for a bar graph, so I created a duplicate function <code>sm_bar_theme()</code>.</li>
</ul></li>
<li><code>sm_minimal</code> has no major grid. This is useful when a graph has a lot of annotation, such as texts and arrows.</li>
<li><code>sm_slope_theme()</code> is a theme for a slope chart. It removes everything except the y-axis.</li>
<li>All of these functions, except for <code>sm_slope_theme()</code>, have two arguments: <code>borders</code> and <code>legends</code>.
<ul>
<li>For some of these functions, the defaults are set to <code>borders = TRUE</code> and <code>legends = TRUE</code>.</li>
<li>You can check the defaults by typing <code>?</code> in front of the function. Ex: <code>?sm_corr_theme</code></li>
<li>There is no option for <code>borders</code> in <code>sm_slope_theme()</code>.</li>
</ul></li>
<li><code>p1</code> has the default theme of <strong>ggplot2</strong>.</li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-90-1.png" width="508.8" /></p>
<ul>
<li>Now we can change the theme using <code>sm_corr_theme()</code>.</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-91-1.png" width="508.8" /></p>
<ul>
<li>We can also remove <code>borders</code> and <code>legends</code> by setting them as <code>FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>, <span class="at">legends =</span> <span class="cn">FALSE</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-92-1.png" width="355.2" /></p>
<ul>
<li>You can also apply smplot’s colors by using <code>scale_color_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">7</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-93-1.png" width="355.2" /></p>
</div>
</div>
<div id="correlation-plot" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Correlation plot</h2>
<ul>
<li><p><code>sm_corr_theme()</code> and <code>sm_statCorr()</code> can be used as a pair when plotting a correlation.</p></li>
<li><p>This is the plot using the default theme of <strong>ggplot2</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-94-1.png" width="355.2" /></p>
<ul>
<li>The next plot uses <code>sm_corr_theme()</code> to apply the smplot’s theme and <code>sm_statCorr()</code> to print linear regression slope and statistical results from a paired correlation test (Pearson’s).</li>
<li><strong>Important:</strong> <code>sm_statCorr()</code> recognizes the data for the y- and x-axes from the <code>mapping = aes()</code> in <code>ggplot()</code> function.
<ul>
<li>There is no <code>mapping</code> argument in <code>sm_statCorr()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-95-1.png" width="355.2" /></p>
<ul>
<li>You can also change the <code>line_type</code> to <code>'solid'</code> in <code>sm_statCorr()</code>, and change the location of the printed texts by using <code>label_x</code> and <code>label_y</code> arguments.</li>
<li>You can also change the font size of the printed texts by setting <code>text_size</code> to a larger numerical value.</li>
</ul>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>),</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">line_type =</span> <span class="st">&#39;solid&#39;</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">label_x =</span> <span class="fl">3.5</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">label_y =</span> <span class="dv">30</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">text_size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-96-1.png" width="355.2" /></p>
<div id="data-frame-for-a-correlation-plot" class="section level3" number="4.3.1">
<h3 number="4.3.1"><span class="header-section-number">4.3.1</span> Data frame for a correlation plot</h3>
<ul>
<li><p>Column 1 has to be the data for x-axis.</p></li>
<li><p>Column 2 has to be the data for y-axis.</p></li>
<li><p>This structure of the data frame is slightly different from that is typically used in ggplot2 and smplot functions (ex. <code>sm_boxplot()</code>, <code>sm_bar()</code>, <code>sm_violin()</code> and <code>sm_raincloud()</code>).</p></li>
<li><p>Correlation plot and a bar plot requires a different data frame structure.</p></li>
</ul>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>) <span class="co"># generate random data</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>method1 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(method1,method2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>Method <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Method 1&#39;</span>, <span class="st">&#39;Method 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(method1))</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>df_general <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Method) <span class="co"># used for sm_bar(), sm_boxplot(), sm_violin(), etc</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>df_corr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first =</span> method1, <span class="at">second =</span> method2) <span class="co"># used for correlation</span></span></code></pre></div>
<ul>
<li>We have created two data frames: <code>df_general</code> and <code>df_corr</code>. Let’s take a look at their structures.</li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_general)</span></code></pre></div>
<pre><code>##   Subject       Value   Method
## 1      S1 -0.59103110 Method 1
## 2      S2  0.02659437 Method 1
## 3      S3 -1.51655310 Method 1
## 4      S4 -1.36265335 Method 1
## 5      S5  1.17848916 Method 1
## 6      S6 -0.93415132 Method 1</code></pre>
<ul>
<li>Notice that <code>df_general</code> has three columns. The first column is subject, second column is data (i.e., <code>Value</code>) and third column is measurement group.</li>
</ul>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_corr)</span></code></pre></div>
<pre><code>##         first      second
## 1 -0.59103110 -0.65571812
## 2  0.02659437 -0.68251762
## 3 -1.51655310 -0.01585819
## 4 -1.36265335 -0.44260479
## 5  1.17848916  0.35255750
## 6 -0.93415132  0.07317058</code></pre>
<ul>
<li>Notice that <code>df_corr</code> has two columns, each of which represents a measurement group.</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot using dataframe &#39;df_corr&#39; </span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_corr, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> first, <span class="at">y =</span> second)) <span class="sc">+</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;cyan&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;cyan&#39;</span>), <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>,</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">label_y =</span> <span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Method 1&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Method 2&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-100-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bar graph using dataframe &#39;df_general&#39;</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_general, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Value, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;cyan&#39;</span>,<span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-101-1.png" width="355.2" /></p>
</div>
</div>
<div id="boxplot---sm_boxplot" class="section level2" number="4.4">
<h2 number="4.4"><span class="header-section-number">4.4</span> Boxplot - <code>sm_boxplot()</code></h2>
<ul>
<li><code>sm_boxplot()</code> generates a boxplot and individual points at the same time.</li>
<li>It automatically uses <code>sm_hgrid()</code> as its default theme.</li>
<li>First, let’s generate some random data.</li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)), <span class="dv">2</span>)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<ul>
<li>Now, let’s make a boxplot using <code>sm_boxplot()</code>.</li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a boxplot with the random data, all black points</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-103-1.png" width="355.2" /></p>
<ul>
<li>Now let’s apply different color for each Day.</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a boxplot with different colored points</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-104-1.png" width="355.2" /></p>
<ul>
<li>You can change the shape of the boxplot by setting <code>notch = TRUE</code>. You can also change the size of the individual points using <code>point_size</code> argument.</li>
<li>A notched boxplot shows the confidence interval around the median (+/- 1.58 * interquartile range / sqrt(n)).
<ul>
<li>The notches are used for group comparison.</li>
<li>If the notch of each box does not overlap, there is a strong likelihood that the medians are significantly different between groups.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">4</span>, <span class="at">notch =</span> <span class="st">&#39;TRUE&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-105-1.png" width="355.2" /></p>
<div id="plotting-individual-points-with-unique-colors" class="section level3" number="4.4.1">
<h3 number="4.4.1"><span class="header-section-number">4.4.1</span> Plotting individual points with unique colors</h3>
<ul>
<li>One can also use <code>sm_boxplot()</code> to plot individual points with unique colors.</li>
<li>But <code>sm_boxplot()</code> cannot print distinct box colors across distinct x levels (i.e., in this example, all boxes are grey). This is because the author thinks it is not a good practice to print different colors of boxes as they tend to distract the reader.</li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Subject)) <span class="sc">+</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-106-1.png" width="355.2" /></p>
</div>
</div>
<div id="violin-plot---sm_violin" class="section level2" number="4.5">
<h2 number="4.5"><span class="header-section-number">4.5</span> Violin plot - <code>sm_violin()</code></h2>
<ul>
<li><code>sm_violin()</code> plots a violin plot, individual points and lines that indiciate means and +/- 1 standard deviation at the same time.</li>
<li>It is very similar to <code>sm_boxplot()</code> except there is no option for <code>notch = TRUE</code> in <code>sm_violin()</code>.</li>
<li>Also <code>sm_violin()</code> uses both <code>color</code> (for the lines of mean and SD) and <code>fill</code> (for the colors of the points) arguments.</li>
<li>The default border color of the points is <code>white</code>.</li>
<li><code>sm_violin()</code> automatically uses <code>sm_hgrid()</code> as its default theme.</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a violin plot with the random data, all black points and lines</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-107-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a violin plot with different colored points and lines</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-108-1.png" width="355.2" /></p>
<div id="plotting-individual-points-with-unique-colors-1" class="section level3" number="4.5.1">
<h3 number="4.5.1"><span class="header-section-number">4.5.1</span> Plotting individual points with unique colors</h3>
<ul>
<li>One can also use <code>sm_violin()</code> to plot individual points with unique colors.</li>
<li>The x-level has to be grouped in the aesthetics (ex. <code>group = Day</code>).</li>
<li>But <code>sm_violin()</code> cannot print distinct violin colors across distinct x levels (i.e., in this example, all boxes are grey). This is because the author thinks it is not a good practice to print different colors of boxes as they tend to distract the reader.</li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Subject,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Day)) <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">point_alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-109-1.png" width="355.2" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Subject,</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Day, <span class="at">color =</span> Day)) <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">point_alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-110-1.png" width="355.2" /></p>
</div>
</div>
<div id="bar-plot---sm_bar" class="section level2" number="4.6">
<h2 number="4.6"><span class="header-section-number">4.6</span> Bar plot - <code>sm_bar()</code></h2>
<ul>
<li>It automatically uses <code>sm_bar_theme()</code> / <code>sm_hgrid()</code>.</li>
<li>Let’s use data (<code>df</code>) we generated before.</li>
</ul>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-111-1.png" width="355.2" /></p>
<ul>
<li>In this case, the error bar represents <strong>standard error</strong>. If you prefer to show <strong>standard deviation</strong>, then you should set <code>errorbar_type  = 'sd'</code> in <code>sm_bar()</code>.</li>
</ul>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>, <span class="at">errorbar_type =</span> <span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-112-1.png" width="355.2" /></p>
<ul>
<li>95% confidence interval also be displayed with <code>errorbar_type  = 'ci'</code>.</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>, <span class="at">errorbar_type =</span> <span class="st">&#39;ci&#39;</span>) <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-113-1.png" width="355.2" /></p>
<div id="plotting-individual-points-with-unique-colors-2" class="section level3" number="4.6.1">
<h3 number="4.6.1"><span class="header-section-number">4.6.1</span> Plotting individual points with unique colors</h3>
<ul>
<li>One can also use <code>sm_bar()</code> to plot individual points with unique colors.</li>
</ul>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-114-1.png" width="355.2" /></p>
<ul>
<li><code>sm_bar()</code> can also print distinct box colors across distinct x levels.</li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Subject,</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>() <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;lightorange&#39;</span>,<span class="st">&#39;skyblue&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-115-1.png" width="355.2" /></p>
</div>
</div>
<div id="slope-chart---sm_slope" class="section level2" number="4.7">
<h2 number="4.7"><span class="header-section-number">4.7</span> Slope chart - <code>sm_slope()</code></h2>
<ul>
<li>This function plots a slope chart.</li>
<li>A slope chart is useful to describe changes between two different timepoints for each measurement (ex. a participant).</li>
<li>It automatically uses <code>sm_slope_theme()</code>.</li>
<li>Let’s use <code>df</code> that we generated before.</li>
<li><strong>Important:</strong> To make this function work, the <code>mapping</code> within <code>ggplot()</code> has to have a certain structure.
<ul>
<li>x- and y-axes have to be defined.</li>
<li>A slope chart groups each observation (ex. <code>Subject</code>) across x-axis. This has to be specified in <code>mapping</code> as <code>group =</code>.</li>
</ul></li>
<li>The x-axis cannot be <strong>continuous</strong>. It has to be <strong>discrete</strong>. So, it should take the form of <code>character</code> or <code>factor</code> (ex. ‘One’, ‘Two’, ‘Three’). If x-axis only has number (i.e., <code>double</code> form, such as 1.02, 1.05, 1.5), then <code>sm_slope()</code> will produce an error.</li>
<li><code>labels</code> argument is required to use <code>sm_slope()</code>. This refers to the labels of the ticks in the x-axis. Ex. <code>labels = c('Day 1', 'Day 2')</code>.</li>
</ul>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject)) <span class="sc">+</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-116-1.png" width="355.2" /></p>
<ul>
<li>Let’s set the shape to 21.</li>
<li>Let’s make the border color to <code>white</code>.</li>
<li>Let’s apply the same color to each <strong>Day</strong>.</li>
</ul>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject)) <span class="sc">+</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-117-1.png" width="355.2" /></p>
<ul>
<li>You could also apply different color for each <code>Day</code> using <code>scale_fill_manual()</code>.</li>
</ul>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-118-1.png" width="355.2" /></p>
<ul>
<li>You can also change the line color and other aesthetics. For more information, please type <code>?sm_slope</code>.</li>
</ul>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>,<span class="st">&#39;Day 2&#39;</span>), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">line_color =</span> <span class="st">&#39;#ADD8E6&#39;</span>,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line_size =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-119-1.png" width="355.2" /></p>
</div>
<div id="a-bland-altman-plot---sm_bland_altman" class="section level2" number="4.8">
<h2 number="4.8"><span class="header-section-number">4.8</span> A Bland Altman plot - <code>sm_bland_altman()</code></h2>
<ul>
<li><code>sm_bland_altman()</code> and <code>sm_statBlandAlt()</code> functions can be used to create a Bland-Altman plot.</li>
<li>The plot is used to measure agreement between two different measurements.</li>
<li>It is also used to measure test-retest variability of a method.</li>
<li>Let’s generate random data.</li>
</ul>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>second <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(first,second)) <span class="co"># requires library(tidyverse)</span></span></code></pre></div>
<ul>
<li>Now let’s draw a Bland Altman plot using <code>sm_bland_altman()</code>, which requires two arguments: first dataset, second dataset. They have to be numerical vectors of equal length.
<ul>
<li>This function automatically uses <code>sm_classic()</code> theme.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-121-1.png" width="355.2" /></p>
<ul>
<li>The upper dashed line represents the upper limit of the difference between two measurements (mean difference + 1.96 * standard deviation of the difference).</li>
<li>The upper dashed line represents the upper limit of the difference between two measurements (mean difference - 1.96 * standard deviation of the difference).</li>
<li>The middle dashed line represents the mean difference.</li>
<li>The shaded region is the 95% confidence interval of the difference between the two measuremnts from one-sample t-test (difference vs 0).
<ul>
<li>If the shaded region includes 0 in the y-axis, then there is no significant difference (p &gt; 0.05) between 0 and the difference.</li>
<li>If it does not include 0, then there is a significant difference. This indicates that the two measurement results are considerably different.</li>
</ul></li>
<li>I usually label them with <code>annotate()</code>, which is a function
from <strong>ggplot2</strong>. This process can be tedious.</li>
<li>Also, <code>sm_statBlandAlt()</code> calculates the statistical values that are
necessary to draw a Bland-Altman plot, such as the mean difference, upper and lower limits. This function is used to annotate the values in the plot.
<ul>
<li>The arguments for this function are first and second datasets, just like in <code>sm_bland_altman()</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">sm_statBlandAlt</span>(df3<span class="sc">$</span>first,df3<span class="sc">$</span>second) <span class="co"># store the results in res variable </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit<span class="fl">-0.4</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-122-1.png" width="355.2" /></p>
<ul>
<li>Let’s change the border color of the circles to white. To do so, we will have to change their shape to 21.</li>
</ul>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit<span class="fl">-0.4</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-123-1.png" width="355.2" /></p>
</div>
<div id="raincloud-plot---sm_raincloud" class="section level2" number="4.9">
<h2 number="4.9"><span class="header-section-number">4.9</span> Raincloud plot - <code>sm_raincloud()</code></h2>
<ul>
<li>A raincloud plot is a combination of jittered points, a boxplot and a violin plot.</li>
<li>However, this plot can be visually crowded. Some people like to use raincloud plots, some do not. So, the choice to use it is entirely yours.</li>
<li>Let’s generate some random data.</li>
</ul>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<ul>
<li>The x-axis variable column has to have the right level. If not, you
should convert the column as factor and establish the levels correctly.</li>
<li>Now let’s draw a raincloud plot using <code>sm_raincloud()</code>.</li>
</ul>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-125-1.png" width="547.2" /></p>
<ul>
<li>Let’s change the x-axis labels.</li>
</ul>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value) <span class="sc">+</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-126-1.png" width="547.2" /></p>
<ul>
<li>The filling colors of the violin plots and boxplots can be modified by using <code>scale_fill_manual()</code>.</li>
<li>The border color of the violin plot can be changed by using <code>scale_color_manual()</code>.
<ul>
<li>I will set it <code>transparent</code> to remove the border of the violin plots.</li>
</ul></li>
<li>The color of the points can be used by either of the 2 functions depending on the shape, which can be set within <code>sm_raincloud()</code>.</li>
</ul>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-127-1.png" width="547.2" /></p>
<ul>
<li>Since this dataset is a repeated measures (same subject across days), we can also include lines that show the trend of each subject by adding <code>group</code> argument in <code>sm_raincloud()</code>.</li>
<li><code>sep_level</code> is an argument to specify the degree of separation among points, boxplots and violin plots. When <code>sep_level = 0</code>, they will all be crowded. When <code>sep_level = 4</code>, they will all be separated from each other.
<ul>
<li>I personally prefer when the boxplot and violin plots are together, but not the points. So I will set it <code>sep_level = 2</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-128-1.png" width="547.2" /></p>
<ul>
<li>You can also flip the raincloud plot by setting <code>which_side</code> to <code>left</code>.</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.4</span>, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>) <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-129-1.png" width="547.2" /></p>
<ul>
<li>So far the distribution plots (violin plots) have been vertical. We can change their configuration by setting <code>vertical = FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.4</span>, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>, <span class="at">vertical =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-130-1.png" width="355.2" /></p>
<ul>
<li>The orientation is not correct, so let’s change it by setting <code>which_side = 'right'</code>.</li>
</ul>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject, <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.4</span>, <span class="at">which_side =</span> <span class="st">&#39;right&#39;</span>, <span class="at">vertical =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-131-1.png" width="355.2" /></p>
</div>
<div id="overriding-defaults-of-smplots-themes" class="section level2" number="4.10">
<h2 number="4.10"><span class="header-section-number">4.10</span> Overriding defaults of smplot’s themes</h2>
<ul>
<li><p>You can override all the defaults by adding <code>theme()</code> object to your <strong>ggplot2</strong> graph.</p></li>
<li><p>Here is a bar graph.</p></li>
</ul>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-132-1.png" width="355.2" /></p>
<ul>
<li>Now let’s remove the x-axis title <strong>Day</strong>.</li>
</ul>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-133-1.png" width="355.2" /></p>
<ul>
<li>Let’s customise the graph more by changing the y-axis title and adding a main title.</li>
</ul>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Value&#39;</span>) <span class="sc">+</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Reading performance in children&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-134-1.png" width="355.2" /></p>
</div>
<div id="overriding-defaults-of-smplot-colors" class="section level2" number="4.11">
<h2 number="4.11"><span class="header-section-number">4.11</span> Overriding defaults of smplot colors</h2>
<ul>
<li><p><code>sm_color('blue)</code> prints a hex code for the corresponding. Likewise, <code>sm_color('blue','orange')</code> prints out two hex codes.</p></li>
<li><p>Therefore, instead of using <code>sm_color()</code> function to call forth the colors, you can directly write the hex codes.</p></li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#ff1493&#39;</span>, <span class="st">&#39;#483d8B&#39;</span>) <span class="co"># pink and lavender</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_colors)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-135-1.png" width="355.2" /></p>
<!--chapter:end:04-smplot.Rmd-->
</div>
</div>
<div id="data-analysis-in-development" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Data Analysis (in development)</h1>
<p>This section is in development. Contents will include dplyr (filter, select) and statistics (t-test, correlation, power analysis etc).</p>
<pre><code>
&lt;!--chapter:end:05-coverFig.Rmd--&gt;

---
output: html_document
chapter: Recreating Figures from Front. Genetics 
editor_options:
  chunk_output_type: console
---

# Recreating Figures from Front. Genetics (2021)

This chapter refers to this paper: **Seung Hyun Min, Jiawei Zhou. smplot: An R Package for Easy and Elegant Data Visualization (2021). Frontiers in Genetics, 12:802894.**

Load these packages by typing the codes below.


```r
library(tidyverse) # it has ggplot2 package
library(cowplot) # it allows you to save figures in .png file
library(smplot)</code></pre>
<div id="figure-1---correlation-plot" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Figure 1 - Correlation plot</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>corr1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># ggplot2 default</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot without smplot&#39;</span>)</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, </span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;Base plot only using </span><span class="sc">\n</span><span class="st">the defaults of ggplot2&#39;</span>,</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">25</span>)</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>corr2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> <span class="co"># smplot correlation theme </span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot with smplot&#39;</span>) </span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Base plot + sm_corr_theme()&#39;</span>,</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">29</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">23</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;bold(sm_corr_theme())~</span><span class="sc">\n</span><span class="st">provides~</span><span class="sc">\n</span><span class="st">a~theme~with&#39;</span>) <span class="sc">+</span></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">20</span>,</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;minimalistic background</span><span class="sc">\n</span><span class="st">larger font</span><span class="sc">\n</span><span class="st">centered title&#39;</span>)</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>corr3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_corr_theme</span>() <span class="sc">+</span> <span class="co"># smplot corr theme + p and r values</span></span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;green&#39;</span>), <span class="at">corr_method =</span> <span class="st">&#39;spearman&#39;</span>) <span class="sc">+</span></span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Statistics computed with smplot&#39;</span>) </span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>text3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> drat, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Base plot + sm_corr_theme() +</span><span class="sc">\n</span><span class="st">sm_statCorr()&#39;</span>,</span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">30</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">24</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;bold(sm_statCorr())~from~smplot~computes&#39;</span>) <span class="sc">+</span></span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="fl">22.6</span>, </span>
<span id="cb161-42"><a href="#cb161-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;R and p values from a correlation test.&#39;</span>) <span class="sc">+</span></span>
<span id="cb161-43"><a href="#cb161-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">3.9</span>, <span class="at">y =</span> <span class="dv">18</span>,</span>
<span id="cb161-44"><a href="#cb161-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">It also prints the best-fit </span><span class="sc">\n</span><span class="st">linear regression line </span><span class="sc">\n</span><span class="st">based on the R value.&#39;</span>)</span>
<span id="cb161-45"><a href="#cb161-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-46"><a href="#cb161-46" aria-hidden="true" tabindex="-1"></a>corr_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(corr1, text1, corr2, text2, </span>
<span id="cb161-47"><a href="#cb161-47" aria-hidden="true" tabindex="-1"></a>                      corr3, text3,</span>
<span id="cb161-48"><a href="#cb161-48" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb161-49"><a href="#cb161-49" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb161-50"><a href="#cb161-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb161-51"><a href="#cb161-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb161-52"><a href="#cb161-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-53"><a href="#cb161-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(corr_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-137-1.png" width="696" /></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;corr_plots.png&quot;</span>, </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>          corr_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-2---bar-plot" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Figure 2 - Bar plot</h2>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>bar1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&#39;bar&#39;</span>) <span class="sc">+</span> </span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Bar plot without smplot&#39;</span>)</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Bar~plot~using~bold(stat_summary())~from~ggplot2&#39;</span>,</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">3</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) </span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>bar2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">bar_fill_color =</span> <span class="st">&#39;gray80&#39;</span>) <span class="sc">+</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Bar plot using smplot&#39;</span>)</span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Bar~plot~using~bold(sm_bar())&#39;</span>,</span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb163-28"><a href="#cb163-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Individual points,</span><span class="sc">\n</span><span class="st">larger font,</span><span class="sc">\n</span><span class="st">minimalistic theme</span><span class="sc">\n</span><span class="st">centered title</span><span class="sc">\n</span><span class="st">narrower bar width</span><span class="sc">\n</span><span class="st">error bar&#39;</span>,</span>
<span id="cb163-29"><a href="#cb163-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.5</span>)</span>
<span id="cb163-30"><a href="#cb163-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-31"><a href="#cb163-31" aria-hidden="true" tabindex="-1"></a>bar_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(bar1, text1, bar2, text2, </span>
<span id="cb163-32"><a href="#cb163-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb163-33"><a href="#cb163-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb163-34"><a href="#cb163-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb163-35"><a href="#cb163-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb163-36"><a href="#cb163-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-37"><a href="#cb163-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bar_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-138-1.png" width="696" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;bars.png&quot;</span>, </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>          bar_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-3---boxplot" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> Figure 3 - Boxplot</h2>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/smin95/dataviz/master/data.csv&#39;</span>) </span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>boxplot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Boxplot without smplot&#39;</span>)</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Boxplot~using~bold(geom_boxplot())</span><span class="sc">\n</span><span class="st">~from~ggplot2&#39;</span>,</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">8</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>boxplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Boxplot with smplot&#39;</span>) <span class="co"># smplot&#39;s default</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Boxplot~using~bold(sm_boxplot())&#39;</span>,</span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">11</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Individual points,</span><span class="sc">\n</span><span class="st">larger font,</span><span class="sc">\n</span><span class="st">minimalistic theme</span><span class="sc">\n</span><span class="st">centered title&#39;</span>,</span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">5</span>)</span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a>boxplot_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(boxplot1, text1, boxplot2, text2, </span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boxplot_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-139-1.png" width="696" /></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;boxplots.png&quot;</span>, </span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>          boxplot_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-4---violin-plot" class="section level2" number="5.4">
<h2 number="5.4"><span class="header-section-number">5.4</span> Figure 4 - Violin plot</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>violin1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Violin plot without smplot&#39;</span>) <span class="do">## ggplot2 default</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Violin~plot~using~bold(geom_violin())</span><span class="sc">\n</span><span class="st">~from~ggplot2&#39;</span>,</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">8</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>violin2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Violin plot with smplot&#39;</span>) <span class="co"># smplot default</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Violin~plot~using~bold(sm_violin())</span><span class="sc">\n</span><span class="st">from~smplot&#39;</span>,</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">12</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Individual points,</span><span class="sc">\n</span><span class="st">larger font,</span><span class="sc">\n</span><span class="st">minimalistic theme</span><span class="sc">\n</span><span class="st">centered title</span><span class="sc">\n</span><span class="st">error bars&#39;</span>,</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">4</span>)</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>violin_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(violin1, text1, violin2, text2, </span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(violin_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-140-1.png" width="696" /></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;violins.png&quot;</span>, </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>          violin_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-5---slope-chart" class="section level2" number="5.5">
<h2 number="5.5"><span class="header-section-number">5.5</span> Figure 5 - Slope chart</h2>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>),</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A slope chart with 2 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> slope_n2</span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>),</span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb169-32"><a href="#cb169-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_slope() with 4 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb169-33"><a href="#cb169-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> slope_n4</span>
<span id="cb169-34"><a href="#cb169-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-35"><a href="#cb169-35" aria-hidden="true" tabindex="-1"></a>slopes <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(slope_n2, slope_n4, </span>
<span id="cb169-36"><a href="#cb169-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb169-37"><a href="#cb169-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb169-38"><a href="#cb169-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb169-39"><a href="#cb169-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb169-40"><a href="#cb169-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-41"><a href="#cb169-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(slopes)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-141-1.png" width="768" /></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;slopes.png&quot;</span>, </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>          slopes, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-6---raincloud-plot" class="section level2" number="5.6">
<h2 number="5.6"><span class="header-section-number">5.6</span> Figure 6 - Raincloud plot</h2>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>raincloud1 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df1, <span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">0</span>, <span class="at">line_alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">2.85</span>), </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>),</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A raincloud plot with 2 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;sep_level = 0</span><span class="sc">\n</span><span class="st">which_side = &quot;right&quot;&#39;</span>,</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">2.5</span>, </span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;Separation is minimum amongst</span><span class="sc">\n</span><span class="st">points, violin plot and boxplot.</span><span class="sc">\n</span><span class="st">This can be adjusted with&#39;</span>) <span class="sc">+</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.6</span>, <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">  sep_level (0-4).&#39;</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;The violin plots face to the right.</span><span class="sc">\n</span><span class="st">This can be be changed with&#39;</span>) <span class="sc">+</span></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">1.1</span>, <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">   which_side (&quot;right&quot;, &quot;left&quot;, &quot;mixed&quot;).&#39;</span>, <span class="at">fontface =</span> <span class="dv">2</span>)</span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>raincloud2 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df1, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject,</span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.2</span>, <span class="at">which_side =</span> <span class="st">&#39;mixed&#39;</span>) <span class="sc">+</span></span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">2.85</span>), </span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>),</span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb171-33"><a href="#cb171-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_raincloud() with 2 x-levels&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-34"><a href="#cb171-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-35"><a href="#cb171-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb171-36"><a href="#cb171-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-37"><a href="#cb171-37" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb171-38"><a href="#cb171-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb171-39"><a href="#cb171-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;sep_level = 2</span><span class="sc">\n</span><span class="st">which_side = &quot;mixed&quot;&#39;</span>,</span>
<span id="cb171-40"><a href="#cb171-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">4.7</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb171-41"><a href="#cb171-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">2.8</span>, </span>
<span id="cb171-42"><a href="#cb171-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;Default sep_level is set at 2</span><span class="sc">\n</span><span class="st"> but this can be changed (0-4).&#39;</span>) <span class="sc">+</span></span>
<span id="cb171-43"><a href="#cb171-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb171-44"><a href="#cb171-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;The violin plots face both to the</span><span class="sc">\n</span><span class="st">left (x=1) and right (x=2).&#39;</span>) <span class="sc">+</span></span>
<span id="cb171-45"><a href="#cb171-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">label =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">which_side = &quot;mixed&quot; only works when</span><span class="sc">\n</span><span class="st">there are 2 x discrete levels.&#39;</span>, <span class="at">fontface =</span> <span class="dv">2</span>)</span>
<span id="cb171-46"><a href="#cb171-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-47"><a href="#cb171-47" aria-hidden="true" tabindex="-1"></a>raincloud3 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df1, <span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb171-48"><a href="#cb171-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb171-49"><a href="#cb171-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">4</span>, <span class="at">line_alpha =</span> <span class="fl">0.2</span>, <span class="at">which_side =</span> <span class="st">&#39;left&#39;</span>) <span class="sc">+</span></span>
<span id="cb171-50"><a href="#cb171-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">2.85</span>), </span>
<span id="cb171-51"><a href="#cb171-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>),</span>
<span id="cb171-52"><a href="#cb171-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb171-53"><a href="#cb171-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb171-54"><a href="#cb171-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb171-55"><a href="#cb171-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;A raincloud with no overlap&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-56"><a href="#cb171-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-57"><a href="#cb171-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb171-58"><a href="#cb171-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-59"><a href="#cb171-59" aria-hidden="true" tabindex="-1"></a>text3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb171-60"><a href="#cb171-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb171-61"><a href="#cb171-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;sep_level = 4</span><span class="sc">\n</span><span class="st">which_side = &quot;left&quot;&#39;</span>,</span>
<span id="cb171-62"><a href="#cb171-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb171-63"><a href="#cb171-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.5</span>,</span>
<span id="cb171-64"><a href="#cb171-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="st">&#39;The violin plots face to the left.&#39;</span>)</span>
<span id="cb171-65"><a href="#cb171-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-66"><a href="#cb171-66" aria-hidden="true" tabindex="-1"></a>raincloud_2x_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(raincloud1, text1, </span>
<span id="cb171-67"><a href="#cb171-67" aria-hidden="true" tabindex="-1"></a>                           raincloud2, text2, </span>
<span id="cb171-68"><a href="#cb171-68" aria-hidden="true" tabindex="-1"></a>                           raincloud3, text3,  </span>
<span id="cb171-69"><a href="#cb171-69" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb171-70"><a href="#cb171-70" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb171-71"><a href="#cb171-71" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb171-72"><a href="#cb171-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb171-73"><a href="#cb171-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-74"><a href="#cb171-74" aria-hidden="true" tabindex="-1"></a>raincloud4 <span class="ot">&lt;-</span> <span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb171-75"><a href="#cb171-75" aria-hidden="true" tabindex="-1"></a>             <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb171-76"><a href="#cb171-76" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb171-77"><a href="#cb171-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), </span>
<span id="cb171-78"><a href="#cb171-78" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>),</span>
<span id="cb171-79"><a href="#cb171-79" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb171-80"><a href="#cb171-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb171-81"><a href="#cb171-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb171-82"><a href="#cb171-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Four discrete levels of x, sep_level = 2, which_side = &quot;right&quot;&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-83"><a href="#cb171-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-84"><a href="#cb171-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))</span>
<span id="cb171-85"><a href="#cb171-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-86"><a href="#cb171-86" aria-hidden="true" tabindex="-1"></a>raincloud_all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(raincloud_2x_all, </span>
<span id="cb171-87"><a href="#cb171-87" aria-hidden="true" tabindex="-1"></a>                           raincloud4,  </span>
<span id="cb171-88"><a href="#cb171-88" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;D&quot;</span>),</span>
<span id="cb171-89"><a href="#cb171-89" aria-hidden="true" tabindex="-1"></a>                           <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb171-90"><a href="#cb171-90" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb171-91"><a href="#cb171-91" aria-hidden="true" tabindex="-1"></a>                           <span class="at">scale =</span> <span class="fl">0.95</span>,</span>
<span id="cb171-92"><a href="#cb171-92" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">7.5</span>,<span class="fl">2.5</span>))</span>
<span id="cb171-93"><a href="#cb171-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-94"><a href="#cb171-94" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(raincloud_all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-142-1.png" width="696" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;rainclouds.png&quot;</span>, </span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>          raincloud_all, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="figure-7---case-study" class="section level2" number="5.7">
<h2 number="5.7"><span class="header-section-number">5.7</span> Figure 7 - Case study</h2>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>) <span class="co"># generate random data</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>method1 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">19</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">2.5</span>)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(method1,method2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>Method <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Method 1&#39;</span>, <span class="st">&#39;Method 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(method1))</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Method)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co"># slope chart</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Value, </span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> Subject, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Method 1&#39;</span>, <span class="st">&#39;Method 2&#39;</span>),</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Slope chart&#39;</span>) <span class="sc">+</span> </span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="sc">+</span></span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Gene expression level&#39;</span>) <span class="sc">+</span> </span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">label =</span> <span class="st">&#39;sm_slope()&#39;</span>) <span class="ot">-&gt;</span> slope</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot</span></span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first =</span> method1, <span class="at">second =</span> method2)</span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a>corr_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df3, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> first, <span class="at">y =</span> second)) <span class="sc">+</span> </span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">sm_corr_theme</span>(<span class="at">borders =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_statCorr</span>(<span class="at">color =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">corr_method =</span> <span class="st">&#39;pearson&#39;</span>,</span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">label_y =</span> <span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Correlation plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Method 1&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Method 2&#39;</span>) <span class="sc">+</span></span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">2.3</span>, <span class="at">label =</span> <span class="st">&#39;sm_corr_theme() + sm_statCorr()&#39;</span>)</span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a><span class="co"># BA plot</span></span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">sm_statBlandAlt</span>(df3<span class="sc">$</span>first,df3<span class="sc">$</span>second)</span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a>ba_plot <span class="ot">&lt;-</span> <span class="fu">sm_bland_altman</span>(df3<span class="sc">$</span>first, df3<span class="sc">$</span>second, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Mean&#39;</span>, <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>mean_diff,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>mean_diff <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Upper limit&#39;</span>, <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>upper_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>upper_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="st">&#39;Lower limit&#39;</span>, <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">+</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb173-48"><a href="#cb173-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">signif</span>(res<span class="sc">$</span>lower_limit,<span class="dv">3</span>), <span class="at">x =</span> <span class="fl">4.3</span>, <span class="at">y =</span> res<span class="sc">$</span>lower_limit <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb173-49"><a href="#cb173-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Bland-Altman plot&#39;</span>) <span class="sc">+</span></span>
<span id="cb173-50"><a href="#cb173-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">label =</span> <span class="st">&#39;sm_statBlandAlt() + </span><span class="sc">\n</span><span class="st">sm_bland_altman()&#39;</span>)</span>
<span id="cb173-51"><a href="#cb173-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-52"><a href="#cb173-52" aria-hidden="true" tabindex="-1"></a>case_study <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(slope, corr_plot, ba_plot, </span>
<span id="cb173-53"><a href="#cb173-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb173-54"><a href="#cb173-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="co"># horizontal position of ABC labels</span></span>
<span id="cb173-55"><a href="#cb173-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb173-56"><a href="#cb173-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb173-57"><a href="#cb173-57" aria-hidden="true" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb173-58"><a href="#cb173-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-59"><a href="#cb173-59" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(case_study)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-143-1.png" width="1051.2" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;case_study.png&quot;</span>, </span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>          case_study, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="recreating-the-cover-figure" class="section level2" number="5.8">
<h2 number="5.8"><span class="header-section-number">5.8</span> Recreating the Cover Figure</h2>
<p>Load these packages by typing the codes below.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smplot)</span></code></pre></div>
</div>
<div id="boxplot-and-violin-plot-1" class="section level2" number="5.9">
<h2 number="5.9"><span class="header-section-number">5.9</span> Boxplot and violin plot</h2>
<div id="upload-pre-existing-data" class="section level3 unnumbered">
<h3 class="unnumbered">Upload pre-existing data</h3>
<ul>
<li>Upload the data using <code>read_csv()</code>.</li>
<li>Then, convert the Day levels into factor to override the alphabetical order.</li>
</ul>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/smin95/dataviz/master/data.csv&#39;</span>) </span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span></code></pre></div>
<ul>
<li>Plot the boxplot using <code>sm_boxplot()</code> with your preferred aesthetics.</li>
<li>Then store the figure into a variable.</li>
</ul>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_boxplot()&#39;</span>) <span class="sc">+</span> </span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> boxplot</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boxplot)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-146-1.png" width="355.2" /></p>
<ul>
<li>Plot the violin plot using <code>sm_violin()</code> and store it in a variable.</li>
</ul>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_violin()&#39;</span>) <span class="sc">+</span> </span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))<span class="ot">-&gt;</span> violin</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(violin)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-147-1.png" width="355.2" /></p>
</div>
</div>
<div id="bar-plot-and-slope-chart" class="section level2" number="5.10">
<h2 number="5.10"><span class="header-section-number">5.10</span> Bar plot and slope chart</h2>
<ul>
<li>Generate random data.</li>
</ul>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<ul>
<li>Draw a bar plot using <code>sm_bar()</code> and store it in a variable.</li>
</ul>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">point_alpha =</span> <span class="dv">1</span>, <span class="at">bar_alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">bar_fill_color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_bar()&#39;</span>) <span class="sc">+</span> </span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> bar</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bar)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-149-1.png" width="355.2" /></p>
<ul>
<li>Draw a slope chart using <code>sm_slope()</code> and store it in a variable.</li>
</ul>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>),</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_slope()&#39;</span>) <span class="sc">+</span> </span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> slope</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(slope)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-150-1.png" width="355.2" /></p>
</div>
<div id="raincloud-plot" class="section level2" number="5.11">
<h2 number="5.11"><span class="header-section-number">5.11</span> Raincloud plot</h2>
<ul>
<li>Generate random data.</li>
</ul>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span></code></pre></div>
<ul>
<li>Draw a raincloud plot using <code>sm_raincloud()</code> and store it in a variable.</li>
</ul>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject,</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), </span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>),</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;sm_raincloud()&#39;</span>) <span class="sc">+</span> </span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> raincloud</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(raincloud)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-152-1.png" width="547.2" /></p>
</div>
<div id="put-all-figures-together" class="section level2" number="5.12">
<h2 number="5.12"><span class="header-section-number">5.12</span> Put all figures together</h2>
<ul>
<li>First add boxplot, violin plot, bar plot and slope chart together in 2x2 using <code>plot_grid()</code> from the <code>cowplot</code> package.</li>
</ul>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>add_four <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(boxplot, violin, bar, slope,</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(add_four)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-153-1.png" width="710.4" /></p>
<ul>
<li>Then, add the raincloud plot below the combined 2x2 figure (<code>add_four</code>).</li>
</ul>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(add_four, raincloud, <span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">1.05</span>))</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(all)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-154-1.png" width="710.4" /></p>
<ul>
<li>Now save the figure in a png file in your working directory using <code>save_plot()</code> from the <code>cowplot</code> package.</li>
</ul>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;sample.png&quot;</span>, </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>          tgd, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<div id="the-codes-only-with-no-discussion" class="section level3 unnumbered">
<h3 class="unnumbered">The codes only with no discussion</h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/smin95/dataviz/master/data.csv&#39;</span>) </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;Three&#39;</span>))</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span> </span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_boxplot</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Boxplot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> boxplot</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color =</span> Day)) <span class="sc">+</span> </span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_violin</span>() <span class="sc">+</span> </span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Violin plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))<span class="ot">-&gt;</span> violin</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># generate random data</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">2</span>)</span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-24"><a href="#cb187-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb187-25"><a href="#cb187-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_bar</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">point_alpha =</span> <span class="dv">1</span>, <span class="at">bar_alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb187-26"><a href="#cb187-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">bar_fill_color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb187-27"><a href="#cb187-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb187-28"><a href="#cb187-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb187-29"><a href="#cb187-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Bar plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb187-30"><a href="#cb187-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> bar</span>
<span id="cb187-31"><a href="#cb187-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-32"><a href="#cb187-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, </span>
<span id="cb187-33"><a href="#cb187-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> Subject, <span class="at">fill =</span> Day)) <span class="sc">+</span></span>
<span id="cb187-34"><a href="#cb187-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sm_slope</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>),</span>
<span id="cb187-35"><a href="#cb187-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">line_alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb187-36"><a href="#cb187-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_color</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb187-37"><a href="#cb187-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Slope chart&#39;</span>) <span class="sc">+</span> </span>
<span id="cb187-38"><a href="#cb187-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> slope</span>
<span id="cb187-39"><a href="#cb187-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-40"><a href="#cb187-40" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb187-41"><a href="#cb187-41" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># generate random data</span></span>
<span id="cb187-42"><a href="#cb187-42" aria-hidden="true" tabindex="-1"></a>day1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb187-43"><a href="#cb187-43" aria-hidden="true" tabindex="-1"></a>day2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb187-44"><a href="#cb187-44" aria-hidden="true" tabindex="-1"></a>day3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="fl">1.5</span>)</span>
<span id="cb187-45"><a href="#cb187-45" aria-hidden="true" tabindex="-1"></a>day4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">2</span>)</span>
<span id="cb187-46"><a href="#cb187-46" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&#39;S&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)), <span class="dv">4</span>)</span>
<span id="cb187-47"><a href="#cb187-47" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(day1,day2,day3,day4),<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb187-48"><a href="#cb187-48" aria-hidden="true" tabindex="-1"></a>Day <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Day 1&#39;</span>, <span class="st">&#39;Day 2&#39;</span>, <span class="st">&#39;Day 3&#39;</span>, <span class="st">&#39;Day 4&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(day1))</span>
<span id="cb187-49"><a href="#cb187-49" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Subject, Data, Day)</span>
<span id="cb187-50"><a href="#cb187-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-51"><a href="#cb187-51" aria-hidden="true" tabindex="-1"></a><span class="fu">sm_raincloud</span>(<span class="at">data =</span> df2, <span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">group =</span> Subject,</span>
<span id="cb187-52"><a href="#cb187-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">boxplot_alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb187-53"><a href="#cb187-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">sep_level =</span> <span class="dv">2</span>, <span class="at">line_alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb187-54"><a href="#cb187-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">4.75</span>), </span>
<span id="cb187-55"><a href="#cb187-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>),</span>
<span id="cb187-56"><a href="#cb187-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb187-57"><a href="#cb187-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="st">&#39;transparent&#39;</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb187-58"><a href="#cb187-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">sm_palette</span>(<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb187-59"><a href="#cb187-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Raincloud plot&#39;</span>) <span class="sc">+</span> </span>
<span id="cb187-60"><a href="#cb187-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Day&#39;</span>) <span class="sc">+</span> </span>
<span id="cb187-61"><a href="#cb187-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="ot">-&gt;</span> raincloud</span>
<span id="cb187-62"><a href="#cb187-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-63"><a href="#cb187-63" aria-hidden="true" tabindex="-1"></a>add_four <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(boxplot, violin, bar, slope,</span>
<span id="cb187-64"><a href="#cb187-64" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span><span class="dv">2</span>,</span>
<span id="cb187-65"><a href="#cb187-65" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb187-66"><a href="#cb187-66" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="fl">0.95</span>)</span>
<span id="cb187-67"><a href="#cb187-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-68"><a href="#cb187-68" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(add_four, raincloud, <span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb187-69"><a href="#cb187-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb187-70"><a href="#cb187-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">1.05</span>))</span>
<span id="cb187-71"><a href="#cb187-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-72"><a href="#cb187-72" aria-hidden="true" tabindex="-1"></a><span class="fu">save_plot</span>(<span class="st">&quot;sample.png&quot;</span>, </span>
<span id="cb187-73"><a href="#cb187-73" aria-hidden="true" tabindex="-1"></a>          tgd, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">base_asp =</span> .<span class="dv">95</span>,</span>
<span id="cb187-74"><a href="#cb187-74" aria-hidden="true" tabindex="-1"></a>          <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb187-75"><a href="#cb187-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-76"><a href="#cb187-76" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!--</span>chapter<span class="sc">:</span>end<span class="sc">:</span><span class="dv">06</span><span class="sc">-</span>manuscriptFig.Rmd<span class="sc">-</span><span class="ot">-&gt;</span></span></code></pre></div>
</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
